{"version":3,"sources":["webpack://VClerkWidget/./node_modules/skylinkjs/src/adapter.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/getSDPCommonSupports.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/constants.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/utils/skylinkEvent.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/stream-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/datachannel-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/peer-handshake-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/init-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/candidate-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/peer-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/socket-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/media-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/constants.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/messages.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/parseMediaOptions.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveTransceiverMid.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveMediaState.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveMediaId.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/buildPeerMediaInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveStreamIdOfTrack.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveTracks.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/updatePeerMediaInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/defaults/socketConfig.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/defaults/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/helpers/createSocket.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/helpers/processSignalingMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getPeerInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getCurrentSessionInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getUserInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getUserData.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/setUserData.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/prepStopUserMediaStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/tryStopStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/removeSenderFromList.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/prepStopStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/stopAddedStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/removeTracks.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/listenForEventAndDeleteMediaInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/stopAddedStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/updateMediaInfoMediaState.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/deleteStreamFromState.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/dispatchOnLocalStreamEnded.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/prepStopScreenStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/initRefreshConnectionAndResolve.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/stopReplacedStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/stopStream/stopReplacedStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getPeersDataChannels.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getPeersCustomSettings.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/getPeersStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/helpers/setGreatestPeerPriorityWeight.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-data/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/helpers/handleSocketClose.js","webpack://VClerkWidget/./node_modules/skylinkjs/configs/app.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleSignalingStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/onconnect.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/ondisconnect.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/onerror.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/onreconnectattempt.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/onreconnectfailed.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/callbacks/onreconnecterror.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/helpers/setSocketCallbacks.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/helpers/shouldBufferMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/signaling-server-helpers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/deleteEncryptSecrets.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/setEncryptSecrets.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/utils.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/setSelectedSecretId.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/helpers/getMessageConfig.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/helpers/sendMessageToSig.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/helpers/dispatchOnIncomingMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/utils/skylinkError.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/helpers/trySendMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/getMessageConfig.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/encryptMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/helpers/tryDecryptMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/encrypted-messaging/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/async-messaging/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/async-messaging/helpers/getMessageConfig.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/async-messaging/helpers/parseDecryptedMessageData.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/async-messaging/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/messaging/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/userMessageHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/compatibility/dependencies.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/compatibility/ice-connection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/compatibility/peer-connection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/helpers/setIceServers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/helpers/addIceCandidateFromQueue.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleIceCandidateStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/helpers/addIceCandidate.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleIceGatheringStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/helpers/onIceCandidate.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/helpers/addIceCandidateToQueue.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/ice-connection/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/inRoomHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/parsers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/parsers/enterAndWelcome.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/parsers/parseUserInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/commons/processPeer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleNegotiationStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/commons/enterAndWelcome.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/enterHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/commons/offerAndAnswer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/offerHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/answerHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/renegotiateIfNeeded.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/refresh-connection/buildRefreshConnectionResult.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/refresh-connection/refreshConnection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/answerAckHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/welcomeHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/candidateHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/getPeerListHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleSessionStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/introduceErrorHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleIceConnectionStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/byeHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/commons/offerAndAnswer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/createOffer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/createPeerConnection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/addPeer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/createAnswer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/sendMessageToDataChannel.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/processDataChannelData.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/callbacks/onmessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleDataChannelStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/callbacks/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/callbacks/onopen.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/callbacks/onerror.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/callbacks/onbufferedamountlow.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/callbacks/onclose.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/data-transfer-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/sendP2PMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/closeDataChannel.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/refresh-connection/sendRestartOfferMsg.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/refresh-connection/restartPeerConnection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/refresh-connection/restartMCUConnection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/refresh-connection/refreshPeerConnection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/createDataChannel.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/getPeersInRoom.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/signalingEndOfCandidates.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/getDataChannelBuffer.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/data-channel/refreshDataChannel.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/buildPeerInformations.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/getConnectionStatus.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/closePeerConnection.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/updatePeerInformationsMediaStatus.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/processNewSender.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/ondatachannel.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/onicecandidate.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleBandwidthStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/bandwidthAdjuster.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/oniceconnectionstatechange.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/ontrack.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/onicegatheringstatechange.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/onsignalingstatechange.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/onremovetrack.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/peer-addition/callbacks/onsenderadded.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/streamHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleRecordingStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/recordingHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/rtmpHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/helpers/dispatchMediaStateChangeEvents.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/helpers/mediaInfoEventHelpers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/audioStateChangeHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/videoStateChangeHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/mediaInfoEventHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/helpers/muteEventHelpers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/helpers/shouldDropMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/redirectHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/muteVideoEventHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/muteAudioEventHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/setUserDataHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/handlers/storedMessagesHandler.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-handler/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/joinRoomMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/enterRoomMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/welcomeMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/offerMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/answerMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/answerAckMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/candidateMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/setUserDataMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/getPeerListMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/restartOfferMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/streamMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/recordingMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/rtmpMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/byeMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/roomLockMeessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/mediaInfoEventMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/muteAudioEventMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/muteVideoEventMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/getStoredMessagesMessage.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/builders/getUserMessages.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/message-builder/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/signaling-server/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/sendMediaInfoMsg.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/parseSDPForTransceiverMid.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveValueGivenTransceiverMid.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/retrieveFormattedMediaInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/resetPeerMedia.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/populatePeerMediaInfo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/helpers/processOnRemoveTrack.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-media/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/muteStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/addLocalMediaStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/replaceTrack.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/sendStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/getStreamSources.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/processNewStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/processStreamInState.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/parseStreamSettings.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/prepMediaAccessRequest.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/onRemoteTrackAdded.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/onStreamAccessError.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/getStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/getScreenSources.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/updateStreamsMediaStatus.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/updateRemoteStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/retrieveVideoStreams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/splitAudioAndVideoStream.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/updateStreamsMutedSettings.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/media-stream/helpers/onStreamAccessSuccess.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/utils/helpers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/utils/skylinkEventManager.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/logger/log-helpers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/logger-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/logger/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/setSDPCodecParams.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/removeSDPUnknownAptRtx.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/getSDPCodecsSupport.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/getCodecsSupport.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/removeSDPFilteredCandidates.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/setSDPCodec.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/setSDPBitrate.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/removeSDPCodecs.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/removeSDPREMBPackets.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/handleSDPConnectionSettings.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/removeSDPFirefoxH264Pref.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/renderSDPOutput.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/getSDPICECandidates.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/getSDPSelectedCodec.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/setOriginalDTLSRole.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/modifyDTLSRole.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/helpers/getTransceiverMid.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/session-description/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/parseSelectedCandidatePair.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/parseCertificates.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/tabulateStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/parseAudio.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/parseVideo.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/parsers/parseMedia.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/helpers/statistics/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/screen-sharing/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/screen-sharing/helpers/updateScreenStreamState.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-connection/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/screen-sharing/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-states.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/peer-privileged/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/api-server/defaultOptions.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/models/skylink-room.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/models/skylink-user.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/models/api-response.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/api-server/api-helpers.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/server-communication/api-server/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/room/leaveRoom.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-stats/handleClientStats.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/models/skylink-state.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/room/joinRoom.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/room/lockRoom.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/skylink-events/room-events.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/room/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/recording/recording.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/recording/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/rtmp/helpers/sendRTMPMessageViaSig.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/rtmp/helpers/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/rtmp/helpers/checkRTMPDependencies.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/rtmp/helpers/registerRTMPEventListenersAndResolve.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/features/rtmp/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/public/index.js","webpack://VClerkWidget/./node_modules/skylinkjs/src/index.js"],"names":["options","onwebrtcreadyDone","WebRTCPlugin","plugin","_onwebrtcreadies","webRTCReady","baseCallback","Error","callback","window","require","_defineMediaSourcePolyfill","push","maybeThroughWebRTCReady","length","forEach","onwebrtcready","webrtcDetectedBrowser","webrtcDetectedVersion","webrtcMinimumVersion","webrtcDetectedDCSupport","parseWebrtcDetectedBrowser","hasMatch","opr","addons","opera","navigator","userAgent","indexOf","match","parseInt","webrtcDetectedType","chromiumVersion","parseFloat","split","document","documentMode","exec","StyleMedia","InstallTrigger","chrome","webstore","test","HTMLElement","safari","pushNotification","toString","AppleWebKitBuild","isMobile","hasNativeImpl","majorVersion","minorVersion","nativeImplIsOverridable","forceSafariPlugin","addExtensions","attachMediaStream","reattachMediaStream","mozGetUserMedia","element","stream","srcObject","to","from","webkitGetUserMedia","src","URL","createObjectURL","console","error","targetMid","sessionDescription","roomKey","state","getSkylinkState","offer","audio","video","AdapterJS","currentCodecSupport","peerInformations","beSilentOnParseLogs","getInitOptions","sdp","h264","vp8","opus","peerAgent","agent","name","Object","keys","remoteCodecs","getSDPCodecsSupport","localCodecs","ac","hasOwnProperty","vc","ON_INCOMING_STREAM","ON_INCOMING_SCREEN_STREAM","STREAM_ENDED","PEER_UPDATED","PEER_JOINED","PEER_LEFT","DATA_CHANNEL_STATE","ON_INCOMING_MESSAGE","HANDSHAKE_PROGRESS","SERVER_PEER_JOINED","SERVER_PEER_LEFT","CANDIDATES_GATHERED","DATA_STREAM_STATE","DATA_TRANSFER_STATE","ON_INCOMING_DATA","ON_INCOMING_DATA_REQUEST","ON_INCOMING_DATA_STREAM","ON_INCOMING_DATA_STREAM_STARTED","ON_INCOMING_DATA_STREAM_STOPPED","GET_PEERS_STATE_CHANGE","SESSION_DISCONNECT","STREAM_MUTED","CHANNEL_OPEN","CHANNEL_REOPEN","CHANNEL_CLOSE","CHANNEL_MESSAGE","CHANNEL_ERROR","CHANNEL_RETRY","SOCKET_ERROR","SYSTEM_ACTION","MEDIA_ACCESS_FALLBACK","MEDIA_ACCESS_REQUIRED","MEDIA_ACCESS_STOPPED","MEDIA_ACCESS_SUCCESS","RECORDING_STATE","LOCAL_MEDIA_MUTED","MEDIA_ACCESS_ERROR","GET_CONNECTION_STATUS_STATE_CHANGE","READY_STATE_CHANGE","ROOM_LOCK","INTRODUCE_STATE_CHANGE","BYE","RTMP_STATE","LOGGED_ON_CONSOLE","MEDIA_INFO_DELETED","STORED_MESSAGES","ENCRYPT_SECRETS_UPDATED","PERSISTENT_MESSAGE_STATE","detail","this","onIncomingStream","onIncomingScreenStream","streamEnded","streamMuted","onDataChannelStateChanged","onIncomingMessage","handshakeProgress","readyStateChange","candidateProcessingState","candidateGenerationState","iceConnectionState","peerUpdated","peerJoined","peerLeft","serverPeerLeft","getPeersStateChange","peerConnectionState","getConnectionStatusStateChange","socketError","mediaAccessFallback","rtmpState","mediaAccessError","CONNECTING","OPEN","CLOSING","CLOSED","ERROR","CREATE_ERROR","BUFFERED_AMOUNT_LOW","SEND_MESSAGE_ERROR","DATA_CHANNEL_TYPE","MESSAGING","DATA","DATA_CHANNEL_MESSAGE_ERROR","MESSAGE","TRANSFER","DATA_TRANSFER_DATA_TYPE","BINARY_STRING","ARRAY_BUFFER","BLOB","STRING","DT_PROTOCOL_VERSION","DATA_TRANSFER_TYPE","UPLOAD","DOWNLOAD","DATA_TRANSFER_SESSION_TYPE","DATA_URL","UPLOAD_REQUEST","UPLOAD_STARTED","DOWNLOAD_STARTED","REJECTED","CANCEL","UPLOADING","DOWNLOADING","UPLOAD_COMPLETED","DOWNLOAD_COMPLETED","USER_REJECTED","USER_UPLOAD_REQUEST","START_ERROR","SENDING_STARTED","SENDING_STOPPED","RECEIVING_STARTED","RECEIVING_STOPPED","RECEIVED","SENT","NEW","GATHERING","COMPLETED","DROPPED","BUFFERED","PROCESSING","PROCESS_SUCCESS","PROCESS_ERROR","STARTING","CHECKING","CONNECTED","FAILED","TRICKLE_FAILED","DISCONNECTED","TURN_TRANSPORT","UDP","TCP","ANY","NONE","ALL","STABLE","HAVE_LOCAL_OFFER","HAVE_REMOTE_OFFER","GET_CONNECTION_STATUS_STATE","RETRIEVING","RETRIEVE_SUCCESS","RETRIEVE_ERROR","SERVER_PEER_TYPE","MCU","BUNDLE_POLICY","MAX_COMPAT","BALANCED","MAX_BUNDLE","RTCP_MUX_POLICY","REQUIRE","NEGOTIATE","PEER_CERTIFICATE","RSA","ECDSA","AUTO","ENTER","WELCOME","OFFER","ANSWER","ANSWER_ACK","GET_PEERS_STATE","ENQUIRED","DISPATCHED","INTRODUCE_STATE","INTRODUCING","WARNING","REJECT","LOCKED","SYSTEM_ACTION_REASON","CREDENTIALS_EXPIRED","CREDENTIALS_ERROR","DUPLICATED_LOGIN","ROOM_NOT_STARTED","EXPIRED","ROOM_LOCKED","FAST_MESSAGE","ROOM_CLOSING","ROOM_CLOSED","SERVER_ERROR","KEY_ERROR","INIT","LOADING","READY_STATE_CHANGE_ERROR","API_INVALID","API_DOMAIN_NOT_MATCH","API_CORS_DOMAIN_NOT_MATCH","API_CREDENTIALS_INVALID","API_CREDENTIALS_NOT_MATCH","API_INVALID_PARENT_KEY","API_NO_MEETING_RECORD_FOUND","API_OVER_SEAT_LIMIT","API_RETRIEVAL_FAILED","API_WRONG_ACCESS_DOMAIN","XML_HTTP_REQUEST_ERROR","XML_HTTP_NO_REPONSE_ERROR","NO_SOCKET_IO","NO_XMLHTTPREQUEST_SUPPORT","NO_WEBRTC_SUPPORT","NO_PATH","ADAPTER_NO_LOADED","PARSE_CODECS","REGIONAL_SERVER","APAC1","US1","PRIORITY_WEIGHT_SCHEME","ENFORCE_OFFERER","ENFORCE_ANSWERER","LOG_LEVEL","DEBUG","LOG","INFO","WARN","CONNECTION_FAILED","RECONNECTION_FAILED","CONNECTION_ABORTED","RECONNECTION_ABORTED","RECONNECTION_ATTEMPT","SOCKET_FALLBACK","NON_FALLBACK","FALLBACK_PORT","FALLBACK_SSL_PORT","LONG_POLLING","LONG_POLLING_SSL","SM_PROTOCOL_VERSION","VIDEO_CODEC","VP8","H264","VP9","AUDIO_CODEC","ISAC","OPUS","ILBC","G722","PCMU","PCMA","MEDIA_SOURCE","SCREEN","WINDOW","TAB","TAB_AUDIO","APPLICATION","BROWSER","CAMERA","VIDEO_RESOLUTION","QQVGA","width","height","HQVGA","QVGA","WQVGA","HVGA","VGA","WVGA","FWVGA","SVGA","DVGA","WSVGA","HD","HDPLUS","FHD","QHD","WQXGAPLUS","UHD","UHDPLUS","FUHD","QUHD","MEDIA_ACCESS_FALLBACK_STATE","FALLBACKING","FALLBACKED","START","STOP","LINK","CHUNK_FILE_SIZE","MOZ_CHUNK_FILE_SIZE","BINARY_FILE_SIZE","MOZ_BINARY_FILE_SIZE","CHUNK_DATAURL_SIZE","DC_PROTOCOL_TYPE","WRQ","ACK","SIG_MESSAGE_TYPE","JOIN_ROOM","IN_ROOM","CANDIDATE","REDIRECT","UPDATE_USER","PUBLIC_MESSAGE","PRIVATE_MESSAGE","STREAM","GROUP","GET_PEERS","PEER_LIST","INTRODUCE","INTRODUCE_ERROR","APPROACH","START_RECORDING","STOP_RECORDING","RECORDING","END_OF_CANDIDATES","START_SCREENSHARE","START_RTMP","STOP_RTMP","RTMP","MEDIA_INFO_EVENT","MUTE_VIDEO_EVENT","MUTE_AUDIO_EVENT","GET_STORED_MESSAGES","STREAM_STATUS","ENDED","REPLACED_STREAM_ENDED","SCREENSHARE_REPLACE_START","USER_MEDIA_REPLACE_START","GROUP_MESSAGE_LIST","VIDEO_QUALITY","HQ","SQ","LQ","SDP_SEMANTICS","PLAN_B","UNIFIED","MEDIA_STATUS","MUTED","ACTIVE","UNAVAILABLE","SKYLINK_EVENT","SKYLINK_ERROR","STATS_MODULE","SESSION_DESCRIPTION","PEER_CONNECTION","CANDIDATE_HANDLER","DATA_CHANNEL","SIG_SERVER","PEER_MEDIA","PEER_INFORMATION","ROOM","MEDIA_STREAM","ASYNC_MESSAGING","ENCRYPTED_MESSAGING","MEDIA_TYPE","AUDIO_MIC","VIDEO_CAMERA","VIDEO_SCREEN","VIDEO_OTHER","AUDIO","VIDEO","TRACK_READY_STATE","LIVE","TRACK_KIND","MEDIA_STATE","STOPPED","MEDIA_INFO","PUBLISHER_ID","MEDIA_ID","TRANSCEIVER_MID","MEDIA_META_DATA","SIMULCAST","STREAM_ID","SDK_VERSION","SDK_NAME","WEB","ANDROID","IOS","CPP","API_VERSION","SIGNALING_VERSION","CHROME","FIREFOX","SAFARI","REACT_NATIVE","PEER_TYPE","SOCKET_EVENTS","CONNECT","DISCONNECT","RECONNECT_ATTEMPT","RECONNECT_SUCCESS","RECONNECT_FAILED","RECONNECT_ERROR","SOCKET_TYPE","POLLING","WEBSOCKET","XHR_POLLING","JSONP_POLLING","STATES","SIGNALING","EVENTS","ERRORS","NO_ADAPTER","NO_FETCH_SUPPORT","NO_APP_KEY","AUTH_CORS","AUTH_GENERAL","SOCKET_CREATE_FAILED","SOCKET_ERROR_ABORT","API_SUCCESS","CODEC_SUPPORT","SCREEN_SHARE","NOT_IN_ROOM","NO_PEERS","LEAVE_ROOM","DROPPING_HANGUP","LEAVE_ALL_ROOMS","SUCCESS","SENDING_BYE","DISCONNECT_SOCKET","REMOVE_STATE","ROOM_STATE","NOT_FOUND","LEFT","NO_ROOM_NAME","PEER_INFORMATIONS","NO_PEER_INFO","UPDATE_USER_DATA","OUTDATED_MSG","USER_DATA_NOT_JSON","NO_PEER_CONNECTION","REMOVE_TRACK","REPLACE_TRACK","REFRESH","end_of_candidates","end_of_candidate_failure","not_initialised","getstats_api_not_available","connection_status_no_pc","ice_connection_state","peer_connection_state","ice_gathering_state","refresh_start","refresh_failed","refresh_completed","refresh_peer_failed","refresh_peer_success","refresh_no_peer_connection","refresh_peerId_no_match","refresh_no_edge_support","refresh_not_supported","peerId_does_not_exist","PEER_PRIVILEGED","not_privileged","no_appkey","getPeerListFromServer","ICE_CANDIDATE","DROPPING_CANDIDATE","INVALID_CANDIDATE","VALID_CANDIDATE","FILTERED_CANDIDATE","FILTERING_FLAG_NOT_HONOURED","CANDIDATE_ADDED","ADDING_CANDIDATE","FAILED_ADDING_CANDIDATE","ADD_BUFFERED_CANDIDATE","ADD_CANDIDATE_TO_BUFFER","END_OF_CANDIDATES_SUCCESS","END_OF_CANDIDATES_FAILURE","ICE_GATHERING_STARTED","ICE_GATHERING_COMPLETED","CANDIDATE_GENERATED","DROP_EOC","ICE_TRICKLE_DISABLED","SENDING_CANDIDATE","NO_SDP","parsing_media_ssrc","reviving_dataChannel","refresh_error","closed","onclose_error","NO_REMOTE_DATA_CHANNEL","FAILED_CLOSING","NO_SESSIONS","NEGOTIATION_PROGRESS","SET_LOCAL_DESCRIPTION","SET_REMOTE_DESCRIPTION","APPLYING_BUFFERED_REMOTE_OFFER","FAILED_SET_LOCAL_DESCRIPTION","FAILED_SET_REMOTE_DESCRIPTION","FAILED_SET_REMOTE_ANSWER","FAILED_RENEGOTIATION","NOT_STABLE","PROCESSING_EXISTING_SDP","OFFER_TIEBREAKER","NO_LOCAL_BUFFERED_OFFER","ADDING_REMOTE_OFFER_TO_BUFFER","MESSAGE_ADDED_TO_BUFFER","ENTER_LISTENER","BUFFERED_MESSAGES_SENT","BUFFERED_MESSAGES_DROPPED","DROPPING_MUTE_EVENT","BUFFER_NOT_NEEDED","ABORTING_OFFER","BROADCAST_MESSAGE","RECEIVED_MESSAGE","PERSISTENCE","SEND_MESSAGE","NOT_PERSISTED","IS_PERSISTENT_CONFIG","FAILED_SETTING_PERSISTENCE","INVALID_TYPE","PERSISTENT_MESSAGE_FEATURE_NOT_ENABLED","ENCRYPTION","DELETE_ALL","FAILED_DECRYPTING_MESSAGE","ENCRYPT_SECRET","INVALID_SECRETS","SET_SELECTED_SECRET","DELETE_ENCRYPT_SECRETS","SET_ENCRYPT_SECRET","SECRET_ID_NOT_FOUND","NO_SECRET_OR_SECRET_ID","SECRET_ID_NOT_UNIQUE","SECRET_ID_NOT_SELECTED","SECRET_ID_NOT_PROVIDED","SECRETS_NOT_PROVIDED","DROPPING_MESSAGE","FAILED_SENDING_MESSAGE","UPDATE_SUCCESS","NO_ASSOCIATED_STREAM_ID","FAILED_PROCESSING_MEDIA_INFO_EVENT","FAILED_UPDATING","FAILED_PROCESSING_PEER_MEDIA","FAILED_UPDATING_TRANSCEIVER_MID","FAILED_SETTING_PEER_MEDIA_INFO","READ_ONLY_VALUE","INVALID_MEDIA_TYPE","VIDEO_STATE_CHANGE","AUDIO_STATE_CHANGE","VIDEO_SCREEN_STATE_CHANGE","STOP_SETTINGS","STOP_SUCCESS","REMOTE_TRACK_REMOVED","START_FALLBACK","NO_OPTIONS","DEFAULT_OPTIONS","FALLBACK_SUCCESS","START_SCREEN_SUCCESS","STOP_SCREEN_SUCCESS","UPDATE_MUTED_SETTINGS","UPDATE_MEDIA_STATUS","AUDIO_MUTED","VIDEO_MUTED","STOP_SCREEN","START_SCREEN","STOP_ADDED_STREAM","STOP_REPLACED_STREAM","STOP_USER_MEDIA","STOP_AUDIO_TRACK","STOP_VIDEO_TRACK","STOP_MEDIA_TRACK","STOP_SCREEN_TRACK","DROPPING_ONREMOVETRACK","NO_STREAM","INVALID_STREAM_ID","NO_USER_MEDIA_STREAMS","INVALID_STREAM_ID_TYPE","NO_STREAM_ID","PEER_SCREEN_ACTIVE","REPLACE_SCREEN","FALLBACK","INVALID_GUM_OPTIONS","GET_USER_MEDIA","INVALID_MUTE_OPTIONS","NO_STREAMS_MUTED","SEND_STREAM","INVALID_MEDIA_STREAM_ARRAY","ACTIVE_STREAMS","NOT_INITIATED","STATS_DISCARDED","RETRIEVE_STATS_FAILED","POST_FAILED","PARSE_FAILED","STATS_IS_NULL","INVALID_TRACK_KIND","HANDLE_ICE_GATHERING_STATS","PROCESS_FAILED","HANDLE_NEGOTIATION_STATS","create","create_error","set","set_error","dropped","answer","HANDLE_DATA_CHANNEL_STATS","open","reconnecting","HANDLE_CONNECTION_STATS","HANDLE_BANDWIDTH_STATS","RETRIEVE_FAILED","NO_STATE","HANDLE_ICE_CONNECTION_STATS","SEND_FAILED","HANDLE_RECORDING_STATS","REQUEST_START","REQUEST_STOP","ERROR_NO_MCU_START","ERROR_NO_MCU_STOP","ERROR_START_ACTIVE","ERROR_STOP_ACTIVE","ERROR_MIN_STOP","MCU_RECORDING_ERROR","START_SUCCESS","START_FAILED","STOP_FAILED","MIN_RECORDING_TIME_REACHED","MCU_NOT_CONNECTED","EXISTING_RECORDING_IN_PROGRESS","NO_RECORDING_IN_PROGRESS","MIN_RECORDING_TIME","STOP_ABRUPT","SESSION_EMPTY","start_no_mcu","stop_no_mcu","start_no_stream_id","start_no_endpoint","starting_rtmp","stopping_rtmp","message_received_from_sig","stop_session_empty","stopped_success","started_success","error_session_empty","error_session","error_Session_abrupt","PERSISTENT_MESSAGE","NO_DEPENDENCY","UTILS","INVALID_BROWSER_AGENT","LOGGER","EVENT_DISPATCHED","EVENT_REGISTERED","EVENT_UNREGISTERED","EVENT_DISPATCH_ERROR","EVENT_REGISTER_ERROR","EVENT_UNREGISTER_ERROR","LOGS_NOT_STORED","LOGS_CLEARED","INVALID_CB","BROWSER_AGENT","roomState","room","id","mediaOptions","userData","streamsBandwidthSettings","googleX","bAS","publishOnly","sdpSettings","connection","data","direction","send","receive","voiceActivityDetection","peerConnectionConfig","bundlePolicy","rtcpMuxPolicy","iceCandidatePoolSize","certificate","disableBundle","bandwidthAdjuster","bandwidth","googleXBandwidth","min","max","peerConnection","bpProp","rmpProp","pcProp","autoBandwidthAdjustment","interval","limitAtPercentage","useUploadBwOnly","track","peerConnections","RTCPeerConnections","values","transceiverMid","p","transceivers","getTransceivers","t","sender","mid","readyState","muted","trackKind","streamId","mediaType","publisherId","mediaId","retrieveMediaId","kind","mediaState","retrieveMediaState","retrieveTransceiverMid","trackId","mediaMetaData","simulcast","isMatchedTrack","streamTrack","streams","streamObjs","userMedia","i","tracks","getTracks","j","map","streamObj","peerId","dispatchEvent","key","value","mediaInfo","updatedState","peerMedias","log","setSkylinkState","doUpdate","user","sid","sendMediaInfoMsg","dispatchMediaInfoMsg","err","msg","JSON","stringify","SOCKET_DEFAULTS","RECONNECTION_ATTEMPTS","RECONNECTION_DELAY_MAX","RECONNECTION_DELAY","RECONNECTION_FINAL_ATTEMPTS","CONFIGS","SOCKET","forceNew","reconnection","timeout","socketTimeout","path","socketServerPath","reconnectionAttempts","reconnectionDelayMax","reconnectionDelay","transports","toLowerCase","query","Skylink_SDK_type","Skylink_SDK_version","Skylink_API_version","extraHeaders","DEFAULTS","params","skylinkState","initOptions","config","socketServer","socketPorts","socketConfig","ports","isAObj","Array","isArray","signalingServerProtocol","signalingServerPort","isFirstConnectionAttempt","fallbackType","isLastPort","isAString","socketType","socketSession","finalAttempts","url","signalingServer","protocol","Date","now","getSignalingServerUrl","io","messageHandler","message","type","inRoomHandler","enterRoomHandler","offerHandler","welcomeHandler","answerHandler","answerAckHandler","candidateHandler","getPeerListHandler","introduceError","byeHandler","streamHandler","recordingHandler","redirectHandler","rtmpHandler","setUserDataHandler","mediaInfoEventHandler","userMessageHandler","storedMessagesHandler","muteAudioEventHandler","muteVideoEventHandler","peerInfo","isUser","getCurrentSessionInfo","roomName","settings","dataChannels","main","channel","connected","peerConnStatus","init","receiveOnly","hasMCU","logNoRoomState","enableDataChannel","codecParams","streamsMediaStatus","peerPriorityWeight","enableIceRestart","SMProtocolVersion","DTProtocolVersion","mediaStatus","version","os","platform","pluginVersion","VERSION","SDKVersion","priorityWeight","screenshare","streamIds","maxBandwidth","isABoolean","stereo","usedtx","isANumber","maxplaybackrate","useinbandfec","customSettings","frameRate","facingMode","resolution","userInfo","peerUserData","updatedUserData","setUserData","isSelf","hasStreamBeenReplaced","stoppedStream","some","isReplaced","stopMediaTracks","stop","indexToRemove","currentRTCRTPSenders","listOfSenders","splice","stopStream","prepStopStreams","roomId","fromLeaveRoom","isScreensharing","Promise","resolve","reject","prepStopScreenStream","then","catch","rej","prepStopUserMediaStreams","filteredStreams","replacedStreams","addedStreams","userMediaStreamId","filterUserMediaStreams","stopReplacedStream","stopAddedStream","stopAddedStreams","stopReplacedStreams","initRefreshConnectionAndResolve","tryStopStream","removeTracks","updateMediaInfoMediaState","deleteStreamFromState","listenForEventAndDeleteMediaInfo","dispatchOnLocalStreamEnded","deleteScreensharingInstance","getAudioTracks","getVideoTracks","peerIds","connectionState","senders","getSenders","y","removeTrack","executeOfferCallback","evt","s","hasAudioTrack","deleteUnavailableMedia","executeMediaDeletedCallback","removeEventListener","addEventListener","setMediaStateToUnavailable","streamIdToRemove","streamsMutedSettings","isEmptyObj","isVideo","hasVideoTrack","isAudio","mediaAccessStopped","screenStream","isEmptyArray","dispatchPeerUpdatedEvent","executeAnswerAckCallback","refreshConnection","sendStreamReplaceEndedMsg","updatedRoomState","parseMediaOptions","useExactConstraints","prepMediaAccessRequest","getUserMedia","addLocalMediaStreams","currentRoomState","onRemoteTrackAdded","muteStreams","sendStream","getStreamSources","getScreenSources","updateRemoteStreams","getStreams","active","streamOptions","audioSettings","parseStreamSettings","videoSettings","onStreamAccessSuccess","hasPeerDataChannels","getPeerCustomSettings","usePeerId","signalingState","getPeerInfo","peerCustomConfigs","call","peerCustomConfigBandwidth","peerCustomConfigGoogleXBandwidth","getUserInfo","getUserData","getPeersStreams","includeSelf","listOfPeersStreams","selfStreams","getSelfStreams","selfScreen","getSelfScreen","maps","hasPeerConnections","listOfPeers","retrieveRemoteStreams","getPeersDataChannels","listOfPeersDataChannels","channelProp","channelName","channelType","transferId","peerChannel","getDataChannelBuffer","currentTransferId","currentStreamId","getPeersCustomSettings","customSettingsList","hasPeers","setGreatestPeerPriorityWeight","informationList","entries","maxPeerPriority","peerInformation","reason","inRoom","channelOpen","sessionDisconnect","apiBase","stats","endPoints","client","session","auth","signaling","iceConnection","iceCandidate","iceGathering","negotiation","recording","dataChannel","statsBase","endpoints","app","stats_buffer","bufferTimeout","endpoint","fetch","client_id","enableStatsGathering","method","mode","headers","body","operation","cloneData","assign","setInterval","operations","postStats","super","model","appKey","timestamp","room_id","user_id","signaling_url","signaling_transport","attempts","clientId","toISOString","onConnection","onDisconnect","isChannelOpen","onError","onReconnectAttempt","attempt","currentAttempt","updateAttempts","onReconnectFailed","socket","connect","errorCode","onReconnectError","on","bind","onMessage","initAndTrue","executeCallbackAndRemoveListener","rid","currentBufferedMsgs","socketMessageQueue","bufferMessage","sendMessage","sendBufferedMsg","isNull","isNegotiationTypeMsg","unshift","args","encryptSecrets","selectedSecretId","secretId","updatedData","setSelectedSecretId","secret","updatedEncryptSecrets","utils","isValidString","isValidSecret","isExisting","isValidSecretId","encryptionParam","filter","isEmptyString","hasCrypto","canEncrypt","canDecrypt","targetPeerId","isPrivate","encryptedMessage","sendUserMessage","dispatchOnIncomingMessage","messageContent","content","senderPeerId","isDataChannel","timeStamp","generateISOStringTimesStamp","errorLog","getMessageConfig","sendMessageToSig","trySendMessage","throwError","deleteEncryptSecrets","setEncryptSecret","isPersistent","encryptMessage","decrypt","AES","enc","Utf8","encrypt","tryDecryptMessage","decryptedMessage","instance","dispatchEncryptSecretEvent","encryptionSecretsUpdated","decryptMessage","getRoomStateByName","getParamValidity","parseDecryptedMessageData","parseUNIXTimeStamp","hasPersistentMessage","persistentMessageState","isPublicMessage","encryptedMessaging","getStoredMessages","messageData","parse","messages","decryptStoredMessages","storedMessages","asyncMessaging","canPersist","sendP2PMessage","isPublic","target","processMessage","dependencies","fulfilled","readyStateChangeErrorCode","forceTURNSSL","CONSTANTS","serverConfig","connectionConfig","tcp","iceServerPorts","udp","both","iceServerProtocol","TURN","defaultIceServerPorts","STUN","TEMASYS","DEFAULT_TURN_SERVER","userIceServer","iceServer","urls","username","iceServers","credential","servers","iceServerName","enableTURNServer","TURNServerTransport","enableSTUNServer","usePublicSTUN","server","urlParts","connectionPortsAndProtocolByBrowser","connectionPortsByTurnTransport","concat","getConnectionPortsByTurnTransport","tcpPort","udpPort","bothPort","peerCandidatesQueue","TAGS","PEER_CONNECTION_STATE","candidateArray","nativeCandidate","candidateId","candidateType","candidate","addIceCandidate","isLowerThanVersion","ex","signalingEndOfCandidates","peer_id","is_remote","candidate_id","candidate_sdp_mid","candidate_sdp_mindex","candidate_candidate","sdpMid","sdpMLineIndex","addToStatsBuffer","manageStatsBuffer","addIceCandidateFailure","CANDIDATE_PROCESSING_STATE","remoteDescription","addIceCandidateSuccess","roomkey","isRemote","setIceServers","addIceCandidateFromQueue","onIceCandidate","currentRoom","gatheredCandidates","CANDIDATE_GENERATION_STATE","no_peer_connection","gathering","gathered","localDescription","filterCandidatesType","forceTURN","sending","host","srflx","relay","receiving","sendCandidate","setTimeout","noOfExpectedCandidates","addIceCandidateToQueue","handleIceCandidateStats","rtcIceConnectionEvent","pc_config","tieBreaker","priorityWeightScheme","weightAppendValue","peerConfig","updatePeerMediaWithUserSid","mediaStream","enterRoom","enterAndWelcome","parsedMsg","weight","temasysPluginVersion","parentId","parts","majorVer","join","parseVersion","parseUserInfo","peersInRoom","info","setPeerInformations","buildPeerInformations","cert","caller","isNewPeer","hasScreenshare","peerBrowser","addPeer","serverPeerJoined","serverPeerType","peerMessagesStamps","audioMuted","videoMuted","CALLERS","hasWelcome","userId","peersInRoomIndex","PEER_ID","peerUserInfo","sdp_type","sdp_sdp","sdpOrMessage","checkStampBeforeSendingWelcome","getNextNegotiationStep","handleNegotiationStats","parseAndSendWelcome","RTCPeerConnection","callerState","logStats","peerParams","generateCertificate","certOptions","namedCurve","modulusLength","publicExponent","Uint8Array","hash","handleSetOfferAndAnswerSuccess","description","bufferedLocalOffer","msgType","setOffer","setAnswer","handleSetOfferAndAnswerFailure","setLocalDescription","processingLocalSDP","onLocalDescriptionSetSuccess","onLocalDescriptionSetFailure","negotiating","setRemoteDescription","processingRemoteSDP","mungedSessionDescription","setSDPBitrate","mungeSDP","sendAnswerAck","success","answerAck","onRemoteDescriptionSetSuccess","hasRestart","closeDataChannel","onRemoteDescriptionSetFailure","parseAndSetRemoteDescription","mediaInfoList","resend","isRestart","selfWeight","messageWeight","bufferedRemoteOffers","canProceed","updatedUserInfo","updateState","setPeerMediaInfo","replace","pcSenders","senderGetStatsPromises","savedSenders","isRenegoNeeded","pcSender","getStats","transmittingSenders","all","reslovedResults","reports","senderIndex","report","ssrc","transmittingSendersKeys","senderMatchedCount","tKey","tSender","sIndex","doIceRestart","errors","peersCustomSettings","result","iceRestart","buildResult","refreshErrors","refreshSettings","buildPeerRefreshSettings","buildPeerRefreshErrors","peerRefreshError","mcuUseRenegoRestart","bwOptions","filterParams","self","refreshPeerConnection","results","mResults","finally","offerMessage","shift","hasAppliedBufferedRemoteOffer","shouldRenegotiate","peerEndOfCandidatesCounter","RTCIceCandidate","tag","label","foundation","len","hasSet","candidateProcessingStateEventDetail","peerList","privilegePeerId","contents","introduceStateChange","privilegedPeerId","receivingPeerId","sendingPeerId","local_candidate","remote_candidate","retrieveStatistics","beSilentOnStatsLogs","dirType","selectedCandidatePair","modelCandidate","ip_address","ipAddress","port_number","portNumber","candidate_type","transport","priority","network_type","networkType","closePeerConnection","close","isAgent","isVersion","signalingStateClosed","processPeerConnectionState","iceConnectionStateClosed","processIceConnectionState","triggerPeerLeftEventAndChangeState","roomStateObj","isPeerConnected","checksIfHealthTimerExists","remoteStreams","sdpSessions","peerStats","peerBandwidth","clearPeerInfo","tryCloseDataChannel","restartOfferMsg","sd","setOriginalDTLSRole","modifyDTLSRole","retrieveMediaInfoForOfferAnswer","currentMessageKeys","keyIndex","offerConstraints","offerToReceiveAudio","getSDPCommonSupports","offerToReceiveVideo","addTransceiver","createDataChannel","createAsMessagingChannel","hasMainChannel","endOfCandidates","sdpConstraints","createOffer","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","onOfferCreated","onOfferFailed","hasScreenShare","constraints","iceTransportPolicy","optional","DtlsSrtpKeyAgreement","googIPv6","certificates","msRTCPeerConnection","rtcPeerConnection","useEdgeWebRTC","callbackExtraParams","hasStream","firefoxStreamId","localStream","localStreamId","local","remote","removeStream","ontrack","ondatachannel","onicecandidate","oniceconnectionstatechange","onsignalingstatechange","onicegatheringstatechange","onsenderadded","onremovetrack","createNativePeerConnection","handleIceConnectionStats","sdpSemantics","getConfiguration","answerConstraints","undefined","createAnswer","onAnswerCreated","onAnswerFailed","channelProperty","doNotConvert","messageType","notOpenError","bufferAmount","size","byteLength","rawData","isStreamChunk","objPeerDataChannel","dataStreams","sessionChunkType","protocolData","dataTransfers","sessions","ackN","messageProtocolHandler","event","channel_id","channel_label","channel_type","channel_binary_type","agent_name","agent_type","agent_version","uid","binaryType","onopen","bufferThreshold","handleDataChannelStats","bufferedAmountLowThreshold","onmessage","onerror","errorDetail","onbufferedamountlow","onclose","pid","transferIds","getTransferIDByPeerId","transferInfo","sendP2PMessageForRoom","closeFn","channelNameProp","targetDataChannel","messageBuilder","getRestartOfferMessage","hasLocalDescription","restart","unableToRestartError","refreshSinglePeer","reliable","ordered","buferAmount","roomStates","roomKeys","getPeersInRoom","listOfPeersInfo","expectedLen","mLineCounter","addedMids","sdpLines","rejected","getTime","candidatesLength","expected","received","processed","bufferedAmountLow","refreshDataChannel","mainDataChannel","closeAllDataChannels","restartPeerConnectionPromises","restartPeerConnectionPromise","restartPeerConnection","getConnectionStatus","rejectPromise","errorMsg","isValidPeerId","retrieveValidPeerIdsOrErrorMsg","connectionStatusPromises","peerConnectionStatistics","updatePeerInformationsMediaStatus","transceiver","peerMedia","buildMediaStatus","processNewSender","formatValue","directionType","itemKey","audio_send","audio_recv","video_send","video_recv","bytes","packets","echo_return_loss","echo_return_loss_enhancement","round_trip_time","audio_level","jitter","packets_lost","nack_count","firs_count","plis_count","frames_encoded","frame_width","frame_height","qp_sum","frames","hugeFrames","framesPerSecond","frames_decoded","frames_dropped","decoderImplementation","audioTracks","videoTracks","audioTrack","audioTrackInfo","stream_id","enabled","buildAudioTrackInfo","videoTrack","videoTrackInfo","buildVideoTrackInfo","gatherSendAudioPacketsStats","gatherReceiveAudioPacketsStats","gatherSendVideoPacketsStats","gatherReceiveVideoPacketsStats","buildTrackInfo","arr","total","recv","currentBlock","adjustmentInterval","getIniOptions","clearInterval","totalAudioBw","formatTotalFn","totalVideoBw","isIceConnectionStateCompleted","pcIceConnectionState","ICE_CONNECTION_STATE","rtcTrackEvent","receiver","tscvr","mediaInfos","m","matchPeerIdWithTransceiverMid","isVideoScreenTrack","updateStreamIdFromOntrack","no_room_state","statsInterval","setAdjustmentInterval","iceGatheringState","getStateByKey","updateMediaStatus","dispatchStreamEndedEvent","dispatchIncomingCameraStream","dispatchPeerUpdated","status","getStateByRid","isReplace","replacedStreamId","remoteStreamsObj","recording_id","recordings","recordingId","dispatchRecordingEvent","recordingState","ACTION","dispatchMediaStateChangeEvents","retrieveStreamId","stamp","processOtherChanges","processTransceiverMidChange","updatePeerMediaInfo","processMediaStateChange","processUnavailableStream","valueChanged","newValue","dispatchMuteEvents","shouldDropMessage","enter","welcome","getPeerList","bye","action","currentRecordingId","startedDateTime","endedDateTime","recordingStartInterval","recordingStarted","clearTimeout","recordingStopped","redirect","getAllStates","disconnect","removeSkylinkState","rtmp","rtmpSessions","rtmpId","rtmpSessionStartSuccess","rtmpSessionStopSuccess","rtmpError","rtmpSessionFailed","muteVideoEvent","muteAudioEvent","parsedUserData","mediaInfoEvent","addNewPeerMediaInfo","mediaInfoKeys","k","processStoredMessages","joinRoom","cid","userCred","token","apiOwner","appKeyOwner","roomCred","start","startDateTime","duration","isPrivileged","autoIntroduce","enterMsg","isSuccess","showAll","restartOffer","RESTART","isRestartResend","byeMsg","roomLock","roomLocked","lock","userMessages","signalingReadyMessages","messageBody","msgId","generateUUID","mBody","messageBuilders","signalingMessages","valueOf","WebSocket","resetSocketConfig","Socket","tryCreateSocket","handleCreateSocketFailure","getAnswerMessage","dispatchHandshakeProgress","getAnswerAckMessage","getEnterRoomMessage","getJoinRoomMessage","getOfferMessage","getWelcomeMessage","getCandidateMessage","getSetUserDataMessage","peers","getPeerListMessage","getStreamMessage","recordingMessage","getRecordingMessage","rtmpMessage","getRTMPMessage","muteAudio","getMuteAudioMessage","muteVideo","getMuteVideoMessage","getRoomLockMessage","byeMessage","getByeMessage","mInfo","getMediaInfoEventMessage","history","getGetStoredMessagesMessage","sendChannelMessage","peerMessages","getUserMessages","peerMessage","buildPeerMediaInfo","retrieveStreamIdOfTrack","retrieveTracks","updatedMediaInfo","parseSDPForTransceiverMid","mediaMids","getTransceiverMid","audioMids","videoMids","a","v","retrieveValueGivenTransceiverMid","retrieveFormattedMediaInfo","formattedMediaInfos","clonedMediaInfo","resetPeerMedia","populatePeerMediaInfo","clonedPeerMedia","peerMediaHasPreviousState","processOnRemoveTrack","trackInfo","null","mediaInfoDeleted","targetPeerIds","dispatchEvt","dispatchLocalMediaMutedEvent","hasToggledVideo","hasToggledAudio","localMediaMuted","retrieveOriginalActiveStreamId","currentActiveStreamId","replacedStreamIds","originalActiveStreamId","pReplacedStreamIds","newStream","updateMediaInfo","originalStreamId","retrieveToggleState","startMuteEvents","toggleState","mutedStream","updateStreamsMutedSettings","muteFn","dispatchStreamMutedEvent","updateMediaInfoAndRemoveListener","retrieveMutedSetting","mediaMutedOption","isValid","gumStreamId","isValidStreamId","fOptions","streamIdsThatCanBeMuted","sId","streamIdToMute","isSenderTrackAndTrackMatched","senderTrack","x","isStreamOnPC","addTracksToPC","addTrack","getTrackSender","trackSender","dispatchEvents","restartFn","dispatchEventsToLocalEnd","getOutputSources","sources","outputSources","input","output","sourceItem","item","deviceId","sourceId","groupId","buildStreamObject","getUserMediaSettings","processStreamInState","isAudioFallback","isStreamInState","processNewStream","processPeerMedia","mediaAccessSuccess","mutedSettings","shouldAudioMuted","shouldVideoMuted","exactConstraints","echoCancellation","mute","exact","ideal","rest","mediaDevices","onStreamAccessError","userMediaStreams","addUserMediaStreams","screenshareStream","addScreenshareStream","methods","dispatchOnIncomingStream","dispatchOnIncomingScreenStream","dispatch","audioFallback","fallbackError","isAudioFallbackError","replaceTrack","oldStream","oldVideoTrack","oldAudioTrack","videoSender","audioSender","newVideoTrack","newAudioTrack","isNotObjOrNullOrPlugin","isTypeStream","isArrayOfTypeStream","isAFunction","usePrefetchedStreamsPromises","usePrefetchedStream","processMediaStreamArray","prefetchedStreams","processMediaStream","processMediaOptions","enumerateDevices","devices","streamList","mediaSource","mediaSourceInput","extensionInfo","extensionId","updateStreamsMediaStatus","retrieveVideoStreams","videoStreams","splitAudioAndVideoStream","MediaStream","streamKey","addStreamToState","st","obj","array","string","param","paramName","methodName","proceed","states","matchedRoomState","agentVer","requiredVer","partsA","partsB","d","c","r","Math","random","floor","statelessGetUserMedia","validPeerId","skylinkEventManager","events","privateEvents","eventName","addListener","callbacks","allEventCallbacks","userCallbacks","privateCallbacks","removeListener","cb","addPrivateEventListener","removePrivateEventListener","logMethods","checkSupport","hasSupport","logFn","logger","level","debugObject","datetime","currentLevel","logLevels","SILENT","formattedMessage","fragment1","fragment2","fragment3","messageString","getFormattedMessage","loggedOnConsole","storeLogs","logItems","toUpperCase","storedLogs","TRACE","localStorage","getItem","Number","isNaN","getPersistedLevel","levels","setItem","persistLogLevel","setLevel","prototype","codecName","samplingRate","mLine","RegExp","codecsList","payload","fmtpLine","updatedFmtpLine","addedKeys","fmtpParts","keyAndValue","formatRtx","str","line","codecPayload","formatFmtpRtcpFb","codecs","codec","getCodecsSupport","RTCRtpSender","getCapabilities","clockRate","numChannels","pc","binaryChunkType","prop","e","setSDPCodecParams","opusOptions","minptime","vp8Options","maxFr","maxFs","vp9Options","vp9","h264Options","levelAsymmetryAllowed","profileLevelId","packetizationMode","removeSDPFilteredCandidates","setSDPCodec","overrideSettings","parseFn","codecSettings","channels","setLineFn","isSROk","isChnlsOk","lineParts","audioCodec","videoCodec","bw","mLineType","mLineIndex","cLineIndex","toFixed","bASAudioBw","bASVideoBw","bASDataBw","googleXMinBw","googleXMaxBw","codecRtpMapLineIndex","codecFmtpLineIndex","xGoogleParams","removeSDPCodecs","payloadList","disableVideoFecCodecs","disableComfortNoiseCodec","removeSDPREMBPackets","disableREMB","handleSDPConnectionSettings","bundleLineMids","bundleLineIndex","peerStreamSettings","offerCodecs","mLines","bundleLine","localOfferRes","removeSDPUnknownAptRtx","mediaLines","removeSDPFirefoxH264Pref","renderSDPOutput","msidParts","ssrcParts","ssrcMsidParts","compareA","compareB","appendIndex","getSDPICECandidates","candidates","mediaItem","index","canType","getSDPSelectedCodec","codecInfo","implementation","payloadType","paramItem","aSetupPattern","originalDTLSRole","role","passive","msidLines","parsedMline","trim","firstItem","formatCanTypeFn","parseSelectedCandidatePair","isAutoBwStats","raw","transportStats","selectedLocalCandidateId","selectedRemoteCandidateId","statsReport","selectedCandidatePairId","selected","candidatePairStats","localCandidateId","remoteCandidateId","writable","nominated","prevStats","totalRoundTripTime","roundTripTime","tabulateStats","consentRequestsSent","consentRequests","totalSent","sent","requestsReceived","requests","totalReceived","requestsSent","responsesSent","responses","responsesReceived","remoteCandidateStats","ip","address","port","localCandidateStats","parseCertificates","srtpCipher","dtlsCipher","tlsVersion","localCertificateId","remoteCertificateId","base64Certificate","fingerprintAlgorithm","nTime","oTime","nVal","oVal","parseAudio","parsedStats","packetsReceived","totalPackets","bytesReceived","totalBytes","packetsLost","totalPacketsLost","audioReceiver","audioLevel","totalSamplesReceived","totalSamplesDuration","parseReceiving","bytesSent","packetsSent","retransmittedBytesSent","totalRetransmittedBytesSent","retransmittedPacketsSent","totalRetransmittedPacketsSent","mediaSourceId","echoReturnLoss","echoReturnLossEnhancement","audioSource","parseSending","parseVideo","isInteger","firCount","firsSent","totalFirs","firs","nackCount","nacksSent","totalNacks","nacks","pliCount","plisSent","totalPlis","plis","qpSum","videoReceiver","framesDropped","framesReceived","framesDecoded","frameWidth","frameHeight","firsReceived","nacksReceived","plisReceived","framesEncoded","framesSent","hugeFramesSent","videoSource","parseMedia","beSilentOnLogs","getStatistics","promiseResolve","promiseReject","entry","getStatsFailure","errMsg","gatherRTCPeerConnectionDetails","gatherSDPIceCandidates","gatherSDPCodecs","gatherRTCDataChannelDetails","getStatsSuccess","dcKeys","retrievePeersScreenStreamId","peersScreenStreamId","stopScreenStream","handleScreenStreamStates","addScreenStreamToState","removeScreenStreamFromState","setScreenStateToUnavailable","addScreenStreamCallbacks","onended","retrievePeerScreenStream","peersScreenStream","peerRemoteStreams","screensharingInstance","checkForExistingScreenStreams","checksForReplaceScreen","startScreenCapture","replaceUserMediaStream","getDisplayMedia","hasUserMediaStream","hasMoreThanOneVideoStream","streamExists","replacedStream","updateReplacedStreamInState","getState","deleteAsyncInstance","deleteEncryptedInstance","pShowAll","executeCallbackAndRemoveEvtListener","shouldProceed","defaultRoom","roomServer","apiTimeout","forceSSL","throttleShouldThrowError","enableSimultaneousTransfers","credentials","throttleIntervals","shareScreen","rawApiResponse","room_key","peerConstraints","pc_constraints","offer_constraints","mediaConstraints","media_constraints","ipSigserver","httpPortList","httpsPortList","ipSigserverPath","validateOptions","toReturn","validateAPIResponse","response","ok","loggerMethod","logAPIResponse","parseAndMutateOptions","updatedOptions","authenticateApp","async","urlChar","location","getEndPoint","webRTCReadyOperations","returnObject","ready","testRTCPeerConnection","setUserInitOptions","optionsValidity","webrtcReady","json","apiResponse","codecSupport","userInitOptions","getUserInitOptions","updatedInitOptions","setInitOptions","enforceUserInitOptions","sendByeOrDisconnectSocket","skylinkSignalingServer","isInMoreThanOneRoom","handleChannelClose","stopStreams","clearRoomState","clearRoomStateFromSingletons","leaveRoom","Set","removedState","peerLeftPromises","executePeerLeftProcess","leaveAllRooms","closedRooms","resolves","res","sdk_name","sdk_version","agent_platform","agent_plugin_version","device_version","enumerated_devices","device_muted","language","retryCounters","selectedRoom","socketMessage","lastRestart","socketMessageTimeout","socketUseXDR","streamsDefaultSettings","joinRoomManager","socketsFn","statIdRandom","prefetchedStream","apiServer","handleClientStats","getRoomNameFromParams","createRoom","skylinkApiResponse","checkCodecSupport","createSocket","userMediaParams","streamException","codecError","socketException","lockOrUnlockRoom","lockRoom","isLocked","unlockRoom","manageErrorStatsAndCallback","errorMessage","statsKey","handleRecordingStats","commonRecordingOperations","isStartRecording","statsStateKey","stateToCompare","manageRecordingEventListeners","sendRecordingMessageViaSig","startRecording","stopRecording","checkRTMPDependencies","isStartSession","registerRTMPEventListenersAndResolve","isStartRTMPSession","sendRTMPMessageViaSig","commonRTMPOperations","gRtmpId","logErrorAndReject","getPeerScreenshare","getUserMediaLayer","getRecordings","startSession","stopSession","getEncryptSecrets","getSelectedSecretId","setMessagePersistence","getMessagePersistence","skylinkStates","parsedOptions","setState","removeStateByRoomId","keyOrName"],"mappings":"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","file":"skylink.chunk.bee75dcc25caddcb63f0.js","sourcesContent":["/* eslint-disable */\n// Import webrtc-adapter and add extra methods\nimport AdapterJS from 'webrtc-adapter';\n\nAdapterJS.options = AdapterJS.options || {};\n\n// True is AdapterJS.onwebrtcready was already called, false otherwise\n// Used to make sure AdapterJS.onwebrtcready is only called once\nAdapterJS.onwebrtcreadyDone = false;\n\nAdapterJS.WebRTCPlugin = {\n  plugin: null,\n};\n\nAdapterJS._onwebrtcreadies = [];\n\nAdapterJS.webRTCReady = function (baseCallback) {\n  if (typeof baseCallback !== 'function') {\n    throw new Error('Callback provided is not a function');\n  }\n\n  var callback = function () {\n    // Make users having requirejs to use the webRTCReady function to define first\n    // When you set a setTimeout(definePolyfill, 0), it overrides the WebRTC function\n    // This is be more than 0s\n    if (typeof window.require === 'function' &&\n      typeof AdapterJS._defineMediaSourcePolyfill === 'function') {\n      AdapterJS._defineMediaSourcePolyfill();\n    }\n\n    // All WebRTC interfaces are ready, just call the callback\n    baseCallback(null !== AdapterJS.WebRTCPlugin.plugin);\n  };\n\n\n  if (true === AdapterJS.onwebrtcreadyDone) {\n    callback();\n  } else {\n    // will be triggered automatically when your browser/plugin is ready.\n    AdapterJS._onwebrtcreadies.push(callback);\n  }\n};\n\nAdapterJS.maybeThroughWebRTCReady = function() {\n  if (!AdapterJS.onwebrtcreadyDone) {\n    AdapterJS.onwebrtcreadyDone = true;\n\n    // If new interface for multiple callbacks used\n    if (AdapterJS._onwebrtcreadies.length) {\n      AdapterJS._onwebrtcreadies.forEach(function (callback) {\n        if (typeof(callback) === 'function') {\n          callback(AdapterJS.WebRTCPlugin.plugin !== null);\n        }\n      });\n      // Else if no callbacks on new interface assuming user used old(deprecated) way to set callback through AdapterJS.onwebrtcready = ...\n    } else if (typeof(AdapterJS.onwebrtcready) === 'function') {\n      AdapterJS.onwebrtcready(AdapterJS.WebRTCPlugin.plugin !== null);\n    }\n  }\n};\n\n///////////////////////////////////////////////////////////////////\n// ADAPTERJS BROWSER AND VERSION DETECTION\n//\n// Detected browser agent name. Types are:\n// - 'firefox': Firefox browser.\n// - 'chrome': Chrome browser.\n// - 'opera': Opera browser.\n// - 'safari': Safari browser.\n// - 'IE' - Internet Explorer browser.\nwindow.webrtcDetectedBrowser = null;\n\n// Detected browser version.\nwindow.webrtcDetectedVersion = null;\n\n// The minimum browser version still supported by AJS.\nwindow.webrtcMinimumVersion  = null;\n\n// The type of DC supported by the browser\nwindow.webrtcDetectedDCSupport = null;\n\n// This function helps to retrieve the webrtc detected browser information.\n// This sets:\n// - webrtcDetectedBrowser: The browser agent name.\n// - webrtcDetectedVersion: The browser version.\n// - webrtcMinimumVersion: The minimum browser version still supported by AJS.\n// - webrtcDetectedType: The types of webRTC support.\n//   - 'moz': Mozilla implementation of webRTC.\n//   - 'webkit': WebKit implementation of webRTC.\n//   - 'plugin': Using the plugin implementation.\nAdapterJS.parseWebrtcDetectedBrowser = function () {\n  var hasMatch = null;\n\n  // Detect Opera (8.0+)\n  if ((!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0) {\n    hasMatch = navigator.userAgent.match(/OPR\\/(\\d+)/i) || [];\n\n    window.webrtcDetectedBrowser   = 'opera';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\n    window.webrtcMinimumVersion    = 26;\n    window.webrtcDetectedType      = 'webkit';\n    window.webrtcDetectedDCSupport = 'SCTP'; // Opera 20+ uses Chrome 33\n\n    // Detect Bowser on iOS\n  } else if (navigator.userAgent.match(/Bowser\\/[0-9.]*/g)) {\n    hasMatch = navigator.userAgent.match(/Bowser\\/[0-9.]*/g) || [];\n\n    var chromiumVersion = parseInt((navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./i) || [])[2] || '0', 10);\n\n    window.webrtcDetectedBrowser   = 'bowser';\n    window.webrtcDetectedVersion   = parseFloat((hasMatch[0] || '0/0').split('/')[1], 10);\n    window.webrtcMinimumVersion    = 0;\n    window.webrtcDetectedType      = 'webkit';\n    window.webrtcDetectedDCSupport = chromiumVersion > 30 ? 'SCTP' : 'RTP';\n\n\n    // Detect Opera on iOS (does not support WebRTC yet)\n  } else if (navigator.userAgent.indexOf('OPiOS') > 0) {\n    hasMatch = navigator.userAgent.match(/OPiOS\\/([0-9]+)\\./);\n\n    // Browser which do not support webrtc yet\n    window.webrtcDetectedBrowser   = 'opera';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\n    window.webrtcMinimumVersion    = 0;\n    window.webrtcDetectedType      = null;\n    window.webrtcDetectedDCSupport = null;\n\n    // Detect Chrome on iOS (does not support WebRTC yet)\n  } else if (navigator.userAgent.indexOf('CriOS') > 0) {\n    hasMatch = navigator.userAgent.match(/CriOS\\/([0-9]+)\\./) || [];\n\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\n    window.webrtcMinimumVersion    = 0;\n    window.webrtcDetectedType      = null;\n    window.webrtcDetectedBrowser   = 'chrome';\n    window.webrtcDetectedDCSupport = null;\n\n    // Detect Firefox on iOS (does not support WebRTC yet)\n  } else if (navigator.userAgent.indexOf('FxiOS') > 0) {\n    hasMatch = navigator.userAgent.match(/FxiOS\\/([0-9]+)\\./) || [];\n\n    // Browser which do not support webrtc yet\n    window.webrtcDetectedBrowser   = 'firefox';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\n    window.webrtcMinimumVersion    = 0;\n    window.webrtcDetectedType      = null;\n    window.webrtcDetectedDCSupport = null;\n\n    // Detect IE (6-11)\n  } else if (/*@cc_on!@*/false || !!document.documentMode) {\n    hasMatch = /\\brv[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\n\n    window.webrtcDetectedBrowser   = 'IE';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1], 10);\n    window.webrtcMinimumVersion    = 9;\n    window.webrtcDetectedType      = 'plugin';\n    window.webrtcDetectedDCSupport = 'SCTP';\n\n    if (!webrtcDetectedVersion) {\n      hasMatch = /\\bMSIE[ :]+(\\d+)/g.exec(navigator.userAgent) || [];\n\n      window.webrtcDetectedVersion = parseInt(hasMatch[1] || '0', 10);\n    }\n\n    // Detect Edge (20+)\n  } else if (!!window.StyleMedia || navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n    hasMatch = navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/) || [];\n\n    // Previous webrtc/adapter uses minimum version as 10547 but checking in the Edge release history,\n    // It's close to 13.10547 and ObjectRTC API is fully supported in that version\n\n    window.webrtcDetectedBrowser   = 'edge';\n    window.webrtcDetectedVersion   = parseFloat((hasMatch[0] || '0/0').split('/')[1], 10);\n    window.webrtcMinimumVersion    = 13.10547;\n    window.webrtcDetectedType      = 'ms';\n    window.webrtcDetectedDCSupport = null;\n\n    // Detect Firefox (1.0+)\n    // Placed before Safari check to ensure Firefox on Android is detected\n  } else if (typeof InstallTrigger !== 'undefined' || navigator.userAgent.indexOf('irefox') > 0) {\n    hasMatch = navigator.userAgent.match(/Firefox\\/([0-9]+)\\./) || [];\n\n    window.webrtcDetectedBrowser   = 'firefox';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\n    window.webrtcMinimumVersion    = 33;\n    window.webrtcDetectedType      = 'moz';\n    window.webrtcDetectedDCSupport = 'SCTP';\n\n    // Detect Chrome (1+ and mobile)\n    // Placed before Safari check to ensure Chrome on Android is detected\n  } else if ((!!window.chrome && !!window.chrome.webstore) || navigator.userAgent.indexOf('Chrom') > 0) {\n    hasMatch = navigator.userAgent.match(/Chrom(e|ium)\\/([0-9]+)\\./i) || [];\n\n    window.webrtcDetectedBrowser   = 'chrome';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[2] || '0', 10);\n    window.webrtcMinimumVersion    = 38;\n    window.webrtcDetectedType      = 'webkit';\n    window.webrtcDetectedDCSupport = window.webrtcDetectedVersion > 30 ? 'SCTP' : 'RTP'; // Chrome 31+ supports SCTP without flags\n\n    // Detect Safari\n  } else if (/constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === \"[object SafariRemoteNotification]\"; })(!window['safari'] || safari.pushNotification) || navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./) || navigator.userAgent.match(/Version\\/(\\d+).(\\d+)/)) {\n    hasMatch = navigator.userAgent.match(/version\\/(\\d+)\\.(\\d+)/i) || [];\n    var AppleWebKitBuild = navigator.userAgent.match(/AppleWebKit\\/(\\d+)/i) || [];\n\n    var isMobile      = navigator.userAgent.match(/(iPhone|iPad)/gi);\n    var hasNativeImpl = AppleWebKitBuild.length >= 1 && AppleWebKitBuild[1] >= 604;\n    window.webrtcDetectedBrowser   = 'safari';\n    window.webrtcDetectedVersion   = parseInt(hasMatch[1] || '0', 10);\n    window.webrtcMinimumVersion    = 7;\n    if (isMobile) {\n      window.webrtcDetectedType    = hasNativeImpl ? 'AppleWebKit' : null;\n    } else { // desktop\n      var majorVersion = window.webrtcDetectedVersion;\n      var minorVersion = parseInt(hasMatch[2] || '0', 10);\n      var nativeImplIsOverridable = majorVersion == 11 && minorVersion < 2;\n      window.webrtcDetectedType    = hasNativeImpl && !(AdapterJS.options.forceSafariPlugin && nativeImplIsOverridable) ? 'AppleWebKit' : 'plugin';\n    }\n    window.webrtcDetectedDCSupport = 'SCTP';\n  }\n\n  // Scope it to AdapterJS and window for better consistency\n  AdapterJS.webrtcDetectedBrowser   = window.webrtcDetectedBrowser;\n  AdapterJS.webrtcDetectedVersion   = window.webrtcDetectedVersion;\n  AdapterJS.webrtcMinimumVersion    = window.webrtcMinimumVersion;\n  AdapterJS.webrtcDetectedType      = window.webrtcDetectedType;\n  AdapterJS.webrtcDetectedDCSupport = window.webrtcDetectedDCSupport;\n};\n\n// END OF ADAPTERJS BROWSER AND VERSION DETECTION\n///////////////////////////////////////////////////////////////////\n\n///////////////////////////////////////////////////////////////////\n// EXTENSION FOR CHROME, FIREFOX AND EDGE\n// Includes additional shims\n// -- attachMediaStream\n// -- reattachMediaStream\n// -- a call to AdapterJS.maybeThroughWebRTCReady (notifies WebRTC is ready)\nAdapterJS.addExtensions = function() {\n  var attachMediaStream = null;\n  var reattachMediaStream = null;\n// Add support for legacy functions\n  if ( navigator.mozGetUserMedia ) {\n    // Attach a media stream to an element.\n    attachMediaStream = function(element, stream) {\n      element.srcObject = stream;\n      return element;\n    };\n\n    reattachMediaStream = function(to, from) {\n      to.srcObject = from.srcObject;\n      return to;\n    };\n  } else if ( navigator.webkitGetUserMedia ) {\n    // Attach a media stream to an element.\n    attachMediaStream = function(element, stream) {\n      if (AdapterJS.webrtcDetectedVersion >= 43) {\n        element.srcObject = stream;\n      } else if (typeof element.src !== 'undefined') {\n        element.src = URL.createObjectURL(stream);\n      } else {\n        console.error('Error attaching stream to element.');\n        // logging('Error attaching stream to element.');\n      }\n      return element;\n    };\n\n    reattachMediaStream = function(to, from) {\n      if (AdapterJS.webrtcDetectedVersion >= 43) {\n        to.srcObject = from.srcObject;\n      } else {\n        to.src = from.src;\n      }\n      return to;\n    };\n\n  } else if (AdapterJS.webrtcDetectedType === 'AppleWebKit') {\n    attachMediaStream = function(element, stream) {\n      element.srcObject = stream;\n      return element;\n    };\n    reattachMediaStream = function(to, from) {\n      to.srcObject = from.srcObject;\n      return to;\n    };\n  }\n\n// Propagate attachMediaStream and gUM in window and AdapterJS\n  window.attachMediaStream      = attachMediaStream;\n  window.reattachMediaStream    = reattachMediaStream;\n  AdapterJS.attachMediaStream   = attachMediaStream;\n  AdapterJS.reattachMediaStream = reattachMediaStream;\n};\n\n// END OF EXTENSION OF CHROME, FIREFOX AND EDGE\n///////////////////////////////////////////////////////////////////\n\n// Init browser detection\nAdapterJS.parseWebrtcDetectedBrowser();\n// Add extensions\nAdapterJS.addExtensions();\n// Signal AdapterJS loaded\nAdapterJS.maybeThroughWebRTCReady();\n\nexport default AdapterJS;\n","import Skylink from '../../index';\nimport helpers from './index';\n\nconst getSDPCommonSupports = (targetMid, sessionDescription = null, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const offer = { audio: false, video: false };\n  const { AdapterJS } = window;\n  const { currentCodecSupport, peerInformations } = state;\n  const { beSilentOnParseLogs } = Skylink.getInitOptions();\n\n  if (!targetMid || !(sessionDescription && sessionDescription.sdp)) {\n    // TODO: Implement getCodecsSupport inside room-init\n    offer.video = !!(currentCodecSupport.video.h264 || currentCodecSupport.video.vp8);\n    offer.audio = !!currentCodecSupport.audio.opus;\n\n    if (targetMid) {\n      const peerAgent = ((peerInformations[targetMid] || {}).agent || {}).name || '';\n\n      if (AdapterJS.webrtcDetectedBrowser === peerAgent) {\n        offer.video = Object.keys(currentCodecSupport.video).length > 0;\n        offer.audio = Object.keys(currentCodecSupport.audio).length > 0;\n      }\n    }\n    return offer;\n  }\n\n  const remoteCodecs = helpers.getSDPCodecsSupport(targetMid, sessionDescription, beSilentOnParseLogs);\n  const localCodecs = currentCodecSupport;\n\n  /* eslint-disable no-restricted-syntax */\n  /* eslint-disable no-prototype-builtins */\n  for (const ac in localCodecs.audio) {\n    if (localCodecs.audio.hasOwnProperty(ac) && localCodecs.audio[ac] && remoteCodecs.audio[ac]) {\n      offer.audio = true;\n      break;\n    }\n  }\n\n  for (const vc in localCodecs.video) {\n    if (localCodecs.video.hasOwnProperty(vc) && localCodecs.video[vc] && remoteCodecs.video[vc]) {\n      offer.video = true;\n      break;\n    }\n  }\n\n  return offer;\n};\n\nexport default getSDPCommonSupports;\n","export const ON_INCOMING_STREAM = 'onIncomingStream';\nexport const ON_INCOMING_SCREEN_STREAM = 'onIncomingScreenStream';\nexport const STREAM_ENDED = 'streamEnded';\nexport const PEER_UPDATED = 'peerUpdated';\nexport const PEER_JOINED = 'peerJoined';\nexport const PEER_LEFT = 'peerLeft';\nexport const PEER_CONNECTION_STATE = 'peerConnectionState';\nexport const DATA_CHANNEL_STATE = 'dataChannelState';\nexport const ON_INCOMING_MESSAGE = 'onIncomingMessage';\nexport const HANDSHAKE_PROGRESS = 'handshakeProgress';\nexport const SERVER_PEER_JOINED = 'serverPeerJoined';\nexport const SERVER_PEER_LEFT = 'serverPeerLeft';\nexport const CANDIDATE_PROCESSING_STATE = 'candidateProcessingState';\nexport const CANDIDATE_GENERATION_STATE = 'candidateGenerationState';\nexport const CANDIDATES_GATHERED = 'candidatesGathered';\nexport const DATA_STREAM_STATE = 'dataStreamState';\nexport const DATA_TRANSFER_STATE = 'dataTransferState';\nexport const ON_INCOMING_DATA = 'onIncomingData';\nexport const ON_INCOMING_DATA_REQUEST = 'onIncomingDataRequest';\nexport const ON_INCOMING_DATA_STREAM = 'onIncomingDataStream';\nexport const ON_INCOMING_DATA_STREAM_STARTED = 'onIncomingDataStreamStarted';\nexport const ON_INCOMING_DATA_STREAM_STOPPED = 'onIncomingDataStreamStopped';\nexport const GET_PEERS_STATE_CHANGE = 'getPeersStateChange';\nexport const SESSION_DISCONNECT = 'sessionDisconnect';\nexport const STREAM_MUTED = 'streamMuted';\nexport const CHANNEL_OPEN = 'channelOpen';\nexport const CHANNEL_REOPEN = 'channelReopen';\nexport const CHANNEL_CLOSE = 'channelClose';\nexport const CHANNEL_MESSAGE = 'channelMessage';\nexport const CHANNEL_ERROR = 'channelError';\nexport const CHANNEL_RETRY = 'channelRetry';\nexport const SOCKET_ERROR = 'socketError';\nexport const SYSTEM_ACTION = 'systemAction';\nexport const MEDIA_ACCESS_FALLBACK = 'mediaAccessFallback';\nexport const MEDIA_ACCESS_REQUIRED = 'mediaAccessRequired';\nexport const MEDIA_ACCESS_STOPPED = 'mediaAccessStopped';\nexport const MEDIA_ACCESS_SUCCESS = 'mediaAccessSuccess';\nexport const RECORDING_STATE = 'recordingState';\nexport const LOCAL_MEDIA_MUTED = 'localMediaMuted';\nexport const MEDIA_ACCESS_ERROR = 'mediaAccessError';\nexport const GET_CONNECTION_STATUS_STATE_CHANGE = 'getConnectionStatusStateChange';\nexport const READY_STATE_CHANGE = 'readyStateChange';\nexport const ROOM_LOCK = 'roomLock';\nexport const INTRODUCE_STATE_CHANGE = 'introduceStateChange';\nexport const ICE_CONNECTION_STATE = 'iceConnectionState';\nexport const BYE = 'bye';\nexport const RTMP_STATE = 'rtmpState';\nexport const LOGGED_ON_CONSOLE = 'loggedOnConsole';\nexport const MEDIA_INFO_DELETED = 'mediaInfoDeleted';\nexport const STORED_MESSAGES = 'storedMessages';\nexport const ENCRYPT_SECRETS_UPDATED = 'encryptSecretsUpdated';\nexport const PERSISTENT_MESSAGE_STATE = 'persistentMessageState';\n","class SkylinkEvent {\n  constructor(name, detail) {\n    this.name = name;\n    this.detail = detail;\n  }\n}\n\nexport default SkylinkEvent;\n","import {\n  ON_INCOMING_STREAM,\n  ON_INCOMING_SCREEN_STREAM,\n  STREAM_ENDED,\n  STREAM_MUTED,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.onIncomingStream\n * @description Event triggered when receiving Peer Stream.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {MediaStream} detail.stream - The Stream object. To attach it to an element: <code>attachMediaStream(videoElement, stream);</code>.\n * @param {String} detail.streamId - The stream id.\n * @param {boolean} detail.isSelf -The flag if Peer is User.\n * @param {peerInfo} detail.peerInfo - The Peer session information.\n * @param {String} detail.isReplace - The The flag if the incoming stream has replaced an existing stream.\n * @param {String} detail.replacedStreamId - The streamId of the replaced stream.\n * @param {boolean} detail.isVideo - The flag if the incoming stream has a video track.\n * @param {boolean} detail.isAudio - The flag if the incoming stream has an audio track.\n * @alias SkylinkEvents.onIncomingStream\n * */\nexport const onIncomingStream = (detail = {}) => new SkylinkEvent(ON_INCOMING_STREAM, { detail });\n\n/**\n * @event SkylinkEvents.onIncomingScreenStream\n * @description Event triggered when receving Peer Screenshare Stream.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room.\n * @param {String} detail.peerId - The peer's id.\n * @param {MediaStream} detail.stream - The Stream object.\n * @param {String} detail.streamId - The Stream id.\n * @param {Boolean} detail.isSelf - The flag if Peer is User.\n * @param {peerInfo} detail.peerInfo - The Peer session information.\n * @param {Boolean} detail.isReplace - The flag if the incoming screenshare stream results from shareScreen() called with replaceUserMediaStream = true.\n * @param {boolean} detail.isVideo - The flag if the incoming screen stream has a video track.\n * @param {boolean} detail.isAudio - The flag if the incoming screen stream has an audio track.\n * */\nexport const onIncomingScreenStream = (detail = {}) => new SkylinkEvent(ON_INCOMING_SCREEN_STREAM, { detail });\n\n/**\n * @event SkylinkEvents.streamEnded\n * @description Event triggered when a Peer Stream streaming has stopped. Note that it may not be the currently sent Stream to User, and it also triggers when User leaves the Room for any currently sent Stream to User from Peer.\n * @param {Object} detail - Event's payload.\n * @param {String} detail.peerId - The Peer ID.\n * @param {SkylinkRoom} detail.room - The room.\n * @param {peerInfo} detail.peerInfo - The Peer session information. Object signature matches the <code>peerInfo</code> parameter payload received in the <code>peerJoined</code> event.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @param {Boolean} detail.isScreensharing The flag if Peer Stream is a screensharing Stream.\n * @param {String} detail.streamId The Stream ID.\n * @param {boolean} detail.isVideo - The flag if the ended stream has a video track.\n * @param {boolean} detail.isAudio - The flag if the ended stream has an audio track.\n * */\nexport const streamEnded = (detail = {}) => new SkylinkEvent(STREAM_ENDED, { detail });\n\n/**\n * @event SkylinkEvents.streamMuted\n * @description Event triggered when Peer Stream audio or video tracks has been muted / unmuted.\n * @param {Object} detail - Event's payload.\n * @param {String} detail.peerId -  The Peer ID.\n * @param {peerInfo} detail.peerInfo The Peer session information. Object signature matches the <code>peerInfo</code> parameter payload received in the <code>peerJoined</code> event.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @param {boolean} detail.isVideo - The flag if the muted stream has a video track.\n * @param {boolean} detail.isAudio - The flag if the muted stream has an audio track.\n * @param {boolean} detail.isScreensharing - The flag if the muted stream is a screensharing stream.\n * */\nexport const streamMuted = (detail = {}) => new SkylinkEvent(STREAM_MUTED, { detail });\n","import {\n  DATA_CHANNEL_STATE, ON_INCOMING_MESSAGE, STORED_MESSAGES, ENCRYPT_SECRETS_UPDATED, PERSISTENT_MESSAGE_STATE,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.onDataChannelStateChanged\n * @description Event triggered when a Datachannel connection state has changed.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {SkylinkConstants.DATA_CHANNEL_STATE} detail.state - The current Datachannel connection state.\n * @param {Error} detail.error - The error object. Defined only when <code>state</code> payload is <code>ERROR</code> or <code>SEND_MESSAGE_ERROR</code>.\n * @param {String} detail.channelName - The Datachannel ID.\n * @param {SkylinkConstants.DATA_CHANNEL_TYPE} detail.channelType - The Datachannel type.\n * @param {SkylinkConstants.DATA_CHANNEL_MESSAGE_ERROR} detail.messageType - The Datachannel sending Datachannel message error type.\n *   Defined only when <cod>state</code> payload is <code>SEND_MESSAGE_ERROR</code>.\n * @param {Object} detail.bufferAmount The Datachannel - buffered amount information.\n * @param {number} detail.bufferAmount.bufferedAmount - The size of currently queued data to send on the Datachannel connection.\n * @param {number} detail.bufferAmount.bufferedAmountLowThreshold - Threshold The current buffered amount low threshold configured.\n */\nexport const onDataChannelStateChanged = (detail = {}) => new SkylinkEvent(DATA_CHANNEL_STATE, { detail });\n\n/**\n * @event SkylinkEvents.onIncomingMessage\n * @description Event triggered when receiving message from Peer.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {JSON} detail.message - The message result.\n * @param {JSON|string} detail.message.content - The message.\n * @param {String} detail.message.senderPeerId - The sender Peer ID.\n * @param {String|Array} [detail.message.targetPeerId] The value of the <code>targetPeerId</code>\n *   defined in {@link Skylink#sendP2PMessage} or {@link Skylink#sendMessage}.\n *   Defined as User's Peer ID when <code>isSelf</code> payload value is <code>false</code>.\n *   Defined as <code>null</code> when provided <code>targetPeerId</code> in {@link Skylink#sendP2PMessage} or\n *   {@link Skylink#sendMessage} is not defined.\n * @param {Array} [detail.message.listOfPeers] The list of Peers that the message has been sent to.\n *  Defined only when <code>isSelf</code> payload value is <code>true</code>.\n * @param {boolean} detail.message.isPrivate The flag if message is targeted or not, basing\n *   off the <code>targetPeerId</code> parameter being defined in\n *   {@link Skylink#sendP2PMessage} or\n *   {@link Skylink#sendMessage}.\n * @param {boolean} detail.message.isDataChannel The flag if message is sent from\n *   {@link Skylink#sendP2PMessage}.\n * @param {String} detail.message.timeStamp The time stamp when the message was sent.\n * @param {String} detail.peerId The Peer ID.\n * @param {peerInfo} detail.peerInfo The Peer session information.\n *   Object signature matches the <code>peerInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:peerJoined|peerJoinedEvent}.\n * @param {boolean} detail.isSelf - The flag if Peer is User.\n */\nexport const onIncomingMessage = (detail = {}) => new SkylinkEvent(ON_INCOMING_MESSAGE, { detail });\n\n/**\n * @event SkylinkEvents.storedMessages\n * @description Event triggered when receiving stored messages from the Signaling Server.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {Array} detail.storedMessages - The stored messages result.\n * @param {String} detail.storedMessages[].targetPeerId - The value of the <code>targetPeerId</code>\n *   defined in {@link Skylink#sendP2PMessage} or {@link Skylink#sendMessage}.\n *   Defined as User's Peer ID when <code>isSelf</code> payload value is <code>false</code>.\n *   Defined as <code>null</code> when provided <code>targetPeerId</code> in {@link Skylink#sendP2PMessage} or\n *   {@link Skylink#sendMessage} is not defined.\n * @param {JSON|String} detail.storedMessages[].senderPeerId - The sender Peer ID.\n * @param {JSON|String} detail.storedMessages[].content - The message.\n * @param {JSON|String} detail.storedMessages[].timeStamp - The timestamp when the message was sent, in simplified extended ISO format.\n * @param {boolean} detail.storedMessages.isPrivate - The flag if message is targeted or not, basing\n *   off the <code>targetPeerId</code> parameter being defined in {@link Skylink#sendP2PMessage} or {@link Skylink#sendMessage}. Value will always\n *   be false for stored messages.\n * @param {boolean} detail.storedMessages.isDataChannel - The flag if message is sent from {@link Skylink#sendP2PMessage}. Value will always be\n * true for stored messages.\n * @param {String} detail.peerId - The Peer ID.\n * @param {peerInfo} detail.peerInfo - The Peer session information.\n *   Object signature matches the <code>peerInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:peerJoined|peerJoinedEvent}.\n * @param {boolean} detail.isSelf - The flag if Peer is User.\n */\nexport const storedMessages = (detail = {}) => new SkylinkEvent(STORED_MESSAGES, { detail });\n\n/**\n * @event SkylinkEvents.encryptSecretsUpdated\n * @description Event triggered when encrypt secret data is updated.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {Object} detail.encryptSecrets - The secretId and secret pair.\n * @param {String} detail.selectedSecretId - The id of the secret that is used for encryption and decryption of messages. If value is an\n * empty string, message will not be encrypted.\n * @param {String} detail.peerId - The Peer ID.\n * @param {peerInfo} detail.peerInfo - The Peer session information.\n *   Object signature matches the <code>peerInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:peerJoined|peerJoinedEvent}.\n */\nexport const encryptionSecretsUpdated = (detail = {}) => new SkylinkEvent(ENCRYPT_SECRETS_UPDATED, { detail });\n\n/**\n * @event SkylinkEvents.persistentMessageState\n * @description Event triggered when persistent message state changes.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {Object} detail.isPersistent - The flag if messages should be persistent.\n * @param {String} detail.peerId - The Peer ID.\n * @param {peerInfo} detail.peerInfo - The Peer session information.\n *   Object signature matches the <code>peerInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:peerJoined|peerJoinedEvent}.\n */\nexport const persistentMessageState = (detail = {}) => new SkylinkEvent(PERSISTENT_MESSAGE_STATE, { detail });\n","import { HANDSHAKE_PROGRESS, INTRODUCE_STATE_CHANGE } from './constants';\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @description Event triggered when a Peer connection establishment state has changed.\n * @event SkylinkEvents.handshakeProgress\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.HANDSHAKE_PROGRESS} detail.state The current Peer connection establishment state.\n * @param {String} detail.peerId The Peer ID.\n * @param {SkylinkRoom} detail.room The room.\n * @param {Error|String} [detail.error] The error object.\n *   Defined only when <code>state</code> is <code>ERROR</code>.\n */\nexport const handshakeProgress = (detail = {}) => new SkylinkEvent(HANDSHAKE_PROGRESS, { detail });\n\n/**\n * @description Event triggered when {@link Skylink#introducePeer}\n * introduction request state changes.\n * @event SkylinkEvents.introduceStateChange\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.INTRODUCE_STATE} detail.state The current <code>introducePeer()</code> introduction request state.\n * @param {String} detail.privilegedPeerId The User's privileged Peer ID.\n * @param {String} detail.sendingPeerId The Peer ID to be connected with <code>receivingPeerId</code>.\n * @param {String} detail.receivingPeerId The Peer ID to be connected with <code>sendingPeerId</code>.\n * @param {String} [detail.reason] The error object.\n *   Defined only when <code>state</code> payload is <code>ERROR</code>.\n * @ignore\n */\nexport const introduceStateChange = (detail = {}) => new SkylinkEvent(INTRODUCE_STATE_CHANGE, { detail });\n","/* eslint-disable import/prefer-default-export */\nimport { READY_STATE_CHANGE } from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.readyStateChange\n * @description Event triggered when <code>init()</code> method ready state changes.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.READY_STATE_CHANGE} detail.readyState - The current <code>init()</code> ready state.\n * @param {JSON} detail.error - The error result. Defined only when <code>state</code> is <code>ERROR</code>.\n * @param {Number} detail.error.status - The HTTP status code when failed.\n * @param {SkylinkConstants.READY_STATE_CHANGE_ERROR} detail.error.errorCode - The ready state change failure code.\n * @param {Error} detail.error.content - The error object.\n * @param {String} detail.room - The Room to The Room to retrieve session token for.\n */\nexport const readyStateChange = (detail = {}) => new SkylinkEvent(READY_STATE_CHANGE, { detail });\n","import {\n  CANDIDATE_PROCESSING_STATE,\n  CANDIDATE_GENERATION_STATE,\n  CANDIDATES_GATHERED,\n  ICE_CONNECTION_STATE,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.candidateProcessingState\n * @description Event triggered when remote ICE candidate processing state has changed when Peer is using trickle ICE.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {SkylinkConstants.CANDIDATE_PROCESSING_STATE} detail.state - The ICE candidate processing state.\n * @param {String} detail.candidateId - The remote ICE candidate session ID.\n * @param {String} detail.candidateType - The remote ICE candidate type.\n * @param {Object} detail.candidate - The remote ICE candidate.\n * @param {String} detail.candidate.candidate - The remote ICE candidate connection description.\n * @param {String} detail.candidate.sdpMid- The remote ICE candidate identifier based on the remote session description.\n * @param {number} detail.candidate.sdpMLineIndex - The remote ICE candidate media description index (starting from 0) based on the remote session description.\n * @param {Error} detail.error - The error object.\n */\nexport const candidateProcessingState = detail => new SkylinkEvent(CANDIDATE_PROCESSING_STATE, { detail });\n\n/**\n * @event SkylinkEvents.candidateGenerationState\n * @description Event triggered when a Peer connection ICE gathering state has changed.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {SkylinkConstants.CANDIDATE_GENERATION_STATE} detail.state - The current Peer connection ICE gathering state.\n */\nexport const candidateGenerationState = detail => new SkylinkEvent(CANDIDATE_GENERATION_STATE, { detail });\n\n/**\n * @event SkylinkEvents.candidatesGathered\n * @description Event triggered when all remote ICE candidates gathering has completed and been processed.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {Object} detail.candidatesLength - The remote ICE candidates length.\n * @param {number} detail.candidatesLength.expected - The expected total number of remote ICE candidates to be received.\n * @param {number} detail.candidatesLength.received - The actual total number of remote ICE candidates received.\n * @param {number} detail.candidatesLength.processed - The total number of remote ICE candidates processed.\n */\nexport const candidatesGathered = detail => new SkylinkEvent(CANDIDATES_GATHERED, { detail });\n\n/**\n * @event SkylinkEvents.iceConnectionState\n * @description Learn more about how ICE works in this\n *   <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * Event triggered when a Peer connection ICE connection state has changed.\n * @param {SkylinkEvents.ICE_CONNECTION_STATE} state The current Peer connection ICE connection state.\n * @param {String} peerId The Peer ID.\n */\nexport const iceConnectionState = detail => new SkylinkEvent(ICE_CONNECTION_STATE, { detail });\n","import {\n  PEER_UPDATED,\n  PEER_JOINED,\n  PEER_LEFT,\n  SERVER_PEER_JOINED,\n  SERVER_PEER_LEFT,\n  GET_PEERS_STATE_CHANGE,\n  PEER_CONNECTION_STATE,\n  SESSION_DISCONNECT,\n  GET_CONNECTION_STATUS_STATE_CHANGE,\n} from './constants';\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.peerUpdated\n * @description Event triggered when a Peer session information has been updated.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {boolean} detail.isSelf -The flag if Peer is User.\n * @param {peerInfo} detail.peerInfo - The Peer session information. Object signature matches the <code>peerInfo</code> parameter payload received in the <code>peerJoined</code> event.\n */\nexport const peerUpdated = (detail = {}) => new SkylinkEvent(PEER_UPDATED, { detail });\n\n/**\n * @event SkylinkEvents.peerJoined\n * @description Event triggered when a Peer joins the room.\n * @param {Object} detail - Event's payload\n * @param {SkylinkRoom} detail.room - The current room.\n * @param {String} detail.peerId - The Peer ID.\n * @param {peerInfo} detail.peerInfo - The Peer session information.\n * @param {boolean} detail.isSelf - The flag if Peer is User.\n */\nexport const peerJoined = (detail = {}) => new SkylinkEvent(PEER_JOINED, { detail });\n\n/**\n * @event SkylinkEvents.peerLeft\n * @description Event triggered when a Peer leaves the room.\n * @param {Object} detail - Event's payload.\n * @param {String} detail.peerId - The Peer ID.\n * @param {peerInfo} detail.peerInfo - The Peer session information. Object signature matches the <code>peerInfo</code> parameter payload received in the<code>peerJoined</code> event.\n * @param {boolean} detail.isSelf - The flag if Peer is User.\n */\nexport const peerLeft = (detail = {}) => new SkylinkEvent(PEER_LEFT, { detail });\n\n/**\n * @event SkylinkEvents.serverPeerJoined\n * @description Event triggered when a server Peer joins the room.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkRoom} detail.room - The current room\n * @param {String} detail.peerId - The peer's id\n * @param {SkylinkConstants.SERVER_PEER_TYPE} detail.serverPeerType - The server Peer type\n */\nexport const serverPeerJoined = (detail = {}) => new SkylinkEvent(SERVER_PEER_JOINED, { detail });\n\n/**\n * @event SkylinkEvents.serverPeerLeft\n * @description Event triggered when a server Peer leaves the room.\n * @param {Object} detail - Event's payload\n * @param {String} detail.peerId - The Peer ID\n * @param {SkylinkRoom} detail.room - The room.\n * @param {SkylinkConstants.SERVER_PEER_TYPE} detail.serverPeerType - The server Peer type\n */\nexport const serverPeerLeft = (detail = {}) => new SkylinkEvent(SERVER_PEER_LEFT, { detail });\n\n/**\n * @event SkylinkEvents.getPeersStateChange\n * @description Event triggered when <code>getPeers()</code> method retrieval state changes.\n * @param {Object} detail - Event's payload\n * @param {SkylinkConstants.GET_PEERS_STATE} detail.state - The current <code>getPeers()</code> retrieval state.\n * @param {SkylinkUser.sid} detail.privilegePeerId - The Users privileged Peer Id.\n * @param {Object} detail.peerList - The list of Peer IDs Rooms within the same App space.\n * @param {Array} detail.peerList.#room - The list of Peer IDs associated with the Room defined in <code>#room</code> property.\n * @memberOf SkylinkEvents\n */\nexport const getPeersStateChange = (detail = {}) => new SkylinkEvent(GET_PEERS_STATE_CHANGE, { detail });\n\n/**\n * @event SkylinkEvents.peerConnectionState\n * @description Event triggered when a Peer connection session description exchanging state has changed.\n *  <blockquote class=\"info\">\n *   Learn more about how ICE works in this\n *   <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * @param {Object} detail - Event's payload\n * @param {SkylinkConstants.PEER_CONNECTION_STATE} detail.state - The current Peer connection session description exchanging states.\n * @param {String} detail.peerId - The Peer ID\n */\nexport const peerConnectionState = (detail = {}) => new SkylinkEvent(PEER_CONNECTION_STATE, { detail });\n\n/**\n * @event SkylinkEvents.sessionDisconnect\n * @description Event triggered when Room session has ended abruptly due to network disconnections.\n * @param {Object} detail - Event's payload.\n * @param {String} detail.peerId - The User's Room session Peer ID\n * @param {peerInfo} detail.peerInfo - The User's Room session information. Object signature matches the <code>peerInfo</code> parameter payload received in the<code>peerJoined</code> event.\n */\nexport const sessionDisconnect = (detail = {}) => new SkylinkEvent(SESSION_DISCONNECT, { detail });\n\n/**\n * Event triggered when <code>{@link PeerConnection.getConnectionStatus}</code> method\n * retrieval state changes.\n * @event SkylinkEvents.getConnectionStatusStateChange\n * @param {Object} detail - Event's payload/\n * @param {SkylinkConstants.GET_CONNECTION_STATUS_STATE} detail.state The current <code>getConnectionStatus()</code> retrieval state.\n * @param {String} detail.peerId The Peer ID.\n * @param {statistics} [detail.stats] The Peer connection current stats.\n * @param {Error} detail.error - The error object. Defined only when <code>state</code> payload is <code>RETRIEVE_ERROR</code>.\n */\nexport const getConnectionStatusStateChange = (detail = {}) => new SkylinkEvent(GET_CONNECTION_STATUS_STATE_CHANGE, { detail });\n","/* eslint-disable */\nimport {\n  CHANNEL_OPEN,\n  CHANNEL_REOPEN,\n  CHANNEL_CLOSE,\n  CHANNEL_ERROR,\n  CHANNEL_MESSAGE,\n  CHANNEL_RETRY,\n  SOCKET_ERROR,\n  SYSTEM_ACTION,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent'\n\n/**\n * @event SkylinkEvents.channelOpen\n * @description Event triggered when socket connection to Signaling server has opened.\n * @param {Object} detail - Event's payload.\n * @param {socketSession} detail.session The socket connection session information.\n */\nexport const channelOpen = detail => new SkylinkEvent(CHANNEL_OPEN, { detail });\n\n/**\n * @event SkylinkEvents.channelReopen\n * @description Event triggered when socket connection to Signaling server has re-opened.\n * @param {Object} detail - Event's payload.\n * @param {socketSession} detail.session The socket connection session information.\n * @example\n * Example 1: Listen on channelReopen to handle successful socket reconnection if socket was disconnected\n * (channelClose event emitted).\n * SkylinkEventManager.addEventListener(SkylinkConstants.EVENTS.CHANNEL_REOPEN, evt => {\n *   const { detail } = evt;\n *   skylink.leaveRoom() // call leaveRoom to ensure that previous peer information will be removed\n *   .then(() => skylink.joinRoom(joinRoomOptions))\n *   .then((streams) => {\n *     window.attachMediaStream(el, stream);\n *   })\n * });\n */\nexport const channelReopen = detail => new SkylinkEvent(CHANNEL_REOPEN, { detail });\n\n/**\n * @description Event triggered when socket connection to Signaling server has closed.\n * @event SkylinkEvents.channelClose\n * @param {Object} detail - Event's payload.\n * @param {socketSession} detail.session The socket connection session information.\n */\nexport const channelClose = detail => new SkylinkEvent(CHANNEL_CLOSE, { detail });\n\n/**\n * @description This may be caused by Javascript errors in the event listener when subscribing to events.<br>\n * It may be resolved by checking for code errors in your Web App in the event subscribing listener.<br>\n * Event triggered when socket connection encountered exception.\n * @event SkylinkEvents.channelError\n * @param {Object} detail - Event's payload.\n * @param {Error|String} detail.error The error object.\n * @param {socketSession} detail.session The socket connection session information.\n */\nexport const channelError = detail => new SkylinkEvent(CHANNEL_ERROR, { detail });\n\n/**\n * @description Note that this is used only for SDK developer purposes.\n * Event triggered when receiving socket message from the Signaling server.\n * @event SkylinkEvents.channelMessage\n * @param {Object} detail - Event's payload.\n * @param {Object} detail.message The socket message object.\n * @param {socketSession} detail.session The socket connection session information.\n */\nexport const channelMessage = detail => new SkylinkEvent(CHANNEL_MESSAGE, { detail });\n\n/**\n * @description Event triggered when attempting to establish socket connection to Signaling server when failed.\n * @event SkylinkEvents.channelRetry\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.SOCKET_FALLBACK} detail.fallbackType The current fallback state.\n * @param {Number} detail.currentAttempt The current socket reconnection attempt.\n * @param {socketSession} detail.session The socket connection session information.\n */\nexport const channelRetry = detail => new SkylinkEvent(CHANNEL_RETRY, { detail });\n\n/**\n * @description Event triggered when attempt to establish socket connection to Signaling server has failed.\n * @event SkylinkEvents.socketError\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.SOCKET_ERROR} detail.errorCode The socket connection error code.\n * @param {Error|String|Number} detail.error The error object.\n * @param {SkylinkConstants.SOCKET_FALLBACK} detail.type The fallback state of the socket connection attempt.\n * @param {socketSession} detail.session The socket connection session information.\n */\nexport const socketError = detail => new SkylinkEvent(SOCKET_ERROR, { detail });\n\n/**\n * @description Event triggered when Signaling server reaction state has changed.\n * @event SkylinkEvents.systemAction\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.SYSTEM_ACTION} detail.action The current Signaling server reaction state.\n *   [Rel: Skylink.SYSTEM_ACTION]\n * @param {String} detail.message The message.\n * @param {SkylinkConstants.SYSTEM_ACTION_REASON} detail.reason The Signaling server reaction state reason of action code.\n */\nexport const systemAction = detail => new SkylinkEvent(SYSTEM_ACTION, { detail });\n","import {\n  MEDIA_ACCESS_FALLBACK,\n  MEDIA_ACCESS_REQUIRED,\n  MEDIA_ACCESS_STOPPED,\n  MEDIA_ACCESS_SUCCESS,\n  RECORDING_STATE,\n  LOCAL_MEDIA_MUTED,\n  MEDIA_ACCESS_ERROR,\n  RTMP_STATE,\n  MEDIA_INFO_DELETED,\n} from './constants';\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.mediaAccessFallback\n * @description Event triggered when Stream retrieval fallback state has changed.\n * @param {Object} detail - Event's payload.\n * @param {JSON} detail.error - The error result.\n * @param {String} detail.error.error - The error object.\n * @param {JSON} detail.error.diff - The list of excepted but received audio and video tracks in Stream. Defined only when <code>state</code> payload is <code>FALLBACKED</code>.\n * @param {JSON} detail.error.video - The expected and received video tracks.\n * @param {Number} detail.error.video.expected - The expected video tracks.\n * @param {Number} detail.error.video.received - The received video tracks.\n * @param {JSON} detail.error.audio - The expected and received audio tracks.\n * @param {Number} detail.error.audio.expected - The expected audio tracks.\n * @param {Number} detail.error.audio.received - The received audio tracks.\n * @param {SkylinkConstants.MEDIA_ACCESS_FALLBACK_STATE} detail.state - The fallback state.\n * @param {boolean} detail.isScreensharing - The flag if event occurred during <code>shareScreen()</code> method and not <code>getUserMedia()</code> method.\n * @param {boolean} detail.isAudioFallback - The flag if event occurred during retrieval of audio tracks only when <code>getUserMedia()</code> method had failed to retrieve both audio and video tracks.\n * @param {String} detail.streamId - The Stream ID. Defined only when <code>state</code> payload is <code>FALLBACKED</code>.\n */\nexport const mediaAccessFallback = (detail = {}) => new SkylinkEvent(MEDIA_ACCESS_FALLBACK, { detail });\n\n/**\n * @event SkylinkEvents.mediaAccessRequired\n * @description Event triggered when retrieval of Stream is required to complete <code>joinRoom()</code> method request.\n * @param {Object} detail -Event's payload.\n */\nexport const mediaAccessRequired = (detail = {}) => new SkylinkEvent(MEDIA_ACCESS_REQUIRED, { detail });\n\n/**\n * @event SkylinkEvents.mediaAccessStopped\n * @description Event triggered when Stream has stopped streaming.\n * @param {Object} detail.isScreensharing - The flag if event occurred during <code>shareScreen()</code> method and not <code>getUserMedia()</code> method.\n * @param {boolean} detail.isAudioFallback - The flag if event occurred during retrieval of audio tracks only when <code>getUserMedia()</code> method had failed to retrieve both audio and video tracks.\n * @param {String} detail.streamId - The Stream ID.\n */\nexport const mediaAccessStopped = (detail = {}) => new SkylinkEvent(MEDIA_ACCESS_STOPPED, { detail });\n\n/**\n * @event SkylinkEvents.mediaAccessSuccess\n * @description Event triggered when retrieval of Stream is successful.\n * @param {Object} detail\n * @param {MediaStream} detail.stream - The Stream object. To attach it to an element: <code>attachMediaStream(videoElement, stream);</code>.\n * @param {Boolean} detail.isScreensharing - The flag if event occurred during <code>shareScreen()</code> method and not <code>getUserMedia()</code> method.\n * @param {Boolean} detail.isAudioFallback - The flag if event occurred during retrieval of audio tracks only when <code>getUserMedia()</code> method had failed to retrieve both audio and video tracks.\n * @param {String} detail.streamId - The Stream ID.\n * @param {boolean} detail.isVideo - The flag if the incoming stream has a video track.\n * @param {boolean} detail.isAudio - The flag if the incoming stream has an audio track.\n * @alias SkylinkEvents.mediaAccessSuccess\n */\nexport const mediaAccessSuccess = (detail = {}) => new SkylinkEvent(MEDIA_ACCESS_SUCCESS, { detail });\n\n/**\n * @event SkylinkEvents.recordingState\n * @description Event triggered when recording session state has changed.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.RECORDING_STATE} detail.state - The current recording session state.\n * @param {String} detail.recordingId - The recording session ID.\n * @param {Error | String} detail.error - The error object. Defined only when <code>state</code> payload is <code>ERROR</code>.\n */\nexport const recordingState = (detail = {}) => new SkylinkEvent(RECORDING_STATE, { detail });\n\n/**\n * @event SkylinkEvents.rtmpState\n * @description Event triggered when rtmp session state has changed.\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.RTMP_STATE} detail.state - The current recording session state.\n * @param {String} detail.rtmpId - The rtmp session ID.\n * @param {Error | String} detail.error - The error object. Defined only when <code>state</code> payload is <code>ERROR</code>.\n */\nexport const rtmpState = (detail = {}) => new SkylinkEvent(RTMP_STATE, { detail });\n\n/**\n * @event SkylinkEvents.localMediaMuted\n * @description Event triggered when <code>muteStreams()</code> method changes User Streams audio and video tracks muted status.\n * @param {Object} detail - Event's payload.\n * @param {String} detail.streamId - The muted Stream Id.\n * @param {Boolean} detail.isScreensharing - The flag if the media muted was screensharing.\n * @param {JSON} detail.mediaStatus - The Peer streaming media status. This indicates the media status for both <code>getUserMedia()</code> Stream and <code>shareScreen()</code> Stream.\n * @param {Boolean} detail.mediaStatus.audioMuted - The value of the audio status. If Peer <code>mediaStatus</code> is <code>-1</code>, audio is not present in the stream. If Peer <code>mediaStatus</code> is <code>1</code>, audio is present\n *   in the stream and active (not muted). If Peer <code>mediaStatus</code> is <code>0</code>, audio is present in the stream and muted.\n * @param {Boolean} detail.mediaStatus.videoMuted - The value of the video status. If Peer <code>mediaStatus</code> is <code>-1</code>, video is not present in the stream. If Peer <code>mediaStatus</code> is <code>1</code>, video is present\n *   in the stream and active (not muted). If Peer <code>mediaStatus</code> is <code>0</code>, video is present in the stream and muted.\n */\nexport const localMediaMuted = (detail = {}) => new SkylinkEvent(LOCAL_MEDIA_MUTED, { detail });\n\n/**\n * @event SkylinkEvents.mediaAccessError\n * @description Event triggered when retrieval of Stream failed.\n * @param {Object} detail - Event's payload.\n * @param {Error | String} detail.error - The error object.\n * @param {Boolean} detail.isScreensharing - The flag if event occurred during <code>shareScreen()</code> method and not <code>getUserMedia()</code> method.\n * @param {Boolean} detail.isAudioFallbackError - The flag if event occurred during retrieval of audio tracks only when <code>getUserMedia()</code> method had failed to retrieve both audio and video tracks.\n */\nexport const mediaAccessError = (detail = {}) => new SkylinkEvent(MEDIA_ACCESS_ERROR, { detail });\n\n/**\n * @event SkylinkEvents.mediaInfo\n * @description Event triggered when media info changes.\n * @param {Object} detail - Event's payload.\n * @param {Object} detail.mediaInfo - The media info object.\n * @private\n */\nexport const mediaInfoDeleted = (detail = {}) => new SkylinkEvent(MEDIA_INFO_DELETED, { detail });\n","import * as SkylinkEventsConstants from './skylink-events/constants';\n\n/**\n * @namespace SkylinkConstants\n * @description Constants used by SkylinkJS are described here.\n */\n\n/**\n * The list of Datachannel connection states.\n * @typedef DATA_CHANNEL_STATE\n * @property {String} CONNECTING          Value <code>\"connecting\"</code>\n *   The value of the state when Datachannel is attempting to establish a connection.\n * @property {String} OPEN                Value <code>\"open\"</code>\n *   The value of the state when Datachannel has established a connection.\n * @property {String} CLOSING             Value <code>\"closing\"</code>\n *   The value of the state when Datachannel connection is closing.\n * @property {String} CLOSED              Value <code>\"closed\"</code>\n *   The value of the state when Datachannel connection has closed.\n * @property {String} ERROR               Value <code>\"error\"</code>\n *   The value of the state when Datachannel has encountered an exception during connection.\n * @property {String} CREATE_ERROR        Value <code>\"createError\"</code>\n *   The value of the state when Datachannel has failed to establish a connection.\n * @property {String} BUFFERED_AMOUNT_LOW Value <code>\"bufferedAmountLow\"</code>\n *   The value of the state when Datachannel when the amount of data buffered to be sent\n *   falls below the Datachannel threshold.\n *   This state should occur only during after {@link Skylink#sendBlobData} or {@link Skylink#sendURLData} or\n *   {@link Skylink#sendP2PMessage}.\n * @property {String} SEND_MESSAGE_ERROR  Value <code>\"sendMessageError\"</code>\n *   The value of the state when Datachannel when data transfer packets or P2P message fails to send.\n *   This state should occur only during after {@link Skylink#sendBlobData} or {@link Skylink#sendURLData} or\n *   {@link Skylink#sendP2PMessage}.\n * @constant\n * @type object\n * @readOnly\n * @since 0.1.0\n * @memberOf SkylinkConstants\n */\nexport const DATA_CHANNEL_STATE = {\n  CONNECTING: 'connecting',\n  OPEN: 'open',\n  CLOSING: 'closing',\n  CLOSED: 'closed',\n  ERROR: 'error',\n  CREATE_ERROR: 'createError',\n  BUFFERED_AMOUNT_LOW: 'bufferedAmountLow',\n  SEND_MESSAGE_ERROR: 'sendMessageError',\n};\n\n/**\n * The list of Datachannel types.\n * @typedef DATA_CHANNEL_TYPE\n * @property {String} MESSAGING Value <code>\"messaging\"</code>\n *   The value of the Datachannel type that is used only for messaging in\n *   {@link Skylink#sendP2PMessage}.\n *   However for Peers that do not support simultaneous data transfers, this Datachannel\n *   type will be used to do data transfers (1 at a time).\n *   Each Peer connections will only have one of this Datachannel type and the\n *   connection will only close when the Peer connection is closed (happens when {@link SkylinkEvents.event:peerConnectionState|peerConnectionStateEvent} triggers parameter payload <code>state</code> as\n *   <code>CLOSED</code> for Peer).\n * @property {String} DATA Value <code>\"data\"</code>\n *   The value of the Datachannel type that is used only for a data transfer in\n *   {@link Skylink#sendURLData} and\n *   {@link Skylink#sendBlobData}.\n *   The connection will close after the data transfer has been completed or terminated (happens when\n *   {@link SkylinkEvents.event:dataTransferStatedataTransferStateEvent} triggers parameter payload\n *   <code>state</code> as <code>DOWNLOAD_COMPLETED</code>, <code>UPLOAD_COMPLETED</code>,\n *   <code>REJECTED</code>, <code>CANCEL</code> or <code>ERROR</code> for Peer).\n * @constant\n * @type object\n * @readOnly\n * @since 0.6.1\n * @memberOf SkylinkConstants\n */\nexport const DATA_CHANNEL_TYPE = {\n  MESSAGING: 'messaging',\n  DATA: 'data',\n};\n\n/**\n * The list of Datachannel sending message error types.\n * @typedef DATA_CHANNEL_MESSAGE_ERROR\n * @property {String} MESSAGE  Value <code>\"message\"</code>\n *   The value of the Datachannel sending message error type when encountered during\n *   sending P2P message from {@link Skylink#sendP2PMessage}.\n * @property {String} TRANSFER Value <code>\"transfer\"</code>\n *   The value of the Datachannel sending message error type when encountered during\n *   data transfers from {@link Skylink#sendURLData} or\n *   {@link Skylink#sendBlobData}.\n * @constant\n * @type object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.16\n */\nexport const DATA_CHANNEL_MESSAGE_ERROR = {\n  MESSAGE: 'message',\n  TRANSFER: 'transfer',\n};\n\n/**\n * The list of supported data transfer data types.\n * @typedef DATA_TRANSFER_DATA_TYPE\n * @property {String} BINARY_STRING Value <code>\"binaryString\"</code>\n *   The value of data transfer data type when Blob binary data chunks encoded to Base64 encoded string are\n *   sent or received over the Datachannel connection for the data transfer session.\n *   Used only in {@link Skylink#sendBlobData} when\n *   parameter <code>sendChunksAsBinary</code> value is <code>false</code>.\n * @property {String} ARRAY_BUFFER  Value <code>\"arrayBuffer\"</code>\n *   The value of data transfer data type when ArrayBuffer binary data chunks are\n *   sent or received over the Datachannel connection for the data transfer session.\n *   Used only in {@link Skylink#sendBlobData} when\n *   parameter <code>sendChunksAsBinary</code> value is <code>true</code>.\n * @property {String} BLOB          Value <code>\"blob\"</code>\n *   The value of data transfer data type when Blob binary data chunks are\n *   sent or received over the Datachannel connection for the data transfer session.\n *   Used only in {@link Skylink#sendBlobData} when\n *   parameter <code>sendChunksAsBinary</code> value is <code>true</code>.\n * @property {String} STRING        Value <code>\"string\"</code>\n *   The value of data transfer data type when only string data chunks are\n *   sent or received over the Datachannel connection for the data transfer session.\n *   Used only in {@link Skylink#sendURLData}.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n * @ignore\n */\nexport const DATA_TRANSFER_DATA_TYPE = {\n  BINARY_STRING: 'binaryString',\n  ARRAY_BUFFER: 'arrayBuffer',\n  BLOB: 'blob',\n  STRING: 'string',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that this is used only for SDK developer purposes.<br>\n *   Current version: <code>0.1.3</code>\n * </blockquote>\n * The value of the current version of the data transfer protocol.\n * @typedef DT_PROTOCOL_VERSION\n * @type string\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.10\n */\nexport const DT_PROTOCOL_VERSION = '0.1.3';\n\n/**\n * The list of data transfers directions.\n * @typedef DATA_TRANSFER_TYPE\n * @property {String} UPLOAD Value <code>\"upload\"</code>\n *   The value of the data transfer direction when User is uploading data to Peer.\n * @property {String} DOWNLOAD Value <code>\"download\"</code>\n *   The value of the data transfer direction when User is downloading data from Peer.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n * @ignore\n */\nexport const DATA_TRANSFER_TYPE = {\n  UPLOAD: 'upload',\n  DOWNLOAD: 'download',\n};\n\n/**\n * The list of data transfers session types.\n * @typedef DATA_TRANSFER_SESSION_TYPE\n * @property {String} BLOB     Value <code>\"blob\"</code>\n *   The value of the session type for\n *   {@link Skylink#sendURLData} data transfer.\n * @property {String} DATA_URL Value <code>\"dataURL\"</code>\n *   The value of the session type for\n *   {@link Skylink#sendBlobData} data transfer.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n * @ignore\n */\nexport const DATA_TRANSFER_SESSION_TYPE = {\n  BLOB: 'blob',\n  DATA_URL: 'dataURL',\n};\n\n/**\n * The list of data transfer states.\n * @typedef DATA_TRANSFER_STATE\n * @property {String} UPLOAD_REQUEST     Value <code>\"request\"</code>\n *   The value of the state when receiving an upload data transfer request from Peer to User.\n *   At this stage, the upload data transfer request from Peer may be accepted or rejected with the\n *   {@link Skylink#acceptDataTransfer} invoked by User.\n * @param {String} USER_UPLOAD_REQUEST Value <code>\"userRequest\"</code>\n *   The value of the state when User sent an upload data transfer request to Peer.\n *   At this stage, the upload data transfer request to Peer may be accepted or rejected with the\n *   {@link Skylink#acceptDataTransfer}invoked by Peer.\n * @property {String} UPLOAD_STARTED     Value <code>\"uploadStarted\"</code>\n *   The value of the state when the data transfer request has been accepted\n *   and data transfer will start uploading data to Peer.\n *   At this stage, the data transfer may be terminated with the\n *   {@link Skylink#cancelDataTransfer}.\n * @property {String} DOWNLOAD_STARTED   Value <code>\"downloadStarted\"</code>\n *   The value of the state when the data transfer request has been accepted\n *   and data transfer will start downloading data from Peer.\n *   At this stage, the data transfer may be terminated with the\n *   {@link Skylink#cancelDataTransfer}.\n * @property {String} REJECTED           Value <code>\"rejected\"</code>\n *   The value of the state when upload data transfer request to Peer has been rejected and terminated.\n * @property {String} USER_REJECTED      Value <code>\"userRejected\"</code>\n *   The value of the state when User rejected and terminated upload data transfer request from Peer.\n * @property {String} UPLOADING          Value <code>\"uploading\"</code>\n *   The value of the state when data transfer is uploading data to Peer.\n * @property {String} DOWNLOADING        Value <code>\"downloading\"</code>\n *   The value of the state when data transfer is downloading data from Peer.\n * @property {String} UPLOAD_COMPLETED   Value <code>\"uploadCompleted\"</code>\n *   The value of the state when data transfer has uploaded successfully to Peer.\n * @property {String} DOWNLOAD_COMPLETED Value <code>\"downloadCompleted\"</code>\n *   The value of the state when data transfer has downloaded successfully from Peer.\n * @property {String} CANCEL             Value <code>\"cancel\"</code>\n *   The value of the state when data transfer has been terminated from / to Peer.\n * @property {String} ERROR              Value <code>\"error\"</code>\n *   The value of the state when data transfer has errors and has been terminated from / to Peer.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.4.0\n * @ignore\n */\nexport const DATA_TRANSFER_STATE = {\n  UPLOAD_REQUEST: 'request',\n  UPLOAD_STARTED: 'uploadStarted',\n  DOWNLOAD_STARTED: 'downloadStarted',\n  REJECTED: 'rejected',\n  CANCEL: 'cancel',\n  ERROR: 'error',\n  UPLOADING: 'uploading',\n  DOWNLOADING: 'downloading',\n  UPLOAD_COMPLETED: 'uploadCompleted',\n  DOWNLOAD_COMPLETED: 'downloadCompleted',\n  USER_REJECTED: 'userRejected',\n  USER_UPLOAD_REQUEST: 'userRequest',\n  START_ERROR: 'startError',\n};\n\n/**\n * The list of data streaming states.\n * @typedef DATA_STREAM_STATE\n * @property {String} SENDING_STARTED   Value <code>\"sendStart\"</code>\n *   The value of the state when data streaming session has started from User to Peer.\n * @property {String} RECEIVING_STARTED Value <code>\"receiveStart\"</code>\n *   The value of the state when data streaming session has started from Peer to Peer.\n * @property {String} RECEIVED          Value <code>\"received\"</code>\n *   The value of the state when data streaming session data chunk has been received from Peer to User.\n * @property {String} SENT              Value <code>\"sent\"</code>\n *   The value of the state when data streaming session data chunk has been sent from User to Peer.\n * @property {String} SENDING_STOPPED   Value <code>\"sendStop\"</code>\n *   The value of the state when data streaming session has stopped from User to Peer.\n * @property {String} RECEIVING_STOPPED Value <code>\"receivingStop\"</code>\n *   The value of the state when data streaming session has stopped from Peer to User.\n * @property {String} ERROR             Value <code>\"error\"</code>\n *   The value of the state when data streaming session has errors.\n *   At this stage, the data streaming state is considered <code>SENDING_STOPPED</code> or\n *   <code>RECEIVING_STOPPED</code>.\n * @property {String} START_ERROR       Value <code>\"startError\"</code>\n *   The value of the state when data streaming session failed to start from User to Peer.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.18\n * @ignore\n */\nexport const DATA_STREAM_STATE = {\n  SENDING_STARTED: 'sendStart',\n  SENDING_STOPPED: 'sendStop',\n  RECEIVING_STARTED: 'receiveStart',\n  RECEIVING_STOPPED: 'receiveStop',\n  RECEIVED: 'received',\n  SENT: 'sent',\n  ERROR: 'error',\n  START_ERROR: 'startError',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Learn more about how ICE works in this\n *   <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of Peer connection ICE gathering states.\n * @typedef CANDIDATE_GENERATION_STATE\n * @property {String} GATHERING Value <code>\"gathering\"</code>\n *   The value of the state when Peer connection is gathering ICE candidates.\n *   These ICE candidates are sent to Peer for its connection to check for a suitable matching\n *   pair of ICE candidates to establish an ICE connection for stream audio, video and data.\n *   See {@link SkylinkConstants.ICE_CONNECTION_STATE|ICE_CONNECTION_STATE} for ICE connection status.\n *   This state cannot happen until Peer connection remote <code>\"offer\"</code> / <code>\"answer\"</code>\n *   session description is set. See {@link SkylinkConstants.PEER_CONNECTION_STATE|PEER_CONNECTION_STATE} for session description exchanging status.\n * @property {String} COMPLETED Value <code>\"completed\"</code>\n *   The value of the state when Peer connection gathering of ICE candidates has completed.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.4.1\n */\nexport const CANDIDATE_GENERATION_STATE = {\n  NEW: 'new',\n  GATHERING: 'gathering',\n  COMPLETED: 'complete',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Learn more about how ICE works in this\n *   <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of Peer connection remote ICE candidate processing states for trickle ICE connections.\n * @typedef CANDIDATE_PROCESSING_STATE\n * @property {String} RECEIVED Value <code>\"received\"</code>\n *   The value of the state when the remote ICE candidate was received.\n * @property {String} DROPPED  Value <code>\"received\"</code>\n *   The value of the state when the remote ICE candidate is dropped.\n * @property {String} BUFFERED  Value <code>\"buffered\"</code>\n *   The value of the state when the remote ICE candidate is buffered.\n * @property {String} PROCESSING  Value <code>\"processing\"</code>\n *   The value of the state when the remote ICE candidate is being processed.\n * @property {String} PROCESS_SUCCESS  Value <code>\"processSuccess\"</code>\n *   The value of the state when the remote ICE candidate has been processed successfully.\n *   The ICE candidate that is processed will be used to check against the list of\n *   locally generated ICE candidate to start matching for the suitable pair for the best ICE connection.\n * @property {String} PROCESS_ERROR  Value <code>\"processError\"</code>\n *   The value of the state when the remote ICE candidate has failed to be processed.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.16\n */\nexport const CANDIDATE_PROCESSING_STATE = {\n  RECEIVED: 'received',\n  DROPPED: 'dropped',\n  BUFFERED: 'buffered',\n  PROCESSING: 'processing',\n  PROCESS_SUCCESS: 'processSuccess',\n  PROCESS_ERROR: 'processError',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Learn more about how ICE works in this\n *   <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of Peer connection ICE connection states.\n * @typedef ICE_CONNECTION_STATE\n * @property {String} CHECKING       Value <code>\"checking\"</code>\n *   The value of the state when Peer connection is checking for a suitable matching pair of\n *   ICE candidates to establish ICE connection.\n *   Exchanging of ICE candidates happens during {@link SkylinkEvents.event:candidateGenerationState|candidateGenerationStateEvent}.\n * @property {String} CONNECTED      Value <code>\"connected\"</code>\n *   The value of the state when Peer connection has found a suitable matching pair of\n *   ICE candidates to establish ICE connection but is still checking for a better\n *   suitable matching pair of ICE candidates for the best ICE connectivity.\n *   At this state, ICE connection is already established and audio, video and\n *   data streaming has already started.\n * @property {String} COMPLETED      Value <code>\"completed\"</code>\n *   The value of the state when Peer connection has found the best suitable matching pair\n *   of ICE candidates to establish ICE connection and checking has stopped.\n *   At this state, ICE connection is already established and audio, video and\n *   data streaming has already started. This may happpen after <code>CONNECTED</code>.\n * @property {String} FAILED         Value <code>\"failed\"</code>\n *   The value of the state when Peer connection ICE connection has failed.\n * @property {String} DISCONNECTED   Value <code>\"disconnected\"</code>\n *   The value of the state when Peer connection ICE connection is disconnected.\n *   At this state, the Peer connection may attempt to revive the ICE connection.\n *   This may happen due to flaky network conditions.\n * @property {String} CLOSED         Value <code>\"closed\"</code>\n *   The value of the state when Peer connection ICE connection has closed.\n *   This happens when Peer connection is closed and no streaming can occur at this stage.\n * @property {String} TRICKLE_FAILED Value <code>\"trickleFailed\"</code>\n *   The value of the state when Peer connection ICE connection has failed during trickle ICE.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n */\nexport const ICE_CONNECTION_STATE = {\n  STARTING: 'starting',\n  CHECKING: 'checking',\n  CONNECTED: 'connected',\n  COMPLETED: 'completed',\n  CLOSED: 'closed',\n  FAILED: 'failed',\n  TRICKLE_FAILED: 'trickleFailed',\n  DISCONNECTED: 'disconnected',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that configuring the protocol may not necessarily result in the desired network transports protocol\n *   used in the actual TURN network traffic as it depends which protocol the browser selects and connects with.\n *   This simply configures the TURN ICE server urls <code?transport=(protocol)</code> query option when constructing\n *   the Peer connection. When all protocols are selected, the ICE servers urls are duplicated with all protocols.\n * </blockquote>\n * The list of TURN network transport protocols options when constructing Peer connections\n * configured in Skylink {@link initOptions}.\n * Example <code>.urls</code> inital input: [<code>\"turn:server.com?transport=tcp\"</code>,\n * <code>\"turn:server1.com:3478\"</code>, <code>\"turn:server.com?transport=udp\"</code>]\n * @typedef TURN_TRANSPORT\n * @property {String} TCP Value  <code>\"tcp\"</code>\n *   The value of the option to configure using only TCP network transport protocol.\n *   Example <code>.urls</code> output: [<code>\"turn:server.com?transport=tcp\"</code>,\n *   <code>\"turn:server1.com:3478?transport=tcp\"</code>]\n * @property {String} UDP Value  <code>\"udp\"</code>\n *   The value of the option to configure using only UDP network transport protocol.\n *   Example <code>.urls</code> output: [<code>\"turn:server.com?transport=udp\"</code>,\n *   <code>\"turn:server1.com:3478?transport=udp\"</code>]\n * @property {String} ANY Value  <code>\"any\"</code>\n *   The value of the option to configure using any network transport protocols configured from the Signaling server.\n *   Example <code>.urls</code> output: [<code>\"turn:server.com?transport=tcp\"</code>,\n *   <code>\"turn:server1.com:3478\"</code>, <code>\"turn:server.com?transport=udp\"</code>]\n * @property {String} NONE Value <code>\"none\"</code>\n *   The value of the option to not configure using any network transport protocols.\n *   Example <code>.urls</code> output: [<code>\"turn:server.com\"</code>, <code>\"turn:server1.com:3478\"</code>]\n *   Configuring this does not mean that no protocols will be used, but\n *   rather removing <code>?transport=(protocol)</code> query option in\n *   the TURN ICE server <code>.urls</code> when constructing the Peer connection.\n * @property {String} ALL Value  <code>\"all\"</code>\n *   The value of the option to configure using both TCP and UDP network transport protocols.\n *   Example <code>.urls</code> output: [<code>\"turn:server.com?transport=tcp\"</code>,\n *   <code>\"turn:server.com?transport=udp\"</code>, <code>\"turn:server1.com:3478?transport=tcp\"</code>,\n *   <code>\"turn:server1.com:3478?transport=udp\"</code>]\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.4\n */\nexport const TURN_TRANSPORT = {\n  UDP: 'udp',\n  TCP: 'tcp',\n  ANY: 'any',\n  NONE: 'none',\n  ALL: 'all',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Learn more about how ICE works in this\n *   <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of Peer connection session description exchanging states.\n * @typedef PEER_CONNECTION_STATE\n * @property {String} STABLE            Value <code>\"stable\"</code>\n *   The value of the state when there is no session description being exchanged between Peer connection.\n * @property {String} HAVE_LOCAL_OFFER  Value <code>\"have-local-offer\"</code>\n *   The value of the state when local <code>\"offer\"</code> session description is set.\n *   This should transition to <code>STABLE</code> state after remote <code>\"answer\"</code>\n *   session description is set.\n *   See {@link SkylinkConstants.HANDSHAKE_PROGRESS|HANDSHAKE_PROGRESS} for a more\n *   detailed exchanging of session description states.\n * @property {String} HAVE_REMOTE_OFFER Value <code>\"have-remote-offer\"</code>\n *   The value of the state when remote <code>\"offer\"</code> session description is set.\n *   This should transition to <code>STABLE</code> state after local <code>\"answer\"</code>\n *   session description is set.\n *   See {@link SkylinkConstants.HANDSHAKE_PROGRESS|HANDSHAKE_PROGRESS} for a more\n *   detailed exchanging of session description states.\n * @property {String} CLOSED            Value <code>\"closed\"</code>\n *   The value of the state when Peer connection is closed and no session description can be exchanged and set.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.0\n */\nexport const PEER_CONNECTION_STATE = {\n  STABLE: 'stable',\n  HAVE_LOCAL_OFFER: 'have-local-offer',\n  HAVE_REMOTE_OFFER: 'have-remote-offer',\n  CLOSED: 'closed',\n};\n\n/**\n * The list of {@link Skylink#getConnectionStatus} retrieval states.\n * @typedef GET_CONNECTION_STATUS_STATE\n * @property {number} RETRIEVING Value <code>0</code>\n *   The value of the state when {@link Skylink#getConnectionStatus} is retrieving the Peer connection stats.\n * @property {number} RETRIEVE_SUCCESS Value <code>1</code>\n *   The value of the state when {@link Skylink#getConnectionStatus} has retrieved the Peer connection stats successfully.\n * @property {number} RETRIEVE_ERROR Value <code>-1</code>\n *   The value of the state when {@link Skylink#getConnectionStatus} has failed retrieving the Peer connection stats.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n */\nexport const GET_CONNECTION_STATUS_STATE = {\n  RETRIEVING: 0,\n  RETRIEVE_SUCCESS: 1,\n  RETRIEVE_ERROR: -1,\n};\n\n/**\n * <blockquote class=\"info\">\n *  As there are more features getting implemented, there will be eventually more different types of\n *  server Peers.\n * </blockquote>\n * The list of available types of server Peer connections.\n * @typedef SERVER_PEER_TYPE\n * @property {String} MCU Value <code>\"mcu\"</code>\n *   The value of the server Peer type that is used for MCU connection.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.1\n */\nexport const SERVER_PEER_TYPE = {\n  MCU: 'mcu',\n  // SIP: 'sip'\n};\n\n/**\n * <blockquote class=\"info\">\n *  Learn more about how ICE works in this\n *  <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of available Peer connection bundle policies.\n * @typedef BUNDLE_POLICY\n * @property {String} MAX_COMPAT Value <code>\"max-compat\"</code>\n *   The value of the bundle policy to generate ICE candidates for each media type\n *   so each media type flows through different transports.\n * @property {String} MAX_BUNDLE Value <code>\"max-bundle\"</code>\n *   The value of the bundle policy to generate ICE candidates for one media type\n *   so all media type flows through a single transport.\n * @property {String} BALANCED   Value <code>\"balanced\"</code>\n *   The value of the bundle policy to use <code>MAX_BUNDLE</code> if Peer supports it,\n *   else fallback to <code>MAX_COMPAT</code>.\n * @property {String} NONE       Value <code>\"none\"</code>\n *   The value of the bundle policy to not use any media bundle.\n *   This removes the <code>a=group:BUNDLE</code> line from session descriptions.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.18\n */\nexport const BUNDLE_POLICY = {\n  MAX_COMPAT: 'max-compat',\n  BALANCED: 'balanced',\n  MAX_BUNDLE: 'max-bundle',\n  NONE: 'none',\n};\n\n/**\n * <blockquote class=\"info\">\n *  Learn more about how ICE works in this\n *  <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of available Peer connection RTCP mux policies.\n * @typedef RTCP_MUX_POLICY\n * @property {String} REQUIRE   Value <code>\"require\"</code>\n *   The value of the RTCP mux policy to generate ICE candidates for RTP only and RTCP shares the same ICE candidates.\n * @property {String} NEGOTIATE Value <code>\"negotiate\"</code>\n *   The value of the RTCP mux policy to generate ICE candidates for both RTP and RTCP each.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.18\n */\nexport const RTCP_MUX_POLICY = {\n  REQUIRE: 'require',\n  NEGOTIATE: 'negotiate',\n};\n\n/**\n * <blockquote class=\"info\">\n *  Learn more about how ICE works in this\n *  <a href=\"https://temasys.com.sg/ice-what-is-this-sorcery/\">article here</a>.\n * </blockquote>\n * The list of available Peer connection certificates cryptographic algorithm to use.\n * @typedef PEER_CERTIFICATE\n * @property {String} RSA   Value <code>\"RSA\"</code>\n *   The value of the Peer connection certificate algorithm to use RSA-1024.\n * @property {String} ECDSA Value <code>\"ECDSA\"</code>\n *   The value of the Peer connection certificate algorithm to use ECDSA.\n * @property {String} AUTO  Value <code>\"AUTO\"</code>\n *   The value of the Peer connection to use the default certificate generated.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.18\n */\nexport const PEER_CERTIFICATE = {\n  RSA: 'RSA',\n  ECDSA: 'ECDSA',\n  AUTO: 'AUTO',\n};\n\n/**\n * The list of Peer connection states.\n * @typedef HANDSHAKE_PROGRESS\n * @property {String} ENTER   Value <code>\"enter\"</code>\n *   The value of the connection state when Peer has just entered the Room.\n *   At this stage, {@link SkylinkConstants.PEER_JOINED|PEER_JOINED}\n *   is triggered.\n * @property {String} WELCOME Value <code>\"welcome\"</code>\n *   The value of the connection state when Peer is aware that User has entered the Room.\n *   At this stage, {@link SkylinkConstants.PEER_JOINED|PEER_JOINED}\n *   is triggered and Peer connection may commence.\n * @property {String} OFFER   Value <code>\"offer\"</code>\n *   The value of the connection state when Peer connection has set the local / remote <code>\"offer\"</code>\n *   session description to start streaming connection.\n * @property {String} ANSWER  Value <code>\"answer\"</code>\n *   The value of the connection state when Peer connection has set the local / remote <code>\"answer\"</code>\n *   session description to establish streaming connection.\n * @property {string} ANSWER_ACK  Value <code>\"answerAck\"</code>\n *   The value of the connection state when Peer connection is aware that the user has received the answer and the handshake is\n *   complete.\n * @property {string} ERROR   Value <code>\"error\"</code>\n *   The value of the connection state when Peer connection has failed to establish streaming connection.\n *   This happens when there are errors that occurs in creating local <code>\"offer\"</code> /\n *   <code>\"answer\"</code>, or when setting remote / local <code>\"offer\"</code> / <code>\"answer\"</code>.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n */\nexport const HANDSHAKE_PROGRESS = {\n  ENTER: 'enter',\n  WELCOME: 'welcome',\n  OFFER: 'offer',\n  ANSWER: 'answer',\n  ANSWER_ACK: 'answerAck',\n  ERROR: 'error',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that this feature requires <code>\"isPrivileged\"</code> flag to be enabled for the App Key\n *   provided in Skylink {@link initOptions}, as only Users connecting using\n *   the App Key with this flag enabled (which we call privileged Users / Peers) can retrieve the list of\n *   Peer IDs from Rooms within the same App space.\n *   <a href=\"http://support.temasys.io/support/solutions/articles/12000012342-what-is-a-privileged-key-\">\n *   Read more about privileged App Key feature here</a>.\n * </blockquote>\n * The list of <a href=\"#method_getPeers\"><code>getPeers()</code> method</a> retrieval states.\n * @typedef GET_PEERS_STATE\n * @property {String} ENQUIRED Value <code>\"enquired\"</code>\n *   The value of the state when <code>getPeers()</code> is retrieving the list of Peer IDs\n *   from Rooms within the same App space from the Signaling server.\n * @property {String} RECEIVED Value <code>\"received\"</code>\n *   The value of the state when <code>getPeers()</code> has retrieved the list of Peer IDs\n *   from Rooms within the same App space from the Signaling server successfully.\n * @readOnly\n * @type Object\n * @constant\n * @public\n * @memberOf SkylinkConstants\n * @since 0.6.1\n */\nexport const GET_PEERS_STATE = {\n  ENQUIRED: 'enquired',\n  DISPATCHED: 'dispatched',\n  RECEIVED: 'received',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that this feature requires <code>\"isPrivileged\"</code> flag to be enabled and\n *   <code>\"autoIntroduce\"</code> flag to be disabled for the App Key provided in\n *   Skylink {@link initOptions}, as only Users connecting using\n *   the App Key with this flag enabled (which we call privileged Users / Peers) can retrieve the list of\n *   Peer IDs from Rooms within the same App space.\n *   <a href=\"http://support.temasys.io/support/solutions/articles/12000012342-what-is-a-privileged-key-\">\n *   Read more about privileged App Key feature here</a>.\n * </blockquote>\n * The list of {@link Skylink#introducePeer} Peer introduction request states.\n * @typedef INTRODUCE_STATE\n * @property {String} INTRODUCING Value <code>\"enquired\"</code>\n *   The value of the state when introduction request for the selected pair of Peers has been made to the Signaling server.\n * @property {String} ERROR       Value <code>\"error\"</code>\n *   The value of the state when introduction request made to the Signaling server\n *   for the selected pair of Peers has failed.\n * @readOnly\n * @constant\n * @memberOf SkylinkConstants\n * @since 0.6.1\n * @ignore\n */\nexport const INTRODUCE_STATE = {\n  INTRODUCING: 'introducing',\n  ERROR: 'error',\n};\n\n/**\n * The list of Signaling server reaction states during {@link Skylink#joinRoom}.\n * @typedef SYSTEM_ACTION\n * @property {String} WARNING Value <code>\"warning\"</code>\n *   The value of the state when Room session is about to end.\n * @property {String} REJECT  Value <code>\"reject\"</code>\n *   The value of the state when Room session has failed to start or has ended.\n * @property {String} LOCKED  Value <code>\"locked\"</code>\n *   The value of the state when Room sis locked.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.1\n */\nexport const SYSTEM_ACTION = {\n  WARNING: 'warning',\n  REJECT: 'reject',\n  LOCKED: 'locked',\n};\n\n/**\n * The list of Signaling server reaction states reason of action code during\n * {@link Skylink#joinRoom}.\n * @typedef SYSTEM_ACTION_REASON\n * @property {String} CREDENTIALS_EXPIRED Value <code>\"oldTimeStamp\"</code>\n *   The value of the reason code when Room session token has expired.\n *   Happens during {@link Skylink#joinRoom} request.\n *   Results with: <code>REJECT</code>\n * @property {String} CREDENTIALS_ERROR   Value <code>\"credentialError\"</code>\n *   The value of the reason code when Room session token provided is invalid.\n *   Happens during {@link Skylink#joinRoom} request.\n * @property {String} DUPLICATED_LOGIN    Value <code>\"duplicatedLogin\"</code>\n *   The value of the reason code when Room session token has been used already.\n *   Happens during {@link Skylink#joinRoom} request.\n *   Results with: <code>REJECT</code>\n * @property {String} ROOM_NOT_STARTED    Value <code>\"notStart\"</code>\n *   The value of the reason code when Room session has not started.\n *   Happens during {@link Skylink#joinRoom} request.\n *   Results with: <code>REJECT</code>\n * @property {String} EXPIRED             Value <code>\"expired\"</code>\n *   The value of the reason code when Room session has ended already.\n *   Happens during {@link Skylink#joinRoom} request.\n *   Results with: <code>REJECT</code>\n * @property {String} ROOM_LOCKED         Value <code>\"locked\"</code>\n *   The value of the reason code when Room is locked.\n *   Happens during {@link Skylink#joinRoom} request.\n *   Results with: <code>REJECT</code>\n * @property {String} FAST_MESSAGE        Value <code>\"fastmsg\"</code>\n *    The value of the reason code when User is flooding socket messages to the Signaling server\n *    that is sent too quickly within less than a second interval.\n *    Happens after Room session has started. This can be caused by various methods like\n *    {@link Skylink#sendMessage},\n *    {@link Skylink#muteStreams},\n *    {@link Skylink#enableAudio},\n *    {@link Skylink#enableVideo},\n *    {@link Skylink#disableAudio},\n *    {@link Skylink#disableVideo},\n *    Results with: <code>WARNING</code>\n * @property {String} ROOM_CLOSING        Value <code>\"toClose\"</code>\n *    The value of the reason code when Room session is ending.\n *    Happens after Room session has started. This serves as a prerequisite warning before\n *    <code>ROOM_CLOSED</code> occurs.\n *    Results with: <code>WARNING</code>\n * @property {String} ROOM_CLOSED         Value <code>\"roomclose\"</code>\n *    The value of the reason code when Room session has just ended.\n *    Happens after Room session has started.\n *    Results with: <code>REJECT</code>\n * @property {String} SERVER_ERROR        Value <code>\"serverError\"</code>\n *    The value of the reason code when Room session fails to start due to some technical errors.\n *    Happens during {@link Skylink#joinRoom} request.\n *    Results with: <code>REJECT</code>\n * @property {String} KEY_ERROR           Value <code>\"keyFailed\"</code>\n *    The value of the reason code when Room session fails to start due to some technical error pertaining to\n *    App Key initialization.\n *    Happens during {@link Skylink#joinRoom} request.\n *    Results with: <code>REJECT</code>\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.2\n */\nexport const SYSTEM_ACTION_REASON = {\n  CREDENTIALS_EXPIRED: 'oldTimeStamp',\n  CREDENTIALS_ERROR: 'credentialError',\n  DUPLICATED_LOGIN: 'duplicatedLogin',\n  ROOM_NOT_STARTED: 'notStart',\n  EXPIRED: 'expired',\n  ROOM_LOCKED: 'locked',\n  FAST_MESSAGE: 'fastmsg',\n  ROOM_CLOSING: 'toclose',\n  ROOM_CLOSED: 'roomclose',\n  SERVER_ERROR: 'serverError',\n  KEY_ERROR: 'keyFailed',\n};\n\n/**\n * The list of Skylink {@link initOptions} ready states.\n * @typedef READY_STATE_CHANGE\n * @property {number} INIT      Value <code>0</code>\n *   The value of the state when <code>init()</code> has just started.\n * @property {number} LOADING   Value <code>1</code>\n *   The value of the state when <code>init()</code> is authenticating App Key provided\n *   (and with credentials if provided as well) with the Auth server.\n * @property {number} COMPLETED Value <code>2</code>\n *   The value of the state when <code>init()</code> has successfully authenticated with the Auth server.\n *   Room session token is generated for joining the <codRoom</code> provided in <code>init()</code>.\n *   Room session token has to be generated each time User switches to a different Room\n *   in {@link Skylink#joinRoom}.\n * @property {number} ERROR     Value <code>-1</code>\n *   The value of the state when <code>init()</code> has failed authenticating with the Auth server.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.1.0\n */\nexport const READY_STATE_CHANGE = {\n  INIT: 0,\n  LOADING: 1,\n  COMPLETED: 2,\n  ERROR: -1,\n};\n\n/**\n * The list of Skylink {@link initOptions} ready state failure codes.\n * @typedef READY_STATE_CHANGE_ERROR\n * @property {number} API_INVALID                 Value <code>4001</code>\n *   The value of the failure code when provided App Key in <code>init()</code> does not exists.\n *   To resolve this, check that the provided App Key exists in\n *   <a href=\"https://console.temasys.io\">the Temasys Console</a>.\n * @property {number} API_DOMAIN_NOT_MATCH        Value <code>4002</code>\n *   The value of the failure code when <code>\"domainName\"</code> property in the App Key does not\n *   match the accessing server IP address.\n *   To resolve this, contact our <a href=\"http://support.temasys.io\">support portal</a>.\n * @property {number} API_CORS_DOMAIN_NOT_MATCH   Value <code>4003</code>\n *   The value of the failure code when <code>\"corsurl\"</code> property in the App Key does not match accessing CORS.\n *   To resolve this, configure the App Key CORS in\n *   <a href=\"https://console.temasys.io\">the Temasys Console</a>.\n * @property {number} API_CREDENTIALS_INVALID     Value <code>4004</code>\n *   The value of the failure code when there is no [CORS](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)\n *   present in the HTTP headers during the request to the Auth server present nor\n *   <code>options.credentials.credentials</code> configuration provided in the <code>init()</code>.\n *   To resolve this, ensure that CORS are present in the HTTP headers during the request to the Auth server.\n * @property {number} API_CREDENTIALS_NOT_MATCH   Value <code>4005</code>\n *   The value of the failure code when the <code>options.credentials.credentials</code> configuration provided in the\n *   <code>init()</code> does not match up with the <code>options.credentials.startDateTime</code>,\n *   <code>options.credentials.duration</code> or that the <code>\"secret\"</code> used to generate\n *   <code>options.credentials.credentials</code> does not match the App Key's <code>\"secret</code> property provided.\n *   To resolve this, check that the <code>options.credentials.credentials</code> is generated correctly and\n *   that the <code>\"secret\"</code> used to generate it is from the App Key provided in the <code>init()</code>.\n * @property {number} API_INVALID_PARENT_KEY      Value <code>4006</code>\n *   The value of the failure code when the App Key provided does not belong to any existing App.\n *   To resolve this, check that the provided App Key exists in\n *   <a href=\"https://console.temasys.io\">the Developer Console</a>.\n * @property {number} API_NO_MEETING_RECORD_FOUND Value <code>4010</code>\n *   The value of the failure code when provided <code>options.credentials</code>\n *   does not match any scheduled meetings available for the \"Persistent Room\" enabled App Key provided.\n *   See the <a href=\"http://support.temasys.io/support/solutions/articles/\n * 12000002811-using-the-persistent-room-feature-to-configure-meetings\">Persistent Room article</a> to learn more.\n * @property {number} API_OVER_SEAT_LIMIT         Value <code>4020</code>\n *   The value of the failure code when App Key has reached its current concurrent users limit.\n *   To resolve this, use another App Key. To create App Keys dynamically, see the\n *   <a href=\"https://temasys.atlassian.net/wiki/display/TPD/SkylinkAPI+-+Application+Resources\">Application REST API\n *   docs</a> for more information.\n * @property {number} API_RETRIEVAL_FAILED        Value <code>4021</code>\n *   The value of the failure code when App Key retrieval of authentication token fails.\n *   If this happens frequently, contact our <a href=\"http://support.temasys.io\">support portal</a>.\n * @property {number} API_WRONG_ACCESS_DOMAIN     Value <code>5005</code>\n *   The value of the failure code when App Key makes request to the incorrect Auth server.\n *   To resolve this, ensure that the <code>roomServer</code> is not configured. If this persists even without\n *   <code>roomServer</code> configuration, contact our <a href=\"http://support.temasys.io\">support portal</a>.\n * @property {number} XML_HTTP_REQUEST_ERROR      Value <code>-1</code>\n *   The value of the failure code when requesting to Auth server has timed out.\n * @property {number} XML_HTTP_NO_REPONSE_ERROR      Value <code>-2</code>\n *   The value of the failure code when response from Auth server is empty or timed out.\n * @property {number} NO_SOCKET_IO                Value <code>1</code>\n *   The value of the failure code when dependency <a href=\"http://socket.io/download/\">Socket.IO client</a> is not loaded.\n *   To resolve this, ensure that the Socket.IO client dependency is loaded before the Skylink SDK.\n *   You may use the provided Socket.IO client <a href=\"http://socket.io/download/\">CDN here</a>.\n * @property {number} NO_XMLHTTPREQUEST_SUPPORT   Value <code>2</code>\n *   The value of the failure code when <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest\">\n *   XMLHttpRequest API</a> required to make request to Auth server is not supported.\n *   To resolve this, display in the Web UI to ask clients to switch to the list of supported browser\n *   as <a href=\"https://github.com/Temasys/SkylinkJS/tree/0.6.14#supported-browsers\">listed in here</a>.\n * @property {number} NO_WEBRTC_SUPPORT           Value <code>3</code>\n *   The value of the failure code when <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/\">\n *   RTCPeerConnection API</a> required for Peer connections is not supported.\n *   To resolve this, display in the Web UI to ask clients to switch to the list of supported browser\n *   as <a href=\"https://github.com/Temasys/SkylinkJS/tree/0.6.14#supported-browsers\">listed in here</a>.\n *   For <a href=\"http://confluence.temasys.com.sg/display/TWPP\">plugin supported browsers</a>, if the clients\n *   does not have the plugin installed, there will be an installation toolbar that will prompt for installation\n *   to support the RTCPeerConnection API.\n * @property {number} NO_PATH                     Value <code>4</code>\n *   The value of the failure code when provided <code>init()</code> configuration has errors.\n * @property {number} ADAPTER_NO_LOADED           Value <code>7</code>\n *   The value of the failure code when dependency <a href=\"https://github.com/Temasys/AdapterJS/\">AdapterJS</a>\n *   is not loaded.\n *   To resolve this, ensure that the AdapterJS dependency is loaded before the Skylink dependency.\n *   You may use the provided AdapterJS <a href=\"https://github.com/Temasys/AdapterJS/\">CDN here</a>.\n * @property {number} PARSE_CODECS                Value <code>8</code>\n *   The value of the failure code when codecs support cannot be parsed and retrieved.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.4.0\n */\nexport const READY_STATE_CHANGE_ERROR = {\n  API_INVALID: 4001,\n  API_DOMAIN_NOT_MATCH: 4002,\n  API_CORS_DOMAIN_NOT_MATCH: 4003,\n  API_CREDENTIALS_INVALID: 4004,\n  API_CREDENTIALS_NOT_MATCH: 4005,\n  API_INVALID_PARENT_KEY: 4006,\n  API_NO_MEETING_RECORD_FOUND: 4010,\n  API_OVER_SEAT_LIMIT: 4020,\n  API_RETRIEVAL_FAILED: 4021,\n  API_WRONG_ACCESS_DOMAIN: 5005,\n  XML_HTTP_REQUEST_ERROR: -1,\n  XML_HTTP_NO_REPONSE_ERROR: -2,\n  NO_SOCKET_IO: 1,\n  NO_XMLHTTPREQUEST_SUPPORT: 2,\n  NO_WEBRTC_SUPPORT: 3,\n  NO_PATH: 4,\n  ADAPTER_NO_LOADED: 7,\n  PARSE_CODECS: 8,\n};\n\n/**\n * Spoofs the REGIONAL_SERVER to prevent errors on deployed apps except the fact this no longer works.\n * Automatic regional selection has already been implemented hence REGIONAL_SERVER is no longer useful.\n * @typedef REGIONAL_SERVER\n * @constant\n * @type Object\n * @readOnly\n * @private\n * @memberOf SkylinkConstants\n * @since 0.6.16\n */\nexport const REGIONAL_SERVER = {\n  APAC1: '',\n  US1: '',\n};\n\n/**\n * The list of User's priority weight schemes for {@link Skylink#joinRoom} connections.\n * @typedef PRIORITY_WEIGHT_SCHEME\n * @property {String} ENFORCE_OFFERER  Value <code>\"enforceOfferer\"</code>\n *   The value of the priority weight scheme to enforce User as the offerer.\n * @property {String} ENFORCE_ANSWERER Value <code>\"enforceAnswerer\"</code>\n *   The value of the priority weight scheme to enforce User as the answerer.\n * @property {String} AUTO             Value <code>\"auto\"</code>\n *   The value of the priority weight scheme to let User be offerer or answerer based on Signaling server selection.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.18\n * @deprecated\n * @ignore\n */\nexport const PRIORITY_WEIGHT_SCHEME = {\n  ENFORCE_OFFERER: 'enforceOfferer',\n  ENFORCE_ANSWERER: 'enforceAnswerer',\n  AUTO: 'auto',\n};\n\n/**\n * The list of the SDK <code>console</code> API log levels.\n * @typedef LOG_LEVEL\n * @property {number} DEBUG Value <code>4</code>\n *   The value of the log level that displays <code>console</code> <code>debug</code>,\n *   <code>log</code>, <code>info</code>, <code>warn</code> and <code>error</code> logs.\n * @property {number} LOG   Value <code>3</code>\n *   The value of the log level that displays only <code>console</code> <code>log</code>,\n *   <code>info</code>, <code>warn</code> and <code>error</code> logs.\n * @property {number} INFO  Value <code>2</code>\n *   The value of the log level that displays only <code>console</code> <code>info</code>,\n *   <code>warn</code> and <code>error</code> logs.\n * @property {number} WARN  Value <code>1</code>\n *   The value of the log level that displays only <code>console</code> <code>warn</code>\n *   and <code>error</code> logs.\n * @property {number} ERROR Value <code>0</code>\n *   The value of the log level that displays only <code>console</code> <code>error</code> logs.\n * @property {number} NONE Value <code>-1</code>\n *   The value of the log level that displays no logs.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.4\n */\nexport const LOG_LEVEL = {\n  DEBUG: 4,\n  LOG: 3,\n  INFO: 2,\n  WARN: 1,\n  ERROR: 0,\n  NONE: -1,\n};\n\n/**\n * The list of {@link Skylink#joinRoom} socket connection failure states.\n * @typedef SOCKET_ERROR\n * @property {number} CONNECTION_FAILED    Value <code>0</code>\n *   The value of the failure state when <code>joinRoom()</code> socket connection failed to establish with\n *   the Signaling server at the first attempt.\n * @property {number} RECONNECTION_FAILED  Value <code>-1</code>\n *   The value of the failure state when <code>joinRoom()</code> socket connection failed to establish\n *   the Signaling server after the first attempt.\n * @property {number} CONNECTION_ABORTED   Value <code>-2</code>\n *   The value of the failure state when <code>joinRoom()</code> socket connection will not attempt\n *   to reconnect after the failure of the first attempt in <code>CONNECTION_FAILED</code> as there\n *   are no more ports or transports to attempt for reconnection.\n * @property {number} RECONNECTION_ABORTED Value <code>-3</code>\n *   The value of the failure state when <code>joinRoom()</code> socket connection will not attempt\n *   to reconnect after the failure of several attempts in <code>RECONNECTION_FAILED</code> as there\n *   are no more ports or transports to attempt for reconnection.\n * @property {number} RECONNECTION_ATTEMPT Value <code>-4</code>\n *   The value of the failure state when <code>joinRoom()</code> socket connection is attempting\n *   to reconnect with a new port or transport after the failure of attempts in\n *   <code>CONNECTION_FAILED</code> or <code>RECONNECTED_FAILED</code>.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.6\n */\nexport const SOCKET_ERROR = {\n  CONNECTION_FAILED: 0,\n  RECONNECTION_FAILED: -1,\n  CONNECTION_ABORTED: -2,\n  RECONNECTION_ABORTED: -3,\n  RECONNECTION_ATTEMPT: -4,\n};\n\n/**\n * The list of {@link Skylink#joinRoom} socket connection reconnection states.\n * @typedef SOCKET_FALLBACK\n * @property {String} NON_FALLBACK      Value <code>\"nonfallback\"</code>\n *   The value of the reconnection state when <code>joinRoom()</code> socket connection is at its initial state\n *   without transitioning to any new socket port or transports yet.\n * @property {String} FALLBACK_PORT     Value <code>\"fallbackPortNonSSL\"</code>\n *   The value of the reconnection state when <code>joinRoom()</code> socket connection is reconnecting with\n *   another new HTTP port using WebSocket transports to attempt to establish connection with Signaling server.\n * @property {String} FALLBACK_PORT_SSL Value <code>\"fallbackPortSSL\"</code>\n *   The value of the reconnection state when <code>joinRoom()</code> socket connection is reconnecting with\n *   another new HTTPS port using WebSocket transports to attempt to establish connection with Signaling server.\n * @property {String} LONG_POLLING      Value <code>\"fallbackLongPollingNonSSL\"</code>\n *   The value of the reconnection state when <code>joinRoom()</code> socket connection is reconnecting with\n *   another new HTTP port using Polling transports to attempt to establish connection with Signaling server.\n * @property {String} LONG_POLLING_SSL  Value <code>\"fallbackLongPollingSSL\"</code>\n *   The value of the reconnection state when <code>joinRoom()</code> socket connection is reconnecting with\n *   another new HTTPS port using Polling transports to attempt to establish connection with Signaling server.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.6\n */\nexport const SOCKET_FALLBACK = {\n  NON_FALLBACK: 'nonfallback',\n  FALLBACK_PORT: 'fallbackPortNonSSL',\n  FALLBACK_SSL_PORT: 'fallbackPortSSL',\n  LONG_POLLING: 'fallbackLongPollingNonSSL',\n  LONG_POLLING_SSL: 'fallbackLongPollingSSL',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that this is used only for SDK developer purposes.<br>\n *   Current version: <code>0.1.4</code>\n * </blockquote>\n * The value of the current version of the Signaling socket message protocol.\n * @typedef SM_PROTOCOL_VERSION\n * @constant\n * @type string\n * @memberOf SkylinkConstants\n * @since 0.6.0\n */\nexport const SM_PROTOCOL_VERSION = '2.1.0';\n\n/**\n * <blockquote class=\"info\">\n *   Note that if the video codec is not supported, the SDK will not configure the local <code>\"offer\"</code> or\n *   <code>\"answer\"</code> session description to prefer the codec.\n * </blockquote>\n * The list of available video codecs to set as the preferred video codec to use to encode\n * sending video data when available encoded video codec for Peer connections\n * configured in Skylink {@link initOptions}.\n * @typedef VIDEO_CODEC\n * @property {String} AUTO Value <code>\"auto\"</code>\n *   The value of the option to not prefer any video codec but rather use the created\n *   local <code>\"offer\"</code> / <code>\"answer\"</code> session description video codec preference.\n * @property {String} VP8  Value <code>\"VP8\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/VP8\">VP8</a> video codec.\n * @property {String} VP9  Value <code>\"VP9\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/VP9\">VP9</a> video codec.\n * @property {String} H264 Value <code>\"H264\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/H.264/MPEG-4_AVC\">H264</a> video codec.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.10\n */\nexport const VIDEO_CODEC = {\n  AUTO: 'auto',\n  VP8: 'VP8',\n  H264: 'H264',\n  VP9: 'VP9',\n  // H264UC: 'H264UC'\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that if the audio codec is not supported, the SDK will not configure the local <code>\"offer\"</code> or\n *   <code>\"answer\"</code> session description to prefer the codec.\n * </blockquote>\n * The list of available audio codecs to set as the preferred audio codec to use to encode\n * sending audio data when available encoded audio codec for Peer connections\n * configured in Skylink {@link initOptions}.\n * @typedef AUDIO_CODEC\n * @property {String} AUTO Value <code>\"auto\"</code>\n *   The value of the option to not prefer any audio codec but rather use the created\n *   local <code>\"offer\"</code> / <code>\"answer\"</code> session description audio codec preference.\n * @property {String} OPUS Value <code>\"opus\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/Opus_(audio_format)\">OPUS</a> audio codec.\n * @property {String} ISAC Value <code>\"ISAC\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/Internet_Speech_Audio_Codec\">ISAC</a> audio codec.\n * @property {String} ILBC Value <code>\"ILBC\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/Internet_Low_Bitrate_Codec\">iLBC</a> audio codec.\n * @property {String} G722 Value <code>\"G722\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/G.722\">G722</a> audio codec.\n * @property {String} PCMA Value <code>\"PCMA\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/G.711\">G711u</a> audio codec.\n * @property {String} PCMU Value <code>\"PCMU\"</code>\n *   The value of the option to prefer the <a href=\"https://en.wikipedia.org/wiki/G.711\">G711a</a> audio codec.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.10\n */\nexport const AUDIO_CODEC = {\n  AUTO: 'auto',\n  ISAC: 'ISAC',\n  OPUS: 'opus',\n  ILBC: 'ILBC',\n  G722: 'G722',\n  PCMU: 'PCMU',\n  PCMA: 'PCMA',\n  // SILK: 'SILK'\n};\n\n/**\n * The list of available screensharing media sources configured in the\n * {@link Skylink#shareScreen}.\n * @typedef MEDIA_SOURCE\n * @property {String} SCREEN Value <code>\"screen\"</code>\n *   The value of the option to share entire screen.\n * @property {String} WINDOW Value <code>\"window\"</code>\n *   The value of the option to share application windows.\n * @property {String} TAB Value <code>\"tab\"</code>\n *   The value of the option to share browser tab.\n *   Note that this is only supported by from Chrome 52+ and Opera 39+.\n * @property {String} TAB_AUDIO Value <code>\"audio\"</code>\n *   The value of the option to share browser tab audio.\n *   Note that this is only supported by Chrome 52+ and Opera 39+.\n *   <code>options.audio</code> has to be enabled with <code>TAB</code> also requested to enable sharing of tab audio.\n * @property {String} APPLICATION Value <code>\"application\"</code>\n *   The value of the option to share applications.\n *   Note that this is only supported by Firefox currently.\n * @property {String} BROWSER Value <code>\"browser\"</code>\n *   The value of the option to share browser.\n *   Note that this is only supported by Firefox currently, and requires toggling the <code>media.getUserMedia.browser.enabled</code>\n *   in <code>about:config</code>.\n * @property {String} CAMERA Value <code>\"camera\"</code>\n *   The value of the option to share camera.\n *   Note that this is only supported by Firefox currently.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.10\n */\nexport const MEDIA_SOURCE = {\n  SCREEN: 'screen',\n  WINDOW: 'window',\n  TAB: 'tab',\n  TAB_AUDIO: 'audio',\n  APPLICATION: 'application',\n  BROWSER: 'browser',\n  CAMERA: 'camera',\n};\n\n/**\n * <blockquote class=\"info\">\n *   Note that currently {@link Skylink#getUserMedia} only configures\n *   the maximum resolution of the Stream due to browser interopability and support.\n * </blockquote>\n * The list of <a href=\"https://en.wikipedia.org/wiki/Graphics_display_resolution#Video_Graphics_Array\">\n * video resolutions</a> sets configured in the {@link Skylink#getUserMedia}.\n * @typedef VIDEO_RESOLUTION\n * @property {Object} QQVGA Value <code>{ width: 160, height: 120 }</code>\n *   The value of the option to configure QQVGA resolution.\n *   Aspect ratio: <code>4:3</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} HQVGA Value <code>{ width: 240, height: 160 }</code>\n *   The value of the option to configure HQVGA resolution.\n *   Aspect ratio: <code>3:2</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} QVGA Value <code>{ width: 320, height: 240 }</code>\n *   The value of the option to configure QVGA resolution.\n *   Aspect ratio: <code>4:3</code>\n * @property {Object} WQVGA Value <code>{ width: 384, height: 240 }</code>\n *   The value of the option to configure WQVGA resolution.\n *   Aspect ratio: <code>16:10</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} HVGA Value <code>{ width: 480, height: 320 }</code>\n *   The value of the option to configure HVGA resolution.\n *   Aspect ratio: <code>3:2</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} VGA Value <code>{ width: 640, height: 480 }</code>\n *   The value of the option to configure VGA resolution.\n *   Aspect ratio: <code>4:3</code>\n * @property {Object} WVGA Value <code>{ width: 768, height: 480 }</code>\n *   The value of the option to configure WVGA resolution.\n *   Aspect ratio: <code>16:10</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} FWVGA Value <code>{ width: 854, height: 480 }</code>\n *   The value of the option to configure FWVGA resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} SVGA Value <code>{ width: 800, height: 600 }</code>\n *   The value of the option to configure SVGA resolution.\n *   Aspect ratio: <code>4:3</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} DVGA Value <code>{ width: 960, height: 640 }</code>\n *   The value of the option to configure DVGA resolution.\n *   Aspect ratio: <code>3:2</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} WSVGA Value <code>{ width: 1024, height: 576 }</code>\n *   The value of the option to configure WSVGA resolution.\n *   Aspect ratio: <code>16:9</code>\n * @property {Object} HD Value <code>{ width: 1280, height: 720 }</code>\n *   The value of the option to configure HD resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on device supports.\n * @property {Object} HDPLUS Value <code>{ width: 1600, height: 900 }</code>\n *   The value of the option to configure HDPLUS resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} FHD Value <code>{ width: 1920, height: 1080 }</code>\n *   The value of the option to configure FHD resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on device supports.\n * @property {Object} QHD Value <code>{ width: 2560, height: 1440 }</code>\n *   The value of the option to configure QHD resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} WQXGAPLUS Value <code>{ width: 3200, height: 1800 }</code>\n *   The value of the option to configure WQXGAPLUS resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} UHD Value <code>{ width: 3840, height: 2160 }</code>\n *   The value of the option to configure UHD resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} UHDPLUS Value <code>{ width: 5120, height: 2880 }</code>\n *   The value of the option to configure UHDPLUS resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} FUHD Value <code>{ width: 7680, height: 4320 }</code>\n *   The value of the option to configure FUHD resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @property {Object} QUHD Value <code>{ width: 15360, height: 8640 }</code>\n *   The value of the option to configure QUHD resolution.\n *   Aspect ratio: <code>16:9</code>\n *   Note that configurating this resolution may not be supported depending on browser and device supports.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.6\n */\nexport const VIDEO_RESOLUTION = {\n  QQVGA: { width: 160, height: 120 /* , aspectRatio: '4:3' */ },\n  HQVGA: { width: 240, height: 160 /* , aspectRatio: '3:2' */ },\n  QVGA: { width: 320, height: 240 /* , aspectRatio: '4:3' */ },\n  WQVGA: { width: 384, height: 240 /* , aspectRatio: '16:10' */ },\n  HVGA: { width: 480, height: 320 /* , aspectRatio: '3:2' */ },\n  VGA: { width: 640, height: 480 /* , aspectRatio: '4:3' */ },\n  WVGA: { width: 768, height: 480 /* , aspectRatio: '16:10' */ },\n  FWVGA: { width: 854, height: 480 /* , aspectRatio: '16:9' */ },\n  SVGA: { width: 800, height: 600 /* , aspectRatio: '4:3' */ },\n  DVGA: { width: 960, height: 640 /* , aspectRatio: '3:2' */ },\n  WSVGA: { width: 1024, height: 576 /* , aspectRatio: '16:9' */ },\n  HD: { width: 1280, height: 720 /* , aspectRatio: '16:9' */ },\n  HDPLUS: { width: 1600, height: 900 /* , aspectRatio: '16:9' */ },\n  FHD: { width: 1920, height: 1080 /* , aspectRatio: '16:9' */ },\n  QHD: { width: 2560, height: 1440 /* , aspectRatio: '16:9' */ },\n  WQXGAPLUS: { width: 3200, height: 1800 /* , aspectRatio: '16:9' */ },\n  UHD: { width: 3840, height: 2160 /* , aspectRatio: '16:9' */ },\n  UHDPLUS: { width: 5120, height: 2880 /* , aspectRatio: '16:9' */ },\n  FUHD: { width: 7680, height: 4320 /* , aspectRatio: '16:9' */ },\n  QUHD: { width: 15360, height: 8640 /* , aspectRatio: '16:9' */ },\n};\n\n/**\n * The list of {@link Skylink#getUserMedia} or\n * {@link Skylink#shareScreen} Stream fallback states.\n * @typedef MEDIA_ACCESS_FALLBACK_STATE\n * @property {Object} FALLBACKING Value <code>0</code>\n *   The value of the state when <code>getUserMedia()</code> will retrieve audio track only\n *   when retrieving audio and video tracks failed.\n *   This can be configured by Skylink {@link initOptions}\n *   <code>audioFallback</code> option.\n * @property {Object} FALLBACKED  Value <code>1</code>\n *   The value of the state when <code>getUserMedia()</code> or <code>shareScreen()</code>\n *   retrieves camera / screensharing Stream successfully but with missing originally required audio or video tracks.\n * @property {Object} ERROR       Value <code>-1</code>\n *   The value of the state when <code>getUserMedia()</code> failed to retrieve audio track only\n *   after retrieving audio and video tracks failed.\n * @readOnly\n * @constant\n * @type Object\n * @memberOf SkylinkConstants\n * @since 0.6.14\n */\nexport const MEDIA_ACCESS_FALLBACK_STATE = {\n  FALLBACKING: 0,\n  FALLBACKED: 1,\n  ERROR: -1,\n};\n\n/**\n * The list of recording states.\n * @typedef RECORDING_STATE\n * @property {number} START Value <code>0</code>\n *   The value of the state when recording session has started.\n * @property {number} STOP Value <code>1</code>\n *   The value of the state when recording session has stopped.<br>\n *   At this stage, the recorded videos will go through the mixin server to compile the videos.\n * @property {number} LINK Value <code>2</code>\n *   The value of the state when recording session mixin request has been completed.\n * @property {number} ERROR Value <code>-1</code>\n *   The value of the state state when recording session has errors.\n *   This can happen during recording session or during mixin of recording videos,\n *   and at this stage, any current recording session or mixin is aborted.\n * @constant\n * @type Object\n * beta\n * @memberOf SkylinkConstants\n * @since 0.6.16\n */\nexport const RECORDING_STATE = {\n  START: 0,\n  STOP: 1,\n  LINK: 2,\n  ERROR: -1,\n};\n\n/**\n * Stores the data chunk size for Blob transfers.\n * @typedef CHUNK_FILE_SIZE\n * @type Number\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.2\n * @ignore\n */\nexport const CHUNK_FILE_SIZE = 49152;\n\n/**\n * Stores the data chunk size for Blob transfers transferring from/to\n *   Firefox browsers due to limitation tested in the past in some PCs (linx predominatly).\n * @typedef MOZ_CHUNK_FILE_SIZE\n * @type Number\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.2\n * @ignore\n */\nexport const MOZ_CHUNK_FILE_SIZE = 12288;\n\n/**\n * Stores the data chunk size for binary Blob transfers.\n * @typedef BINARY_FILE_SIZE\n * @type Number\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.16\n * @ignore\n */\nexport const BINARY_FILE_SIZE = 65456;\n\n/**\n * Stores the data chunk size for binary Blob transfers.\n * @typedef MOZ_BINARY_FILE_SIZE\n * @type Number\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.16\n * @ignore\n */\nexport const MOZ_BINARY_FILE_SIZE = 16384;\n\n/**\n * Stores the data chunk size for data URI string transfers.\n * @typedef CHUNK_DATAURL_SIZE\n * @type Number\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.2\n * @ignore\n */\nexport const CHUNK_DATAURL_SIZE = 1212;\n\n/**\n * Stores the list of data transfer protocols.\n * @typedef DC_PROTOCOL_TYPE\n * @property {String} WRQ The protocol to initiate data transfer.\n * @property {String} ACK The protocol to request for data transfer chunk.\n *   Give <code>-1</code> to reject the request at the beginning and <code>0</code> to accept\n *   the data transfer request.\n * @property {String} CANCEL The protocol to terminate data transfer.\n * @property {String} ERROR The protocol when data transfer has errors and has to be terminated.\n * @property {String} MESSAGE The protocol that is used to send P2P messages.\n * @constant\n * @type Object\n * @readOnly\n * @private\n * @memberOf SkylinkConstants\n * @since 0.5.2\n * @ignore\n */\nexport const DC_PROTOCOL_TYPE = {\n  WRQ: 'WRQ',\n  ACK: 'ACK',\n  ERROR: 'ERROR',\n  CANCEL: 'CANCEL',\n  MESSAGE: 'MESSAGE',\n};\n\n/**\n * Stores the list of socket messaging protocol types.\n * See confluence docs for the list based on the current <code>SM_PROTOCOL_VERSION</code>.\n * @typedef SIG_MESSAGE_TYPE\n * @property {String} JOIN_ROOM Value <code>joinRoom</code>\n * Message sent by peer to Signalling server to join the room.\n * @property {String} IN_ROOM Value <code>inRoom</code>\n * Message received by peer from Signalling server when peer successfully connects to the room.\n * @property {String} ENTER Value <code>enter</code>\n * Message sent by peer to all peers in the room (after <code>inRoom</code> message).\n * @property {String} WELCOME Value <code>welcome</code>\n * Message sent by peer in response to <code>enter</code> message.\n * @property {String} OFFER Value <code>offer</code>\n * Messsage sent by the peer with the higher weight to the targeted peer after the enter/welcome message.\n * Message is sent after the local offer is created and set, or after all its local ICE candidates have been gathered completely for non-trickle ICE connections (gathering process happens after the local offer is set).\n * The targeted peer will have to set the received remote offer, create and set the local answer and send to sender peer the <code>answer</code> message to end the offer/answer handshaking process.\n * @property {String} ANSWER Value <code>answer</code>\n * Message sent by the targeted peer with the lower weight back to the peer in response to <code>offer</code> message.\n * The peer will have to set the received remote answer, which ends the offer/answer handshaking process.\n * @property {String} CANDIDATE Value <code>candidate</code>\n * Message sent by peer to targeted peer when it has gathered a local ICE candidate.\n * @property {String} BYE Value <code>bye</code>\n * Message that is broadcast by Signalling server when a peer's socket connection has been disconnected. This happens when a peer leaves the room.\n * @property {String} REDIRECT Value <code>redirect</code>\n * Message received from Signalling server when a peer fails to connect to the room (after <code>joinRoom</code> message).\n * @property {String} UPDATE_USER Value <code>updateUserEvent</code>\n * Message that is broadcast by peer to all peers in the room when the peer's custom userData has changed.\n * @property {String} ROOM_LOCK Value <code>roomLockEvent</code>\n * Message that is broadcast by peer to all peers in the room to toggle the Signaling server Room lock status\n * @property {String} MUTE_VIDEO_EVENT Value <code>muteVideoEvent</code>\n * Message that is broadcast by peer to all peers in the room to inform other peers that its sent stream object video tracks muted status have changed.\n * @property {String} MUTE_AUDIO_EVENT Value <code>muteAudioEvent</code>\n * Message that is broadcast by peer to all peers in the room to inform other peers that its sent stream object audio tracks muted status have changed.\n * @property {String} PUBLIC_MESSAGE Value <code>public</code>\n * Message sent by peer to all peers in the room as a public message.\n * @property {String} PRIVATE_MESSAGE Value <code>private</code>\n * Message sent to a targeted peer as a private message.\n * @property {String} STREAM Value <code>stream</code>\n * Message that is boradcast by peer to all peers in the room to indicate the sender peer's stream object status.\n * @property {String} GROUP Value <code>group</code>\n * Message that is boradcast by peer to all peers in the room for bundled messages that was sent before a second interval.\n * @property {String} GET_PEERS Value <code>getPeers</code>\n * Message sent by peer (connecting from a Privileged Key) to the Signaling server to retrieve a list of peer IDs in each room within the same App space (app keys that have the same parent app).\n * @property {String} PEER_LIST Value <code>peerList</code>\n * Message sent by Signalling server to the peer (connecting from a Privileged Key) containing the list of peer IDs.\n * @property {String} INTRODUCE Value <code>introduce</code>\n * Message sent by peer (connecting from a Privileged Key) to the Signaling server to introduce a peer to another peer in the same room. Peers can be a Privileged Key Peer or non-Privileged Key Peer.\n * @property {String} INTRODUCE_ERROR Value <code>introduceError</code>\n * Message sent by Signaling server to requestor peer (connecting from a Privileged Key) when introducing two peers fails.\n * @property {String} APPROACH Value <code>approach</code>\n * Message sent by Signaling server to the peer defined in the \"sendingPeerId\" in the <code>introduce</code> message.\n * @property {String} START_RECORDING Value <code>startRecordingRoom</code>\n * Message sent by peer to a peer (connecting from an MCU Key) to start recording session.\n * @property {String} STOP_RECORDING Value <code>stopRecordingRooms</code>\n * Message sent by peer to a peer (connecting from an MCU Key) to stop recording session.\n * @property {String} RECORDING Value <code>recordingEvent</code>\n * Message broadcasted by peer (connecting from an MCU Key) to all peers to indicate the status of the recording session.\n * @property {String} END_OF_CANDIDATES Value <code>endOfCandidates</code>\n * Message sent by peer to the targeted peer after all its local ICE candidates gathering has completed.\n * @property {String} MEDIA_INFO_EVENT Value <code>mediaStateChangeEvent</code>\n * Message sent by peer to all peers to communicate change of media state.\n * * @property {String} MESSAGE Value <code>message</code>\n * Message sent by peer to all peers in the room as either a public or a private message.\n * @property {String} GET_STORED_MESSAGES Value <code>getStoredMessages</code>\n * Message sent by peer to Signaling server to retrieve stored (persisted) messages.\n * @private\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.5.6\n */\nexport const SIG_MESSAGE_TYPE = {\n  JOIN_ROOM: 'joinRoom',\n  IN_ROOM: 'inRoom',\n  ENTER: 'enter',\n  WELCOME: 'welcome',\n  OFFER: 'offer',\n  ANSWER: 'answer',\n  ANSWER_ACK: 'answerAck',\n  CANDIDATE: 'candidate',\n  BYE: 'bye',\n  REDIRECT: 'redirect',\n  UPDATE_USER: 'updateUserEvent',\n  ROOM_LOCK: 'roomLockEvent',\n  PUBLIC_MESSAGE: 'public',\n  PRIVATE_MESSAGE: 'private',\n  STREAM: 'stream',\n  GROUP: 'group',\n  GET_PEERS: 'getPeers',\n  PEER_LIST: 'peerList',\n  INTRODUCE: 'introduce',\n  INTRODUCE_ERROR: 'introduceError',\n  APPROACH: 'approach',\n  START_RECORDING: 'startRecordingRoom',\n  STOP_RECORDING: 'stopRecordingRoom',\n  RECORDING: 'recordingEvent',\n  END_OF_CANDIDATES: 'endOfCandidates',\n  START_SCREENSHARE: 'startScreenshare',\n  START_RTMP: 'startRTMP',\n  STOP_RTMP: 'stopRTMP',\n  RTMP: 'rtmpEvent',\n  MEDIA_INFO_EVENT: 'mediaInfoEvent',\n  MUTE_VIDEO_EVENT: 'muteVideoEvent',\n  MUTE_AUDIO_EVENT: 'muteAudioEvent',\n  MESSAGE: 'message',\n  GET_STORED_MESSAGES: 'getStoredMessages',\n  STORED_MESSAGES: 'storedMessages',\n};\n\nexport const STREAM_STATUS = {\n  ENDED: 'ended',\n  REPLACED_STREAM_ENDED: 'replacedStreamEnded',\n  SCREENSHARE_REPLACE_START: 'screenshareStart',\n  USER_MEDIA_REPLACE_START: 'userMediaReplaceStart',\n};\n\n/**\n * Stores the list of socket messaging protocol types to queue when sent less than a second interval.\n * @typedef GROUP_MESSAGE_LIST\n * @type Array\n * @readOnly\n * @private\n * @memberOf SkylinkConstants\n * @since 0.5.10\n */\nexport const GROUP_MESSAGE_LIST = [\n  SIG_MESSAGE_TYPE.STREAM,\n  SIG_MESSAGE_TYPE.UPDATE_USER,\n  SIG_MESSAGE_TYPE.MUTE_AUDIO_EVENT,\n  SIG_MESSAGE_TYPE.MUTE_VIDEO_EVENT,\n  SIG_MESSAGE_TYPE.PUBLIC_MESSAGE,\n];\n\n/**\n * The options available for video and audio bitrates (kbps) quality.\n * @typedef VIDEO_QUALITY\n * @property {Object} HD Value <code>{ video: 3200, audio: 80 }</code>\n *   The value of option to prefer high definition video and audio bitrates.\n * @property {Object} HQ Value <code>{ video: 1200, audio: 50 }</code>\n *   The value of option to prefer high quality video and audio bitrates.\n * @property {Object} SQ Value <code>{ video: 800, audio: 30 }</code>\n *   The value of option to prefer standard quality video and audio bitrates.\n * @property {Object} LQ Value <code>{ video: 500, audio: 20 }</code>\n *   The value of option to prefer low quality video and audio bitrates.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.32\n */\nexport const VIDEO_QUALITY = {\n  HD: { video: 3200, audio: 150 },\n  HQ: { video: 1200, audio: 80 },\n  SQ: { video: 800, audio: 30 },\n  LQ: { video: 400, audio: 20 },\n};\n\n/**\n * The options available for SDP sematics while create a PeerConnection.\n * @typedef SDP_SEMANTICS\n * @property {String} PLAN_B\n *   The value of option to prefer plan-b sdp.\n * @property {String} UNIFIED\n *   The value of option to prefer unified-plan sdp.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.32\n */\nexport const SDP_SEMANTICS = {\n  PLAN_B: 'plan-b',\n  UNIFIED: 'unified-plan',\n};\n\n/**\n * The list of RTMP states.\n * @typedef RTMP_STATE\n * @property {number} START Value <code>0</code>\n *   The value of the state when live streaming session has started.\n * @property {number} STOP Value <code>1</code>\n *   The value of the state when live streaming session has stopped.<br>\n *   At this stage, the recorded videos will go through the mixin server to compile the videos.\n * @property {number} ERROR Value <code>-1</code>\n *   The value of the state state when live streaming session has errors.\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 0.6.34\n */\nexport const RTMP_STATE = {\n  START: 0,\n  STOP: 1,\n  ERROR: -1,\n};\n\n/**\n * The status of media on the stream.\n * @typedef MEDIA_STATUS\n * @property {number} MUTED <small>Value <code>0</code></small>\n * The media is present in the stream and muted\n * @property {number} ACTIVE <small>Value <code>1</code></small>\n * The media is present in the stream and active\n * @property {number} UNAVAILABLE <small>Value <code>-1</code></small>\n * The media is not present in the stream\n * @constant\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 1.0\n */\nexport const MEDIA_STATUS = {\n  MUTED: 0,\n  ACTIVE: 1,\n  UNAVAILABLE: -1,\n};\n\n/**\n * The logging tags.\n * @typedef TAGS\n * @property {String} STATS_MODULE\n * @property {String} SESSION_DESCRIPTION\n * @property {String} PEER_CONNECTION\n * @property {String} CANDIDATE_HANDLER\n * @property {String} SIG_SERVER\n * @property {String} PEER_MEDIA\n * @property {String} PEER_INFORMATION\n * @property {String} MEDIA_STREAM\n * @constant\n * @private\n * @type Object\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const TAGS = {\n  SKYLINK_EVENT: 'SKYLINK EVENT',\n  SKYLINK_ERROR: 'SKYLINK ERROR',\n  STATS_MODULE: 'RTCStatsReport',\n  SESSION_DESCRIPTION: 'RTCSessionDescription',\n  PEER_CONNECTION: 'RTCPeerConnection',\n  CANDIDATE_HANDLER: 'RTCIceCandidate',\n  DATA_CHANNEL: 'RTCDataChannel',\n  SIG_SERVER: 'SIG SERVER',\n  PEER_MEDIA: 'PEER MEDIA',\n  PEER_INFORMATION: 'PEER INFORMATION',\n  ROOM: 'ROOM',\n  RECORDING: 'RECORDING',\n  MEDIA_STREAM: 'MEDIA STREAM',\n  MESSAGING: 'MESSAGING',\n  ASYNC_MESSAGING: 'ASYNC MESSAGING',\n  ENCRYPTED_MESSAGING: 'ENCRYPTED MESSAGING',\n};\n\n/**\n * The list of media types.\n * @typedef MEDIA_TYPE\n * @property {String} AUDIO_MIC - Audio from a microphone.\n * @property {String} VIDEO_CAMERA - Video from a Camera of any type.\n * @property {String} VIDEO_SCREEN - Video of the Screen captured for screen sharing.\n * @property {String} VIDEO_OTHER - Video from source other than Camera.\n * @property {String} AUDIO - Audio from an unspecified MediaType.\n * @property {String} VIDEO - Video from an unspecified MediaType.\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const MEDIA_TYPE = {\n  AUDIO_MIC: 'audioMic',\n  VIDEO_CAMERA: 'videoCamera',\n  VIDEO_SCREEN: 'videoScreen',\n  VIDEO_OTHER: 'videoOther',\n  AUDIO: 'audio',\n  VIDEO: 'video',\n};\n\n/**\n * The ready state of the track.\n * @typedef TRACK_READY_STATE\n * @type {Object}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const TRACK_READY_STATE = {\n  LIVE: 'live',\n  ENDED: 'ended',\n};\n\n/**\n * The track kind.\n * @typedef TRACK_KIND\n * @type {Object}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const TRACK_KIND = {\n  AUDIO: 'audio',\n  VIDEO: 'video',\n};\n\n/**\n * The state of the media.\n * @typedef MEDIA_STATE\n * @property {String} MUTED - The state when the MediaTrack enabled flag is set to false. The MediaTrack is sending black frames.\n * @property {String} ACTIVE - The state when the MediaTrack enabled flag and active flag is set to true. The MediaTrack is sending frames with content.\n * @property {String} STOPPED - The state when the MediaTrack active flag is false. The MediaTrack is not sending any frames.\n * @property {String} UNAVAILABLE - The state when the MediaTrack is no longer available or has been disposed.\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const MEDIA_STATE = {\n  MUTED: 'muted',\n  ACTIVE: 'active',\n  STOPPED: 'stopped',\n  UNAVAILABLE: 'unavailable',\n};\n\n/**\n * Media Info keys.\n * @typedef MEDIA_INFO\n * @type {Object}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const MEDIA_INFO = {\n  PUBLISHER_ID: 'publisherId',\n  MEDIA_ID: 'mediaId',\n  MEDIA_TYPE: 'mediaType',\n  MEDIA_STATE: 'mediaState',\n  TRANSCEIVER_MID: 'transceiverMid',\n  MEDIA_META_DATA: 'mediaMetaData',\n  SIMULCAST: 'simulcast',\n  STREAM_ID: 'streamId',\n};\n\n/**\n * The SDK version.\n * @typedef SDK_VERSION\n * @type {String}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const SDK_VERSION = '2.0.0';\n\n/**\n * The SDK type.\n * @typedef SDK_NAME\n * @type {Object}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const SDK_NAME = {\n  WEB: 'Web SDK',\n  ANDROID: 'Android SDK',\n  IOS: 'iOS SDK',\n  CPP: 'C++ SDK',\n};\n\n/**\n * The API version.\n * @typedef API_VERSION\n * @type {String}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const API_VERSION = '9.0.0';\n\n/**\n * select Signaling server version.\n * @typedef Signaling_version\n * @type {String}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const SIGNALING_VERSION = 'sig-v2';\n\n/**\n * The Browser agent type.\n * @typedef BROWSER_AGENT\n * @type {Object}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const BROWSER_AGENT = {\n  CHROME: 'chrome',\n  FIREFOX: 'firefox',\n  SAFARI: 'safari',\n  REACT_NATIVE: 'react-native',\n};\n\n/**\n * The Peer type.\n * @typedef PEER_TYPE\n * @type {Object}\n * @private\n * @constant\n * @readOnly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const PEER_TYPE = {\n  MCU: 'MCU',\n};\n\n/**\n * Events dispatched by Socket.io.\n * @typedef SOCKET_EVENTS\n * @type {Object}\n * @private\n * @constant\n * @readonly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const SOCKET_EVENTS = {\n  CONNECT: 'connect',\n  DISCONNECT: 'disconnect',\n  RECONNECT_ATTEMPT: 'reconnect_attempt',\n  RECONNECT_SUCCESS: 'reconnect_success',\n  RECONNECT_FAILED: 'reconnect_failed',\n  RECONNECT_ERROR: 'reconnect_error',\n  MESSAGE: 'message',\n  ERROR: 'error',\n};\n\n/**\n * Socket types\n * @typedef SOCKET_TYPE\n * @type {Object}\n * @private\n * @constant\n * @readonly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const SOCKET_TYPE = {\n  POLLING: 'Polling',\n  WEBSOCKET: 'WebSocket',\n  XHR_POLLING: 'xhr-polling',\n  JSONP_POLLING: 'jsonp-polling',\n};\n\n/**\n * The state of the SDK.\n * @typedef STATES\n * @type {Object}\n * @private\n * @constant\n * @readonly\n * @memberOf SkylinkConstants\n * @since 2.0\n */\nexport const STATES = {\n  SIGNALING: SOCKET_EVENTS,\n};\n\n/**\n * @namespace SkylinkConstants.EVENTS\n * @type {object}\n * @property {String} ON_INCOMING_STREAM - 'onIncomingStream'\n * @property {String} ON_INCOMING_SCREEN_STREAM - 'onIncomingScreenStream'\n * @property {String} STREAM_ENDED - 'streamEnded'\n * @property {String} PEER_UPDATED - 'peerUpdated'\n * @property {String} PEER_JOINED - 'peerJoined'\n * @property {String} PEER_LEFT - 'peerLeft'\n * @property {String} PEER_CONNECTION_STATE - 'peerConnectionState'\n * @property {String} DATA_CHANNEL_STATE - 'dataChannelState'\n * @property {String} ON_INCOMING_MESSAGE - 'onIncomingMessage'\n * @property {String} HANDSHAKE_PROGRESS - 'handshakeProgress'\n * @property {String} SERVER_PEER_JOINED - 'serverPeerJoined'\n * @property {String} SERVER_PEER_LEFT - 'serverPeerLeft'\n * @property {String} CANDIDATE_PROCESSING_STATE - 'candidateProcessingState'\n * @property {String} CANDIDATE_GENERATION_STATE - 'candidateGenerationState'\n * @property {String} CANDIDATES_GATHERED - 'candidatesGathered'\n * @property {String} ON_INCOMING_DATA - 'onIncomingData'\n * @property {String} GET_PEERS_STATE_CHANGE - 'getPeersStateChange'\n * @property {String} SESSION_DISCONNECT - 'sessionDisconnect'\n * @property {String} STREAM_MUTED - 'streamMuted'\n * @property {String} CHANNEL_OPEN - 'channelOpen'\n * @property {String} CHANNEL_CLOSE - 'channelClose'\n * @property {String} CHANNEL_MESSAGE - 'channelMessage'\n * @property {String} CHANNEL_ERROR - 'channelError'\n * @property {String} CHANNEL_RETRY - 'channelRetry'\n * @property {String} SOCKET_ERROR - 'socketError'\n * @property {String} SYSTEM_ACTION - 'systemAction'\n * @property {String} MEDIA_ACCESS_FALLBACK - 'mediaAccessFallback'\n * @property {String} MEDIA_ACCESS_REQUIRED - 'mediaAccessRequired'\n * @property {String} MEDIA_ACCESS_STOPPED - 'mediaAccessStopped'\n * @property {String} MEDIA_ACCESS_SUCCESS - 'mediaAccessSuccess'\n * @property {String} RECORDING_STATE - 'recordingState'\n * @property {String} LOCAL_MEDIA_MUTED - 'localMediaMuted'\n * @property {String} MEDIA_ACCESS_ERROR - 'mediaAccessError'\n * @property {String} GET_CONNECTION_STATUS_STATE_CHANGE - 'getConnectionStatusStateChange'\n * @property {String} READY_STATE_CHANGE - 'readyStateChange'\n * @property {String} ROOM_LOCK - 'roomLock'\n * @property {String} ICE_CONNECTION_STATE - 'iceConnectionState'\n * @property {String} BYE - 'bye'\n * @property {String} RTMP_STATE - 'rtmpState'\n * @property {String} STORED_MESSAGES - 'storedMessages'\n * @property {String} ENCRYPT_SECRETS_UPDATED - 'encryptSecretsUpdated'\n * @memberOf SkylinkConstants\n * @constant\n * @readonly\n * @since 2.0\n */\nexport const EVENTS = SkylinkEventsConstants;\n","const MESSAGES = {\n  INIT: {\n    ERRORS: {\n      NO_ADAPTER: 'AdapterJS dependency is not loaded or incorrect AdapterJS dependency is used',\n      NO_SOCKET_IO: 'Socket.io not loaded - Please load socket.io',\n      NO_FETCH_SUPPORT: 'Fetch API is not supported in your browser. Please make sure you are using a modern browser: https://caniuse.com/#search=fetch',\n      NO_APP_KEY: 'Please provide an App Key - Get one at console.temasys.io!',\n      AUTH_CORS: 'Promise rejected due to CORS forbidden request - Please visit: http://support.temasys.com.sg/support/solutions/articles/12000006761-i-get-a-403-forbidden-access-is-denied-when-i-load-the-application-why-',\n      AUTH_GENERAL: 'Promise rejected due to network issue',\n      SOCKET_CREATE_FAILED: 'Failed creating socket connection object ->',\n      SOCKET_ERROR_ABORT: 'Reconnection aborted as the connection timed out or there no more available ports, transports and final attempts left',\n    },\n    INFO: {\n      API_SUCCESS: 'Promise resolved: APP Authenticated Successfully!',\n    },\n  },\n  JOIN_ROOM: {\n    ERRORS: {\n      CODEC_SUPPORT: 'No audio/video codecs available to start connection',\n    },\n  },\n  ROOM: {\n    ERRORS: {\n      STOP: {\n        SCREEN_SHARE: 'Error stopping screenshare',\n      },\n      NOT_IN_ROOM: 'User is not in room',\n      NO_PEERS: 'No peers in room',\n    },\n    LEAVE_ROOM: {\n      ERROR: 'Leave room error -->',\n      NO_PEERS: 'No peers in room',\n      DROPPING_HANGUP: 'Dropping hang-up from remote peer',\n      LEAVE_ALL_ROOMS: {\n        SUCCESS: 'Successfully left all rooms',\n        ERROR: 'Leave all rooms error -->',\n      },\n      PEER_LEFT: {\n        START: 'Initiating peer left process',\n        SUCCESS: 'Successfully completed peer left process',\n        ERROR: 'Failed peer left process',\n      },\n      SENDING_BYE: 'Sending bye message to all peers',\n      DISCONNECT_SOCKET: {\n        SUCCESS: 'Successfully disconnected socket',\n      },\n      REMOVE_STATE: {\n        SUCCESS: 'Successfully removed room state',\n      },\n    },\n  },\n  ROOM_STATE: {\n    NOT_FOUND: 'Could not retrieve room state for room name/key',\n    LEFT: 'Peer left room',\n    NO_ROOM_NAME: 'No room name specified',\n  },\n  PEER_INFORMATIONS: {\n    NO_PEER_INFO: 'Not able to retrieve Peer Information for peerId:',\n    UPDATE_USER_DATA: 'Peer updated userData: ',\n    OUTDATED_MSG: 'Dropping outdated status ->',\n    USER_DATA_NOT_JSON: 'UserData is not JSON',\n  },\n  PEER_CONNECTION: {\n    NO_PEER_CONNECTION: 'No Peer Connection detected',\n    ERRORS: {\n      REMOVE_TRACK: 'Error removing track from peer connection',\n      REPLACE_TRACK: 'Error replacing track in peer connection',\n      REFRESH: 'Error refreshing peer connection',\n    },\n    end_of_candidates: 'Signaling of end-of-candidates remote ICE gathering',\n    end_of_candidate_failure: 'Failed signaling end-of-candidates ->',\n    not_initialised: 'Peer connection is not initialised',\n    getstats_api_not_available: 'getStats() API is not available',\n    connection_status_no_pc: 'There is currently no peer connections to retrieve connection status',\n    ice_connection_state: 'Ice connection state changed ->',\n    peer_connection_state: 'Peer connection state changed ->',\n    ice_gathering_state: 'Ice gathering state changed ->',\n    refresh_start: 'START: Refreshing peer connections',\n    refresh_failed: 'FAILED: Refreshing peer connections',\n    refresh_completed: 'All peer connections refreshed with resolve or errors',\n    refresh_peer_failed: 'Peer connection failed to refresh: ',\n    refresh_peer_success: 'Peer connection refreshed successfully: ',\n    refresh_no_peer_connection: 'There is currently no peer connections to restart',\n    refresh_peerId_no_match: 'PeerId does not match existing peer connections',\n    refresh_no_edge_support: 'Edge browser currently does not support renegotiation',\n    refresh_not_supported: 'Failed restarting with other agents connecting from other SDKs as re-negotiation is not supported by other SDKs',\n    peerId_does_not_exist: 'Peer Id does not exist ->',\n  },\n  PEER_PRIVILEGED: {\n    not_privileged: 'Please upgrade your key to privileged to use this function',\n    no_appkey: 'App key is not defined - Please authenticate again',\n    getPeerListFromServer: 'Enquired server for peers within the App space',\n  },\n  ICE_CANDIDATE: {\n    CANDIDATE_HANDLER: {\n      DROPPING_CANDIDATE: 'Dropping ICE candidate',\n      INVALID_CANDIDATE: 'Received invalid ICE candidate message ->',\n      VALID_CANDIDATE: 'Received ICE candidate ->',\n      FILTERED_CANDIDATE: 'Dropping received ICE candidate as it matches ICE candidate filtering flag ->',\n      FILTERING_FLAG_NOT_HONOURED: 'Not dropping received ICE candidate as TURN connections are enforced as MCU is present (and act as a TURN itself) so filtering of ICE candidate flags are not honoured ->',\n      CANDIDATE_ADDED: 'Added ICE candidate successfully',\n      ADDING_CANDIDATE: 'Adding ICE Candidate',\n      FAILED_ADDING_CANDIDATE: 'Failed adding ICE candidate ->',\n      ADD_BUFFERED_CANDIDATE: 'Adding buffered ICE candidate',\n      ADD_CANDIDATE_TO_BUFFER: 'Adding ICE candidate to buffer',\n      END_OF_CANDIDATES_SUCCESS: 'Signaling of end-of-candidates remote ICE gathering',\n      END_OF_CANDIDATES_FAILURE: 'Failed signaling of end-of-candidates remote ICE gathering',\n      ICE_GATHERING_STARTED: 'ICE gathering has started',\n      ICE_GATHERING_COMPLETED: 'ICE gathering has completed',\n      CANDIDATE_GENERATED: 'Generated ICE candidate ->',\n      DROP_EOC: 'Dropping of sending ICE candidate end-of-candidates signal or unused ICE candidates ->',\n      ICE_TRICKLE_DISABLED: 'Dropping of sending ICE candidate as trickle ICE is disabled ->',\n      SENDING_CANDIDATE: 'Sending ICE candidate ->',\n      NO_SDP: 'Not sending any session description after ICE gathering completed as it is not present',\n    },\n  },\n  SESSION_DESCRIPTION: {\n    parsing_media_ssrc: 'Parsing session description media SSRCs ->',\n  },\n  DATA_CHANNEL: {\n    reviving_dataChannel: 'Reviving Datachannel connection',\n    refresh_error: 'Not a valid Datachannel connection',\n    CLOSING: 'Closing DataChannel',\n    closed: 'Datachannel has closed',\n    onclose_error: 'Error in data-channel onclose callback',\n    NO_REMOTE_DATA_CHANNEL: 'Remote peer does not have data channel',\n    ERRORS: {\n      FAILED_CLOSING: 'Failed closing DataChannels --> ',\n      NO_SESSIONS: 'Peer Connection does not have DataChannel sessions',\n    },\n  },\n  NEGOTIATION_PROGRESS: {\n    SET_LOCAL_DESCRIPTION: 'Successfully set local description -->',\n    SET_REMOTE_DESCRIPTION: 'Successfully set remote description -->',\n    APPLYING_BUFFERED_REMOTE_OFFER: 'Applying buffered remote offer',\n    ERRORS: {\n      FAILED_SET_LOCAL_DESCRIPTION: 'Failed setting local description -->',\n      FAILED_SET_REMOTE_DESCRIPTION: 'Failed setting remote description -->',\n      FAILED_SET_REMOTE_ANSWER: 'Peer failed to set remote answer.',\n      FAILED_RENEGOTIATION: 'Failed renegotiation after answerAck',\n      NOT_STABLE: 'Dropping of message as signaling state is not stable',\n      PROCESSING_EXISTING_SDP: 'Dropping message as there is another sessionDescription being processed -->',\n      OFFER_TIEBREAKER: 'Dropping the received offer: self weight is greater than incoming offer weight -->',\n      NO_LOCAL_BUFFERED_OFFER: 'FATAL: No buffered local offer found - Unable to setLocalDescription',\n      ADDING_REMOTE_OFFER_TO_BUFFER: 'Adding remote offer received to buffer as current negotiation has not completed',\n    },\n  },\n  SIGNALING: {\n    MESSAGE_ADDED_TO_BUFFER: 'Message buffered as enter message has not been sent',\n    ENTER_LISTENER: 'Enter listener initialized',\n    BUFFERED_MESSAGES_SENT: 'Buffered messages sent',\n    BUFFERED_MESSAGES_DROPPED: 'Buffered messages dropped - no mid',\n    OUTDATED_MSG: 'Dropping outdated status ->',\n    DROPPING_MUTE_EVENT: 'Dropping mute audio / video event message as it is processed by mediaInfoEvent',\n    BUFFER_NOT_NEEDED: 'Enter message sent. Messages do not need to be buffered',\n    ABORTING_OFFER: 'Aborting offer as current negotiation has not completed',\n  },\n  MESSAGING: {\n    PRIVATE_MESSAGE: 'Sending private message to Peer',\n    BROADCAST_MESSAGE: 'Broadcasting message to Peers',\n    RECEIVED_MESSAGE: 'Received message from Peer',\n    PERSISTENCE: {\n      SEND_MESSAGE: 'Sending persisted message',\n      NOT_PERSISTED: 'Message will not be persisted as persistent flag is set to false',\n      STORED_MESSAGES: 'Received stored messages for room',\n      IS_PERSISTENT_CONFIG: 'Persistent message flag is set to',\n      ERRORS: {\n        FAILED_SETTING_PERSISTENCE: 'Failed setting persistent message flag',\n        INVALID_TYPE: 'Persistent message flag must be of type boolean',\n        PRIVATE_MESSAGE: 'Cannot persist private messages',\n        PERSISTENT_MESSAGE_FEATURE_NOT_ENABLED: 'Persistent Message feature is not enabled. Enable'\n          + ' this feature on the key under \\'Advanced Settings\\' in the Temasys Console',\n      },\n    },\n    ENCRYPTION: {\n      SEND_MESSAGE: 'Sending encrypted message',\n      DELETE_ALL: 'Deleting all stored secrets',\n      ERRORS: {\n        FAILED_DECRYPTING_MESSAGE: 'Failed decrypting message',\n        ENCRYPT_SECRET: 'Incorrect secret provided',\n        INVALID_SECRETS: 'No or invalid secret and secret id provided',\n        SET_SELECTED_SECRET: 'Failed setting selected secret',\n        DELETE_ENCRYPT_SECRETS: 'Failed deleting secret',\n        SET_ENCRYPT_SECRET: 'Failed setting secret',\n        SECRET_ID_NOT_FOUND: 'Secret id not found',\n        NO_SECRET_OR_SECRET_ID: 'Secret and / or secret id not provided',\n        INVALID_TYPE: 'Secret and secret id must be of type string and not empty',\n        SECRET_ID_NOT_UNIQUE: 'Secret id provided is not unique',\n        SECRET_ID_NOT_SELECTED: 'Secret id not selected',\n        SECRET_ID_NOT_PROVIDED: 'Secret id not provided',\n        SECRETS_NOT_PROVIDED: 'Secrets not provided',\n      },\n    },\n    ERRORS: {\n      DROPPING_MESSAGE: 'Dropping message',\n      FAILED_SENDING_MESSAGE: 'Failed to send user message',\n    },\n  },\n  MEDIA_INFO: {\n    UPDATE_SUCCESS: 'Successfully updated media info',\n    ERRORS: {\n      NO_ASSOCIATED_STREAM_ID: 'There is no streamId associated with the mediaId and transceiverMid pair',\n      FAILED_PROCESSING_MEDIA_INFO_EVENT: 'Failed to process mediaInfoEvent message',\n      FAILED_UPDATING: 'Failed to update media info',\n      FAILED_PROCESSING_PEER_MEDIA: 'Failed to process media info',\n      FAILED_UPDATING_TRANSCEIVER_MID: 'Failed updating media info transceiverMid after setLocalDescription',\n      FAILED_SETTING_PEER_MEDIA_INFO: 'Failed setting peer media at offer / answer',\n    },\n    WARN: {\n      READ_ONLY_VALUE: 'Attempting to change media info read only value: ',\n      INVALID_MEDIA_TYPE: 'Invalid media info media type: ',\n    },\n    VIDEO_STATE_CHANGE: 'Peers\\'s video state changed to ->',\n    AUDIO_STATE_CHANGE: 'Peers\\'s audio state changed to ->',\n    VIDEO_SCREEN_STATE_CHANGE: 'Peers\\'s video screen state changed to ->',\n  },\n  MEDIA_STREAM: {\n    STOP_SETTINGS: 'Stopped streams with settings:',\n    STOP_SUCCESS: 'Successfully stopped and removed stream from state',\n    REMOTE_TRACK_REMOVED: 'Remote MediaStreamTrack removed',\n    START_FALLBACK: 'Fall back to retrieve audio only stream',\n    NO_OPTIONS: 'No user media options provided',\n    DEFAULT_OPTIONS: 'Using default options',\n    FALLBACK_SUCCESS: 'Successfully retrieved audio fallback stream',\n    START_SCREEN_SUCCESS: 'Successfully retrieved screen share stream',\n    STOP_SCREEN_SUCCESS: 'Successfully stopped screen share stream',\n    UPDATE_MUTED_SETTINGS: 'Updated stream muted setting',\n    UPDATE_MEDIA_STATUS: 'Updated stream media status',\n    AUDIO_MUTED: 'Peers\\'s audio muted: ',\n    VIDEO_MUTED: 'Peers\\'s video muted: ',\n    ERRORS: {\n      STOP_SCREEN: 'Error stopping screen share stream',\n      START_SCREEN: 'Error starting screen share stream',\n      STOP_ADDED_STREAM: 'Error stopping added stream',\n      STOP_REPLACED_STREAM: 'Error stopping replaced stream',\n      STOP_USER_MEDIA: 'Error stopping user media',\n      STOP_AUDIO_TRACK: 'Error stopping audio tracks in stream',\n      STOP_VIDEO_TRACK: 'Error stopping video tracks in stream',\n      STOP_MEDIA_TRACK: 'Error stopping MediaTrack',\n      STOP_SCREEN_TRACK: 'Error stopping screen track in stream',\n      DROPPING_ONREMOVETRACK: 'Dropping onremovetrack',\n      NO_STREAM: 'No stream to process',\n      INVALID_STREAM_ID: 'No stream detected with stream id',\n      NO_USER_MEDIA_STREAMS: 'No user media streams detected',\n      INVALID_STREAM_ID_TYPE: 'Stream id is not a string',\n      NO_STREAM_ID: 'No stream id provided',\n      PEER_SCREEN_ACTIVE: 'Peer has existing screen share',\n      REPLACE_SCREEN: 'Error replacing user media stream with screenshare stream',\n      FALLBACK: 'Error retrieving fallback audio stream',\n      INVALID_GUM_OPTIONS: 'Invalid user media options',\n      GET_USER_MEDIA: 'Error retrieving stream from \\'getUserMedia\\' method',\n      INVALID_MUTE_OPTIONS: 'Invalid muteStreams options provided',\n      NO_STREAMS_MUTED: 'No streams to mute',\n      SEND_STREAM: 'Error sending stream',\n      INVALID_MEDIA_STREAM_ARRAY: 'Array is not of type MediaStream',\n      ACTIVE_STREAMS: 'There are currently active streams being sent to remote peers. Please stop streams.',\n    },\n  },\n  STATS_MODULE: {\n    NOT_INITIATED: 'Stats Module is not initiated',\n    STATS_DISCARDED: 'Stats report discarded as peer has left the room',\n    ERRORS: {\n      RETRIEVE_STATS_FAILED: 'Failed retrieving stats',\n      POST_FAILED: 'Failed posting to stats api',\n      PARSE_FAILED: 'Failed parsing stats report',\n      STATS_IS_NULL: 'Stats object is null',\n      INVALID_TRACK_KIND: 'Media kind is not audio or video',\n    },\n    HANDLE_ICE_GATHERING_STATS: {\n      PROCESS_FAILED: 'process_failed',\n      PROCESS_SUCCESS: 'process_success',\n      PROCESSING: 'processing',\n      DROPPED: 'dropped',\n      BUFFERED: 'buffered',\n    },\n    HANDLE_NEGOTIATION_STATS: {\n      OFFER: {\n        create: 'create_offer',\n        create_error: 'error_create_offer',\n        set: 'set_offer',\n        set_error: 'error_set_offer',\n        offer: 'offer',\n        dropped: 'dropped_offer',\n      },\n      ANSWER: {\n        create: 'create_answer',\n        create_error: 'error_create_answer',\n        set: 'set_answer',\n        set_error: 'error_set_ANSWER',\n        answer: 'answer',\n        dropped: 'dropped_answer',\n      },\n    },\n    HANDLE_DATA_CHANNEL_STATS: {\n      open: 'open',\n      closed: 'closed',\n      reconnecting: 'reconnecting',\n    },\n    HANDLE_CONNECTION_STATS: {},\n    HANDLE_BANDWIDTH_STATS: {\n      RETRIEVE_FAILED: 'Failed posting bandwidth stats: ',\n      NO_STATE: 'No room state',\n    },\n    HANDLE_ICE_CONNECTION_STATS: {\n      RETRIEVE_FAILED: 'Failed retrieving stats: ',\n      SEND_FAILED: 'Failed sending ice connection stats: ',\n    },\n    HANDLE_RECORDING_STATS: {\n      START: 'start',\n      STOP: 'stop',\n      REQUEST_START: 'request-start',\n      REQUEST_STOP: 'request-stop',\n      ERROR_NO_MCU_START: 'error-no-mcu-start',\n      ERROR_NO_MCU_STOP: 'error-no-mcu-stop',\n      ERROR_START_ACTIVE: 'error-start-when-active',\n      ERROR_STOP_ACTIVE: 'error-stop-when-active',\n      ERROR_MIN_STOP: 'error-min-stop',\n      MCU_RECORDING_ERROR: 'mcu-recording-error',\n    },\n  },\n  RECORDING: {\n    START_SUCCESS: 'Started recording',\n    STOP_SUCCESS: 'Stopped recording',\n    START_FAILED: 'Failed to start recording',\n    STOP_FAILED: 'Failed to stop recording',\n    MIN_RECORDING_TIME_REACHED: '4 seconds has been recorded - Recording can be stopped now',\n    ERRORS: {\n      MCU_NOT_CONNECTED: 'MCU is not connected',\n      EXISTING_RECORDING_IN_PROGRESS: 'There is an existing recording in-progress',\n      NO_RECORDING_IN_PROGRESS: 'There is no existing recording in-progress',\n      MIN_RECORDING_TIME: '4 seconds has not been recorded yet',\n      STOP_ABRUPT: 'Recording stopped abruptly before 4 seconds',\n      SESSION_EMPTY: 'Received request of \"off\" but the session is empty',\n      MCU_RECORDING_ERROR: 'Recording error received from MCU',\n    },\n  },\n  RTMP: {\n    start_no_mcu: 'Unable to start RTMP session as MCU is not connected',\n    stop_no_mcu: 'Unable to stop RTMP as MCU is not connected',\n    start_no_stream_id: 'Unable to start RTMP Session stream id is missing',\n    start_no_endpoint: 'Unable to start RTMP Session as Endpoint is missing',\n    starting_rtmp: 'Starting RTMP Session',\n    stopping_rtmp: 'Stopping RTMP Session',\n    message_received_from_sig: 'Received RTMP Session message ->',\n    stop_session_empty: 'Received request of \"off\" but the session is empty',\n    stopped_success: 'Stopped RTMP Session',\n    started_success: 'Started RTMP Session',\n    error_session_empty: 'Received error but the session is empty ->',\n    error_session: 'RTMP session failure ->',\n    error_Session_abrupt: 'Stopped RTMP session abruptly',\n  },\n  PERSISTENT_MESSAGE: {\n    ERRORS: {\n      NO_DEPENDENCY: 'CryptoJS is not available',\n    },\n  },\n  UTILS: {\n    INVALID_BROWSER_AGENT: 'Invalid browser agent',\n  },\n  LOGGER: {\n    EVENT_DISPATCHED: 'Event dispatched',\n    EVENT_REGISTERED: 'Event successfully registered',\n    EVENT_UNREGISTERED: 'Event successfully unregistered',\n    EVENT_DISPATCH_ERROR: 'Error dispatching event',\n    EVENT_REGISTER_ERROR: 'Error registering event',\n    EVENT_UNREGISTER_ERROR: 'Error unregistering event',\n    LOGS_NOT_STORED: 'Store logs feature is not enabled. Enable it via SkylinkLogger.setLevel(logLevel, storeLogs)',\n    LOGS_CLEARED: 'Stored logs cleared',\n    INVALID_CB: 'Dropping listener as it is not a function',\n  },\n  BROWSER_AGENT: {\n    REACT_NATIVE: {\n      ERRORS: {\n        DROPPING_ONREMOVETRACK: 'Dropping onremovetrack as trackInfo is malformed',\n      },\n    },\n  },\n};\n\nexport default MESSAGES;\n","import Skylink from '../../index';\nimport { BUNDLE_POLICY, RTCP_MUX_POLICY, PEER_CERTIFICATE } from '../../constants';\n\n/**\n * @param {GetUserMediaOptions} options\n * @param {SkylinkState} roomState\n * @return {SkylinkState}\n * @memberOf MediaStreamHelpers\n * @private\n */\nconst parseMediaOptions = (options, roomState) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const mediaOptions = options || {};\n\n  state.userData = mediaOptions.userData || state.userData || '';\n  state.streamsBandwidthSettings = {\n    googleX: {},\n    bAS: {},\n  };\n  state.publishOnly = false;\n  state.sdpSettings = {\n    connection: {\n      audio: true,\n      video: true,\n      data: true,\n    },\n    direction: {\n      audio: { send: true, receive: true },\n      video: { send: true, receive: true },\n    },\n  };\n  state.voiceActivityDetection = typeof mediaOptions.voiceActivityDetection === 'boolean' ? mediaOptions.voiceActivityDetection : true;\n  state.peerConnectionConfig = {\n    bundlePolicy: BUNDLE_POLICY.BALANCED,\n    rtcpMuxPolicy: RTCP_MUX_POLICY.REQUIRE,\n    iceCandidatePoolSize: 0,\n    certificate: PEER_CERTIFICATE.AUTO,\n    disableBundle: false,\n  };\n  state.bandwidthAdjuster = null;\n\n  if (mediaOptions.bandwidth) {\n    if (typeof mediaOptions.bandwidth.audio === 'number') {\n      state.streamsBandwidthSettings.bAS.audio = mediaOptions.bandwidth.audio;\n    }\n\n    if (typeof mediaOptions.bandwidth.video === 'number') {\n      state.streamsBandwidthSettings.bAS.video = mediaOptions.bandwidth.video;\n    }\n\n    if (typeof mediaOptions.bandwidth.data === 'number') {\n      state.streamsBandwidthSettings.bAS.data = mediaOptions.bandwidth.data;\n    }\n  }\n\n  if (mediaOptions.googleXBandwidth) {\n    if (typeof mediaOptions.googleXBandwidth.min === 'number') {\n      state.streamsBandwidthSettings.googleX.min = mediaOptions.googleXBandwidth.min;\n    }\n\n    if (typeof mediaOptions.googleXBandwidth.max === 'number') {\n      state.streamsBandwidthSettings.googleX.max = mediaOptions.googleXBandwidth.max;\n    }\n  }\n\n  if (mediaOptions.sdpSettings) {\n    if (mediaOptions.sdpSettings.direction) {\n      if (mediaOptions.sdpSettings.direction.audio) {\n        state.sdpSettings.direction.audio.receive = typeof mediaOptions.sdpSettings.direction.audio.receive === 'boolean' ? mediaOptions.sdpSettings.direction.audio.receive : true;\n        state.sdpSettings.direction.audio.send = typeof mediaOptions.sdpSettings.direction.audio.send === 'boolean' ? mediaOptions.sdpSettings.direction.audio.send : true;\n      }\n\n      if (mediaOptions.sdpSettings.direction.video) {\n        state.sdpSettings.direction.video.receive = typeof mediaOptions.sdpSettings.direction.video.receive === 'boolean' ? mediaOptions.sdpSettings.direction.video.receive : true;\n        state.sdpSettings.direction.video.send = typeof mediaOptions.sdpSettings.direction.video.send === 'boolean' ? mediaOptions.sdpSettings.direction.video.send : true;\n      }\n    }\n    if (mediaOptions.sdpSettings.connection) {\n      state.sdpSettings.connection.audio = typeof mediaOptions.sdpSettings.connection.audio === 'boolean' ? mediaOptions.sdpSettings.connection.audio : true;\n      state.sdpSettings.connection.video = typeof mediaOptions.sdpSettings.connection.video === 'boolean' ? mediaOptions.sdpSettings.connection.video : true;\n      state.sdpSettings.connection.data = typeof mediaOptions.sdpSettings.connection.data === 'boolean' ? mediaOptions.sdpSettings.connection.data : true;\n    }\n  }\n\n  if (mediaOptions.publishOnly) {\n    state.sdpSettings.direction.audio.send = true;\n    state.sdpSettings.direction.audio.receive = false;\n    state.sdpSettings.direction.video.send = true;\n    state.sdpSettings.direction.video.receive = false;\n    state.publishOnly = true;\n  }\n\n  /* eslint-disable no-restricted-syntax */\n  /* eslint-disable no-prototype-builtins */\n  if (mediaOptions.peerConnection && typeof mediaOptions.peerConnection === 'object') {\n    if (typeof mediaOptions.peerConnection.bundlePolicy === 'string') {\n      for (const bpProp in BUNDLE_POLICY) {\n        if (BUNDLE_POLICY.hasOwnProperty(bpProp) && BUNDLE_POLICY[bpProp] === mediaOptions.peerConnection.bundlePolicy) {\n          state.peerConnectionConfig.bundlePolicy = mediaOptions.peerConnection.bundlePolicy;\n        }\n      }\n    }\n    if (typeof mediaOptions.peerConnection.rtcpMuxPolicy === 'string') {\n      for (const rmpProp in RTCP_MUX_POLICY) {\n        if (RTCP_MUX_POLICY.hasOwnProperty(rmpProp) && RTCP_MUX_POLICY[rmpProp] === mediaOptions.peerConnection.rtcpMuxPolicy) {\n          state.peerConnectionConfig.rtcpMuxPolicy = mediaOptions.peerConnection.rtcpMuxPolicy;\n        }\n      }\n    }\n    if (typeof mediaOptions.peerConnection.iceCandidatePoolSize === 'number' && mediaOptions.peerConnection.iceCandidatePoolSize > 0) {\n      state.peerConnectionConfig.iceCandidatePoolSize = mediaOptions.peerConnection.iceCandidatePoolSize;\n    }\n    if (typeof mediaOptions.peerConnection.certificate === 'string') {\n      for (const pcProp in PEER_CERTIFICATE) {\n        if (PEER_CERTIFICATE.hasOwnProperty(pcProp) && PEER_CERTIFICATE[pcProp] === mediaOptions.peerConnection.certificate) {\n          state.peerConnectionConfig.certificate = mediaOptions.peerConnection.certificate;\n        }\n      }\n    }\n    state.peerConnectionConfig.disableBundle = mediaOptions.peerConnection.disableBundle === true;\n  }\n\n  if (mediaOptions.autoBandwidthAdjustment) {\n    state.bandwidthAdjuster = {\n      interval: 10,\n      limitAtPercentage: 100,\n      useUploadBwOnly: false,\n    };\n\n    if (typeof mediaOptions.autoBandwidthAdjustment === 'object') {\n      if (typeof mediaOptions.autoBandwidthAdjustment.interval === 'number' && mediaOptions.autoBandwidthAdjustment.interval >= 10) {\n        state.bandwidthAdjuster.interval = mediaOptions.autoBandwidthAdjustment.interval;\n      }\n      if (typeof mediaOptions.autoBandwidthAdjustment.limitAtPercentage === 'number' && (mediaOptions.autoBandwidthAdjustment.limitAtPercentage >= 0 && mediaOptions.autoBandwidthAdjustment.limitAtPercentage <= 100)) {\n        state.bandwidthAdjuster.limitAtPercentage = mediaOptions.autoBandwidthAdjustment.limitAtPercentage;\n      }\n      if (typeof mediaOptions.autoBandwidthAdjustment.useUploadBwOnly === 'boolean') {\n        state.bandwidthAdjuster.useUploadBwOnly = mediaOptions.autoBandwidthAdjustment.useUploadBwOnly;\n      }\n    }\n  }\n  return state;\n};\n\nexport default parseMediaOptions;\n","import Skylink from '../../index';\n\n// requires the mid to be set after setOffer both local or remote\nconst retrieveTransceiverMid = (room, track) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = roomState;\n  const RTCPeerConnections = Object.values(peerConnections);\n  let transceiverMid = null;\n\n  for (let p = 0; p < RTCPeerConnections.length; p += 1) {\n    const transceivers = RTCPeerConnections[p].getTransceivers();\n    for (let t = 0; t < transceivers.length; t += 1) {\n      if (transceivers[t].sender.track && transceivers[t].sender.track.id === track.id) {\n        transceiverMid = transceivers[t].mid;\n        break;\n      }\n    }\n  }\n  return transceiverMid;\n};\n\nexport default retrieveTransceiverMid;\n","import { MEDIA_STATE, TRACK_READY_STATE } from '../../constants';\n\nconst retrieveMediaState = (track) => {\n  if (track.readyState === TRACK_READY_STATE.ENDED) {\n    return MEDIA_STATE.UNAVAILABLE;\n  } if (track.muted) {\n    return MEDIA_STATE.MUTED;\n  }\n  return MEDIA_STATE.ACTIVE;\n};\n\nexport default retrieveMediaState;\n","import { TRACK_KIND } from '../../constants';\n\nconst retrieveMediaId = (trackKind, streamId) => {\n  const prefix = trackKind === TRACK_KIND.AUDIO ? 'AUDIO' : 'VIDEO';\n  return `${prefix}_${streamId}`;\n};\n\nexport default retrieveMediaId;\n","import helpers from './index';\n\nconst buildPeerMediaInfo = (room, mid, track, streamId, mediaType) => ({\n  publisherId: mid,\n  mediaId: helpers.retrieveMediaId(track.kind, streamId),\n  mediaType,\n  mediaState: helpers.retrieveMediaState(track),\n  transceiverMid: helpers.retrieveTransceiverMid(room, track),\n  streamId,\n  trackId: track.id,\n  mediaMetaData: '',\n  simulcast: '',\n});\n\nexport default buildPeerMediaInfo;\n","import Skylink from '../../index';\n\nconst isMatchedTrack = (streamTrack, track) => streamTrack.id === track.id;\n\nconst retrieveStreamIdOfTrack = (room, track) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { streams } = state;\n  const streamObjs = Object.values(streams.userMedia);\n  let streamId = null;\n\n  for (let i = 0; i < streamObjs.length; i += 1) {\n    const tracks = streamObjs[i].stream.getTracks();\n\n    for (let j = 0; j < tracks.length; j += 1) {\n      if (isMatchedTrack(tracks[j], track)) {\n        streamId = streamObjs[i].id;\n        break;\n      }\n    }\n  }\n\n  return streamId;\n};\n\nexport default retrieveStreamIdOfTrack;\n","import Skylink from '../../index';\n\nconst retrieveTracks = (room) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { streams } = state;\n  const tracks = [];\n\n  const fStreams = Object.values(streams.userMedia).map(streamObj => streamObj.stream);\n  fStreams.forEach((stream) => {\n    stream.getTracks().forEach((track) => {\n      tracks.push(track);\n    });\n  });\n\n  return tracks;\n};\n\nexport default retrieveTracks;\n","import Skylink from '../../index';\nimport helpers from './index';\nimport logger from '../../logger/index';\nimport { TAGS } from '../../constants';\nimport MESSAGES from '../../messages';\n\nconst doUpdate = (room, peerId, dispatchEvent, mediaId, key = false, value = false, mediaInfo = false) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n  // Check for key + value || mediaInfo but not both\n  if (!mediaInfo && key && value) {\n    updatedState.peerMedias[peerId][mediaId][key] = value;\n    logger.log.INFO([peerId, TAGS.PEER_MEDIA, null, `${MESSAGES.MEDIA_INFO.UPDATE_SUCCESS} -- ${mediaId} - ${key}: ${value}`]);\n  } else if (mediaInfo && !key && !value) {\n    updatedState.peerMedias[peerId] = updatedState.peerMedias[peerId] || {};\n    updatedState.peerMedias[peerId][mediaId] = mediaInfo;\n  } else {\n    // log if !key && !value && !mediaInfo - nothing to update or if all present which to update?\n  }\n\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nconst dispatchMediaInfoMsg = (room, peerId, dispatchEvent, mediaId) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n  if (updatedState.user.sid === peerId && dispatchEvent) {\n    helpers.sendMediaInfoMsg(room, updatedState.peerMedias[peerId][mediaId]);\n  }\n};\n\n// dispatch event when:\n// 1) not from offer and answer\n// 2) self mediaInfo is updated\n// 3) self a new stream (with new mediaInfo obj) will replace an existing stream - e.g. screen share, send stream\n\nconst updatePeerMediaInfo = (room, peerId, dispatchEvent, mediaId, key = false, value = false, mediaInfo = false) => {\n  try {\n    doUpdate(room, peerId, dispatchEvent, mediaId, key, value, mediaInfo);\n    dispatchMediaInfoMsg(room, peerId, dispatchEvent, mediaId);\n  } catch (err) {\n    const msg = mediaInfo ? JSON.stringify(mediaInfo) : `${mediaId} - ${key}: ${value}`;\n    logger.log.ERROR([peerId, TAGS.PEER_MEDIA, null, `${MESSAGES.MEDIA_INFO.ERRORS.FAILED_UPDATING} -- ${msg}`], err);\n  }\n};\n\nexport default updatePeerMediaInfo;\n","import {\n  API_VERSION, SDK_NAME, SDK_VERSION, SIGNALING_VERSION, SOCKET_TYPE,\n} from '../constants';\n\nconst SOCKET_DEFAULTS = {\n  RECONNECTION_ATTEMPTS: {\n    WEBSOCKET: 5,\n    POLLING: 4,\n  },\n  RECONNECTION_DELAY_MAX: 5000,\n  RECONNECTION_DELAY: 1000,\n  RECONNECTION_FINAL_ATTEMPTS: 10,\n};\n\nconst SOCKET_CONFIG = options => ({\n  forceNew: true,\n  reconnection: true,\n  timeout: options.socketTimeout,\n  path: options.socketServerPath,\n  reconnectionAttempts: SOCKET_DEFAULTS.RECONNECTION_ATTEMPTS.WEBSOCKET,\n  reconnectionDelayMax: SOCKET_DEFAULTS.RECONNECTION_DELAY_MAX,\n  reconnectionDelay: SOCKET_DEFAULTS.RECONNECTION_DELAY,\n  transports: [SOCKET_TYPE.WEBSOCKET.toLowerCase()],\n  query: {\n    Skylink_SDK_type: SDK_NAME.WEB,\n    Skylink_SDK_version: SDK_VERSION,\n    Skylink_API_version: API_VERSION,\n    'X-Server-Select': SIGNALING_VERSION,\n  },\n  extraHeaders: {\n    Skylink_SDK_type: SDK_NAME.WEB,\n    Skylink_SDK_version: SDK_VERSION,\n    Skylink_API_version: API_VERSION,\n    'X-Server-Select': SIGNALING_VERSION,\n  },\n});\n\nexport default SOCKET_CONFIG;\nexport { SOCKET_DEFAULTS };\n","import SOCKET_CONFIG, { SOCKET_DEFAULTS } from './socketConfig';\n\nconst CONFIGS = {\n  SOCKET: SOCKET_CONFIG,\n};\n\nconst DEFAULTS = {\n  SOCKET: SOCKET_DEFAULTS,\n};\n\nconst retrieveConfig = (name, options) => CONFIGS[name](options);\n\nexport default retrieveConfig;\nexport { DEFAULTS };\n","/* eslint-disable prefer-destructuring */\nimport Skylink from '../../../index';\nimport { SOCKET_FALLBACK, SOCKET_TYPE } from '../../../constants';\nimport retrieveConfig, { DEFAULTS } from '../../../defaults/index';\nimport { isAString, isAObj } from '../../../utils/helpers';\n\nconst isFirstConnectionAttempt = config => !config.signalingServerPort;\n\nconst isLastPort = (ports, config) => ports.indexOf(config.signalingServerPort) === ports.length - 1;\n\nconst getSignalingServerUrl = (params) => {\n  const {\n    signalingServerProtocol,\n    signalingServer,\n    signalingServerPort,\n    socketServer,\n  } = params;\n\n  let url = '';\n\n  if (isAString(signalingServer)) {\n    url = `${signalingServerProtocol}//${signalingServer}`;\n  } else if (signalingServer && isAObj(signalingServer) && signalingServer.protocol) {\n    url = `${signalingServer.protocol}//${socketServer.url}:${signalingServerPort}?rand=${Date.now()}`;\n  } else {\n    url = `${signalingServerProtocol}//${signalingServer}:${signalingServerPort}?rand=${Date.now()}`;\n  }\n\n  return url;\n};\n\nconst createSocket = (params) => {\n  const skylinkState = Skylink.getSkylinkState(params.roomKey);\n  const initOptions = Skylink.getInitOptions();\n  const { config } = params;\n  const { socketServer, socketTimeout, socketServerPath } = initOptions;\n  const { socketPorts } = skylinkState;\n  const socketConfig = retrieveConfig('SOCKET', { socketTimeout, socketServerPath });\n\n  let ports = [];\n\n  if (socketServer && isAObj(socketServer) && Array.isArray(socketServer.ports) && socketServer.ports.length) {\n    ({ ports } = socketServer);\n  } else {\n    ports = socketPorts[config.signalingServerProtocol];\n  }\n\n  if (isFirstConnectionAttempt(config)) {\n    config.signalingServerPort = ports[0];\n    config.fallbackType = SOCKET_FALLBACK.NON_FALLBACK;\n  } else if (isLastPort(ports, config) || isAString(initOptions.socketServer)) {\n    // re-refresh to long-polling port\n    if (config.socketType === SOCKET_TYPE.WEBSOCKET) {\n      config.socketType = SOCKET_TYPE.POLLING;\n      config.signalingServerPort = ports[0];\n    } else {\n      config.socketSession.finalAttempts += 1;\n      config.signalingServerPort = ports[0];\n    }\n  // move to the next port\n  } else {\n    config.signalingServerPort = ports[ports.indexOf(config.signalingServerPort) + 1];\n  }\n\n  if (config.socketType === SOCKET_TYPE.POLLING) {\n    socketConfig.reconnectionDelayMax = DEFAULTS.SOCKET.RECONNECTION_DELAY_MAX;\n    socketConfig.reconnectionAttempts = DEFAULTS.SOCKET.RECONNECTION_ATTEMPTS.POLLING;\n    socketConfig.transports = [SOCKET_TYPE.XHR_POLLING, SOCKET_TYPE.JSONP_POLLING, SOCKET_TYPE.POLLING.toLowerCase()];\n  }\n\n  const url = getSignalingServerUrl({\n    signalingServerProtocol: config.signalingServerProtocol,\n    signalingServer: skylinkState.socketServer,\n    signalingServerPort: config.signalingServerPort,\n    socketServer,\n  });\n\n  config.socketServer = socketServer;\n  config.socketServerPath = socketServerPath;\n  skylinkState.socketSession = config;\n  Skylink.setSkylinkState(skylinkState, params.roomKey);\n\n  return window.io(url, socketConfig);\n};\n\nexport default createSocket;\n","import { SIG_MESSAGE_TYPE } from '../../../constants';\nimport logger from '../../../logger';\n\nconst processSignalingMessage = (messageHandler, message) => {\n  const { type } = message;\n  logger.log.INFO(['SIG SERVER', null, type, 'received']);\n  switch (type) {\n    case SIG_MESSAGE_TYPE.IN_ROOM: messageHandler.inRoomHandler(message); break;\n    case SIG_MESSAGE_TYPE.ENTER: messageHandler.enterRoomHandler(message); break;\n    case SIG_MESSAGE_TYPE.OFFER: messageHandler.offerHandler(message); break;\n    case SIG_MESSAGE_TYPE.WELCOME: messageHandler.welcomeHandler(message); break;\n    case SIG_MESSAGE_TYPE.ANSWER: messageHandler.answerHandler(message); break;\n    case SIG_MESSAGE_TYPE.ANSWER_ACK: messageHandler.answerAckHandler(message); break;\n    case SIG_MESSAGE_TYPE.CANDIDATE: messageHandler.candidateHandler(message); break;\n    case SIG_MESSAGE_TYPE.PEER_LIST: messageHandler.getPeerListHandler(message); break;\n    case SIG_MESSAGE_TYPE.INTRODUCE_ERROR: messageHandler.introduceError(message); break;\n    case SIG_MESSAGE_TYPE.BYE: messageHandler.byeHandler(message); break;\n    case SIG_MESSAGE_TYPE.STREAM: messageHandler.streamHandler(message); break;\n    case SIG_MESSAGE_TYPE.RECORDING: messageHandler.recordingHandler(message); break;\n    case SIG_MESSAGE_TYPE.REDIRECT: messageHandler.redirectHandler(message); break;\n    case SIG_MESSAGE_TYPE.RTMP: messageHandler.rtmpHandler(message); break;\n    case SIG_MESSAGE_TYPE.UPDATE_USER: messageHandler.setUserDataHandler(message); break;\n    case SIG_MESSAGE_TYPE.MEDIA_INFO_EVENT: messageHandler.mediaInfoEventHandler(message); break;\n    case SIG_MESSAGE_TYPE.MESSAGE: messageHandler.userMessageHandler(message, null); break;\n    case SIG_MESSAGE_TYPE.STORED_MESSAGES: messageHandler.storedMessagesHandler(message); break;\n    // Backward compatibility for 0.9.x\n    case SIG_MESSAGE_TYPE.MUTE_AUDIO_EVENT: messageHandler.muteAudioEventHandler(message); break;\n    case SIG_MESSAGE_TYPE.MUTE_VIDEO_EVENT: messageHandler.muteVideoEventHandler(message); break;\n    // Backward compatibility for public and private message protocol\n    case SIG_MESSAGE_TYPE.PUBLIC_MESSAGE: messageHandler.userMessageHandler(message, true); break;\n    case SIG_MESSAGE_TYPE.PRIVATE_MESSAGE: messageHandler.userMessageHandler(message, false); break;\n    default: break;\n  }\n};\n\nexport default processSignalingMessage;\n","import clone from 'clone';\nimport Skylink from '../../index';\nimport logger from '../../logger';\nimport messages from '../../messages';\nimport { DATA_CHANNEL_STATE, PEER_TYPE } from '../../constants';\nimport PeerData from '../index';\n\nconst isUser = (peerId, roomState) => {\n  const { user } = roomState;\n  return peerId === user.sid;\n};\n\n/**\n * @description Function that returns the User / Peer current session information.\n * @private\n * @param {String} peerId\n * @param {SkylinkRoom} room\n * @return {peerInfo}\n * @memberOf PeerDataHelpers\n */\nconst getPeerInfo = (peerId, room) => {\n  let peerInfo = null;\n  if (!peerId) {\n    return null;\n  }\n  const state = Skylink.getSkylinkState(room.id);\n\n  if (!state) {\n    Skylink.logNoRoomState(room.id);\n    return peerInfo;\n  }\n\n  if (isUser(peerId, state)) {\n    return PeerData.getCurrentSessionInfo(room);\n  }\n\n  peerInfo = clone(state.peerInformations[peerId]);\n\n  if (!peerInfo) {\n    logger.log.ERROR(`${messages.PEER_INFORMATIONS.NO_PEER_INFO} ${peerId}`);\n    return peerInfo;\n  }\n\n  // FIXME: would there ever be a case of !peerInfo.settings?\n  // if (!peerInfo.settings) {\n  //   peerInfo.settings = {};\n  // }\n\n  // if (!peerInfo.mediaStatus) {\n  //   peerInfo.mediaStatus = {};\n  // }\n\n  peerInfo.room = clone(room.roomName);\n\n  peerInfo.settings.data = !!(state.dataChannels[peerId] && state.dataChannels[peerId].main && state.dataChannels[peerId].main.channel && state.dataChannels[peerId].main.channel.readyState === DATA_CHANNEL_STATE.OPEN);\n  peerInfo.connected = state.peerConnStatus[peerId] && !!state.peerConnStatus[peerId].connected;\n  peerInfo.init = state.peerConnStatus[peerId] && !!state.peerConnStatus[peerId].init;\n\n  // peerInfo.settings.bandwidth = peerInfo.settings.bandwidth || {};\n  // peerInfo.settings.googleXBandwidth = peerInfo.settings.googleXBandwidth || {};\n\n  // if (!(typeof peerInfo.settings.video === 'boolean' || typeof peerInfo.settings.video === 'object')) {\n  //   // peerInfo.settings.video = false;\n  //   peerInfo.mediaStatus.audioMuted = true;\n  // }\n\n  // if (!(typeof peerInfo.settings.audio === 'boolean' || typeof peerInfo.settings.audio === 'object')) {\n  //   // peerInfo.settings.audio = false;\n  //   peerInfo.mediaStatus.audioMuted = true;\n  // }\n\n  // if (typeof peerInfo.mediaStatus.audioMuted !== 'boolean') {\n  //   peerInfo.mediaStatus.audioMuted = true;\n  // }\n\n  // if (typeof peerInfo.mediaStatus.videoMuted !== 'boolean') {\n  //   peerInfo.mediaStatus.videoMuted = true;\n  // }\n\n  // if (peerInfo.settings.maxBandwidth) {\n  //   peerInfo.settings.bandwidth = clone(peerInfo.settings.maxBandwidth);\n  //   delete peerInfo.settings.maxBandwidth;\n  // }\n\n  // if (peerInfo.settings.video && typeof peerInfo.settings.video === 'object' && peerInfo.settings.video.customSettings && typeof peerInfo.settings.video.customSettings === 'object') {\n  // // if (peerInfo.settings.video.customSettings && typeof peerInfo.settings.video.customSettings === 'object') {\n  //   if (peerInfo.settings.video.customSettings.frameRate) {\n  //     peerInfo.settings.video.frameRate = clone(peerInfo.settings.video.customSettings.frameRate);\n  //   }\n  //   if (peerInfo.settings.video.customSettings.facingMode) {\n  //     peerInfo.settings.video.facingMode = clone(peerInfo.settings.video.customSettings.facingMode);\n  //   }\n  //   if (peerInfo.settings.video.customSettings.width) {\n  //     peerInfo.settings.video.resolution = peerInfo.settings.video.resolution || {};\n  //     peerInfo.settings.video.resolution.width = clone(peerInfo.settings.video.customSettings.width);\n  //   }\n  //   if (peerInfo.settings.video.customSettings.height) {\n  //     peerInfo.settings.video.resolution = peerInfo.settings.video.resolution || {};\n  //     peerInfo.settings.video.resolution.height = clone(peerInfo.settings.video.customSettings.height);\n  //   }\n  // }\n\n  // if (peerInfo.settings.audio && typeof peerInfo.settings.audio === 'object') {\n  //   peerInfo.settings.audio.stereo = peerInfo.settings.audio.stereo === true;\n  // }\n\n  // TODO: check if receiveOnly and publishOnly is required\n  if (peerId === PEER_TYPE.MCU) {\n    peerInfo.config.receiveOnly = true;\n    peerInfo.config.publishOnly = false;\n  } else if (state.hasMCU) {\n    peerInfo.config.receiveOnly = false;\n    peerInfo.config.publishOnly = true;\n  }\n\n  // TODO: check if the sdp parsing is required\n  // parse sdp to update media settings and status\n  // if (!state.sdpSettings.direction.audio.receive) {\n  //   peerInfo.settings.audio = false;\n  //   peerInfo.mediaStatus.audioMuted = true;\n  // }\n  //\n  // if (!state.sdpSettings.direction.video.receive) {\n  //   peerInfo.settings.video = false;\n  //   peerInfo.mediaStatus.videoMuted = true;\n  // }\n  //\n  // if (!state.sdpSettings.connection.audio) {\n  //   peerInfo.settings.audio = false;\n  //   peerInfo.mediaStatus.audioMuted = true;\n  // }\n  //\n  // if (!state.sdpSettings.connection.video) {\n  //   peerInfo.settings.video = false;\n  //   peerInfo.mediaStatus.videoMuted = true;\n  // }\n\n  // Makes sense to be send direction since we are retrieving information if Peer is sending anything to us\n  // if (state.sdpSessions[peerId] && state.sdpSessions[peerId].remote && state.sdpSessions[peerId].remote.connection && typeof state.sdpSessions[peerId].remote.connection === 'object') {\n  //   if (!(state.sdpSessions[peerId].remote.connection.audio && state.sdpSessions[peerId].remote.connection.audio.indexOf('send') > -1)) {\n  //     peerInfo.settings.audio = false;\n  //     peerInfo.mediaStatus.audioMuted = true;\n  //   }\n  //   if (!(state.sdpSessions[peerId].remote.connection.video && state.sdpSessions[peerId].remote.connection.video.indexOf('send') > -1)) {\n  //     peerInfo.settings.video = false;\n  //     peerInfo.mediaStatus.videoMuted = true;\n  //   }\n  //   if (!(state.sdpSessions[peerId].remote.connection.data && state.sdpSessions[peerId].remote.connection.data.indexOf('send') > -1)) {\n  //     peerInfo.settings.data = false;\n  //   }\n  // }\n\n  // if (!(peerInfo.userData !== null && typeof peerInfo.userData !== 'undefined')) {\n  //   peerInfo.userData = '';\n  // }\n\n  // if (!peerInfo.settings.audio) {\n  //   peerInfo.mediaStatus.audioMuted = true;\n  // }\n  //\n  // if (!peerInfo.settings.video) {\n  //   peerInfo.mediaStatus.videoMuted = true;\n  // }\n\n  if (!peerInfo.settings.audio && !peerInfo.settings.video) {\n    peerInfo.config.receiveOnly = true;\n    peerInfo.config.publishOnly = false;\n  }\n\n  return peerInfo;\n};\n\nexport default getPeerInfo;\n","import clone from 'clone';\nimport Skylink from '../../index';\nimport { isAObj, isABoolean, isANumber } from '../../utils/helpers';\nimport { SDK_VERSION } from '../../constants';\n\n/**\n * @description Function that returns the current session peerInfo is peer isSelf.\n * @private\n * @param {SkylinkRoom} room\n * @return {peerInfo}\n * @memberOf PeerDataHelpers\n */\nconst getCurrentSessionInfo = (room) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const initOptions = Skylink.getInitOptions();\n  const { AdapterJS } = window;\n  const { enableDataChannel, codecParams } = initOptions;\n  const { roomName } = room;\n  const {\n    streamsMediaStatus,\n    userData,\n    peerPriorityWeight,\n    enableIceRestart,\n    publishOnly,\n    SMProtocolVersion,\n    DTProtocolVersion,\n    streams,\n    streamsBandwidthSettings,\n    sdpSettings,\n    user,\n  } = state;\n\n  const peerInfo = {\n    userData,\n    settings: {\n      audio: false,\n      video: false,\n    },\n    mediaStatus: {},\n    agent: {\n      name: AdapterJS.webrtcDetectedBrowser,\n      version: AdapterJS.webrtcDetectedVersion,\n      os: window.navigator.platform,\n      pluginVersion: AdapterJS.WebRTCPlugin.plugin ? AdapterJS.WebRTCPlugin.plugin.VERSION : null,\n      SMProtocolVersion,\n      DTProtocolVersion,\n      SDKVersion: SDK_VERSION,\n    },\n    room: roomName,\n    config: {\n      enableDataChannel,\n      enableIceRestart,\n      priorityWeight: peerPriorityWeight,\n      receiveOnly: false,\n      publishOnly,\n    },\n    sid: user.sid,\n    screenshare: false,\n  };\n\n  if (streams && streams.userMedia) {\n    const streamIds = Object.keys(streams.userMedia);\n    if (streams.userMedia[streamIds[0]]) { // assume that all the streams have the same settings\n      peerInfo.settings = clone(streams.userMedia[streamIds[0]].settings);\n    }\n  }\n\n  peerInfo.mediaStatus = streamsMediaStatus;\n\n  peerInfo.userData = userData || null;\n\n  peerInfo.config.receiveOnly = !peerInfo.settings.video && !peerInfo.settings.audio;\n\n  if (streams.screenshare) {\n    peerInfo.screenshare = true;\n  }\n\n  peerInfo.settings.maxBandwidth = clone(streamsBandwidthSettings.bAS);\n  peerInfo.settings.googleXBandwidth = clone(streamsBandwidthSettings.googleX);\n\n  if (peerInfo.settings.bandwidth) {\n    peerInfo.settings.maxBandwidth = clone(peerInfo.settings.bandwidth);\n    delete peerInfo.settings.bandwidth;\n  }\n\n  peerInfo.settings.data = enableDataChannel && sdpSettings.connection.data;\n\n  if (peerInfo.settings.audio && isAObj(peerInfo.settings.audio)) {\n    // Override the settings.audio.usedtx\n    if (isABoolean(typeof codecParams.audio.opus.stereo)) {\n      peerInfo.settings.audio.stereo = codecParams.audio.opus.stereo;\n    }\n    // Override the settings.audio.usedtx\n    if (isABoolean(codecParams.audio.opus.usedtx)) {\n      peerInfo.settings.audio.usedtx = codecParams.audio.opus.usedtx;\n    }\n    // Override the settings.audio.maxplaybackrate\n    if (isANumber(codecParams.audio.opus.maxplaybackrate)) {\n      peerInfo.settings.audio.maxplaybackrate = codecParams.audio.opus.maxplaybackrate;\n    }\n    // Override the settings.audio.useinbandfec\n    if (isABoolean(codecParams.audio.opus.useinbandfec)) {\n      peerInfo.settings.audio.useinbandfec = codecParams.audio.opus.useinbandfec;\n    }\n  }\n\n  if (peerInfo.settings.video && isAObj(peerInfo.settings.video)) {\n    peerInfo.settings.video.customSettings = {};\n\n    if (peerInfo.settings.video.frameRate && isAObj(peerInfo.settings.video.frameRate)) {\n      peerInfo.settings.video.customSettings.frameRate = clone(peerInfo.settings.video.frameRate);\n      peerInfo.settings.video.frameRate = -1;\n    }\n\n    if (peerInfo.settings.video.facingMode && isAObj(peerInfo.settings.video.facingMode)) {\n      peerInfo.settings.video.customSettings.facingMode = clone(peerInfo.settings.video.facingMode);\n      peerInfo.settings.video.facingMode = '-1';\n    }\n\n    if (peerInfo.settings.video.resolution && isAObj(peerInfo.settings.video.resolution)) {\n      if (peerInfo.settings.video.resolution.width && isAObj(peerInfo.settings.video.resolution.width)) {\n        peerInfo.settings.video.customSettings.width = clone(peerInfo.settings.video.width);\n        peerInfo.settings.video.resolution.width = -1;\n      }\n\n      if (peerInfo.settings.video.resolution.height && isAObj(peerInfo.settings.video.resolution.height)) {\n        peerInfo.settings.video.customSettings.height = clone(peerInfo.settings.video.height);\n        peerInfo.settings.video.resolution.height = -1;\n      }\n    }\n  }\n\n  if (!peerInfo.settings.audio && !peerInfo.settings.video) {\n    peerInfo.config.receiveOnly = true;\n    peerInfo.config.publishOnly = false;\n  }\n\n  return clone(peerInfo);\n};\n\nexport default getCurrentSessionInfo;\n","import helpers from './index';\n\n/**\n * @description Function that returns the userInfo to be sent to Signaling.\n * @private\n * @param {SkylinkRoom} room\n * @return {Object}\n * @memberOf PeerDataHelpers\n */\nconst getUserInfo = (room) => {\n  const userInfo = helpers.getCurrentSessionInfo(room);\n  delete userInfo.room;\n  // delete userInfo.config;\n  // delete userInfo.settings.data;\n  return userInfo;\n};\n\nexport default getUserInfo;\n","/**\n * @description Function that returns the User / Peer current custom data.\n * @private\n * @param {Skylink} roomState\n * @param {String} peerId\n * @return {roomState.userData}\n * @memberOf PeerDataHelpers\n */\nconst getUserData = (roomState, peerId) => {\n  if (peerId && roomState.peerInformations[peerId]) {\n    let peerUserData = roomState.peerInformations[peerId].userData;\n\n    if (!peerUserData) {\n      peerUserData = '';\n    }\n    return peerUserData;\n  }\n  return roomState.userData;\n};\n\nexport default getUserData;\n","import Skylink from '../../index';\nimport SkylinkSignalingServer from '../../server-communication/signaling-server';\nimport helpers from './index';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { peerUpdated } from '../../skylink-events';\nimport logger from '../../logger';\nimport MESSAGES from '../../messages';\n\n/**\n * @description Function that overwrites the User current custom data.\n * @private\n * @param {SkylinkRoom} room\n * @param {String | Object} userData\n * @memberOf PeerDataHelpers\n * @fires peerUpdated\n */\nconst setUserData = (room, userData) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const { PEER_INFORMATIONS: { UPDATE_USER_DATA } } = MESSAGES;\n  const updatedUserData = userData || '';\n\n  roomState.userData = updatedUserData;\n  Skylink.setSkylinkState(roomState, roomState.room.id);\n\n  new SkylinkSignalingServer().setUserData(roomState);\n\n  dispatchEvent(peerUpdated({\n    peerId: roomState.user.sid,\n    peerInfo: helpers.getCurrentSessionInfo(room),\n    isSelf: true,\n  }));\n\n  logger.log.INFO(UPDATE_USER_DATA, updatedUserData);\n};\n\nexport default setUserData;\n","import logger from '../../../logger';\nimport { TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\nimport stopStreamHelpers from './index';\n\nconst hasStreamBeenReplaced = (state, stoppedStream) => {\n  const { streams } = state;\n\n  if (!streams.userMedia) {\n    return false;\n  }\n\n  const streamObjs = Object.values(streams.userMedia);\n\n  return streamObjs.some(streamObj => streamObj.isReplaced && (streamObj.id === stoppedStream.id));\n};\n\nconst filterUserMediaStreams = (state) => {\n  const { streams } = state;\n  const filteredStreams = {\n    replacedStreams: [],\n    addedStreams: [],\n  };\n  const streamIds = Object.keys(streams.userMedia);\n  streamIds.forEach((userMediaStreamId) => {\n    if (hasStreamBeenReplaced(state, streams.userMedia[userMediaStreamId].stream)) {\n      filteredStreams.replacedStreams.push(streams.userMedia[userMediaStreamId].stream);\n    } else {\n      filteredStreams.addedStreams.push(streams.userMedia[userMediaStreamId].stream);\n    }\n  });\n\n  return filteredStreams;\n};\n\n// eslint-disable-next-line consistent-return\nconst prepStopUserMediaStreams = (state, streamId, fromLeaveRoom) => new Promise((resolve, reject) => {\n  const { user } = state;\n  const filteredStreams = filterUserMediaStreams(state);\n  const isScreensharing = false;\n\n  try {\n    if (!streamId) {\n      stopStreamHelpers.stopAddedStreams(state, filteredStreams.addedStreams, isScreensharing, fromLeaveRoom);\n\n      // TODO:\n      // added streams must be stopped first and renegotiation started before replaced streams are stopped\n      // add event listener to listen for handshake offer to trigger stopReplacedStreams\n\n      stopStreamHelpers.stopReplacedStreams(state, filteredStreams.replacedStreams, isScreensharing, fromLeaveRoom);\n    } else {\n      const { stream } = state.streams.userMedia[streamId];\n      if (hasStreamBeenReplaced(state, stream)) {\n        // TODO\n        stopStreamHelpers.stopReplacedStream(state, stream, fromLeaveRoom);\n      } else {\n        stopStreamHelpers.stopAddedStream(state, stream, isScreensharing, fromLeaveRoom);\n      }\n    }\n\n    return stopStreamHelpers.initRefreshConnectionAndResolve(state.room, fromLeaveRoom, resolve, reject);\n  } catch (error) {\n    logger.log.DEBUG([user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.STOP_USER_MEDIA], error);\n    reject(MESSAGES.MEDIA_STREAM.ERRORS.STOP_USER_MEDIA);\n  }\n});\n\nexport default prepStopUserMediaStreams;\n","import logger from '../../../logger';\nimport { TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\n\nexport const stopMediaTracks = (tracks, peerId) => {\n  if (!tracks || !tracks[0]) {\n    return false;\n  }\n\n  tracks.forEach((track) => {\n    try {\n      track.stop();\n    } catch (error) {\n      logger.log.ERROR([peerId, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.ERRORS.STOP_MEDIA_TRACK} - track id: ${track.id}`], error);\n    }\n  });\n\n  return true;\n};\n\nconst tryStopStream = (stream, peerId) => {\n  if (!stream) return;\n\n  try {\n    stopMediaTracks(stream.getAudioTracks());\n  } catch (error) {\n    logger.log.ERROR([peerId, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.ERRORS.STOP_AUDIO_TRACK} - stream id: ${stream.id}`], error);\n  }\n\n  try {\n    stopMediaTracks(stream.getVideoTracks());\n  } catch (error) {\n    logger.log.ERROR([peerId, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.ERRORS.STOP_VIDEO_TRACK} - stream id: ${stream.id}`], error);\n  }\n};\n\nexport default tryStopStream;\n","import logger from '../../logger';\nimport Skylink from '../../index';\n\nconst removeSenderFromList = (state, peerId, sender) => {\n  const { room } = state;\n  const updatedState = state;\n  let indexToRemove = -1;\n\n  if (!updatedState.currentRTCRTPSenders[peerId]) {\n    return;\n  }\n\n  const listOfSenders = updatedState.currentRTCRTPSenders[peerId];\n\n  for (let i = 0; i < listOfSenders.length; i += 1) {\n    if (sender === listOfSenders[i]) {\n      indexToRemove = i;\n      break;\n    }\n  }\n\n  if (indexToRemove !== -1) {\n    listOfSenders.splice(indexToRemove, 1);\n    updatedState.currentRTCRTPSenders[peerId] = listOfSenders;\n    Skylink.setSkylinkState(updatedState, room.id);\n  } else {\n    logger.log.WARN([peerId, null, null, 'No matching sender was found for the peer.'], sender);\n  }\n};\n\nexport default removeSenderFromList;\n","import prepStopStreams from './prepStopStreams';\nimport prepStopUserMediaStreams from './prepStopUserMediaStreams';\nimport stopAddedStream from './stopAddedStream';\nimport tryStopStream from './tryStopStream';\nimport removeTracks from './removeTracks';\nimport listenForEventAndDeleteMediaInfo from './listenForEventAndDeleteMediaInfo';\nimport stopAddedStreams from './stopAddedStreams';\nimport updateMediaInfoMediaState from './updateMediaInfoMediaState';\nimport deleteStreamFromState from './deleteStreamFromState';\nimport dispatchOnLocalStreamEnded from './dispatchOnLocalStreamEnded';\nimport prepStopScreenStream from './prepStopScreenStream';\nimport initRefreshConnectionAndResolve from './initRefreshConnectionAndResolve';\nimport stopReplacedStream from './stopReplacedStream';\nimport stopReplacedStreams from './stopReplacedStreams';\n\nconst stopStreamHelpers = {\n  prepStopStreams,\n  prepStopUserMediaStreams,\n  stopAddedStream,\n  tryStopStream,\n  removeTracks,\n  listenForEventAndDeleteMediaInfo,\n  stopAddedStreams,\n  updateMediaInfoMediaState,\n  deleteStreamFromState,\n  dispatchOnLocalStreamEnded,\n  prepStopScreenStream,\n  initRefreshConnectionAndResolve,\n  stopReplacedStream,\n  stopReplacedStreams,\n};\n\nexport default stopStreamHelpers;\n","import Skylink from '../../../index';\nimport stopStreamHelpers from './index';\nimport MESSAGES from '../../../messages';\n\n// eslint-disable-next-line consistent-return\nconst prepStopStreams = (roomId, streamId, fromLeaveRoom = false, isScreensharing = false) => new Promise((resolve, reject) => {\n  const state = Skylink.getSkylinkState(roomId);\n  const { streams } = state;\n\n  if (!state || !streams) {\n    reject(new Error(`${MESSAGES.ROOM_STATE.NOT_FOUND} - ${roomId}`));\n  }\n\n  if (!streams || (!isScreensharing && !streams.userMedia) || (isScreensharing && !streams.screenshare) || (isScreensharing && streams.screenshare && (streams.screenshare.id !== streamId))) {\n    reject(new Error(`${MESSAGES.MEDIA_STREAM.ERRORS.NO_STREAM} - ${streamId}`));\n  }\n\n  if (isScreensharing) {\n    stopStreamHelpers.prepStopScreenStream(state.room, streamId, fromLeaveRoom)\n      .then(() => resolve())\n      .catch(rej => reject(rej));\n  } else {\n    stopStreamHelpers.prepStopUserMediaStreams(state, streamId, fromLeaveRoom)\n      .then(() => resolve())\n      .catch(rej => reject(rej));\n  }\n});\n\nexport default prepStopStreams;\n","import logger from '../../../logger';\nimport { TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\nimport stopStreamHelpers from './index';\nimport ScreenSharing from '../../../features/screen-sharing';\n\nconst stopAddedStream = (state, stream, isScreensharing = false, fromLeaveRoom = false) => {\n  const { room, user } = state;\n\n  try {\n    stopStreamHelpers.tryStopStream(stream, user.sid);\n\n    if (!fromLeaveRoom) {\n      stopStreamHelpers.removeTracks(room, stream);\n      stopStreamHelpers.updateMediaInfoMediaState(room, stream);\n      stopStreamHelpers.deleteStreamFromState(room, stream, isScreensharing);\n      stopStreamHelpers.listenForEventAndDeleteMediaInfo(room, stream);\n      stopStreamHelpers.dispatchOnLocalStreamEnded(room, stream, isScreensharing);\n\n      if (isScreensharing) {\n        new ScreenSharing(state).deleteScreensharingInstance(room);\n      }\n    }\n  } catch (err) {\n    logger.log.ERROR([user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.STOP_ADDED_STREAM], err);\n  }\n};\n\nexport default stopAddedStream;\n","import Skylink from '../../../index';\nimport logger from '../../../logger';\nimport MESSAGES from '../../../messages';\nimport removeSenderFromList from '../../../peer-connection/helpers/removeSenderFromList';\nimport { PEER_CONNECTION_STATE, TAGS } from '../../../constants';\n\nconst removeTrack = (state, peerConnections, track) => {\n  const trackId = track.id;\n  const peerIds = Object.keys(peerConnections);\n\n  for (let i = 0; i < peerIds.length; i += 1) {\n    try {\n      const targetMid = peerIds[i];\n      const peerConnection = peerConnections[targetMid];\n\n      if (peerConnection.connectionState === PEER_CONNECTION_STATE.CLOSED) {\n        break;\n      }\n\n      const senders = peerConnection.getSenders();\n      let sender = null;\n      for (let y = 0; y < senders.length; y += 1) {\n        if (senders[y].track && senders[y].track.id === trackId) {\n          sender = senders[y];\n          peerConnection.removeTrack(sender);\n          removeSenderFromList(state, targetMid, sender);\n        }\n      }\n    } catch (error) {\n      logger.log.ERROR([peerIds[i], TAGS.PEER_CONNECTION, null, MESSAGES.PEER_CONNECTION.ERRORS.REMOVE_TRACK], error);\n    }\n  }\n};\n\n/**\n * Function that removes the tracks from the peer connection.\n * @param {SkylinkRoom} room\n * @param {MediaStream} stream\n * @memberOf MediaStreamHelpers\n */\nconst removeTracks = (room, stream) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections, user } = state;\n  const tracks = stream.getTracks();\n\n  try {\n    tracks.forEach((track) => {\n      removeTrack(state, peerConnections, track);\n    });\n  } catch (error) {\n    logger.log.ERROR([user.sid, TAGS.PEER_CONNECTION, null, MESSAGES.PEER_CONNECTION.ERRORS.REMOVE_TRACK], error);\n  }\n};\n\nexport default removeTracks;\n","import { EVENTS, HANDSHAKE_PROGRESS, TRACK_KIND } from '../../../constants';\nimport PeerMedia from '../../../peer-media';\nimport Skylink from '../../../index';\nimport { addEventListener, removeEventListener } from '../../../utils/skylinkEventManager';\nimport { hasAudioTrack } from '../../../utils/helpers';\n\nconst listenForEventAndDeleteMediaInfo = (room, stream) => {\n  const state = Skylink.getSkylinkState(room.id);\n\n  const executeOfferCallback = (evt) => {\n    const s = stream;\n    const { user } = state;\n    const { detail } = evt;\n    if (detail.state === HANDSHAKE_PROGRESS.OFFER) {\n      const mediaId = PeerMedia.retrieveMediaId(hasAudioTrack(s) ? TRACK_KIND.AUDIO : TRACK_KIND.VIDEO, s.id);\n      PeerMedia.deleteUnavailableMedia(room, user.sid, mediaId);\n    }\n  };\n\n  const executeMediaDeletedCallback = () => {\n    removeEventListener(EVENTS.HANDSHAKE_PROGRESS, executeOfferCallback);\n    removeEventListener(EVENTS.MEDIA_INFO_DELETED, executeMediaDeletedCallback);\n  };\n\n  addEventListener(EVENTS.HANDSHAKE_PROGRESS, executeOfferCallback);\n  addEventListener(EVENTS.MEDIA_INFO_DELETED, executeMediaDeletedCallback);\n};\n\nexport default listenForEventAndDeleteMediaInfo;\n","import stopStreamHelpers from './index';\n\nconst stopAddedStreams = (state, streams, isScreensharing, fromLeaveRoom) => {\n  streams.forEach((stream) => {\n    stopStreamHelpers.stopAddedStream(state, stream, isScreensharing, fromLeaveRoom);\n  });\n};\n\nexport default stopAddedStreams;\n","import Skylink from '../../../index';\nimport PeerMedia from '../../../peer-media';\n\nconst updateMediaInfoMediaState = (room, stream) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { user } = state;\n  const streamId = stream.id;\n  const mediaId = PeerMedia.retrieveMediaId(stream.getTracks()[0].kind, streamId);\n  PeerMedia.setMediaStateToUnavailable(room, user.sid, mediaId);\n};\n\nexport default updateMediaInfoMediaState;\n","import { isEmptyObj } from '../../../utils/helpers';\nimport logger from '../../../logger';\nimport { TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\nimport Skylink from '../../../index';\n\nconst deleteStreamFromState = (room, stream, isScreensharing = null) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n  const { user } = updatedState;\n  const streamIdToRemove = stream.id;\n\n  if (isScreensharing) {\n    delete updatedState.streams.screenshare;\n    delete updatedState.streamsMediaStatus[stream.id];\n    delete updatedState.streamsMutedSettings[stream.id];\n    updatedState.streams.screenshare = null;\n\n    logger.log.INFO([user.sid, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.STOP_SUCCESS} - stream id: ${stream.id} (screenshare)`]);\n  } else {\n    delete updatedState.streams.userMedia[streamIdToRemove];\n    delete updatedState.streamsMediaStatus[stream.id];\n    delete updatedState.streamsMutedSettings[stream.id];\n\n    if (isEmptyObj(updatedState.streams.userMedia)) {\n      updatedState.streams.userMedia = null;\n    }\n\n    logger.log.INFO([user.sid, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.STOP_SUCCESS} - stream id: ${stream.id}`]);\n  }\n\n  Skylink.setSkylinkState(updatedState, updatedState.room.id);\n};\n\nexport default deleteStreamFromState;\n","import { mediaAccessStopped, peerUpdated, streamEnded } from '../../../skylink-events';\nimport Skylink from '../../../index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { hasVideoTrack, hasAudioTrack } from '../../../utils/helpers';\nimport logger from '../../../logger';\nimport MESSAGES from '../../../messages';\nimport PeerData from '../../../peer-data/index';\nimport helpers from '../../../peer-data/helpers';\nimport { TAGS } from '../../../constants';\n\n/**\n * Function that handles the <code>RTCPeerConnection.removeTracks(sender)</code> on the local MediaStream.\n * @param {SkylinkRoom} room\n * @param {MediaStream} stream - The stream.\n * @param {boolean} isScreensharing\n * @memberOf MediaStreamHelpers\n * @fires streamEnded\n */\nconst dispatchOnLocalStreamEnded = (room, stream, isScreensharing = false) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { MEDIA_STREAM } = MESSAGES;\n  const { user } = state;\n  const isSelf = true;\n\n  logger.log.INFO([user.sid, TAGS.MEDIA_STREAM, null, MEDIA_STREAM.STOP_SETTINGS], {\n    peerId: user.sid, isSelf, isScreensharing, stream,\n  });\n\n  dispatchEvent(streamEnded({\n    room,\n    peerId: user.sid,\n    peerInfo: PeerData.getCurrentSessionInfo(room),\n    isSelf,\n    isScreensharing,\n    streamId: stream.id,\n    isVideo: hasVideoTrack(stream),\n    isAudio: hasAudioTrack(stream),\n  }));\n\n  dispatchEvent(mediaAccessStopped({\n    isScreensharing,\n    streamId: stream.id,\n  }));\n\n  dispatchEvent(peerUpdated({\n    peerId: user.sid,\n    peerInfo: helpers.getCurrentSessionInfo(room),\n    isSelf: true,\n  }));\n};\n\nexport default dispatchOnLocalStreamEnded;\n","import stopStreamHelpers from './index';\nimport logger from '../../../logger';\nimport { TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\nimport Skylink from '../../../index';\n\nconst hasStreamBeenReplaced = (state, stoppedStream) => {\n  const { streams } = state;\n\n  if (!streams.userMedia) {\n    return false;\n  }\n\n  const streamObjs = Object.values(streams.userMedia);\n\n  return streamObjs.some(streamObj => streamObj.isReplaced && (streamObj.id === stoppedStream.id));\n};\n\nconst prepStopScreenStream = (room, streamId, fromLeaveRoom = false) => new Promise((resolve, reject) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { user, streams } = state;\n  const screenStream = streams.screenshare.stream;\n  const isScreensharing = true;\n\n  try {\n    if (hasStreamBeenReplaced(state, screenStream)) {\n      stopStreamHelpers.stopReplacedStream(state, screenStream, isScreensharing, fromLeaveRoom);\n    } else {\n      stopStreamHelpers.stopAddedStream(state, screenStream, isScreensharing, fromLeaveRoom);\n    }\n\n    stopStreamHelpers.initRefreshConnectionAndResolve(state.room, fromLeaveRoom, resolve, reject);\n  } catch (error) {\n    logger.log.DEBUG([user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.STOP_SCREEN], error);\n    reject(new Error(MESSAGES.MEDIA_STREAM.ERRORS.STOP_SCREEN));\n  }\n});\n\nexport default prepStopScreenStream;\n","import { isEmptyArray } from '../../../utils/helpers';\nimport PeerConnection from '../../../peer-connection';\nimport Skylink from '../../../index';\nimport { addEventListener, dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { peerUpdated } from '../../../skylink-events';\nimport PeerData from '../../../peer-data';\nimport PeerMedia from '../../../peer-media/index';\nimport { EVENTS, HANDSHAKE_PROGRESS } from '../../../constants';\n\nconst dispatchPeerUpdatedEvent = (roomState) => {\n  const { room, user } = roomState;\n\n  dispatchEvent(peerUpdated({\n    peerId: user.sid,\n    isSelf: true,\n    peerInfo: PeerData.getCurrentSessionInfo(room),\n  }));\n};\n\n// eslint-disable-next-line consistent-return\nconst initRefreshConnectionAndResolve = (room, fromLeaveRoom, resolve, reject) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n\n  try {\n    if (!fromLeaveRoom) {\n      if (!isEmptyArray(Object.keys(peerConnections))) {\n        // eslint-disable-next-line consistent-return\n        const executeAnswerAckCallback = (evt) => {\n          const { detail } = evt;\n          if (detail.state === HANDSHAKE_PROGRESS.ANSWER_ACK) {\n            return (resolve());\n          }\n        };\n\n        addEventListener(EVENTS.HANDSHAKE_PROGRESS, executeAnswerAckCallback);\n\n        PeerConnection.refreshConnection(state);\n      } else {\n        dispatchPeerUpdatedEvent(state);\n        PeerMedia.deleteUnavailableMedia(state.room, state.user.sid);\n        return resolve();\n      }\n    }\n  } catch (err) {\n    reject(err);\n  }\n};\n\nexport default initRefreshConnectionAndResolve;\n","import logger from '../../../logger';\nimport { STREAM_STATUS, TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\nimport stopStreamHelpers from './index';\nimport SkylinkSignalingServer from '../../../server-communication/signaling-server';\n\nconst sendStreamReplaceEndedMsg = (state, stoppedStream) => {\n  const { room, user } = state;\n  const signaling = new SkylinkSignalingServer();\n  signaling.stream(room.id, user, stoppedStream, STREAM_STATUS.REPLACED_STREAM_ENDED, null);\n};\n\n// TODO:\n//  implement stop user media stream\n//  stop screen stream will be implemented diff - need to replace the screen stream with the original user media stream\n//  ref: onScreenStreamEnded for previous implementation\nconst stopReplacedStream = (state, stream, isScreensharing, fromLeaveRoom) => {\n  const { user, room } = state;\n\n  try {\n    stopStreamHelpers.tryStopStream(stream);\n\n    if (!fromLeaveRoom) {\n      sendStreamReplaceEndedMsg(state, stream);\n      stopStreamHelpers.deleteStreamFromState(room, stream, isScreensharing);\n      stopStreamHelpers.dispatchOnLocalStreamEnded(room, stream);\n    }\n  } catch (err) {\n    logger.log.ERROR([user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.STOP_REPLACED_STREAM], err);\n  }\n};\n\nexport default stopReplacedStream;\n","import stopStreamHelpers from './index';\n\nconst stopReplacedStreams = (state, streams, isScreensharing, fromLeaveRoom) => {\n  streams.forEach((stream) => {\n    stopStreamHelpers.stopReplacedStream(state, stream, isScreensharing, fromLeaveRoom);\n  });\n};\n\nexport default stopReplacedStreams;\n","import Skylink from '../index';\nimport helpers from './helpers/index';\nimport stopStreamHelpers from './helpers/stopStream/index';\nimport logger from '../logger';\nimport MESSAGES from '../messages';\nimport { isAObj } from '../utils/helpers';\nimport { TAGS, TRACK_KIND } from '../constants';\n\n/**\n * @private\n * @classdesc Class used for handling RTCMediaStream. Helper methods are listed inside <code>{@link MediaStreamHelpers}</code>.\n * @class\n */\nclass MediaStream {\n  /**\n   * @description Function that retrieves camera Stream.\n   * @param {SkylinkState} state\n   * @param {GetUserMediaOptions} mediaOptions - The camera Stream configuration options.\n   * @return {Promise}\n   */\n  static getUserMedia(state, mediaOptions = {}) {\n    const { room } = state;\n    const updatedRoomState = helpers.parseMediaOptions(mediaOptions, state);\n    const { audio, video } = mediaOptions;\n    const useExactConstraints = !!mediaOptions.useExactConstraints;\n    Skylink.setSkylinkState(updatedRoomState, room.id);\n\n    return helpers.prepMediaAccessRequest({\n      useExactConstraints,\n      audio,\n      video,\n      roomKey: room.id,\n    });\n  }\n\n  /**\n   * @description Function that filters user input from getUserMedia public method\n   * @param {SkylinkState} roomState\n   * @param {GetUserMediaOptions} options\n   */\n  static getUserMediaLayer(roomState, options = null) {\n    return new Promise((resolve, reject) => {\n      let mediaOptions = {\n        audio: true,\n        video: true,\n      };\n\n      if (!options) {\n        logger.log.WARN([roomState.user.sid, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.NO_OPTIONS} - ${MESSAGES.MEDIA_STREAM.DEFAULT_OPTIONS}`], mediaOptions);\n      }\n\n      if (!isAObj(options)) {\n        logger.log.ERROR([roomState.user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.INVALID_GUM_OPTIONS], options);\n        reject(new Error(MESSAGES.MEDIA_STREAM.ERRORS.INVALID_GUM_OPTIONS), null);\n      }\n\n      mediaOptions = options;\n\n      const getUserMediaPromise = MediaStream.getUserMedia(roomState, mediaOptions);\n      getUserMediaPromise.then((stream) => {\n        resolve(stream);\n      }).catch((error) => {\n        reject(error);\n      });\n    });\n  }\n\n  /**\n   * Function that stops the getUserMedia() streams.\n   * @param {SkylinkState} roomState\n   * @param {String} streamId - The id of the stream to stop if there is more than one getUserMedia stream.\n   */\n  static stopStreams(roomState, streamId) {\n    return stopStreamHelpers.prepStopStreams(roomState.room.id, streamId);\n  }\n\n  /**\n   * Function that sets User's Stream to send to Peer connection.\n   * @param {String} targetMid - The mid of the target peer\n   * @param {SkylinkState} roomState - Skylink State of current room\n   */\n  static addLocalMediaStreams(targetMid, roomState) {\n    helpers.addLocalMediaStreams(targetMid, roomState);\n  }\n\n  /**\n   * Function that handles the <code>RTCPeerConnection.ontrack</code> event on remote stream added.\n   * @param {MediaStream} stream - {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaStream}\n   * @param {SkylinkState} currentRoomState - Current room state\n   * @param {String} targetMid - The mid of the target peer\n   * @param {boolean} [isScreensharing=false] - The flag if stream is a screenshare stream.\n   */\n  static onRemoteTrackAdded(stream, currentRoomState, targetMid, isScreensharing, isVideo, isAudio) {\n    helpers.onRemoteTrackAdded(stream, currentRoomState, targetMid, isScreensharing, isVideo, isAudio);\n  }\n\n  /**\n   * Function that mutes the stream.\n   * @param {SkylinkState} roomState\n   * @param {Object} options\n   * @param {boolean} options.audioMuted\n   * @param {boolean} options.videoMuted\n   * @param {String} streamId\n   */\n  static muteStreams(roomState, options, streamId) {\n    return helpers.muteStreams(roomState, options, streamId);\n  }\n\n  /**\n   * Function that sends the MediaStream object if present or mediaStream settings.\n   * @param {SkylinkState} roomState\n   * @param {MediaStream|Object} options\n   */\n  static sendStream(roomState, options) {\n    return helpers.sendStream(roomState, options);\n  }\n\n  static getStreamSources() {\n    return helpers.getStreamSources();\n  }\n\n  static getScreenSources() {\n    return helpers.getScreenSources();\n  }\n\n  static updateRemoteStreams(room, peerId, stream) {\n    return helpers.updateRemoteStreams(room, peerId, stream);\n  }\n\n  /**\n   * Function that returns all active streams including screenshare stream if present.\n   * @param {SkylinkState} roomState\n   * @return {streamList} streamList\n   */\n  static getStreams(roomState) {\n    return helpers.getStreams(roomState);\n  }\n\n  static usePrefetchedStream(roomKey, stream, options = null) {\n    return new Promise((resolve) => {\n      if (!stream && (options.id && options.active)) {\n        // eslint-disable-next-line no-param-reassign\n        stream = options;\n      }\n\n      const streamOptions = { audio: stream.getAudioTracks().length !== 0, video: stream.getVideoTracks().length !== 0 };\n      const audioSettings = helpers.parseStreamSettings(streamOptions, TRACK_KIND.AUDIO);\n      const videoSettings = helpers.parseStreamSettings(streamOptions, TRACK_KIND.VIDEO);\n      const isAudioFallback = false;\n      return helpers.onStreamAccessSuccess(roomKey, stream, audioSettings, videoSettings, isAudioFallback, resolve);\n    });\n  }\n}\n\nexport default MediaStream;\n","import { isEmptyObj } from '../../utils/helpers';\nimport { SkylinkConstants } from '../../index';\nimport PeerConnection from '../../peer-connection';\n\nconst hasPeerDataChannels = dataChannels => !isEmptyObj(dataChannels);\n\n/**\n * @description Function that gets the current list of connected Peers Datachannel connections in the Room.\n * @private\n * @param {SkylinkState} roomState\n * @return {Object} listOfPeersDataChannels\n * @memberOf PeerDataHelpers\n */\nconst getPeersDataChannels = (roomState) => {\n  const { dataChannels } = roomState;\n  const listOfPeersDataChannels = {};\n  const listOfPeers = Object.keys(dataChannels);\n\n  for (let i = 0; i < listOfPeers.length; i += 1) {\n    const peerId = listOfPeers[i];\n    listOfPeersDataChannels[peerId] = {};\n\n    if (hasPeerDataChannels(dataChannels)) {\n      const channelProp = Object.keys(dataChannels[peerId]);\n      for (let y = 0; y < channelProp.length; y += 1) {\n        const channel = dataChannels[peerId][channelProp[y]];\n        const {\n          channelName,\n          channelType,\n          transferId,\n          streamId,\n        } = channel;\n        let peerChannel = null;\n        peerChannel = PeerConnection.getDataChannelBuffer(channel);\n        peerChannel.channelProp = channelProp[y];\n        peerChannel.channelName = channelName;\n        peerChannel.channelType = channelType;\n        peerChannel.currentTransferId = transferId;\n        peerChannel.currentStreamId = streamId;\n        peerChannel.readyState = channel.channel\n          ? channel.channel.readyState : SkylinkConstants.DATA_CHANNEL_STATE.CREATE_ERROR;\n\n        listOfPeersDataChannels[peerId][channelName] = peerChannel;\n      }\n    }\n  }\n\n  return listOfPeersDataChannels;\n};\n\nexport default getPeersDataChannels;\n","import clone from 'clone';\nimport {\n  isEmptyObj, isAObj, isANumber,\n} from '../../utils/helpers';\nimport { PEER_CONNECTION_STATE, PEER_TYPE } from '../../constants';\nimport Skylink from '../..';\nimport PeerData from '../index';\n\nconst hasPeers = peerInformations => !isEmptyObj(peerInformations);\n\n/**\n * Function that gets a current custom Peer settings.\n * @param {SkylinkState} state\n * @param {String} peerId\n * @private\n * @return {Object}\n * @memberOf PeerDataHelpers\n */\nconst getPeerCustomSettings = (state, peerId) => {\n  const { streams } = state;\n  const customSettings = {};\n  customSettings.settings = {\n    audio: false,\n    video: false,\n    data: false,\n    bandwidth: clone(state.streamsBandwidthSettings.bAS),\n    googleXBandwidth: clone(state.streamsBandwidthSettings.googleX),\n  };\n\n  const usePeerId = state.hasMCU ? PEER_TYPE.MCU : peerId;\n\n  if (state.peerConnections[usePeerId].signalingState !== PEER_CONNECTION_STATE.CLOSED) {\n    const initOptions = Skylink.getInitOptions();\n    const peerInfo = PeerData.getPeerInfo(usePeerId, state.room);\n\n    customSettings.settings = clone(peerInfo.settings);\n    customSettings.settings.data = initOptions.enableDataChannel && state.peerInformations[usePeerId].config.enableDataChannel;\n\n    // TODO: check logic - why the need to build again and not take from getPeerInfo since the signature is the same\n    if (streams.userMedia || streams.screenshare) {\n      // if (state.streams.userMedia) {\n      //   const streamIds = Object.keys(streams.userMedia);\n      //   selectedStream = state.streams.userMedia[streamIds[0]];\n      // } else if (state.streams.screenshare) {\n      //   selectedStream = state.streams.screenshare;\n      // }\n\n      // customSettings.settings.audio = clone(selectedStream.settings.audio);\n      // customSettings.settings.video = clone(selectedStream.settings.video);\n      // customSettings.mediaStatus = clone(state.streamsMutedSettings);\n\n      // typeof state.peerConnections[peerId].getSenders === 'function' - native function\n      // if (!initOptions.useEdgeWebRTC && !window.msRTCPeerConnection) {\n      //   const senders = state.peerConnections[usePeerId].getSenders();\n      //   let hasSendAudio = false;\n      //   let hasSendVideo = false;\n      //\n      //   if (senders.length !== 0) {\n      //     for (let i = 0; i < senders.length; i += 1) {\n      //       if (senders[i].track && senders[i].track.kind === 'audio') {\n      //         hasSendAudio = true;\n      //       } else if (senders[i].track && senders[i].track.kind === 'video') {\n      //         hasSendVideo = true;\n      //       }\n      //     }\n      //\n      //     if (!hasSendAudio) {\n      //       customSettings.settings.audio = false;\n      //       customSettings.mediaStatus.audioMuted = true;\n      //     }\n      //\n      //     if (!hasSendVideo) {\n      //       customSettings.settings.video = false;\n      //       customSettings.mediaStatus.videoMuted = true;\n      //     }\n      //   }\n      // }\n    }\n  }\n\n  //  update default conifg with peer custom config TODO: check if parsing of state.peerCustomConfigs is required or if it can be assigned directly\n  if (state.peerCustomConfigs[usePeerId]) {\n    if (Object.hasOwnProperty.call(state.peerCustomConfigs[usePeerId], 'bandwidth')) {\n      const peerCustomConfigBandwidth = state.peerCustomConfigs[usePeerId].bandwidth;\n\n      if (isAObj(peerCustomConfigBandwidth)) {\n        if (isANumber(peerCustomConfigBandwidth.audio)) {\n          customSettings.settings.bandwidth.audio = peerCustomConfigBandwidth.audio;\n        }\n        if (isANumber(peerCustomConfigBandwidth.video)) {\n          customSettings.settings.bandwidth.video = peerCustomConfigBandwidth.video;\n        }\n        if (isANumber(peerCustomConfigBandwidth.data)) {\n          customSettings.settings.bandwidth.data = peerCustomConfigBandwidth.data;\n        }\n      }\n    }\n\n    if (Object.hasOwnProperty.call(state.peerCustomConfigs[usePeerId], 'googleXBandwidth')) {\n      const peerCustomConfigGoogleXBandwidth = state.peerCustomConfigs[usePeerId].googleXBandwidth;\n\n      if (isAObj(peerCustomConfigGoogleXBandwidth)) {\n        if (isANumber(peerCustomConfigGoogleXBandwidth.min)) {\n          customSettings.settings.googleXBandwidth.min = peerCustomConfigGoogleXBandwidth.min;\n        }\n        if (isANumber(peerCustomConfigGoogleXBandwidth.max)) {\n          customSettings.settings.googleXBandwidth.max = peerCustomConfigGoogleXBandwidth.max;\n        }\n      }\n    }\n  }\n\n  // Check we are going to send data to peer // TODO: is the above check enough or do we need to parse it from sdp\n  // if (state.sdpSessions[usePeerId]) {\n  //   const peerLocalConnection = state.sdpSessions[usePeerId].local.connection;\n  //   if (isAObj(peerLocalConnection)) {\n  //     if (state.sdpSessions[usePeerId].local.connection.audio\n  //       && state.sdpSessions[usePeerId].local.connection.audio.indexOf('send') > -1) {\n  //       customSettings.settings.audio = true;\n  //       customSettings.mediaStatus.audioMuted = false;\n  //     }\n  //     if (state.sdpSessions[usePeerId].local.connection.video\n  //       && state.sdpSessions[usePeerId].local.connection.video.indexOf('send') > -1) {\n  //       customSettings.settings.video = true;\n  //       customSettings.mediaStatus.videoMuted = false;\n  //     }\n  //     if (state.sdpSessions[usePeerId].local.connection.data\n  //       && state.sdpSessions[usePeerId].local.connection.data.indexOf('send') > -1) {\n  //       customSettings.settings.data = true;\n  //     }\n  //   }\n  // }\n\n  return customSettings;\n};\n\n/**\n * @description Function that gets the list of current custom Peer settings sent and set.\n * @param {SkylinkState} roomState\n * @return {Object} customSettingsList\n * @memberOf PeerDataHelpers\n */\nconst getPeersCustomSettings = (roomState) => {\n  const { peerInformations } = roomState;\n  const customSettingsList = {};\n\n  if (hasPeers(peerInformations)) {\n    const peerIds = Object.keys(peerInformations);\n\n    for (let peerId = 0; peerId < peerIds.length; peerId += 1) {\n      customSettingsList[peerIds[peerId]] = getPeerCustomSettings(roomState, peerIds[peerId]);\n    }\n\n    return customSettingsList;\n  }\n\n  return customSettingsList;\n};\n\nexport default getPeersCustomSettings;\n","import getPeerInfo from './getPeerInfo';\nimport getCurrentSessionInfo from './getCurrentSessionInfo';\nimport getUserInfo from './getUserInfo';\nimport getUserData from './getUserData';\nimport setUserData from './setUserData';\nimport getPeersStreams from './getPeersStreams';\nimport getPeersDataChannels from './getPeersDataChannels';\nimport getPeersCustomSettings from './getPeersCustomSettings';\nimport setGreatestPeerPriorityWeight from './setGreatestPeerPriorityWeight';\n\n/**\n * @namespace PeerDataHelpers\n * @description All helper and utility functions for <code>{@link PeerData}</code> class are listed here.\n * @private\n * @type {{getCurrentSessionInfo, getPeerInfo, getUserData, getUserInfo, setUserData, getPeersStreams, getPeersDataChannels, getPeersCustomSettings, setGreatestPeerPriorityWeight}}\n */\nconst helpers = {\n  getPeerInfo,\n  getCurrentSessionInfo,\n  getUserInfo,\n  getUserData,\n  setUserData,\n  getPeersStreams,\n  getPeersDataChannels,\n  getPeersCustomSettings,\n  setGreatestPeerPriorityWeight,\n};\n\nexport default helpers;\n","import { isEmptyObj } from '../../utils/helpers';\nimport MediaStream from '../../media-stream';\n\nconst hasPeerConnections = (peerConnections, hasMCU) => (hasMCU ? !!peerConnections.MCU.maps : !isEmptyObj(peerConnections));\n\nconst getSelfStreams = (streams) => {\n  if (streams.userMedia) {\n    return streams.userMedia;\n  }\n  return null;\n};\n\nconst getSelfScreen = (streams) => {\n  if (streams.screenshare) {\n    return streams.screenshare;\n  }\n  return null;\n};\n\n/**\n * @description Function that gets the list of connected Peers Streams in the Room.\n * @param {SkylinkState} roomState\n * @param {boolean} [includeSelf=true] - The flag if self streams are included.\n * @return {Object}\n * @memberOf PeerDataHelpers\n */\nconst getPeersStreams = (roomState, includeSelf = true) => {\n  const listOfPeersStreams = {};\n  const {\n    peerConnections,\n    user,\n    streams,\n    hasMCU,\n  } = roomState;\n\n  if (user && user.sid && includeSelf) {\n    const selfStreams = getSelfStreams(streams);\n    const selfScreen = getSelfScreen(streams);\n    listOfPeersStreams[user.sid] = selfStreams || selfScreen ? {} : null;\n\n    if (selfStreams) {\n      Object.keys(selfStreams).forEach((streamId) => {\n        listOfPeersStreams[user.sid].isSelf = true;\n        listOfPeersStreams[user.sid][streamId] = selfStreams[streamId].stream;\n      });\n    }\n\n    if (selfScreen) {\n      listOfPeersStreams[user.sid].isSelf = true;\n      listOfPeersStreams[user.sid][selfScreen.id] = selfScreen;\n    }\n  }\n\n  if (hasPeerConnections(peerConnections, hasMCU)) {\n    const listOfPeers = hasMCU ? Object.keys(peerConnections.MCU.maps) : Object.keys(peerConnections);\n    for (let i = 0; i < listOfPeers.length; i += 1) {\n      listOfPeersStreams[listOfPeers[i]] = {};\n      const remoteStreams = MediaStream.retrieveRemoteStreams(roomState, listOfPeers[i]);\n      remoteStreams.forEach((stream) => {\n        listOfPeersStreams[listOfPeers[i]][stream.id] = stream;\n      });\n    }\n  }\n\n  return isEmptyObj(listOfPeersStreams) ? null : listOfPeersStreams;\n};\n\nexport default getPeersStreams;\n","import Skylink from '../../index';\nimport logger from '../../logger';\n\n/**\n * Iterates through all connected peers to find the greatest peerPriorityWeight and sets the current users peerPriorityWeight to max.\n * @param {SkylinkState} roomState\n * @private\n */\nconst setGreatestPeerPriorityWeight = (roomState) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { peerInformations } = state;\n  const informationList = Object.entries(peerInformations);\n  const selfPriorityWeight = state.peerPriorityWeight;\n\n  let maxPeerPriority = selfPriorityWeight;\n  for (let i = 0; i < informationList.length; i += 1) {\n    const peerInformation = informationList[i][1];\n    const { config: { priorityWeight } } = peerInformation;\n\n    if (priorityWeight > maxPeerPriority) {\n      maxPeerPriority = priorityWeight;\n      state.peerPriorityWeight = maxPeerPriority + 1;\n    }\n  }\n  Skylink.setSkylinkState(state, state.room.id);\n  logger.log.DEBUG(`User's priorityWeight is set to ${maxPeerPriority}`);\n};\n\nexport default setGreatestPeerPriorityWeight;\n","import helpers from './helpers';\n\n/**\n * @classdesc Class that represents PeerData methods\n * @class\n * @private\n */\nclass PeerData {\n  /**\n   * @description Function that returns the User / Peer current session information.\n   * @private\n   * @param {String} peerId\n   * @param {SkylinkRoom} room\n   * @return {peerInfo}\n   */\n  static getPeerInfo(peerId, room) {\n    return helpers.getPeerInfo(peerId, room);\n  }\n\n  /**\n   * @private\n   * @param {SkylinkRoom} room\n   * @return {peerInfo}\n   */\n  static getCurrentSessionInfo(room) {\n    return helpers.getCurrentSessionInfo(room);\n  }\n\n  /**\n   * @description Function that returns the User session information to be sent to Peers.\n   * @private\n   * @param {SkylinkRoom} room\n   * @return {Object}\n   */\n  static getUserInfo(room) {\n    return helpers.getUserInfo(room);\n  }\n\n  /**\n   * @description Function that returns the User / Peer current custom data.\n   * @private\n   * @param {Skylink} roomState\n   * @param {String} peerId\n   * @return {roomState.userData}\n   */\n  static getUserData(roomState, peerId) {\n    return helpers.getUserData(roomState, peerId);\n  }\n\n  /**\n   * @description Function that overwrites the User current custom data.\n   * @private\n   * @param {SkylinkRoom} room\n   * @param {String | Object} userData\n   */\n  static setUserData(room, userData) {\n    helpers.setUserData(room, userData);\n  }\n\n  /**\n   * @description  Function that gets the list of connected Peers Streams in the Room.\n   * @private\n   * @param {SkylinkState} roomState\n   * @param {boolean} [includeSelf=true] - The flag if self streams are included.\n   * @return {Object}\n   */\n  static getPeersStreams(roomState, includeSelf) {\n    return helpers.getPeersStreams(roomState, includeSelf);\n  }\n\n  /**\n   * @description Function that gets the current list of connected Peers Datachannel connections in the Room.\n   * @private\n   * @param {SkylinkState} roomState\n   * @return {Object} listOfPeersDataChannels\n   */\n  static getPeersDataChannels(roomState) {\n    return helpers.getPeersDataChannels(roomState);\n  }\n\n  /**\n   * @description Function that gets the list of current custom Peer settings sent and set.\n   * @param {SkylinkState} roomState\n   * @return {Object}\n   */\n  static getPeersCustomSettings(roomState) {\n    return helpers.getPeersCustomSettings(roomState);\n  }\n\n  /**\n   * Iterates through all connected peers to find the greatest peerPriorityWeight and sets the current users peerPriorityWeight to max.\n   * @param {SkylinkState} roomState\n   * @return {*|void}\n   */\n  static setGreatestPeerPriorityWeight(roomState) {\n    return helpers.setGreatestPeerPriorityWeight(roomState);\n  }\n}\n\nexport default PeerData;\n","import clone from 'clone';\nimport Skylink from '../../../index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { channelClose, sessionDisconnect } from '../../../skylink-events';\nimport logger from '../../../logger';\nimport PeerData from '../../../peer-data';\n\nconst handleSocketClose = (roomKey, reason) => {\n  const state = Skylink.getSkylinkState(roomKey) || Object.values(Skylink.getSkylinkState())[0]; // to handle leaveAllRooms method\n\n  const {\n    socketSession, inRoom, room, user,\n  } = state;\n\n  logger.log.INFO([null, 'Socket', null, `Channel closed. Reason - ${reason}`]);\n\n  state.channelOpen = false;\n  Skylink.setSkylinkState(state, roomKey);\n\n  dispatchEvent(channelClose({\n    socketSession: clone(socketSession),\n  }));\n\n  if (inRoom && user && user.sid) {\n    dispatchEvent(sessionDisconnect({\n      peerId: user.sid,\n      peerInfo: PeerData.getCurrentSessionInfo(room),\n    }));\n  }\n};\n\nexport default handleSocketClose;\n","const config = {\n  apiBase: 'https://api.temasys.io',\n  stats: {\n    endPoints: {\n      client: '/client',\n      session: '/session',\n      auth: '/auth',\n      signaling: '/signaling',\n      iceConnection: '/client/iceconnection',\n      iceCandidate: '/client/icecandidate',\n      iceGathering: '/client/icegathering',\n      negotiation: '/client/negotiation',\n      bandwidth: '/client/bandwidth',\n      recording: '/client/recording',\n      dataChannel: '/client/datachannel',\n    },\n  },\n};\n\nconfig.stats.statsBase = `${config.apiBase}/rest/stats`;\n\nexport default config;\n","import appConfig from '../../configs/app';\nimport Skylink from '../index';\nimport logger from '../logger';\nimport MESSAGES from '../messages';\n\n/* eslint-disable class-methods-use-this */\n/**\n * @class\n * @classdesc This class is used to post the stats data.\n * @private\n */\nclass SkylinkStats {\n  constructor() {\n    this.endpoints = appConfig.stats.endPoints;\n    this.stats_buffer = {};\n    this.bufferTimeout = false;\n  }\n\n  postStats(endpoint, data) {\n    const { STATS_MODULE } = MESSAGES;\n    const { fetch } = window;\n\n    try {\n      if (!data.client_id) {\n        return;\n      }\n      const initOptions = Skylink.getInitOptions();\n      const { enableStatsGathering } = initOptions;\n\n      if (enableStatsGathering) {\n        fetch(`${appConfig.stats.statsBase}${endpoint}`, {\n          method: 'POST',\n          mode: 'cors',\n          headers: {\n            'Content-type': 'application/json',\n          },\n          body: JSON.stringify(data),\n        });\n      }\n    } catch (err) {\n      logger.log.WARN(STATS_MODULE.ERRORS.POST_FAILED, err);\n    }\n  }\n\n  addToStatsBuffer(operation, data, url) {\n    if (!this.stats_buffer[operation]) {\n      this.stats_buffer[operation] = {};\n      this.stats_buffer[operation].url = url;\n      this.stats_buffer[operation].data = [];\n    }\n\n    const cloneData = Object.assign({}, data);\n    this.stats_buffer[operation].data.push(cloneData);\n  }\n\n  manageStatsBuffer() {\n    if (!this.bufferTimeout) {\n      this.bufferTimeout = true;\n      setInterval(() => {\n        const operations = Object.keys(this.stats_buffer);\n        for (let i = 0; i < operations.length; i += 1) {\n          if (this.stats_buffer[operations[i]].data.length > 0) {\n            this.postStats(this.stats_buffer[operations[i]].url, this.stats_buffer[operations[i]].data);\n            this.stats_buffer[operations[i]].data = [];\n          }\n        }\n      }, 5000);\n    }\n  }\n}\n\nexport default SkylinkStats;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\n\nclass HandleSignalingStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      state: null,\n      signaling_url: null,\n      signaling_transport: null,\n      attempts: null,\n      error: null,\n    };\n  }\n\n  send(roomKey, state, error) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n    const { socketSession } = roomState;\n\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.client_id = roomState.clientId;\n    this.model.state = state;\n    this.model.signaling_url = roomState.socketSession.socketServer;\n    this.model.signaling_transport = roomState.socketSession.socketType.toLowerCase();\n    this.model.attempts = socketSession.socketSession.finalAttempts === 0 ? socketSession.socketSession.attempts : (socketSession.socketSession.finalAttempts * 2) + socketSession.socketSession.attempts;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.attempts = typeof error === 'number' ? error : null;\n    this.model.error = (typeof error === 'string' ? error : (error && error.message)) || null;\n\n    this.postStats(this.endpoints.signaling, this.model);\n  }\n}\n\nexport default HandleSignalingStats;\n","import onConnection from './onconnect';\nimport onDisconnect from './ondisconnect';\nimport onError from './onerror';\nimport onReconnectAttempt from './onreconnectattempt';\nimport onReconnectFailed from './onreconnectfailed';\nimport onReconnectError from './onreconnecterror';\n\nconst callbacks = {\n  onConnection,\n  onDisconnect,\n  onError,\n  onReconnectAttempt,\n  onReconnectFailed,\n  onReconnectError,\n};\n\nexport default callbacks;\n","import clone from 'clone';\nimport Skylink from '../../../index';\nimport HandleSignalingStats from '../../../skylink-stats/handleSignalingStats';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { channelOpen, channelReopen } from '../../../skylink-events';\nimport { STATES } from '../../../constants';\n\nconst onConnection = (resolve, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { socketSession } = state;\n\n  new HandleSignalingStats().send(roomKey, STATES.SIGNALING.CONNECT, null);\n\n  if (!state.channelOpen) {\n    state.channelOpen = true;\n    Skylink.setSkylinkState(state, roomKey);\n  }\n\n  if (socketSession.socketSession.finalAttempts !== 0 || socketSession.socketSession.attempts !== 0) {\n    dispatchEvent(channelReopen({\n      socketSession: clone(socketSession),\n    }));\n\n    new HandleSignalingStats().send(roomKey, STATES.SIGNALING.RECONNECT_SUCCESS);\n  } else {\n    dispatchEvent(channelOpen({\n      socketSession: clone(socketSession),\n    }));\n  }\n\n  resolve();\n};\n\nexport default onConnection;\n","import Skylink from '../../../index';\nimport HandleSignalingStats from '../../../skylink-stats/handleSignalingStats';\nimport { handleSocketClose } from '../signaling-server-helpers';\nimport { STATES } from '../../../constants';\n\nconst onDisconnect = (roomKey, reason) => {\n  const state = Skylink.getSkylinkState(roomKey) || Object.values(Skylink.getSkylinkState())[0]; // to handle leaveAllRooms method\n  const isChannelOpen = state.channelOpen;\n  const { room } = state;\n\n  new HandleSignalingStats().send(room.id, STATES.SIGNALING.DISCONNECT, null);\n\n  if (isChannelOpen || (!isChannelOpen && roomKey !== room.roomName)) { // to handle leaveAllRooms method\n    handleSocketClose(room.id, reason);\n  }\n};\n\nexport default onDisconnect;\n","import clone from 'clone';\nimport HandleSignalingStats from '../../../skylink-stats/handleSignalingStats';\nimport Skylink from '../../../index';\nimport logger from '../../../logger/index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { channelError } from '../../../skylink-events/index';\nimport { STATES } from '../../../constants';\n\nconst onError = (roomKey, error) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { socketSession } = state;\n\n  new HandleSignalingStats().send(roomKey, STATES.SIGNALING.ERROR, error);\n\n  logger.log.ERROR([null, 'Socket', null, 'Exception occurred ->'], error);\n\n  dispatchEvent(channelError({\n    error,\n    socketSession: clone(socketSession),\n  }));\n};\n\nexport default onError;\n","import clone from 'clone';\nimport SkylinkSignalingServer from '../index';\nimport Skylink from '../../../index';\nimport HandleSignalingStats from '../../../skylink-stats/handleSignalingStats';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { channelRetry } from '../../../skylink-events/index';\nimport { STATES } from '../../../constants';\n\n// eslint-disable-next-line no-unused-vars\nconst onReconnectAttempt = (roomKey, attempt) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { socketSession } = state;\n  const signaling = new SkylinkSignalingServer();\n  let currentAttempt = 0;\n\n  signaling.updateAttempts(roomKey, 'attempts', attempt);\n\n  if (socketSession.socketSession.finalAttempts === 0) {\n    currentAttempt = attempt;\n  } else {\n    currentAttempt = (socketSession.socketSession.finalAttempts * 2) + socketSession.socketSession.attempts;\n  }\n\n  new HandleSignalingStats().send(roomKey, STATES.SIGNALING.RECONNECT_ATTEMPT, currentAttempt);\n\n  dispatchEvent(channelRetry({\n    fallbackType: socketSession.fallbackType,\n    currentAttempt,\n    session: clone(Skylink.getSkylinkState(roomKey).socketSession),\n  }));\n};\n\nexport default onReconnectAttempt;\n","import clone from 'clone';\nimport Skylink from '../../../index';\nimport { STATES, SOCKET_ERROR } from '../../../constants';\nimport HandleSignalingStats from '../../../skylink-stats/handleSignalingStats';\nimport MESSAGES from '../../../messages';\nimport SkylinkSignalingServer from '../index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { socketError } from '../../../skylink-events';\nimport { DEFAULTS } from '../../../defaults/index';\n\nconst onReconnectFailed = (resolve, reject, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { socketSession } = state;\n  const signaling = new SkylinkSignalingServer();\n\n  // try next port or transport\n  if (socketSession.socketSession.attempts === DEFAULTS.SOCKET.RECONNECTION_ATTEMPTS.WEBSOCKET && socketSession.socketSession.finalAttempts < DEFAULTS.SOCKET.RECONNECTION_FINAL_ATTEMPTS && !socketSession.socketTimeout) {\n    signaling.socket.connect();\n    signaling.updateAttempts(roomKey, 'attempts', socketSession.socketSession.attempts === DEFAULTS.SOCKET.RECONNECTION_ATTEMPTS.WEBSOCKET ? 0 : socketSession.socketSession.attempts += 1);\n    signaling.updateAttempts(roomKey, 'finalAttempts', socketSession.socketSession.finalAttempts += 1);\n  } else {\n    new HandleSignalingStats().send(roomKey, STATES.SIGNALING.RECONNECT_FAILED, MESSAGES.INIT.ERRORS.SOCKET_ERROR_ABORT);\n\n    dispatchEvent(socketError({\n      session: clone(socketSession),\n      errorCode: SOCKET_ERROR.RECONNECTION_ABORTED,\n      type: socketSession.fallbackType,\n      error: new Error(MESSAGES.INIT.ERRORS.SOCKET_ERROR_ABORT),\n    }));\n\n    reject(new Error(MESSAGES.INIT.ERRORS.SOCKET_ERROR_ABORT));\n  }\n};\n\nexport default onReconnectFailed;\n","import HandleSignalingStats from '../../../skylink-stats/handleSignalingStats';\nimport Skylink from '../../../index';\nimport logger from '../../../logger';\nimport { STATES } from '../../../constants';\n\nconst onReconnectError = (roomKey, error) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { socketSession } = state;\n\n  new HandleSignalingStats().send(roomKey, STATES.SIGNALING.RECONNECT_ERROR, error);\n\n  if (!socketSession.socketTimeout && error ? error === 'timeout' : false) {\n    logger.log.ERROR([null, 'Socket', null, `${socketSession.socketType} connection timed out.`]);\n    socketSession.socketTimeout = true;\n    Skylink.setSkylinkState(state, roomKey);\n  }\n};\n\nexport default onReconnectError;\n","import { SOCKET_EVENTS } from '../../../constants';\nimport callbacks from '../callbacks';\n\nconst setSocketCallbacks = (roomKey, signaling, resolve, reject) => {\n  signaling.socket.on(SOCKET_EVENTS.CONNECT, callbacks.onConnection.bind(signaling, resolve, roomKey));\n  signaling.socket.on(SOCKET_EVENTS.MESSAGE, signaling.onMessage.bind(signaling));\n  signaling.socket.on(SOCKET_EVENTS.DISCONNECT, callbacks.onDisconnect.bind(signaling, roomKey));\n  signaling.socket.on(SOCKET_EVENTS.ERROR, callbacks.onError.bind(signaling, roomKey));\n  signaling.socket.on(SOCKET_EVENTS.RECONNECT_ATTEMPT, callbacks.onReconnectAttempt.bind(signaling, roomKey));\n  signaling.socket.on(SOCKET_EVENTS.RECONNECT_ERROR, callbacks.onReconnectError.bind(signaling, roomKey));\n  signaling.socket.on(SOCKET_EVENTS.RECONNECT_FAILED, callbacks.onReconnectFailed.bind(signaling, resolve, reject, roomKey));\n};\n\nexport default setSocketCallbacks;\n","import clone from 'clone';\nimport Skylink, { SkylinkEventManager } from '../../../index';\nimport {\n  SIG_MESSAGE_TYPE, EVENTS, HANDSHAKE_PROGRESS, TAGS,\n} from '../../../constants';\nimport { isABoolean, isNull } from '../../../utils/helpers';\nimport logger from '../../../logger';\nimport MESSAGES from '../../../messages';\nimport SkylinkSignalingServer from '../index';\n\nconst isNegotiationTypeMsg = (message) => {\n  const {\n    JOIN_ROOM, ENTER, WELCOME, OFFER, ANSWER, ANSWER_ACK, CANDIDATE, END_OF_CANDIDATES,\n  } = SIG_MESSAGE_TYPE;\n  const negTypeMessages = [JOIN_ROOM, ENTER, WELCOME, OFFER, ANSWER, ANSWER_ACK, CANDIDATE, END_OF_CANDIDATES];\n  return negTypeMessages.indexOf(message.type) > -1;\n};\n\nconst sendBufferedMsg = (state, currentBufferedMsgs) => {\n  const signaling = new SkylinkSignalingServer();\n  for (let i = currentBufferedMsgs.length - 1; i >= 0; i -= 1) {\n    const message = currentBufferedMsgs[i];\n    if (!message.mid) {\n      if (!state.user.sid) {\n        logger.log.DEBUG([state.user.sid, TAGS.SIG_SERVER, null, `${MESSAGES.SIGNALING.BUFFERED_MESSAGES_DROPPED}`]);\n        return;\n      }\n      message.mid = state.user.sid;\n    }\n    signaling.sendMessage(message);\n    currentBufferedMsgs.splice(i, 1);\n  }\n};\n\nconst initAndTrue = value => isABoolean(value) && value;\n\nconst executeCallbackAndRemoveListener = (rid, evt) => {\n  const state = Skylink.getSkylinkState(rid);\n  const { detail } = evt;\n\n  if (detail.state === HANDSHAKE_PROGRESS.ENTER) {\n    const currentBufferedMsgs = clone(state.socketMessageQueue);\n    state.user.bufferMessage = false;\n    state.socketMessageQueue = [];\n    Skylink.setSkylinkState(state, state.room.id);\n\n    logger.log.DEBUG([state.user.sid, TAGS.SIG_SERVER, null, `${MESSAGES.SIGNALING.BUFFERED_MESSAGES_SENT}: ${currentBufferedMsgs.length}`]);\n    sendBufferedMsg(state, currentBufferedMsgs);\n    SkylinkEventManager.removeEventListener(EVENTS.HANDSHAKE_PROGRESS, executeCallbackAndRemoveListener);\n  }\n};\n\nconst shouldBufferMessage = (message) => {\n  const { rid } = message;\n  const updatedState = Skylink.getSkylinkState(rid);\n  const { user, room } = updatedState;\n\n  if ((isNull(user.bufferMessage) || initAndTrue(user.bufferMessage)) && !isNegotiationTypeMsg(message)) {\n    logger.log.DEBUG([user.sid, TAGS.SIG_SERVER, null, MESSAGES.SIGNALING.MESSAGE_ADDED_TO_BUFFER]);\n    updatedState.socketMessageQueue.unshift(message);\n\n    if (!initAndTrue(user.bufferMessage)) {\n      updatedState.user.bufferMessage = true;\n      logger.log.DEBUG([user.sid, TAGS.SIG_SERVER, null, MESSAGES.SIGNALING.ENTER_LISTENER]);\n      SkylinkEventManager.addEventListener(EVENTS.HANDSHAKE_PROGRESS, executeCallbackAndRemoveListener.bind(this, rid));\n    }\n\n    Skylink.setSkylinkState(updatedState, room.id);\n\n    return true;\n  }\n\n  if (message.type === HANDSHAKE_PROGRESS.ENTER && isNull(user.bufferMessage)) {\n    logger.log.DEBUG([user.sid, TAGS.SIG_SERVER, null, MESSAGES.SIGNALING.BUFFER_NOT_NEEDED]);\n    updatedState.user.bufferMessage = false;\n    updatedState.socketMessageQueue = [];\n    Skylink.setSkylinkState(updatedState, updatedState.room.id);\n  }\n\n  return false;\n};\n\nexport default shouldBufferMessage;\n","\nimport * as helpers from './helpers/index';\n\nexport const createSocket = params => helpers.createSocket(params);\n\nexport const processSignalingMessage = (...args) => {\n  helpers.processSignalingMessage(...args);\n};\n\nexport const sendChannelMessage = (socket, message) => {\n  socket.send(JSON.stringify(message));\n};\n\nexport const handleSocketClose = (...args) => {\n  helpers.handleSocketClose(...args);\n};\n\nexport const closeSocket = (...args) => {\n  helpers.closeSocket(...args);\n};\n\nexport const setSocketCallbacks = (...args) => {\n  helpers.setSocketCallbacks(...args);\n};\n\nexport const shouldBufferMessage = (...args) => helpers.shouldBufferMessage(...args);\n","import MESSAGES from '../../../../messages';\nimport logger from '../../../../logger';\nimport { TAGS } from '../../../../constants';\nimport helpers from './index';\n\n/**\n * Method that deletes the encryption secret associated with the given secretId. If the secretId is not provided all encryption secrets are deleted.\n * @param encryptSecrets\n * @param selectedSecretId\n * @param secretId\n * @returns {object}\n * @private\n */\nconst deleteEncryptSecrets = (encryptSecrets, selectedSecretId, secretId) => {\n  const updatedData = {\n    encryptSecrets,\n    selectedSecretId,\n  };\n\n  if (secretId) {\n    if (!updatedData.encryptSecrets[secretId]) {\n      throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRET_ID_NOT_FOUND);\n    }\n\n    // selectedSecretId should be set to default if there are no encryptSecrets stored\n    if (updatedData.selectedSecretId === secretId) {\n      updatedData.selectedSecretId = helpers.setSelectedSecretId();\n    }\n\n    delete updatedData.encryptSecrets[secretId];\n  } else {\n    logger.log.DEBUG([null, TAGS.ENCRYPTED_MESSAGING, null, `${MESSAGES.MESSAGING.ENCRYPTION.DELETE_ALL}`]);\n    updatedData.selectedSecretId = helpers.setSelectedSecretId();\n    updatedData.encryptSecrets = {};\n  }\n\n  return updatedData;\n};\n\nexport default deleteEncryptSecrets;\n","import MESSAGES from '../../../../messages';\nimport helpers from './index';\n\nconst isValidSecret = (secret) => {\n  if (!secret) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.NO_SECRET_OR_SECRET_ID);\n  }\n\n  if (!helpers.utils.isValidString(secret)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.INVALID_TYPE);\n  }\n\n  return true;\n};\n\nconst isValidSecretId = (secretId, updatedEncryptSecrets) => {\n  if (!secretId) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.NO_SECRET_OR_SECRET_ID);\n  }\n\n  if (!helpers.utils.isValidString(secretId)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.INVALID_TYPE);\n  }\n\n  if (helpers.utils.isExisting(secretId, updatedEncryptSecrets)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRET_ID_NOT_UNIQUE);\n  }\n\n  return true;\n};\n\n\n// eslint-disable-next-line consistent-return\nconst setEncryptSecret = (encryptSecrets, secret, secretId) => {\n  const updatedEncryptSecrets = encryptSecrets;\n\n  if (isValidSecret(secret) && isValidSecretId(secretId, updatedEncryptSecrets)) {\n    updatedEncryptSecrets[secretId] = secret;\n    return updatedEncryptSecrets;\n  }\n};\n\nexport default setEncryptSecret;\n","import CryptoJS from 'crypto-js';\nimport { isAString, isEmptyObj, isEmptyString } from '../../../../utils/helpers';\nimport MESSAGES from '../../../../messages';\nimport logger from '../../../../logger';\nimport { TAGS } from '../../../../constants';\n\nconst isExisting = (encryptionParam, updatedEncryptSecrets) => {\n  const duplicates = Object.keys(updatedEncryptSecrets).filter(id => id === encryptionParam);\n  return duplicates.length > 0;\n};\n\n// conditions for encryption - encryptSecrets must not be empty obj AND selected secret must not be empty string\nconst canEncrypt = (selectedSecretId, encryptSecrets) => {\n  if (isEmptyObj(encryptSecrets) && isEmptyString(selectedSecretId)) {\n    throw new Error(`${MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRETS_NOT_PROVIDED}, ${MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRET_ID_NOT_PROVIDED}`);\n  } else if (isEmptyString(selectedSecretId)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRET_ID_NOT_SELECTED);\n  } else if (isEmptyObj(encryptSecrets)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRETS_NOT_PROVIDED);\n  }\n\n  return true;\n};\n\n// conditions for decryption - encrypt secrets must not be empty obj\nconst canDecrypt = (encryptSecrets) => {\n  if (isEmptyObj(encryptSecrets)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRETS_NOT_PROVIDED);\n  }\n\n  return true;\n};\n\nconst isValidString = (encryptionParam) => {\n  if (!isAString(encryptionParam) || !isAString(encryptionParam) || isEmptyString(encryptionParam)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.INVALID_TYPE);\n  }\n\n  return true;\n};\n\nconst hasCrypto = () => {\n  if (!CryptoJS) {\n    logger.log.ERROR([null, TAGS.ASYNC_MESSAGING, null, MESSAGES.PERSISTENT_MESSAGE.ERRORS.NO_DEPENDENCY]);\n    return false;\n  }\n\n  return CryptoJS;\n};\n\nconst utils = {\n  isExisting,\n  isValidString,\n  hasCrypto,\n  canEncrypt,\n  canDecrypt,\n};\n\nexport default utils;\n","import helpers from './index';\nimport MESSAGES from '../../../../messages';\n\nconst setSelectedSecretId = (encryptSecrets, secretId) => {\n  if (!secretId) {\n    return '';\n  }\n\n  if (!helpers.utils.isValidString(secretId)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.INVALID_TYPE);\n  }\n\n  if (!encryptSecrets[secretId]) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRET_ID_NOT_FOUND);\n  }\n\n  return secretId;\n};\n\nexport default setSelectedSecretId;\n","import { isAString, isEmptyArray } from '../../../utils/helpers';\nimport logger from '../../../logger';\nimport { PEER_TYPE, TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\n\nconst getMessageConfig = (roomState, targetPeerId) => {\n  const {\n    peerInformations,\n    inRoom,\n    user,\n  } = roomState;\n  let listOfPeers;\n  let isPrivate = false;\n\n  if (!inRoom || !user) {\n    throw Error(MESSAGES.ROOM.ERRORS.NOT_IN_ROOM);\n  }\n\n  if (Array.isArray(targetPeerId) && !isEmptyArray(targetPeerId)) {\n    listOfPeers = targetPeerId;\n    isPrivate = true;\n  } else if (targetPeerId && isAString(targetPeerId)) {\n    listOfPeers = [targetPeerId];\n    isPrivate = true;\n  } else {\n    listOfPeers = Object.keys(peerInformations);\n  }\n\n  listOfPeers.forEach((peerId, i) => {\n    if (!peerInformations[peerId]) {\n      logger.log.WARN([peerId, TAGS.MESSAGING, null, `${MESSAGES.MESSAGING.ERRORS.DROPPING_MESSAGE} - ${MESSAGES.PEER_CONNECTION.NO_PEER_CONNECTION}`]);\n      listOfPeers.splice(i, 1);\n    } else if (peerId === PEER_TYPE.MCU) {\n      listOfPeers.splice(i, 1);\n    }\n  });\n\n  if (listOfPeers.length === 0) {\n    logger.log.WARN([null, TAGS.MESSAGING, null, MESSAGES.PEER_CONNECTION.NO_PEER_CONNECTION]);\n  }\n\n  return { listOfPeers, isPrivate };\n};\n\nexport default getMessageConfig;\n","import SkylinkSignalingServer from '../../../server-communication/signaling-server';\nimport messagingHelpers from './index';\n\nconst sendMessageToSig = (roomState, config, message, encryptedMessage = '', targetPeerId) => {\n  const signaling = new SkylinkSignalingServer();\n  signaling.sendUserMessage(roomState, config, encryptedMessage || message);\n  messagingHelpers.dispatchOnIncomingMessage(roomState, config, message, true, targetPeerId);\n};\n\nexport default sendMessageToSig;\n","import { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { onIncomingMessage } from '../../../skylink-events';\nimport { generateISOStringTimesStamp } from '../../../utils/helpers';\nimport PeerData from '../../../peer-data';\nimport logger from '../../../logger';\nimport { TAGS } from '../../../constants';\nimport MESSAGES from '../../../messages';\n\n// if isSelf = true, targetPeerId is the peer id targeted in sendMessage\n// else targetPeerId is the targetMid of the incoming sig msg\nconst dispatchOnIncomingMessage = (roomState, config, messageContent, isSelf, targetPeerId) => {\n  const { room, user } = roomState;\n\n  logger.log.DEBUG([isSelf ? null : targetPeerId, TAGS.MESSAGING, null, `${MESSAGES.MESSAGING.RECEIVED_MESSAGE} - isPrivate: ${config.isPrivate}`]);\n  const message = {\n    // eslint-disable-next-line no-nested-ternary\n    targetPeerId: isSelf ? (config.isPrivate ? targetPeerId : null) : user.sid,\n    content: messageContent,\n    senderPeerId: isSelf ? user.sid : targetPeerId,\n    isDataChannel: false,\n    isPrivate: config.isPrivate,\n    timeStamp: generateISOStringTimesStamp(),\n  };\n\n  if (isSelf) {\n    message.listOfPeers = config.listOfPeers;\n  }\n\n  dispatchEvent(onIncomingMessage({\n    room,\n    message,\n    isSelf,\n    peerId: isSelf ? user.sid : targetPeerId,\n    peerInfo: isSelf ? PeerData.getCurrentSessionInfo(room) : PeerData.getPeerInfo(targetPeerId, room),\n  }));\n};\n\nexport default dispatchOnIncomingMessage;\n","import logger from '../logger';\nimport { TAGS } from '../constants';\n\nclass SkylinkError {\n  static throwError(errorLog = '', message = '') {\n    logger.log.ERROR([null, TAGS.SKYLINK_ERROR, null, `${errorLog}${(message ? ` - ${message}` : '')}`]);\n    throw new Error(`${errorLog}${(message ? ` - ${message}` : '')}`);\n  }\n}\n\nexport default SkylinkError;\n","import getMessageConfig from './getMessageConfig';\nimport sendMessageToSig from './sendMessageToSig';\nimport dispatchOnIncomingMessage from './dispatchOnIncomingMessage';\nimport trySendMessage from './trySendMessage';\n\nconst helpers = {\n  getMessageConfig,\n  sendMessageToSig,\n  dispatchOnIncomingMessage,\n  trySendMessage,\n};\n\nexport default helpers;\n","import SkylinkError from '../../../utils/skylinkError';\nimport messagingHelpers from './index';\nimport MESSAGES from '../../../messages';\n\nconst trySendMessage = (roomState, message, targetPeerId) => {\n  try {\n    const config = messagingHelpers.getMessageConfig(roomState, targetPeerId);\n    messagingHelpers.sendMessageToSig(roomState, config, message, null, targetPeerId);\n  } catch (error) {\n    SkylinkError.throwError(MESSAGES.MESSAGING.ERRORS.FAILED_SENDING_MESSAGE);\n  }\n};\n\nexport default trySendMessage;\n","import deleteEncryptSecrets from './deleteEncryptSecrets';\nimport setEncryptSecret from './setEncryptSecrets';\nimport utils from './utils';\nimport setSelectedSecretId from './setSelectedSecretId';\nimport getMessageConfig from './getMessageConfig';\nimport encryptMessage from './encryptMessage';\nimport tryDecryptMessage from './tryDecryptMessage';\n\nconst helpers = {\n  deleteEncryptSecrets,\n  setEncryptSecret,\n  setSelectedSecretId,\n  utils,\n  getMessageConfig,\n  encryptMessage,\n  tryDecryptMessage,\n};\n\nexport default helpers;\n","import messagingHelpers from '../../helpers/index';\nimport encryptHelpers from './index';\n\nconst getMessageConfig = (roomState, targetPeerId, encryptSecrets, selectedSecretId, isPersistent) => {\n  const config = messagingHelpers.getMessageConfig(roomState, targetPeerId);\n\n  if (encryptHelpers.utils.hasCrypto() && encryptHelpers.utils.canEncrypt(selectedSecretId, encryptSecrets)) {\n    config.secretId = selectedSecretId;\n  }\n\n  if (isPersistent) {\n    config.isPersistent = isPersistent;\n  }\n\n  return config;\n};\n\nexport default getMessageConfig;\n","import CryptoJS from 'crypto-js';\nimport MESSAGES from '../../../../messages';\n\nconst encryptMessage = (message, secret, decrypt = false) => {\n  if (decrypt) {\n    try {\n      const decipher = CryptoJS.AES.decrypt(message, secret);\n\n      return decipher.toString(CryptoJS.enc.Utf8);\n    } catch (error) {\n      throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.ENCRYPT_SECRET);\n    }\n  }\n\n  const cipher = CryptoJS.AES.encrypt(message, secret);\n\n  return cipher.toString();\n};\n\nexport default encryptMessage;\n","import encryptHelpers from './index';\nimport { isEmptyString } from '../../../../utils/helpers';\nimport MESSAGES from '../../../../messages';\n\nconst tryDecryptMessage = (message, secretId, encryptSecrets) => {\n  const decryptedMessage = encryptHelpers.encryptMessage(message, encryptSecrets[secretId], true);\n  if (isEmptyString(decryptedMessage)) {\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.ENCRYPT_SECRET);\n  } else {\n    return decryptedMessage;\n  }\n};\n\nexport default tryDecryptMessage;\n","import encryptHelpers from './helpers/index';\nimport messagingHelpers from '../helpers/index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { encryptionSecretsUpdated } from '../../../skylink-events';\nimport MESSAGES from '../../../messages';\nimport getUserInfo from '../../../peer-data/helpers/getUserInfo';\nimport { getParamValidity, getRoomStateByName } from '../../../utils/helpers';\nimport SkylinkError from '../../../utils/skylinkError';\nimport logger from '../../../logger';\nimport { TAGS } from '../../../constants';\n\nconst instance = {};\n/**\n * @classdesc Class used for handling encryption\n * @class\n * @private\n */\nclass EncryptedMessaging {\n  constructor(roomState) {\n    const { room, user } = roomState;\n\n    if (!instance[room.id]) {\n      instance[room.id] = this;\n    }\n\n    this.room = room;\n    this.peerId = user.sid;\n\n    /**\n     * The secret id and encrypt secret key-value pair.\n     * @type {Object|{}}\n     */\n    this.encryptSecrets = {};\n\n    /**\n     * The selected secret id.\n     * @type {String}\n     */\n    this.selectedSecretId = '';\n\n    return instance[room.id];\n  }\n\n  setEncryptSecret(secret, secretId) {\n    try {\n      this.encryptSecrets = encryptHelpers.setEncryptSecret(this.encryptSecrets, secret, secretId);\n      this.dispatchEncryptSecretEvent();\n    } catch (error) {\n      SkylinkError.throwError(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SET_ENCRYPT_SECRET, error.message);\n    }\n  }\n\n  getEncryptSecrets() {\n    return this.encryptSecrets;\n  }\n\n  deleteEncryptSecrets(secretId) {\n    try {\n      const updatedData = encryptHelpers.deleteEncryptSecrets(this.encryptSecrets, this.selectedSecretId, secretId);\n      this.encryptSecrets = updatedData.encryptSecrets;\n      this.selectedSecretId = updatedData.selectedSecretId;\n      this.dispatchEncryptSecretEvent();\n    } catch (error) {\n      SkylinkError.throwError(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.DELETE_ENCRYPT_SECRETS, error.message);\n    }\n  }\n\n  setSelectedSecretId(secretId) {\n    try {\n      this.selectedSecretId = encryptHelpers.setSelectedSecretId(this.encryptSecrets, secretId);\n      this.dispatchEncryptSecretEvent();\n    } catch (error) {\n      SkylinkError.throwError(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SET_SELECTED_SECRET, error.message);\n    }\n  }\n\n  getSelectedSecretId() {\n    return this.selectedSecretId;\n  }\n\n  dispatchEncryptSecretEvent() {\n    dispatchEvent(encryptionSecretsUpdated({\n      room: this.room,\n      encryptSecrets: this.encryptSecrets,\n      selectedSecretId: this.selectedSecretId,\n      peerInfo: getUserInfo(this.room),\n      peerId: this.peerId,\n    }));\n  }\n\n  canEncrypt(throwError) {\n    try {\n      if (encryptHelpers.utils.canEncrypt(this.selectedSecretId, this.encryptSecrets)) {\n        return encryptHelpers.utils.isValidString(this.selectedSecretId) && encryptHelpers.utils.isValidString(this.encryptSecrets[this.selectedSecretId]);\n      }\n\n      return false;\n    } catch (err) {\n      if (throwError) {\n        throw new Error(err.message);\n      }\n      return false;\n    }\n  }\n\n  decryptStoredMessages(message, secretId) {\n    if (encryptHelpers.utils.canEncrypt(secretId, this.encryptSecrets) && !Object.keys(this.encryptSecrets).filter(key => key === secretId).length) {\n      throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.SECRET_ID_NOT_FOUND);\n    }\n\n    return this.decryptMessage(message, secretId);\n  }\n\n  decryptMessage(message, secretId = '') {\n    if (secretId && encryptHelpers.utils.canDecrypt(this.encryptSecrets)) {\n      return encryptHelpers.tryDecryptMessage(message, secretId, this.encryptSecrets);\n    }\n\n    throw new Error(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.INVALID_SECRETS);\n  }\n\n  sendMessage(roomName, message, targetPeerId, isPersistent = false) {\n    const roomState = getRoomStateByName(roomName);\n    if (getParamValidity(message, 'message', 'sendMessage') && roomState) {\n      try {\n        logger.log.DEBUG([null, TAGS.ASYNC_MESSAGING, null, MESSAGES.MESSAGING.ENCRYPTION.SEND_MESSAGE]);\n        const config = encryptHelpers.getMessageConfig(roomState, targetPeerId, this.encryptSecrets, this.selectedSecretId, isPersistent);\n        const encryptedMessage = encryptHelpers.encryptMessage(message, this.encryptSecrets[this.selectedSecretId]);\n        messagingHelpers.sendMessageToSig(roomState, config, message, encryptedMessage, targetPeerId);\n      } catch (error) {\n        SkylinkError.throwError(MESSAGES.MESSAGING.ERRORS.DROPPING_MESSAGE, error.message);\n      }\n    }\n  }\n\n  static deleteEncryptedInstance(room) {\n    delete instance[room.id];\n  }\n}\n\nexport default EncryptedMessaging;\n","import getMessageConfig from './getMessageConfig';\nimport parseDecryptedMessageData from './parseDecryptedMessageData';\n\nconst helpers = {\n  getMessageConfig,\n  parseDecryptedMessageData,\n};\n\nexport default helpers;\n","import encryptHelpers from '../../encrypted-messaging/helpers';\n\nconst getMessageConfig = (roomState, targetPeerId) => {\n  const config = encryptHelpers.getMessageConfig(roomState, targetPeerId);\n  config.isPersistent = true;\n\n  return config;\n};\n\nexport default getMessageConfig;\n","import { parseUNIXTimeStamp } from '../../../../utils/helpers';\n\nconst parseDecryptedMessageData = (message, targetMid) => ({\n  targetPeerId: targetMid,\n  senderPeerId: message.mid,\n  content: message.data,\n  timeStamp: parseUNIXTimeStamp(message.timeStamp),\n  isPrivate: false,\n  isDataChannel: false,\n});\n\nexport default parseDecryptedMessageData;\n","import { TAGS } from '../../../constants';\nimport logger from '../../../logger';\nimport MESSAGES from '../../../messages';\nimport SkylinkSignalingServer from '../../../server-communication/signaling-server';\nimport {\n  getParamValidity, getRoomStateByName, isABoolean, isEmptyArray,\n} from '../../../utils/helpers';\nimport SkylinkError from '../../../utils/skylinkError';\nimport Skylink from '../../../index';\nimport EncryptedMessaging from '../encrypted-messaging';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { storedMessages, persistentMessageState } from '../../../skylink-events';\nimport PeerData from '../../../peer-data';\nimport asyncHelpers from './helpers/index';\nimport getUserInfo from '../../../peer-data/helpers/getUserInfo';\n\nconst instance = {};\n\n/**\n * @classdesc Class used for handling the asynchronous messaging feature\n * @class\n * @private\n */\nclass AsyncMessaging {\n  constructor(roomState) {\n    const { user, room, hasPersistentMessage } = roomState;\n\n    if (!instance[room.id]) {\n      instance[room.id] = this;\n    }\n\n    this.room = room;\n    this.peerId = user.sid;\n    this.isPersistent = hasPersistentMessage; // Value defaults to hasPersistentMessage\n    this.hasPersistentMessage = hasPersistentMessage;\n\n    return instance[room.id];\n  }\n\n  setMessagePersistence(isPersistent) {\n    if (!isABoolean(isPersistent)) {\n      throw SkylinkError.throwError(MESSAGES.MESSAGING.PERSISTENCE.ERRORS.FAILED_SETTING_PERSISTENCE, MESSAGES.MESSAGING.PERSISTENCE.ERRORS.INVALID_TYPE);\n    } else if (!this.hasPersistentMessage) {\n      this.isPersistent = isPersistent;\n      throw SkylinkError.throwError(MESSAGES.MESSAGING.PERSISTENCE.ERRORS.PERSISTENT_MESSAGE_FEATURE_NOT_ENABLED);\n    }\n\n    this.isPersistent = isPersistent;\n\n    dispatchEvent(persistentMessageState({\n      room: this.room,\n      isPersistent: this.isPersistent,\n      peerInfo: getUserInfo(this.room),\n      peerId: this.peerId,\n    }));\n  }\n\n  getMessagePersistence() {\n    return this.isPersistent;\n  }\n\n  sendMessage(roomName, message, targetPeerId) {\n    const roomState = getRoomStateByName(roomName);\n    const isPublicMessage = !targetPeerId || (Array.isArray(targetPeerId) && isEmptyArray(targetPeerId));\n    if (getParamValidity(message, 'message', 'sendMessage') && roomState) {\n      try {\n        logger.log.DEBUG([null, TAGS.ASYNC_MESSAGING, null, MESSAGES.MESSAGING.PERSISTENCE.SEND_MESSAGE]);\n        const encryptedMessaging = new EncryptedMessaging(roomState);\n        if (!isPublicMessage) {\n          throw new Error(MESSAGES.MESSAGING.PERSISTENCE.ERRORS.PRIVATE_MESSAGE);\n        }\n\n        if (encryptedMessaging.canEncrypt(true)) {\n          encryptedMessaging.sendMessage(roomName, message, targetPeerId, this.isPersistent);\n        }\n      } catch (error) {\n        SkylinkError.throwError(MESSAGES.MESSAGING.ERRORS.DROPPING_MESSAGE, error.message);\n      }\n    }\n  }\n\n  getStoredMessages() {\n    const roomState = Skylink.getSkylinkState(this.room.id);\n    if (!this.hasPersistentMessage) {\n      logger.log.WARN([this.peerId, TAGS.ASYNC_MESSAGING, null, `${MESSAGES.MESSAGING.PERSISTENCE.ERRORS.PERSISTENT_MESSAGE_FEATURE_NOT_ENABLED}`]);\n      return;\n    }\n\n    new SkylinkSignalingServer().getStoredMessages(roomState);\n  }\n\n  canPersist() {\n    if (this.hasPersistentMessage) {\n      if (this.isPersistent) {\n        return true;\n      }\n\n      logger.log.DEBUG([null, TAGS.ASYNC_MESSAGING, null, MESSAGES.MESSAGING.PERSISTENCE.NOT_PERSISTED]);\n      return false;\n    }\n\n    if (this.isPersistent) {\n      logger.log.DEBUG([null, TAGS.ASYNC_MESSAGING, null, `${MESSAGES.MESSAGING.PERSISTENCE.IS_PERSISTENT_CONFIG} ${this.isPersistent}`]);\n      throw new Error(MESSAGES.MESSAGING.PERSISTENCE.ERRORS.PERSISTENT_MESSAGE_FEATURE_NOT_ENABLED);\n    }\n\n    return false;\n  }\n\n  static processStoredMessages(message) {\n    const roomState = Skylink.getSkylinkState(message.rid);\n    const { room } = roomState;\n    const targetMid = message.mid;\n    const messageData = JSON.parse(message.data);\n    const encryptedMessaging = new EncryptedMessaging(roomState);\n    const messages = [];\n\n    logger.log.DEBUG([targetMid, TAGS.ASYNC_MESSAGING, null, MESSAGES.MESSAGING.PERSISTENCE.STORED_MESSAGES], messageData);\n\n    try {\n      for (let i = 0; i < messageData.length; i += 1) {\n        messageData[i].data = encryptedMessaging.decryptStoredMessages(messageData[i].data, messageData[i].secretId);\n        messages.push(asyncHelpers.parseDecryptedMessageData(messageData[i], targetMid));\n      }\n    } catch (error) {\n      throw SkylinkError.throwError(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.FAILED_DECRYPTING_MESSAGE, error.message);\n    }\n\n    dispatchEvent(storedMessages({\n      room,\n      storedMessages: messages,\n      isSelf: false,\n      peerId: targetMid,\n      peerInfo: PeerData.getPeerInfo(targetMid, room),\n    }));\n  }\n\n  static deleteAsyncInstance(room) {\n    delete instance[room.id];\n  }\n}\n\nexport default AsyncMessaging;\n","import {\n  getParamValidity, getRoomStateByName, isABoolean,\n} from '../../utils/helpers';\nimport PeerConnection from '../../peer-connection';\nimport MESSAGES from '../../messages';\nimport EncryptedMessaging from './encrypted-messaging';\nimport AsyncMessaging from './async-messaging';\nimport messagingHelpers from './helpers';\nimport Skylink from '../../index';\nimport SkylinkError from '../../utils/skylinkError';\n\n/**\n * @classdesc Class that manages the messaging feature\n * @class\n * @private\n */\nclass Messaging {\n  static sendMessage(roomName, message, targetPeerId) {\n    const roomState = getRoomStateByName(roomName);\n    if (getParamValidity(message, 'message', 'sendMessage') && roomState) {\n      const encryptedMessaging = new EncryptedMessaging(roomState);\n      const asyncMessaging = new AsyncMessaging(roomState);\n      if (asyncMessaging.canPersist()) {\n        asyncMessaging.sendMessage(roomName, message, targetPeerId);\n      } else if (encryptedMessaging.canEncrypt()) {\n        encryptedMessaging.sendMessage(roomName, message, targetPeerId);\n      } else {\n        messagingHelpers.trySendMessage(roomState, message, targetPeerId);\n      }\n    }\n  }\n\n  static sendP2PMessage(roomName, message, targetPeerId) {\n    const roomState = getRoomStateByName(roomName);\n    if (getParamValidity(message, 'message', 'sendP2PMessage') && roomState) {\n      PeerConnection.sendP2PMessage(roomName, message, targetPeerId);\n    }\n  }\n\n  static processMessage(message, isPublic) {\n    const {\n      mid,\n      target,\n      rid,\n      secretId,\n      data,\n    } = message;\n    const roomState = Skylink.getSkylinkState(rid);\n    const targetMid = mid;\n\n    let messageData = data;\n    if (secretId) {\n      try {\n        const encryptedMessaging = new EncryptedMessaging(roomState);\n        messageData = encryptedMessaging.decryptMessage(data, secretId);\n      } catch (error) {\n        SkylinkError.throwError(MESSAGES.MESSAGING.ENCRYPTION.ERRORS.FAILED_DECRYPTING_MESSAGE, error.message);\n      }\n    }\n\n    messagingHelpers.dispatchOnIncomingMessage(roomState, { isPrivate: isABoolean(isPublic) ? !isPublic : !!target }, messageData, false, targetMid);\n  }\n}\n\nexport default Messaging;\n","import Messaging from '../../../../features/messaging';\n\nconst userMessageHandler = (message, isPublic) => {\n  Messaging.processMessage(message, isPublic);\n};\n\nexport default userMessageHandler;\n","import MESSAGES from '../messages';\nimport logger from '../logger';\nimport { READY_STATE_CHANGE_ERROR } from '../constants';\n\n/**\n * @private\n * @description Checks for the dependencies required for SkylinkJS\n * @memberOf module:Compatibility\n * @return {{fulfilled: boolean, message: string}}\n */\nconst validateDepencies = () => {\n  const dependencies = {\n    fulfilled: true,\n    message: '',\n  };\n  const { AdapterJS, io, fetch } = window;\n  if (typeof (AdapterJS || window.AdapterJS || window.AdapterJS || {}).webRTCReady !== 'function') {\n    dependencies.message = MESSAGES.INIT.ERRORS.NO_ADAPTER;\n    dependencies.fulfilled = false;\n    dependencies.readyStateChangeErrorCode = READY_STATE_CHANGE_ERROR.ADAPTER_NO_LOADED;\n  } else if (!(io || window.io)) {\n    dependencies.message = MESSAGES.INIT.ERRORS.NO_SOCKET_IO;\n    dependencies.fulfilled = false;\n    dependencies.readyStateChangeErrorCode = READY_STATE_CHANGE_ERROR.NO_SOCKET_IO;\n  } else if (!fetch || !window.fetch) {\n    dependencies.message = MESSAGES.INIT.ERRORS.NO_FETCH_SUPPORT;\n    dependencies.fulfilled = false;\n    dependencies.readyStateChangeErrorCode = READY_STATE_CHANGE_ERROR.NO_XMLHTTPREQUEST_SUPPORT;\n  }\n  if (!dependencies.fulfilled) {\n    logger.log.ERROR(['Validating Dependencies', null, null, dependencies.message]);\n  }\n  return dependencies;\n};\n\nexport default validateDepencies;\n","/**\n * @description Gets TCP and UDP ports based on the browser\n * @param {Object} params\n * @param {boolean} params.forceTURNSSL\n * @param {boolean} params.enableTURNServer\n * @param {enum} params.CONSTANTS\n * @memberOf module:Compatibility\n * @return {{tcp: Array, udp: Array, both: Array, iceServerProtocol: string}}\n */\nconst getConnectionPortsAndProtocolByBrowser = (params) => {\n  const { forceTURNSSL, CONSTANTS, serverConfig } = params;\n  const { AdapterJS } = window;\n  const connectionConfig = {\n    tcp: serverConfig.iceServerPorts.tcp,\n    udp: serverConfig.iceServerPorts.udp,\n    both: serverConfig.iceServerPorts.both,\n    iceServerProtocol: serverConfig.iceServerProtocol,\n    iceServerPorts: serverConfig.iceServerPorts,\n  };\n\n  if (AdapterJS.webrtcDetectedBrowser === 'edge') {\n    connectionConfig.tcp = [];\n    connectionConfig.udp = [3478];\n    connectionConfig.iceServerPorts.both = [];\n    connectionConfig.iceServerProtocol = CONSTANTS.TURN;\n  } else if (forceTURNSSL) {\n    if (AdapterJS.webrtcDetectedBrowser === 'firefox' && AdapterJS.webrtcDetectedVersion < 53) {\n      connectionConfig.udp = [];\n      connectionConfig.tcp = [443];\n      connectionConfig.both = [];\n      connectionConfig.iceServerProtocol = CONSTANTS.TURN;\n    } else {\n      connectionConfig.iceServerPorts.udp = [];\n      connectionConfig.iceServerProtocol = 'turns';\n    }\n  } else if (AdapterJS.webrtcDetectedBrowser === 'firefox') {\n    connectionConfig.udp = [3478];\n    connectionConfig.tcp = [443, 80];\n    connectionConfig.both = [];\n  }\n\n  return connectionConfig;\n};\n\nexport default getConnectionPortsAndProtocolByBrowser;\n","/**\n * @description Function that updates the removeStream method for Firefox.\n * @param peerConnection\n * @return {Function}\n * @memberOf module:Compatibility\n */\nconst updateRemoveStream = (peerConnection) => {\n  const { getSenders, removeTrack } = peerConnection;\n\n  return (stream) => {\n    const { getTracks } = stream;\n    const senders = getSenders();\n\n    for (let s = 0; s < senders.length; s += 1) {\n      const tracks = getTracks();\n      for (let t = 0; t < tracks.length; t += 1) {\n        if (tracks[t] === senders[s].track) {\n          removeTrack(senders[s]);\n        }\n      }\n    }\n  };\n};\n\nexport default updateRemoveStream;\n","import { getConnectionPortsAndProtocolByBrowser } from '../../compatibility/index';\nimport { TURN_TRANSPORT } from '../../constants';\nimport Skylink from '../../index';\n\nconst defaultIceServerPorts = {\n  udp: [3478, 19302, 19303, 19304],\n  tcp: [80, 443],\n  both: [19305, 19306, 19307, 19308],\n};\n\nconst CONSTANTS = {\n  STUN: 'stun',\n  TURN: 'turn',\n  TEMASYS: 'temasys',\n  DEFAULT_TURN_SERVER: 'turn.temasys.io',\n  TCP: 'TCP',\n  UDP: 'UDP',\n};\n\nconst userIceServer = (iceServer, serverConfig) => {\n  const { urls } = iceServer;\n  return [{\n    urls,\n    username: serverConfig.iceServers[1].username || null,\n    credential: serverConfig.iceServers[1].credential || null,\n  }];\n};\n\nconst getConnectionPortsByTurnTransport = (params) => {\n  const {\n    TURNServerTransport,\n    forceTURNSSL,\n    udp,\n    tcp,\n    both,\n  } = params;\n  const ports = {\n    udp: [],\n    tcp: [],\n    both: [],\n  };\n  if (TURNServerTransport === TURN_TRANSPORT.UDP && !forceTURNSSL) {\n    ports.udp = udp.concat(both);\n    ports.tcp = [];\n    ports.both = [];\n  } else if (TURNServerTransport === TURN_TRANSPORT.TCP) {\n    ports.tcp = tcp.concat(both);\n    ports.udp = [];\n    ports.both = [];\n  } else if (TURNServerTransport === TURN_TRANSPORT.NONE) {\n    ports.tcp = [];\n    ports.udp = [];\n  } else {\n    ports.tcp = tcp;\n    ports.udp = udp;\n    ports.both = both;\n  }\n  return ports;\n};\n\nconst getIceServerPorts = () => defaultIceServerPorts;\n\n/**\n * @param {RTCIceServer[]} servers - The list of IceServers passed | {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer}\n * @memberOf IceConnectionHelpers\n * @private\n * @return {filteredIceServers}\n */\nconst setIceServers = (servers) => {\n  const initOptions = Skylink.getInitOptions();\n  const serverConfig = {\n    iceServerName: null,\n    iceServerPorts: getIceServerPorts(),\n    iceServerProtocol: CONSTANTS.STUN,\n    iceServers: [{ urls: [] }, { urls: [] }],\n  };\n\n  const {\n    iceServer,\n    enableTURNServer,\n    forceTURNSSL,\n    TURNServerTransport,\n    enableSTUNServer,\n    usePublicSTUN,\n  } = initOptions;\n\n  servers.forEach((server) => {\n    if (server.url.indexOf(`${CONSTANTS.STUN}:`) === 0) {\n      if (server.url.indexOf(`${CONSTANTS.TEMASYS}`) > 0) {\n        // server[?transport=xxx]\n        serverConfig.iceServerName = (server.url.split(':')[1] || '').split('?')[0] || null;\n      } else {\n        serverConfig.iceServers[0].urls.push(server.url);\n      }\n    } else if (server.url.indexOf('turn:') === 0 && server.url.indexOf('@') > 0 && server.credential && !(serverConfig.iceServers[1].username || serverConfig.iceServers[1].credential)) {\n      /* eslint-disable prefer-destructuring */\n      const parts = server.url.split(':');\n      const urlParts = (parts[1] || '').split('@');\n      serverConfig.iceServerName = (urlParts[1] || '').split('?')[0];\n      serverConfig.iceServers[1].username = urlParts[0];\n      serverConfig.iceServers[1].credential = server.credential;\n      serverConfig.iceServerProtocol = CONSTANTS.TURN;\n    }\n  });\n\n  if (iceServer) {\n    return { iceServers: userIceServer(iceServer, serverConfig) };\n  }\n\n  serverConfig.iceServerName = serverConfig.iceServerName || CONSTANTS.DEFAULT_TURN_SERVER;\n\n  if (serverConfig.iceServerProtocol === CONSTANTS.TURN && !enableTURNServer && !forceTURNSSL) {\n    serverConfig.iceServerProtocol = CONSTANTS.STUN;\n  } else {\n    const connectionPortsAndProtocolByBrowser = getConnectionPortsAndProtocolByBrowser({\n      forceTURNSSL,\n      enableTURNServer,\n      CONSTANTS,\n      serverConfig,\n    });\n    serverConfig.iceServerPorts.tcp = connectionPortsAndProtocolByBrowser.tcp;\n    serverConfig.iceServerPorts.udp = connectionPortsAndProtocolByBrowser.udp;\n    serverConfig.iceServerPorts.both = connectionPortsAndProtocolByBrowser.both;\n    serverConfig.iceServerProtocol = connectionPortsAndProtocolByBrowser.iceServerProtocol;\n  }\n\n  const connectionPortsByTurnTransport = getConnectionPortsByTurnTransport({\n    forceTURNSSL,\n    TURNServerTransport,\n    udp: serverConfig.iceServerPorts.udp,\n    tcp: serverConfig.iceServerPorts.tcp,\n    both: serverConfig.iceServerPorts.both,\n  });\n\n  serverConfig.iceServerPorts.tcp = connectionPortsByTurnTransport.tcp;\n  serverConfig.iceServerPorts.udp = connectionPortsByTurnTransport.udp;\n  serverConfig.iceServerPorts.both = connectionPortsByTurnTransport.both;\n\n  if (serverConfig.iceServerProtocol === CONSTANTS.STUN) {\n    serverConfig.iceServerPorts.tcp = [];\n  }\n\n  if (serverConfig.iceServerProtocol === CONSTANTS.STUN && !enableSTUNServer) {\n    serverConfig.iceServers = [];\n  } else {\n    serverConfig.iceServerPorts.tcp.forEach((tcpPort) => {\n      serverConfig.iceServers[1].urls.push(`${serverConfig.iceServerProtocol}:${serverConfig.iceServerName}:${tcpPort}?transport=tcp`);\n    });\n\n    serverConfig.iceServerPorts.udp.forEach((udpPort) => {\n      serverConfig.iceServers[1].urls.push(`${serverConfig.iceServerProtocol}:${serverConfig.iceServerName}:${udpPort}?transport=udp`);\n    });\n\n    serverConfig.iceServerPorts.both.forEach((bothPort) => {\n      serverConfig.iceServers[1].urls.push(`${serverConfig.iceServerProtocol}:${serverConfig.iceServerName}:${bothPort}`);\n    });\n\n    if (!usePublicSTUN) {\n      serverConfig.iceServers.splice(0, 1);\n    }\n\n    return {\n      iceServers: serverConfig.iceServers,\n    };\n  }\n  return null;\n};\n\nexport default setIceServers;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport messages from '../../messages';\nimport * as constants from '../../constants';\nimport PeerConnection from '../../peer-connection';\nimport IceConnection from '../index';\nimport { isLowerThanVersion } from '../../utils/helpers';\n\n/**\n * @param {String} targetMid\n * @param {SkylinkRoom} room\n * @memberOf IceConnectionHelpers\n * @private\n */\nconst addIceCandidateFromQueue = (targetMid, room) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const peerCandidatesQueue = state.peerCandidatesQueue[targetMid] || [];\n  const peerConnection = state.peerConnections[targetMid];\n  const { AdapterJS } = window;\n  const { TAGS, PEER_CONNECTION_STATE } = constants;\n\n  for (let i = 0; i < peerCandidatesQueue.length; i += 1) {\n    const candidateArray = peerCandidatesQueue[i];\n\n    if (candidateArray) {\n      const nativeCandidate = candidateArray[1];\n      const candidateId = candidateArray[0];\n      const candidateType = nativeCandidate.candidate.split(' ')[7];\n      logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, `${candidateId}:${candidateType}`, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.ADD_BUFFERED_CANDIDATE]);\n      IceConnection.addIceCandidate(targetMid, candidateId, candidateType, nativeCandidate, state);\n    } else if (peerConnection && peerConnection.signalingState !== PEER_CONNECTION_STATE.CLOSED && AdapterJS && isLowerThanVersion(AdapterJS.VERSION, '0.14.0')) {\n      try {\n        peerConnection.addIceCandidate(null);\n        logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, null, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.END_OF_CANDIDATES_SUCCESS]);\n      } catch (ex) {\n        logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, null, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.END_OF_CANDIDATES_FAILURE]);\n      }\n    }\n  }\n\n  delete state.peerCandidatesQueue[targetMid];\n  PeerConnection.signalingEndOfCandidates(targetMid, state);\n};\n\nexport default addIceCandidateFromQueue;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\n\nclass HandleIceCandidateStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      peer_id: null,\n      state: null,\n      is_remote: false,\n      candidate_id: null,\n      candidate_sdp_mid: null,\n      candidate_sdp_mindex: null,\n      candidate_candidate: null,\n      error: null,\n    };\n  }\n\n  send(roomKey, state, peerId, candidateId, candidate, error) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.peer_id = peerId;\n    this.model.client_id = roomState.clientId;\n    this.model.state = state;\n    this.model.is_remote = !!candidateId;\n    this.model.candidate_id = candidateId || null;\n    this.model.candidate_sdp_mid = candidate.sdpMid;\n    this.model.candidate_sdp_mindex = candidate.sdpMLineIndex;\n    this.model.candidate_candidate = candidate.candidate;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.model.error = (typeof error === 'string' ? error : (error && error.message)) || null;\n\n    this.addToStatsBuffer('iceCandidate', this.model, this.endpoints.iceCandidate);\n    this.manageStatsBuffer();\n  }\n}\n\nexport default HandleIceCandidateStats;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport { candidateProcessingState } from '../../skylink-events';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport * as constants from '../../constants';\nimport messages from '../../messages';\nimport HandleIceCandidateStats from '../../skylink-stats/handleIceCandidateStats';\n\nconst handleIceCandidateStats = new HandleIceCandidateStats();\n\n/**\n * Success callback for adding an IceCandidate\n * @param {SkylinkRoom} room - The current room\n * @param {String} targetMid - The mid of the target peer\n * @param {String} candidateId - The id of the ICE Candidate\n * @param {String} candidateType - Type of the ICE Candidate\n * @param {RTCIceCandidate} candidate - An RTCIceCandidate Object\n * @fires candidateProcessingState\n * @memberOf IceConnectionHelpers\n * @private\n */\nconst addIceCandidateSuccess = (room, targetMid, candidateId, candidateType, candidate) => {\n  const { STATS_MODULE, ICE_CANDIDATE } = messages;\n  const { CANDIDATE_PROCESSING_STATE, TAGS } = constants;\n\n  logger.log.INFO([targetMid, TAGS.CANDIDATE_HANDLER, `${candidateId}:${candidateType}`, ICE_CANDIDATE.CANDIDATE_HANDLER.CANDIDATE_ADDED]);\n  dispatchEvent(candidateProcessingState({\n    room,\n    state: CANDIDATE_PROCESSING_STATE.PROCESS_SUCCESS,\n    peerId: targetMid,\n    candidateId,\n    candidateType,\n    candidate,\n    error: null,\n  }));\n  handleIceCandidateStats.send(room.id, STATS_MODULE.HANDLE_ICE_GATHERING_STATS.PROCESS_SUCCESS, targetMid, candidateId, candidate);\n};\n\n/**\n * Failure callback for adding an IceCandidate\n * @param {SkylinkRoom} room - The current room\n * @param {String} targetMid - The mid of the target peer\n * @param {String} candidateId - The id of the ICE Candidate\n * @param {String} candidateType - Type of the ICE Candidate\n * @param {RTCIceCandidate} candidate - An RTCIceCandidate Object\n * @param {Error} error - Error\n * @fires candidateProcessingState\n * @memberOf IceConnectionHelpers\n * @private\n */\nconst addIceCandidateFailure = (room, targetMid, candidateId, candidateType, candidate, error) => {\n  const { STATS_MODULE, ICE_CANDIDATE } = messages;\n  const { CANDIDATE_PROCESSING_STATE, TAGS } = constants;\n\n  logger.log.ERROR([targetMid, TAGS.CANDIDATE_HANDLER, `${candidateId}:${candidateType}`, ICE_CANDIDATE.CANDIDATE_HANDLER.FAILED_ADDING_CANDIDATE], error);\n  dispatchEvent(candidateProcessingState({\n    room,\n    state: CANDIDATE_PROCESSING_STATE.PROCESS_ERROR,\n    peerId: targetMid,\n    candidateId,\n    candidateType,\n    candidate,\n    error,\n  }));\n  handleIceCandidateStats.send(room.id, STATS_MODULE.HANDLE_ICE_GATHERING_STATS.PROCESS_FAILED, targetMid, candidateId, candidate, error);\n};\n\n/**\n * @param {String} targetMid - The mid of the target peer\n * @param {String} candidateId - The id of the ICE Candidate\n * @param {String} candidateType - Type of the ICE Candidate\n * @param {RTCIceCandidate} nativeCandidate - An RTCIceCandidate Object\n * @param {SkylinkState} roomState - Skylink State\n * @fires candidateProcessingState\n * @memberOf IceConnectionHelpers\n * @private\n */\nconst addIceCandidate = (targetMid, candidateId, candidateType, nativeCandidate, roomState) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { peerConnections, room } = state;\n  const peerConnection = peerConnections[targetMid];\n  const candidate = {\n    candidate: nativeCandidate.candidate,\n    sdpMid: nativeCandidate.sdpMid,\n    sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n  };\n  const { STATS_MODULE, ICE_CANDIDATE, PEER_CONNECTION } = messages;\n  const { CANDIDATE_PROCESSING_STATE, PEER_CONNECTION_STATE, TAGS } = constants;\n\n  logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, `${candidateId}:${candidateType}`, ICE_CANDIDATE.CANDIDATE_HANDLER.ADDING_CANDIDATE]);\n  dispatchEvent(candidateProcessingState({\n    peerId: targetMid,\n    room,\n    candidateType,\n    candidate,\n    candidateId,\n    state: CANDIDATE_PROCESSING_STATE.PROCESSING,\n    error: null,\n  }));\n  handleIceCandidateStats.send(room.id, STATS_MODULE.HANDLE_ICE_GATHERING_STATS.PROCESSING, targetMid, candidateId, candidate);\n\n  if (!(peerConnection\n    && peerConnection.signalingState !== PEER_CONNECTION_STATE.CLOSED\n    && peerConnection.remoteDescription\n    && peerConnection.remoteDescription.sdp\n    && peerConnection.remoteDescription.sdp.indexOf(`\\r\\na=mid:${candidate.sdpMid}\\r\\n`) > -1)) {\n    logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, `${candidateId}:${candidateType}`, `${ICE_CANDIDATE.CANDIDATE_HANDLER.DROPPING_CANDIDATE} - ${PEER_CONNECTION.NO_PEER_CONNECTION}`]);\n\n    dispatchEvent(candidateProcessingState({\n      peerId: targetMid,\n      room: roomState.room,\n      candidateType,\n      candidate,\n      candidateId,\n      state: constants.CANDIDATE_PROCESSING_STATE.DROPPED,\n      error: new Error(PEER_CONNECTION.NO_PEER_CONNECTION),\n    }));\n    handleIceCandidateStats.send(room.id, STATS_MODULE.HANDLE_ICE_GATHERING_STATS.PROCESS_FAILED, targetMid, candidateId, candidate, PEER_CONNECTION.NO_PEER_CONNECTION);\n  }\n\n  try {\n    peerConnection.addIceCandidate(candidate)\n      .then(() => { addIceCandidateSuccess(room, targetMid, candidateId, candidateType, candidate); })\n      .catch((error) => { addIceCandidateFailure(room, targetMid, candidateId, candidateType, candidate, error); });\n  } catch (error) {\n    addIceCandidateFailure.bind(peerConnection, room, targetMid, candidateId, candidateType, candidate, error);\n  }\n};\n\nexport default addIceCandidate;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\n\nclass HandleIceGatheringStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      peer_id: null,\n      state: null,\n      is_remote: null,\n      bundlePolicy: null,\n      rtcpMuxPolicy: null,\n    };\n  }\n\n  send(roomkey, state, peerId, isRemote) {\n    const roomState = Skylink.getSkylinkState(roomkey);\n\n    this.model.client_id = roomState.clientId;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.model.room_id = roomkey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.peer_id = peerId;\n    this.model.state = state;\n    this.model.is_remote = isRemote;\n    this.model.bundlePolicy = roomState.peerConnectionConfig.bundlePolicy;\n    this.model.rtcpMuxPolicy = roomState.peerConnectionConfig.rtcpMuxPolicy;\n\n    this.addToStatsBuffer('iceGathering', this.model, this.endpoints.iceGathering);\n    this.manageStatsBuffer();\n  }\n}\n\nconst handleIceGatheringStats = new HandleIceGatheringStats();\nexport default handleIceGatheringStats;\n","import setIceServers from './setIceServers';\nimport addIceCandidateFromQueue from './addIceCandidateFromQueue';\nimport addIceCandidate from './addIceCandidate';\nimport onIceCandidate from './onIceCandidate';\nimport addIceCandidateToQueue from './addIceCandidateToQueue';\n\n/**\n * @namespace IceConnectionHelpers\n * @description All helper and utility functions for <code>{@link IceConnection}</code> class are listed here.\n * @private\n * @type {{setIceServers, addIceCandidateFromQueue, addIceCandidate, onIceCandidate, addIceCandidateToQueue}}\n */\nconst helpers = {\n  setIceServers,\n  addIceCandidateFromQueue,\n  addIceCandidate,\n  onIceCandidate,\n  addIceCandidateToQueue,\n};\n\nexport default helpers;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport messages from '../../messages';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { candidateGenerationState } from '../../skylink-events';\nimport SignalingServer from '../../server-communication/signaling-server';\nimport handleIceGatheringStats from '../../skylink-stats/handleIceGatheringStats';\nimport * as constants from '../../constants';\n\n/**\n * @param targetMid - The mid of the target peer\n * @param {RTCIceCandidate} candidate - {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCIceCandidate}\n * @param {SkylinkRoom} currentRoom - Current room\n * @memberOf IceConnectionHelpers\n * @fires candidateGenerationState\n * @private\n * @return {null}\n */\nconst onIceCandidate = (targetMid, candidate, currentRoom) => {\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const initOptions = Skylink.getInitOptions();\n  const peerConnection = state.peerConnections[targetMid];\n  const signalingServer = new SignalingServer();\n  let gatheredCandidates = state.gatheredCandidates[targetMid];\n  const { CANDIDATE_GENERATION_STATE, TAGS } = constants;\n\n  if (!peerConnection) {\n    logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, null, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.no_peer_connection], candidate);\n    return null;\n  }\n\n  if (candidate.candidate) {\n    if (!peerConnection.gathering) {\n      logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, null, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.ICE_GATHERING_STARTED], candidate);\n      peerConnection.gathering = true;\n      peerConnection.gathered = false;\n      dispatchEvent(candidateGenerationState({\n        room: currentRoom,\n        peerId: targetMid,\n        state: constants.CANDIDATE_GENERATION_STATE.GATHERING,\n      }));\n      handleIceGatheringStats.send(currentRoom.id, CANDIDATE_GENERATION_STATE.GATHERING, targetMid, false);\n    }\n\n    const candidateType = candidate.candidate.split(' ')[7];\n    logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, candidateType, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.CANDIDATE_GENERATED], candidate);\n\n    if (candidateType === 'endOfCandidates' || !(peerConnection\n      && peerConnection.localDescription && peerConnection.localDescription.sdp\n      && peerConnection.localDescription.sdp.indexOf(`\\r\\na=mid:${candidate.sdpMid}\\r\\n`) > -1)) {\n      logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, candidateType, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.DROP_EOC], candidate);\n      return null;\n    }\n\n    if (initOptions.filterCandidatesType[candidateType]) {\n      if (!(state.hasMCU && initOptions.forceTURN)) {\n        logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, candidateType, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.FILTERED_CANDIDATE], candidate);\n        return null;\n      }\n\n      logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, candidateType, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.FILTERING_FLAG_NOT_HONOURED], candidate);\n    }\n\n    if (!gatheredCandidates) {\n      gatheredCandidates = {\n        sending: { host: [], srflx: [], relay: [] },\n        receiving: { host: [], srflx: [], relay: [] },\n      };\n    }\n\n    gatheredCandidates.sending[candidateType].push({\n      sdpMid: candidate.sdpMid,\n      sdpMLineIndex: candidate.sdpMLineIndex,\n      candidate: candidate.candidate,\n    });\n\n    state.gatheredCandidates[targetMid] = gatheredCandidates;\n    Skylink.setSkylinkState(state, currentRoom.id);\n\n    logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, candidateType, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.SENDING_CANDIDATE], candidate);\n\n    signalingServer.sendCandidate(targetMid, state, candidate);\n  } else {\n    logger.log.INFO([targetMid, TAGS.CANDIDATE_HANDLER, null, messages.ICE_CANDIDATE.CANDIDATE_HANDLER.ICE_GATHERING_COMPLETED]);\n\n    if (peerConnection.gathered) {\n      return null;\n    }\n\n    peerConnection.gathering = false;\n    peerConnection.gathered = true;\n\n    dispatchEvent(candidateGenerationState({\n      peerId: targetMid,\n      state: constants.CANDIDATE_GENERATION_STATE.COMPLETED,\n      room: currentRoom,\n    }));\n    handleIceGatheringStats.send(currentRoom.id, CANDIDATE_GENERATION_STATE.COMPLETED, targetMid, false);\n\n    if (state.gatheredCandidates[targetMid]) {\n      const sendEndOfCandidates = () => {\n        if (!state.gatheredCandidates[targetMid]) return;\n        const currentState = Skylink.getSkylinkState(currentRoom.id);\n        if (!currentState) {\n          logger.log.WARN([targetMid, TAGS.CANDIDATE_HANDLER, null, `${messages.ICE_CANDIDATE.CANDIDATE_HANDLER.DROP_EOC} peer has left the room`]);\n          return;\n        }\n\n        signalingServer.sendMessage({\n          type: constants.SIG_MESSAGE_TYPE.END_OF_CANDIDATES,\n          noOfExpectedCandidates: state.gatheredCandidates[targetMid].sending.srflx.length + state.gatheredCandidates[targetMid].sending.host.length + state.gatheredCandidates[targetMid].sending.relay.length,\n          mid: state.user.sid,\n          target: targetMid,\n          rid: currentRoom.id,\n        });\n      };\n      setTimeout(sendEndOfCandidates, 6000);\n    }\n  }\n  return null;\n};\n\nexport default onIceCandidate;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport MESSAGES from '../../messages';\nimport { TAGS, CANDIDATE_PROCESSING_STATE } from '../../constants';\nimport HandleIceCandidateStats from '../../skylink-stats/handleIceCandidateStats';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { candidateProcessingState } from '../../skylink-events';\n\n/**\n * Method that buffers candidates\n * @param {String} targetMid\n * @param {String} candidateId\n * @param {String} candidateType\n * @param {RTCIceCandidate} nativeCandidate\n * @param {SkylinkState} state\n * @memberOf IceConnectionHelpers\n * @private\n */\nconst addIceCandidateToQueue = (targetMid, candidateId, candidateType, nativeCandidate, state) => {\n  const { STATS_MODULE: { HANDLE_ICE_GATHERING_STATS } } = MESSAGES;\n  const updatedState = state;\n  const { room } = updatedState;\n  const handleIceCandidateStats = new HandleIceCandidateStats();\n\n  logger.log.DEBUG([targetMid, TAGS.CANDIDATE_HANDLER, `${candidateId}:${candidateType}`, MESSAGES.ICE_CANDIDATE.CANDIDATE_HANDLER.ADD_CANDIDATE_TO_BUFFER]);\n\n  handleIceCandidateStats.send(room.id, HANDLE_ICE_GATHERING_STATS.BUFFERED, targetMid, candidateId, nativeCandidate);\n  dispatchEvent(candidateProcessingState({\n    room,\n    state: CANDIDATE_PROCESSING_STATE.BUFFERED,\n    peerId: targetMid,\n    candidateId,\n    candidateType,\n    candidate: nativeCandidate.candidate,\n    error: null,\n  }));\n\n  updatedState.peerCandidatesQueue[targetMid] = updatedState.peerCandidatesQueue[targetMid] || [];\n  updatedState.peerCandidatesQueue[targetMid].push([candidateId, nativeCandidate]);\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nexport default addIceCandidateToQueue;\n","import helpers from './helpers/index';\n\n/**\n * @classdesc Class representing an IceConnection. Helper methods are listed inside <code>{@link IceConnectionHelpers}</code>.\n * @private\n * @class\n */\nclass IceConnection {\n  /**\n   * @description Function that filters and configures the ICE servers received from Signaling\n   * based on the <code>init()</code> configuration and returns the updated list of ICE servers to be used when constructing Peer connection.\n   * @param {RTCIceServer[]} iceServers - The list of IceServers passed | {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCIceServer}\n   * @return {filteredIceServers}\n   */\n  static setIceServers(iceServers) {\n    return helpers.setIceServers(iceServers);\n  }\n\n  /**\n   * @description Function that adds all the Peer connection buffered ICE candidates received.\n   * This should be called only after the remote session description is received and set.\n   * @param {String} targetMid - The mid of the target peer\n   * @param {SkylinkRoom} room - Current Room\n   */\n  static addIceCandidateFromQueue(targetMid, room) {\n    return helpers.addIceCandidateFromQueue(targetMid, room);\n  }\n\n  static addIceCandidateToQueue(targetMid, candidateId, candidateType, nativeCandidate, state) {\n    return helpers.addIceCandidateToQueue(targetMid, candidateId, candidateType, nativeCandidate, state);\n  }\n\n  /**\n   * Function that adds the ICE candidate to Peer connection.\n   * @param {String} targetMid - The mid of the target peer\n   * @param {String} candidateId - The id of the ICE Candidate\n   * @param {String} candidateType - Type of the ICE Candidate\n   * @param {RTCIceCandidate} nativeCandidate - An RTCIceCandidate Object | {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCIceCandidate}\n   * @param {SkylinkState} roomState - Skylink State\n   * @fires candidateProcessingState\n   */\n  static addIceCandidate(targetMid, candidateId, candidateType, nativeCandidate, roomState) {\n    return helpers.addIceCandidate(targetMid, candidateId, candidateType, nativeCandidate, roomState);\n  }\n\n  /**\n   *\n   * @param targetMid - The mid of the target peer\n   * @param {RTCPeerConnectionIceEvent} rtcIceConnectionEvent - {@link https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnectionIceEvent}\n   * @param {SkylinkRoom} room - Current room\n   * @fires candidateGenerationState\n   * @return {null}\n   */\n  static onIceCandidate(targetMid, rtcIceConnectionEvent, room) {\n    return helpers.onIceCandidate(targetMid, rtcIceConnectionEvent, room);\n  }\n}\n\nexport default IceConnection;\n","import Skylink from '../../../../index';\nimport SkylinkSignalingServer from '../../index';\nimport IceConnection from '../../../../ice-connection/index';\nimport PeerData from '../../../../peer-data';\nimport PeerMedia from '../../../../peer-media/index';\nimport { peerJoined, onIncomingStream } from '../../../../skylink-events';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { hasAudioTrack, hasVideoTrack } from '../../../../utils/helpers';\nimport * as constants from '../../../../constants';\n\n/**\n * Function that handles the \"inRoom\" socket message received.\n * @param {JSON} message\n * @memberOf SignalingMessageHandler\n * @fires peerJoined\n * @fires handshakeProgress\n * @fires onIncomingStream\n */\nconst inRoomHandler = (message) => {\n  const {\n    pc_config: { iceServers },\n    sid,\n    rid,\n    tieBreaker,\n  } = message;\n  const roomState = Skylink.getSkylinkState(rid);\n  const initOptions = Skylink.getInitOptions();\n  const { priorityWeightScheme } = initOptions;\n  const signaling = new SkylinkSignalingServer();\n  let weightAppendValue = 0;\n\n  roomState.room.connection.peerConfig = IceConnection.setIceServers(iceServers);\n  roomState.room.inRoom = true;\n\n  if (priorityWeightScheme === constants.PRIORITY_WEIGHT_SCHEME.AUTO) {\n    weightAppendValue = 0;\n  } else if (priorityWeightScheme === constants.PRIORITY_WEIGHT_SCHEME.ENFORCE_OFFERER) {\n    weightAppendValue = 2e+15;\n  } else {\n    weightAppendValue = -(2e+15);\n  }\n\n  roomState.peerPriorityWeight = tieBreaker + weightAppendValue;\n  roomState.user.sid = sid;\n  roomState.inRoom = true;\n\n  PeerMedia.updatePeerMediaWithUserSid(roomState.room, sid);\n  Skylink.setSkylinkState(roomState, rid);\n\n  dispatchEvent(peerJoined({\n    peerId: roomState.user.sid,\n    peerInfo: PeerData.getCurrentSessionInfo(roomState.room),\n    isSelf: true,\n    room: roomState.room,\n  }));\n\n  if (roomState.streams.userMedia) {\n    const streamIds = Object.keys(roomState.streams.userMedia);\n    streamIds.forEach((streamId) => {\n      const mediaStream = roomState.streams.userMedia[streamId].stream;\n      dispatchEvent(onIncomingStream({\n        stream: mediaStream,\n        streamId: mediaStream.id,\n        peerId: roomState.user.sid,\n        room: roomState.room,\n        isSelf: true,\n        peerInfo: PeerData.getCurrentSessionInfo(roomState.room),\n        isVideo: hasVideoTrack(mediaStream),\n        isAudio: hasAudioTrack(mediaStream),\n      }));\n    });\n  }\n\n  signaling.enterRoom(roomState);\n};\n\nexport default inRoomHandler;\n","import enterAndWelcome from './enterAndWelcome';\nimport parseUserInfo from './parseUserInfo';\n\nconst parsers = {\n  enterAndWelcome,\n  parseUserInfo,\n};\n\nexport default parsers;\n","import clone from 'clone';\nimport Skylink from '../../..';\nimport { PEER_TYPE, SM_PROTOCOL_VERSION, DT_PROTOCOL_VERSION } from '../../../constants';\nimport { isABoolean, isANumber, isAString } from '../../../utils/helpers';\nimport parsers from './index';\n\nconst parseVersion = (version) => {\n  if (!(version && typeof version === 'string')) {\n    return 0;\n  }\n  // E.g. 0.9.6, replace minor \".\" with 0\n  if (version.indexOf('.') > -1) {\n    const parts = version.split('.');\n    if (parts.length > 2) {\n      const majorVer = parts[0] || '0';\n      parts.splice(0, 1);\n      return parseFloat(`${majorVer}.${parts.join('0')}`, 10);\n    }\n    return parseFloat(version || '0', 10);\n  }\n  return parseInt(version || '0', 10);\n};\n\n\nconst enterAndWelcome = (msg) => {\n  const state = Skylink.getSkylinkState(msg.rid);\n  const parsedMsg = {};\n  const { hasMCU } = state;\n  const {\n    rid,\n    mid,\n    enableIceRestart,\n    enableDataChannel,\n    weight,\n    receiveOnly,\n    publishOnly,\n    agent,\n    os,\n    temasysPluginVersion,\n    SMProtocolVersion,\n    DTProtocolVersion,\n    version,\n    parentId,\n    publisherId,\n  } = msg;\n\n  parsedMsg.publisherId = publisherId || null;\n  parsedMsg.rid = rid;\n  parsedMsg.mid = mid;\n  parsedMsg.agent = agent && isAString(agent) ? agent : 'other';\n  parsedMsg.version = parseVersion(version);\n  parsedMsg.SMProtocolVersion = isAString(SMProtocolVersion) ? SMProtocolVersion : SM_PROTOCOL_VERSION;\n  // eslint-disable-next-line no-nested-ternary\n  parsedMsg.DTProtocolVersion = isAString(DTProtocolVersion) ? DTProtocolVersion : (hasMCU || mid === PEER_TYPE.MCU ? DT_PROTOCOL_VERSION : '0.1.0');\n  parsedMsg.weight = isANumber(weight) ? weight : 0;\n  parsedMsg.receiveOnly = receiveOnly && receiveOnly !== false;\n  parsedMsg.enableDataChannel = isABoolean(enableDataChannel) ? enableDataChannel : true;\n  parsedMsg.enableIceRestart = isABoolean(enableIceRestart) ? enableIceRestart : false;\n  parsedMsg.os = os && isAString(os) ? os : null;\n  parsedMsg.temasysPluginVersion = temasysPluginVersion && isAString(temasysPluginVersion) ? temasysPluginVersion : null;\n  parsedMsg.publishOnly = !!publishOnly;\n  parsedMsg.parentId = !!publishOnly && parentId && isAString(parentId) ? parentId : null;\n  parsedMsg.userInfo = parsers.parseUserInfo(state, msg, parsedMsg);\n\n  if (hasMCU) {\n    parsedMsg.peersInRoom = msg.peersInRoom;\n  }\n\n  return clone(parsedMsg);\n};\n\nexport default enterAndWelcome;\n","const parseUserInfo = (state, msg, parsedMsg) => {\n  const info = Object.assign({}, msg.userInfo);\n\n  info.config = info.config ? info.config : {\n    enableDataChannel: parsedMsg.enableDataChannel,\n    enableIceRestart: parsedMsg.enableIceRestart,\n    priorityWeight: parsedMsg.weight,\n    receiveOnly: parsedMsg.receiveOnly,\n    publishOnly: parsedMsg.publishOnly,\n  };\n\n  info.agent = info.agent ? info.agent : {\n    name: parsedMsg.agent,\n    version: parsedMsg.version,\n    os: parsedMsg.os,\n    pluginVersion: parsedMsg.temasysPluginVersion,\n    SMProtocolVersion: parsedMsg.SMProtocolVersion,\n    DTProtocolVersion: parsedMsg.DTProtocolVersion,\n  };\n\n  info.settings = info.settings ? info.settings : {};\n  info.mediaStatus = info.mediaStatus ? info.mediaStatus : {};\n\n  return info;\n};\n\nexport default parseUserInfo;\n","import Skylink from '../../../../../index';\nimport logger from '../../../../../logger';\nimport PeerConnection from '../../../../../peer-connection';\nimport { CALLERS } from './enterAndWelcome';\nimport { peerJoined, handshakeProgress, serverPeerJoined } from '../../../../../skylink-events';\nimport { dispatchEvent } from '../../../../../utils/skylinkEventManager';\nimport PeerData from '../../../../../peer-data';\nimport parsers from '../../../parsers/index';\nimport { PEER_TYPE, SERVER_PEER_TYPE, HANDSHAKE_PROGRESS } from '../../../../../constants';\n\nconst setPeerInformations = (state, peerId, userInfo) => {\n  const { room } = state;\n  // eslint-disable-next-line no-param-reassign\n  state.peerInformations[peerId] = PeerConnection.buildPeerInformations(userInfo, state);\n  Skylink.setSkylinkState(state, room.id);\n};\n\n/**\n * Function that adds a Peer Connection and updates the state(Skylink State).\n * @param {JSON} params\n * @memberOf SignalingMessageHandler\n * @fires serverPeerJoined\n * @fires peerJoined\n * @fires handshakeProgress\n */\nconst processPeer = (params) => {\n  const {\n    currentRoom,\n    targetMid,\n    cert,\n    userInfo,\n    message,\n    caller,\n  } = params;\n  let isNewPeer = false;\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const { hasMCU } = state;\n  const { peerInformations } = state;\n  if ((!peerInformations[targetMid] && !hasMCU) || (hasMCU && targetMid === PEER_TYPE.MCU && !peerInformations.MCU)) {\n    const hasScreenshare = !!userInfo.screenshare;\n    isNewPeer = true;\n    state.peerInformations[targetMid] = PeerConnection.buildPeerInformations(message.userInfo, state);\n\n    const peerBrowser = {\n      agent: userInfo.agent.name,\n      version: userInfo.agent.version,\n      os: userInfo.agent.os,\n    };\n\n    Skylink.setSkylinkState(state, currentRoom.id);\n\n    PeerConnection.addPeer({\n      currentRoom,\n      targetMid,\n      peerBrowser,\n      cert,\n      receiveOnly: message.receiveOnly,\n      hasScreenshare,\n    });\n\n    if (targetMid === PEER_TYPE.MCU) {\n      logger.log.INFO([targetMid, 'RTCPeerConnection', null, 'MCU feature has been enabled']);\n      state.hasMCU = true;\n      dispatchEvent(serverPeerJoined({\n        peerId: targetMid,\n        serverPeerType: SERVER_PEER_TYPE.MCU,\n        room: currentRoom,\n      }));\n    } else {\n      dispatchEvent(peerJoined({\n        peerId: targetMid,\n        peerInfo: PeerData.getPeerInfo(targetMid, currentRoom),\n        isSelf: false,\n        room: currentRoom,\n      }));\n    }\n  }\n\n  state.peerMessagesStamps[targetMid] = state.peerMessagesStamps[targetMid] || {\n    userData: 0,\n    audioMuted: 0,\n    videoMuted: 0,\n  };\n\n  if (caller === CALLERS.WELCOME) {\n    state.peerMessagesStamps[targetMid].hasWelcome = false;\n  }\n\n  if (caller === CALLERS.WELCOME && hasMCU && Array.isArray(message.peersInRoom) && message.peersInRoom.length) {\n    const userId = state.user.sid;\n    for (let peersInRoomIndex = 0; peersInRoomIndex < message.peersInRoom.length; peersInRoomIndex += 1) {\n      const PEER_ID = message.peersInRoom[peersInRoomIndex].mid;\n      if (PEER_ID !== userId) {\n        const parsedMsg = parsers.enterAndWelcome(message.peersInRoom[peersInRoomIndex]);\n        const peerUserInfo = parsedMsg.userInfo;\n        setPeerInformations(state, PEER_ID, peerUserInfo);\n        dispatchEvent(peerJoined({\n          peerId: PEER_ID,\n          peerInfo: PeerData.getPeerInfo(PEER_ID, currentRoom),\n          isSelf: false,\n          room: currentRoom,\n        }));\n      }\n    }\n  } else if (hasMCU && targetMid !== state.user.sid && targetMid !== PEER_TYPE.MCU) {\n    setPeerInformations(state, targetMid, userInfo);\n    dispatchEvent(peerJoined({\n      peerId: targetMid,\n      peerInfo: PeerData.getPeerInfo(targetMid, currentRoom),\n      isSelf: false,\n      room: currentRoom,\n    }));\n  }\n\n  Skylink.setSkylinkState(state, currentRoom.id);\n\n  if (isNewPeer) {\n    dispatchEvent(handshakeProgress({\n      peerId: targetMid,\n      state: HANDSHAKE_PROGRESS.WELCOME,\n      error: null,\n      room: currentRoom,\n    }));\n  }\n};\n\nexport default processPeer;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\nimport PeerData from '../peer-data';\n\nclass HandleNegotiationStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      peer_id: null,\n      state: null,\n      is_remote: null,\n      weight: null,\n      sdp_type: null,\n      sdp_sdp: null,\n      error: null,\n    };\n  }\n\n  send(roomKey, state, peerId, sdpOrMessage, isRemote, error) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n\n    this.model.client_id = roomState.clientId;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.peer_id = peerId;\n    this.model.state = state;\n    this.model.is_remote = isRemote;\n    this.model.weight = sdpOrMessage.weight || null;\n    this.model.error = (typeof error === 'string' ? error : (error && error.msg)) || null;\n    this.model.sdp_type = null;\n    this.model.sdp_sdp = null;\n\n    // Retrieve the weight for states where the \"weight\" field is not available.\n    if (['enter', 'welcome'].indexOf(this.model.state) === -1) {\n      // Retrieve the peer's weight if it from remote end.\n      this.model.weight = this.model.is_remote && PeerData.getPeerInfo(this.model.peer_id, roomState.room).config && PeerData.getPeerInfo(this.model.peer_id, roomState.room).config.priorityWeight ? PeerData.getPeerInfo(this.model.peer_id, roomState.room).config.priorityWeight : PeerData.getCurrentSessionInfo(roomState.room).config.priorityWeight;\n      this.model.sdp_type = (sdpOrMessage && sdpOrMessage.type) || null;\n      this.model.sdp_sdp = (sdpOrMessage && sdpOrMessage.sdp) || null;\n    }\n\n    this.addToStatsBuffer('negotiation', this.model, this.endpoints.negotiation);\n    this.manageStatsBuffer();\n  }\n}\n\nconst handleNegotationStats = new HandleNegotiationStats();\nexport default handleNegotationStats;\n","import Skylink from '../../../../../index';\nimport { PEER_CERTIFICATE, PEER_CONNECTION_STATE, PEER_TYPE } from '../../../../../constants';\nimport processPeer from './processPeer';\nimport SkylinkSignalingServer from '../../../index';\nimport handleNegotiationStats from '../../../../../skylink-stats/handleNegotiationStats';\nimport logger from '../../../../../logger';\nimport messages from '../../../../../messages';\nimport parsers from '../../../parsers';\n\nexport const CALLERS = {\n  ENTER: 'enterHandler',\n  WELCOME: 'welcomeHander',\n};\n\nconst getNextNegotiationStep = (params) => {\n  let method = 'welcome';\n\n  if (params.caller === CALLERS.WELCOME) {\n    const state = Skylink.getSkylinkState(params.currentRoom.id);\n    const { peerMessagesStamps, peerPriorityWeight, hasMCU } = state;\n    if (hasMCU || peerPriorityWeight > params.message.weight) {\n      if (peerMessagesStamps[params.targetMid].hasWelcome) {\n        method = 'noop';\n        logger.log.WARN([params.targetMid, 'RTCPeerConnection', null, 'Discarding extra \"welcome\" received.']);\n      } else {\n        method = 'offer';\n        state.peerMessagesStamps[params.targetMid].hasWelcome = true;\n        Skylink.setSkylinkState(state, params.currentRoom.id);\n      }\n    }\n  }\n  return method;\n};\n\n// eslint-disable-next-line consistent-return\nconst checkStampBeforeSendingWelcome = (params) => {\n  const { currentRoom, targetMid, message } = params;\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const { peerConnections, hasMCU } = state;\n  const { STATS_MODULE, NEGOTIATION_PROGRESS } = messages;\n  const signaling = new SkylinkSignalingServer();\n  const method = getNextNegotiationStep(params);\n\n  if (method === 'offer') {\n  // Added checks to ensure that connection object is defined first\n    if (!peerConnections[targetMid]) {\n      logger.log.WARN([targetMid, 'RTCSessionDescription', 'offer', NEGOTIATION_PROGRESS.ERRORS.no_peer_connection]);\n      handleNegotiationStats.send(currentRoom.id, STATS_MODULE.HANDLE_NEGOTIATION_STATS.OFFER.dropped, targetMid, message, false, NEGOTIATION_PROGRESS.ERRORS.no_peer_connection);\n      return null;\n    }\n\n    const { signalingState } = peerConnections[targetMid];\n\n    // Added checks to ensure that state is \"stable\" if setting local \"offer\"\n    if (signalingState !== PEER_CONNECTION_STATE.STABLE) {\n      logger.log.WARN([targetMid, 'RTCSessionDescription', 'offer', NEGOTIATION_PROGRESS.ERRORS.NOT_STABLE], signalingState);\n      handleNegotiationStats.send(currentRoom.id, STATS_MODULE.HANDLE_NEGOTIATION_STATS.OFFER.dropped, targetMid, message, false, NEGOTIATION_PROGRESS.ERRORS.NOT_STABLE);\n      return null;\n    }\n\n    signaling[method](params.currentRoom, params.targetMid);\n  } else if (!hasMCU) {\n    signaling[method](params.currentRoom, params.targetMid);\n  }\n};\n\nconst logStats = (caller, targetMid, state, message) => {\n  const { room } = state;\n\n  let callerState = 'enter';\n  if (caller === CALLERS.WELCOME) {\n    callerState = 'welcome';\n  }\n\n  logger.log.INFO([targetMid, 'RTCPeerConnection', null, `Peer ${callerState} received ->`], message);\n  handleNegotiationStats.send(room.id, callerState, targetMid, message, true);\n};\n\n/**\n * Function that parses the enterAndWelcome and welcome message and sends the offer or welcome message.\n * @param {JSON} message\n * @param {String} caller\n * @memberOf SignalingMessageHandler\n */\nexport const parseAndSendWelcome = (message, caller) => {\n  const parsedMsg = parsers.enterAndWelcome(message);\n  const {\n    rid, mid, userInfo, publisherId,\n  } = parsedMsg;\n  const state = Skylink.getSkylinkState(rid);\n  const { hasMCU } = state;\n  const targetMid = hasMCU && publisherId ? publisherId : mid;\n  const { RTCPeerConnection } = window;\n\n  logStats(caller, targetMid, state, parsedMsg);\n\n  let callerState = 'enter';\n  if (caller === CALLERS.WELCOME) {\n    callerState = 'welcome';\n  }\n  if (targetMid !== PEER_TYPE.MCU && hasMCU && state.publishOnly) {\n    logger.log.WARN([targetMid, 'RTCPeerConnection', null, `Discarding ${callerState} for publishOnly case -> `], message);\n    return;\n  }\n\n  const peerParams = {\n    currentRoom: state.room,\n    targetMid,\n    userInfo,\n    message: parsedMsg,\n    caller,\n  };\n\n  if (state.peerConnectionConfig.certificate !== PEER_CERTIFICATE.AUTO && typeof RTCPeerConnection.generateCertificate === 'function') {\n    let certOptions = {};\n    if (state.peerConnectionConfig.certificate === PEER_CERTIFICATE.ECDSA) {\n      certOptions = {\n        name: 'ECDSA',\n        namedCurve: 'P-256',\n      };\n    } else {\n      certOptions = {\n        name: 'RSASSA-PKCS1-v1_5',\n        modulusLength: 2048,\n        publicExponent: new Uint8Array([1, 0, 1]),\n        hash: 'SHA-256',\n      };\n    }\n    RTCPeerConnection.generateCertificate(certOptions).then((cert) => {\n      peerParams.cert = cert;\n      processPeer(peerParams);\n      checkStampBeforeSendingWelcome(peerParams);\n    });\n  } else {\n    processPeer(peerParams);\n    checkStampBeforeSendingWelcome(peerParams);\n  }\n};\n","import { parseAndSendWelcome, CALLERS } from './commons/enterAndWelcome';\n\nconst enterHandler = (message) => {\n  parseAndSendWelcome(message, CALLERS.ENTER);\n};\n\nexport default enterHandler;\n","/* eslint-disable no-unused-vars,no-multi-assign */\nimport Skylink from '../../../../../index';\nimport logger from '../../../../../logger';\nimport {\n  TAGS, PEER_CONNECTION_STATE, HANDSHAKE_PROGRESS, DATA_CHANNEL_STATE,\n} from '../../../../../constants';\nimport IceConnection from '../../../../../ice-connection/index';\nimport SkylinkSignalingServer from '../../../index';\nimport PeerConnection from '../../../../../peer-connection/index';\nimport { handshakeProgress } from '../../../../../skylink-events';\nimport { dispatchEvent } from '../../../../../utils/skylinkEventManager';\nimport handleNegotiationStats from '../../../../../skylink-stats/handleNegotiationStats';\nimport MESSAGES from '../../../../../messages';\nimport PeerMedia from '../../../../../peer-media/index';\nimport SessionDescription from '../../../../../session-description';\n\nconst handleSetOfferAndAnswerSuccess = (state, targetMid, description, isRemote) => {\n  const { STATS_MODULE: { HANDLE_NEGOTIATION_STATS } } = MESSAGES;\n  const { peerConnections, bufferedLocalOffer, room } = state;\n  const peerConnection = peerConnections[targetMid];\n  const msgType = description.type === 'offer' ? 'OFFER' : 'ANSWER';\n\n  handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS[msgType].set, targetMid, description, isRemote);\n\n  if (isRemote) { // handshake progress is triggered on the local end after sdp it is created\n    dispatchEvent(handshakeProgress({\n      state: HANDSHAKE_PROGRESS[msgType],\n      peerId: targetMid,\n      room,\n    }));\n  }\n\n  if (isRemote) {\n    if (description.type === 'offer') {\n      peerConnection.setOffer = 'remote';\n    } else {\n      peerConnection.setAnswer = 'remote';\n    }\n    IceConnection.addIceCandidateFromQueue(targetMid, room);\n  } else {\n    bufferedLocalOffer[targetMid] = null;\n    if (description.type === 'offer') {\n      peerConnection.setOffer = 'local';\n    } else {\n      peerConnection.setAnswer = 'local';\n    }\n  }\n\n  Skylink.setSkylinkState(state, room.id);\n};\n\nconst handleSetOfferAndAnswerFailure = (state, targetMid, description, isRemote, error) => {\n  const { room, user } = state;\n  const { STATS_MODULE: { HANDLE_NEGOTIATION_STATS } } = MESSAGES;\n  const msgType = description.type === 'offer' ? 'OFFER' : 'ANSWER';\n\n  handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS[msgType].set_error, targetMid, description, isRemote, error);\n\n  dispatchEvent(handshakeProgress({\n    state: HANDSHAKE_PROGRESS.ERROR,\n    peerId: isRemote ? targetMid : user.sid,\n    error,\n    room,\n  }));\n};\n\nconst mungeSDP = (targetMid, sessionDescription, roomKey) => {\n  const mungedSessionDescription = sessionDescription;\n  // modifying the remote description received\n  // TODO: Below SDP methods needs to be implemented in the SessionDescription Class.\n  // sessionDescriptionToSet.sdp = SessionDescription.removeSDPFilteredCandidates(targetMid, sessionDescriptionToSet, message.rid);\n  // sessionDescriptionToSet.sdp = SessionDescription.setSDPCodec(targetMid, sessionDescriptionToSet, message.rid);\n  mungedSessionDescription.sdp = SessionDescription.setSDPBitrate(targetMid, mungedSessionDescription, roomKey);\n  // sessionDescriptionToSet.sdp = SessionDescription.setSDPCodecParams(targetMid, sessionDescriptionToSet, message.rid);\n  // sessionDescriptionToSet.sdp = SessionDescription.removeSDPCodecs(targetMid, sessionDescriptionToSet, message.rid);\n  // sessionDescriptionToSet.sdp = SessionDescription.removeSDPREMBPackets(targetMid, sessionDescriptionToSet, message.rid);\n  // sessionDescriptionToSet.sdp = SessionDescription.handleSDPConnectionSettings(targetMid, sessionDescriptionToSet, message.rid, 'remote');\n  // sessionDescriptionToSet.sdp = SessionDescription.removeSDPUnknownAptRtx(targetMid, sessionDescriptionToSet, message.rid);\n\n  // if (AdapterJS.webrtcDetectedBrowser === 'firefox') {\n  //   SessionDescription.setOriginalDTLSRole(state, sessionDescriptionToSet, true);\n  // }\n\n  // logger.log.INFO([targetMid, 'RTCSessionDescription', type, `Updated remote ${type} ->`], sessionDescriptionToSet.sdp);\n  return mungedSessionDescription;\n};\n\nconst setLocalDescription = (room, targetMid, localDescription) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n  const { type } = localDescription;\n  const peerConnection = peerConnections[targetMid];\n  const { STATS_MODULE } = MESSAGES;\n  const msgType = type === 'offer' ? 'OFFER' : 'ANSWER';\n\n  peerConnection.processingLocalSDP = true;\n\n  handleNegotiationStats.send(room.id, STATS_MODULE.HANDLE_NEGOTIATION_STATS[msgType][type], targetMid, localDescription, false);\n\n  return peerConnection.setLocalDescription(localDescription)\n    .then(() => peerConnection);\n};\n\nconst onLocalDescriptionSetSuccess = (RTCPeerConnection, room, targetMid, localDescription) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n  const { NEGOTIATION_PROGRESS } = MESSAGES;\n  const peerConnection = peerConnections[targetMid] = RTCPeerConnection;\n\n  logger.log.DEBUG([targetMid, TAGS.SESSION_DESCRIPTION, localDescription.type, NEGOTIATION_PROGRESS.SET_LOCAL_DESCRIPTION], localDescription);\n\n  peerConnection.processingLocalSDP = false;\n  handleSetOfferAndAnswerSuccess(state, targetMid, localDescription, false);\n};\n\nconst onLocalDescriptionSetFailure = (room, targetMid, localDescription, error) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n  const peerConnection = peerConnections[targetMid];\n  const { NEGOTIATION_PROGRESS } = MESSAGES;\n\n  logger.log.ERROR([targetMid, TAGS.SESSION_DESCRIPTION, localDescription.type, NEGOTIATION_PROGRESS.FAILED_SET_LOCAL_DESCRIPTION], error);\n\n  peerConnection.processingLocalSDP = false;\n  peerConnection.negotiating = false;\n\n  handleSetOfferAndAnswerFailure(state, targetMid, localDescription, false, error);\n};\n\nconst setRemoteDescription = (room, targetMid, remoteDescription) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n  const { type } = remoteDescription;\n  const { STATS_MODULE, NEGOTIATION_PROGRESS } = MESSAGES;\n  const peerConnection = peerConnections[targetMid];\n  const msgType = type === 'offer' ? 'OFFER' : 'ANSWER';\n\n  peerConnection.processingRemoteSDP = true;\n  handleNegotiationStats.send(room.id, STATS_MODULE.HANDLE_NEGOTIATION_STATS[msgType][type], targetMid, remoteDescription, true);\n  const mungedSessionDescription = mungeSDP(targetMid, remoteDescription, room.id);\n  return peerConnection.setRemoteDescription(mungedSessionDescription)\n    .then(() => peerConnection);\n};\n\nconst sendAnswerAck = (state, targetMid, success) => {\n  const updatedState = state;\n  updatedState.peerConnections[targetMid].negotiating = false;\n  Skylink.setSkylinkState(updatedState, targetMid);\n\n  const signaling = new SkylinkSignalingServer();\n  signaling.answerAck(state, targetMid, success);\n};\n\nconst onRemoteDescriptionSetSuccess = (RTCPeerConnection, room, targetMid, remoteDescription) => {\n  const signaling = new SkylinkSignalingServer();\n  const { type } = remoteDescription;\n  const { NEGOTIATION_PROGRESS, DATA_CHANNEL } = MESSAGES;\n\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n  const peerConnection = peerConnections[targetMid] = RTCPeerConnection;\n\n  logger.log.DEBUG([targetMid, TAGS.SESSION_DESCRIPTION, type, NEGOTIATION_PROGRESS.SET_REMOTE_DESCRIPTION], remoteDescription);\n\n  peerConnection.processingRemoteSDP = false;\n\n  if (type === 'offer') {\n    handleSetOfferAndAnswerSuccess(state, targetMid, remoteDescription, true);\n    return signaling.answer(state, targetMid);\n  }\n  // FIXME: why is this needed?\n  if (state.peerMessagesStamps[targetMid]) {\n    state.peerMessagesStamps[targetMid].hasRestart = false;\n  }\n\n  // if remote peer does not have data channel\n  if (state.dataChannels[targetMid] && (peerConnection.remoteDescription.sdp.indexOf('m=application') === -1 || peerConnection.remoteDescription.sdp.indexOf('m=application 0') > 0)) {\n    logger.log.WARN([targetMid, TAGS.PEER_CONNECTION, null, `${DATA_CHANNEL.CLOSING} - ${DATA_CHANNEL.NO_REMOTE_DATA_CHANNEL}`]);\n    PeerConnection.closeDataChannel(state, targetMid);\n  }\n\n  handleSetOfferAndAnswerSuccess(state, targetMid, remoteDescription, true);\n  sendAnswerAck(state, targetMid, true);\n  return true;\n};\n\nconst onRemoteDescriptionSetFailure = (room, targetMid, remoteDescription, error) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerConnections } = state;\n  const peerConnection = peerConnections[targetMid];\n  const { type } = remoteDescription;\n\n  logger.log.ERROR([targetMid, TAGS.SESSION_DESCRIPTION, type, `${MESSAGES.NEGOTIATION_PROGRESS.ERRORS.FAILED_SET_REMOTE_DESCRIPTION} ->`], {\n    error,\n    state: peerConnection.signalingState,\n    [type]: remoteDescription,\n  });\n\n  peerConnection.processingRemoteSDP = false;\n  peerConnection.negotiating = false;\n\n  handleSetOfferAndAnswerFailure(state, targetMid, remoteDescription, true, error);\n\n  if (type === 'answer') {\n    sendAnswerAck(state, targetMid, false);\n  }\n};\n\nconst updateState = (state, message) => {\n  const updatedState = state;\n  const { userInfo, rid, mid } = message;\n  const updatedUserInfo = userInfo;\n  const targetMid = mid;\n\n  if (userInfo && typeof userInfo === 'object') {\n    updatedUserInfo.settings.data = !!(updatedState.dataChannels[targetMid] && updatedState.dataChannels[targetMid].main && updatedState.dataChannels[targetMid].main.channel && updatedState.dataChannels[targetMid].main.channel.readyState === DATA_CHANNEL_STATE.OPEN);\n    updatedState.peerInformations[targetMid].settings = updatedUserInfo.settings || {};\n    updatedState.peerInformations[targetMid].mediaStatus = updatedUserInfo.mediaStatus || {};\n    updatedState.peerInformations[targetMid].userData = updatedUserInfo.userData;\n    // updatedState.peerInformations[targetMid].midSourceMap = updatedUserInfo.midSourceMap;\n  }\n\n  updatedState.peerConnections[targetMid].negotiating = true;\n\n  Skylink.setSkylinkState(updatedState, rid);\n};\n\nconst canProceed = (state, message) => {\n  const {\n    weight, type, mid, sdp, resend,\n  } = message;\n  const {\n    peerPriorityWeight, bufferedLocalOffer, room, peerConnections,\n  } = state;\n  const targetMid = mid;\n  const {\n    processingRemoteSDP, processingLocalSDP, negotiating,\n  } = peerConnections[targetMid];\n  const { STATS_MODULE, NEGOTIATION_PROGRESS, NO_PEER_CONNECTION } = MESSAGES;\n  const msgType = type === 'offer' ? 'OFFER' : 'ANSWER';\n  let error = null;\n\n  if (!peerConnections[targetMid]) {\n    logger.log.ERROR([targetMid, null, type, `${NO_PEER_CONNECTION.NO_PEER_CONNECTION}. Unable to set${type === 'offer' ? 'Remote' : 'Local'}Offer.`]);\n    error = NO_PEER_CONNECTION.NO_PEER_CONNECTION;\n  }\n\n  if (type === 'offer' && peerConnections[targetMid].signalingState !== PEER_CONNECTION_STATE.STABLE) {\n    logger.log.WARN([targetMid, null, type, NEGOTIATION_PROGRESS.ERRORS.NOT_STABLE], {\n      signalingState: peerConnections[targetMid].signalingState,\n      isRestart: !!resend,\n    });\n    error = `Peer connection state is ${peerConnections[targetMid].signalingState}.`;\n  }\n\n  if (type === 'offer' && bufferedLocalOffer[targetMid] && peerPriorityWeight > weight) {\n    logger.log.WARN([targetMid, null, type, NEGOTIATION_PROGRESS.ERRORS.OFFER_TIEBREAKER], {\n      selfWeight: peerPriorityWeight,\n      messageWeight: weight,\n    });\n    error = NEGOTIATION_PROGRESS.ERRORS.OFFER_TIEBREAKER;\n  }\n\n  // if processing remote SDP\n  if (processingRemoteSDP) {\n    logger.log.WARN([targetMid, TAGS.SESSION_DESCRIPTION, type, NEGOTIATION_PROGRESS.ERRORS.PROCESSING_EXISTING_SDP], sdp);\n    error = NEGOTIATION_PROGRESS.ERRORS.PROCESSING_EXISTING_SDP;\n\n    // or completed processing local and remote sdp but answerAck has not been received\n  } else if ((!processingLocalSDP && !processingRemoteSDP && negotiating) && type === 'offer') {\n    // add to bufferedRemoteOffer\n    const updatedState = state;\n    logger.log.DEBUG([targetMid, TAGS.SESSION_DESCRIPTION, type, NEGOTIATION_PROGRESS.ERRORS.ADDING_REMOTE_OFFER_TO_BUFFER], message);\n    updatedState.bufferedRemoteOffers[targetMid] = updatedState.bufferedRemoteOffers[targetMid] ? updatedState.bufferedRemoteOffers[targetMid] : [];\n    updatedState.bufferedRemoteOffers[targetMid].push(message);\n    Skylink.setSkylinkState(updatedState, room.id);\n  }\n\n  if (error) {\n    handleNegotiationStats.send(room.id, STATS_MODULE.HANDLE_NEGOTIATION_STATS[msgType].dropped, targetMid, message, true, error);\n  }\n\n  return !error;\n};\n\n/**\n * Function that parses and sets the remote description for offer and answer.\n * @param {JSON} message\n * @return {null}\n * @memberOf SignalingMessageHandler\n * @fires handshakeProgress\n */\n// eslint-disable-next-line import/prefer-default-export\nexport const parseAndSetRemoteDescription = (message) => {\n  const {\n    rid,\n    mid,\n    type,\n    sdp,\n    mediaInfoList,\n  } = message;\n  const state = Skylink.getSkylinkState(rid);\n  const {\n    hasMCU,\n    room,\n    bufferedLocalOffer,\n  } = state;\n  const targetMid = mid;\n  const msgType = type === 'offer' ? 'OFFER' : 'ANSWER';\n  const { NEGOTIATION_PROGRESS } = MESSAGES;\n\n  logger.log.INFO([targetMid, null, type, `Received ${type} from peer. ${msgType}:`], message);\n\n  if (canProceed(state, message)) {\n    try {\n      updateState(state, message);\n\n      PeerMedia.setPeerMediaInfo(room, targetMid, mediaInfoList);\n      PeerMedia.deleteUnavailableMedia(room, targetMid); // mediaState can be unavailable during renegotiation\n\n      if (type === 'offer') {\n        let localDescription = null;\n        const remoteDescription = {\n          type,\n          sdp: hasMCU ? sdp.replace(/\\r\\n/g, '\\n').split('\\n').join('\\r\\n') : sdp,\n        };\n\n        setRemoteDescription(room, targetMid, remoteDescription)\n          .then(peerConnection => onRemoteDescriptionSetSuccess(peerConnection, room, targetMid, remoteDescription))\n          .catch(error => onRemoteDescriptionSetFailure(room, targetMid, remoteDescription, error))\n          .then((answer) => {\n            localDescription = {\n              type: answer.type,\n              sdp: answer.sdp,\n            };\n            return setLocalDescription(room, targetMid, localDescription);\n          })\n          .then(peerConnection => onLocalDescriptionSetSuccess(peerConnection, room, targetMid, localDescription))\n          .catch(error => onLocalDescriptionSetFailure(room, targetMid, localDescription, error));\n      } else if (bufferedLocalOffer[targetMid]) {\n        const localDescription = bufferedLocalOffer[targetMid];\n        const remoteDescription = {\n          type,\n          sdp: hasMCU ? sdp.replace(/\\r\\n/g, '\\n').split('\\n').join('\\r\\n') : sdp,\n        };\n\n        setLocalDescription(room, targetMid, localDescription)\n          .then(peerConnection => onLocalDescriptionSetSuccess(peerConnection, room, targetMid, localDescription))\n          .catch(error => onLocalDescriptionSetFailure(room, targetMid, localDescription, error))\n          .then(() => setRemoteDescription(room, targetMid, remoteDescription))\n          .then(peerConnection => onRemoteDescriptionSetSuccess(peerConnection, room, targetMid, remoteDescription))\n          .catch(error => onRemoteDescriptionSetFailure(room, targetMid, remoteDescription, error));\n      } else {\n        logger.log.ERROR([targetMid, TAGS.PEER_CONNECTION, null, NEGOTIATION_PROGRESS.ERRORS.NO_LOCAL_BUFFERED_OFFER]);\n      }\n    } catch (error) {\n      logger.log.ERROR([targetMid, TAGS.SESSION_DESCRIPTION, type, `Failed processing ${msgType} ->`], error);\n    }\n  }\n\n  return null;\n};\n","import { parseAndSetRemoteDescription } from './commons/offerAndAnswer';\n\nconst offerHandler = (message) => {\n  parseAndSetRemoteDescription(message);\n};\n\nexport default offerHandler;\n","import { parseAndSetRemoteDescription } from './commons/offerAndAnswer';\n\nconst answerHandler = (message) => {\n  parseAndSetRemoteDescription(message);\n};\n\nexport default answerHandler;\n","const renegotiateIfNeeded = (state, peerId) => {\n  const { peerConnections, currentRTCRTPSenders } = state;\n\n  return new Promise((resolve) => {\n    const peerConnection = peerConnections[peerId];\n    const pcSenders = peerConnection.getSenders() ? peerConnection.getSenders() : [];\n    const senderGetStatsPromises = [];\n    const savedSenders = currentRTCRTPSenders[peerId] || [];\n    let isRenegoNeeded = false;\n\n    pcSenders.forEach((pcSender) => {\n      senderGetStatsPromises.push(pcSender.getStats());\n    });\n\n    const transmittingSenders = {};\n\n    Promise.all(senderGetStatsPromises).then((reslovedResults) => {\n      reslovedResults.forEach((reports, senderIndex) => {\n        reports.forEach((report) => {\n          if (report && report.ssrc) {\n            transmittingSenders[report.ssrc] = pcSenders[senderIndex];\n          } else if (report && report.type === 'ssrc' && report.id.indexOf('send') > 1) { // required for retrieving sender information for react\n            // native ios\n            report.values.forEach((value) => {\n              if (value.ssrc) {\n                transmittingSenders[value.ssrc] = pcSenders[senderIndex];\n              }\n            });\n          }\n        });\n      });\n\n      const transmittingSendersKeys = Object.keys(transmittingSenders);\n\n      if (transmittingSendersKeys.length !== savedSenders.length) {\n        isRenegoNeeded = true;\n      } else {\n        let senderMatchedCount = 0;\n        for (let tKey = 0; tKey < transmittingSendersKeys.length; tKey += 1) {\n          const tSender = transmittingSenders[transmittingSendersKeys[tKey]];\n          for (let sIndex = 0; sIndex < savedSenders.length; sIndex += 1) {\n            const sSender = savedSenders[sIndex];\n            if (tSender === sSender) {\n              senderMatchedCount += 1;\n              break;\n            }\n          }\n        }\n        isRenegoNeeded = senderMatchedCount !== transmittingSendersKeys.length;\n      }\n      resolve(isRenegoNeeded);\n    });\n  });\n};\n\nexport default renegotiateIfNeeded;\n","import Skylink from '../../../index';\nimport PeerData from '../../../peer-data';\n\n/**\n * Method that returns the refreshConnection result.\n * @param {String} peerId\n * @param {SkylinkRoom} room\n * @param {boolean} doIceRestart\n * @param {Array} [errors]\n * @private\n */\nconst buildRefreshConnectionResult = (peerId, room, doIceRestart, errors) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { hasMCU, peerInformations, enableIceRestart } = state;\n  const peersCustomSettings = PeerData.getPeersCustomSettings(state);\n  const result = {};\n\n  result[peerId] = {\n    iceRestart: !hasMCU && peerInformations[peerId] && peerInformations[peerId].config\n      && peerInformations[peerId].config.enableIceRestart && enableIceRestart && doIceRestart,\n    customSettings: peersCustomSettings[peerId] || {},\n  };\n\n  if (errors) {\n    result.errors = errors;\n  }\n\n  return result;\n};\n\nexport default buildRefreshConnectionResult;\n","/* eslint-disable prefer-promise-reject-errors */\nimport Skylink from '../../../index';\nimport MESSAGES from '../../../messages';\nimport logger from '../../../logger';\nimport PeerConnection from '../../index';\nimport {\n  isEmptyArray, isAObj, isAString, isABoolean,\n} from '../../../utils/helpers';\nimport buildRefreshConnectionResult from './buildRefreshConnectionResult';\n\nconst buildResult = (listOfPeers, refreshErrors, refreshSettings) => {\n  const result = {};\n  result.listOfPeers = listOfPeers;\n  result.refreshErrors = refreshErrors;\n  result.refreshSettings = refreshSettings;\n\n  return result;\n};\n\nconst buildPeerRefreshSettings = (listOfPeers, room, doIceRestart) => {\n  const refreshSettings = [];\n\n  Object.keys(listOfPeers).forEach((i) => {\n    refreshSettings.push(buildRefreshConnectionResult(listOfPeers[i], room, doIceRestart));\n  });\n\n  return refreshSettings;\n};\n\nconst buildPeerRefreshErrors = (peerId, errors) => {\n  const peerRefreshError = {};\n  peerRefreshError[peerId] = errors;\n\n  return peerRefreshError;\n};\n\nconst filterParams = (targetPeerId, iceRestart, options, peerConnections) => {\n  let doIceRestart = false;\n  let bwOptions = {};\n  let listOfPeers = Object.keys(peerConnections);\n\n  if (Array.isArray(targetPeerId)) {\n    listOfPeers = targetPeerId;\n  } else if (isAString(targetPeerId)) {\n    listOfPeers = [targetPeerId];\n  } else if (isABoolean(targetPeerId)) {\n    doIceRestart = targetPeerId;\n  } else if (targetPeerId && isAObj(targetPeerId)) {\n    bwOptions = targetPeerId;\n  }\n\n  if (isABoolean(iceRestart)) {\n    doIceRestart = iceRestart;\n  } else if (iceRestart && isAObj(iceRestart)) {\n    bwOptions = iceRestart;\n  }\n\n  if (options && isAObj(options)) {\n    bwOptions = options;\n  }\n\n  return {\n    listOfPeers,\n    doIceRestart,\n    bwOptions,\n  };\n};\n\n/**\n * Function that refreshes Peer connections to update with the current streaming.\n * @param {SkylinkState} roomState\n * @param {String} targetPeerId\n * @param {boolean} iceRestart\n * @param {Object} options\n * @param {Object} options.andwidth\n * @param {Object} options.googleXBandwidth\n * @return {Promise}\n * @memberOf PeerConnection\n */\nconst refreshConnection = (roomState, targetPeerId, iceRestart, options) => new Promise((resolve, reject) => {\n  if (!roomState) {\n    reject(new Error(MESSAGES.ROOM_STATE.NO_ROOM_NAME));\n  }\n\n  const { peerConnections, hasMCU, room } = roomState;\n  const initOptions = Skylink.getInitOptions();\n  const { mcuUseRenegoRestart } = initOptions;\n  const { PEER_CONNECTION } = MESSAGES;\n  const params = filterParams(targetPeerId, iceRestart, options, peerConnections);\n  const { listOfPeers, doIceRestart, bwOptions } = params;\n\n  try {\n    if (isEmptyArray(listOfPeers) && !(hasMCU && !mcuUseRenegoRestart)) {\n      logger.log.ERROR(PEER_CONNECTION.refresh_no_peer_connection);\n      reject({\n        refreshErrors: { self: PEER_CONNECTION.refresh_no_peer_connection },\n        listOfPeers,\n      });\n    }\n\n    logger.log.INFO([null, 'PeerConnection', null, PEER_CONNECTION.refresh_start]);\n\n    const refreshPeerConnectionPromises = PeerConnection.refreshPeerConnection(listOfPeers, roomState, doIceRestart, bwOptions);\n    refreshPeerConnectionPromises\n      .then((results) => {\n        const mResults = hasMCU ? [results] : results;\n        const refreshErrors = [];\n        for (let i = 0; i < mResults.length; i += 1) {\n          if (Array.isArray(mResults[i])) {\n            const error = mResults[i];\n            refreshErrors.push(buildPeerRefreshErrors(error[0], error[1]));\n            logger.log.WARN([listOfPeers, 'PeerConnection', null, PEER_CONNECTION.refresh_peer_failed], error[0]);\n          } else if (typeof mResults[i] === 'string') {\n            logger.log.INFO([listOfPeers, 'PeerConnection', null, PEER_CONNECTION.refresh_peer_success], mResults[i]);\n          }\n        }\n\n        if (refreshErrors.length === listOfPeers.length) {\n          reject(buildResult(listOfPeers, refreshErrors, buildPeerRefreshSettings(listOfPeers, room, doIceRestart)));\n        } else {\n          resolve(buildResult(listOfPeers, refreshErrors, buildPeerRefreshSettings(listOfPeers, room, doIceRestart)));\n        }\n      })\n      .catch(error => logger.log.ERROR([null, 'RTCPeerConnection', null, PEER_CONNECTION.refresh_failed], error))\n      .finally(() => logger.log.INFO(PEER_CONNECTION.refresh_completed));\n  } catch (error) {\n    reject(error);\n  }\n});\n\nexport default refreshConnection;\n","import Skylink from '../../../../index';\nimport renegotiateIfNeeded from '../../../../peer-connection/helpers/renegotiateIfNeeded';\nimport refreshConnection from '../../../../peer-connection/helpers/refresh-connection/refreshConnection';\nimport logger from '../../../../logger';\nimport { TAGS, HANDSHAKE_PROGRESS } from '../../../../constants';\nimport MESSAGES from '../../../../messages';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { handshakeProgress } from '../../../../skylink-events';\nimport { isEmptyArray } from '../../../../utils/helpers';\nimport { parseAndSetRemoteDescription } from './commons/offerAndAnswer';\n\nconst hasAppliedBufferedRemoteOffer = (updatedState, targetMid) => {\n  if (updatedState.bufferedRemoteOffers[targetMid] && !isEmptyArray(updatedState.bufferedRemoteOffers[targetMid])) {\n    const offerMessage = updatedState.bufferedRemoteOffers[targetMid].shift(); // the first buffered message\n    logger.log.DEBUG([targetMid, 'RTCSessionDescription', offerMessage.type, MESSAGES.NEGOTIATION_PROGRESS.APPLYING_BUFFERED_REMOTE_OFFER], offerMessage);\n    parseAndSetRemoteDescription(offerMessage);\n    Skylink.setSkylinkState(updatedState, updatedState.room.id);\n    return true;\n  }\n\n  return false;\n};\n\n/**\n * Method that handles the \"answerAck\" socket message received.\n * See confluence docs for the \"answerAck\" expected properties to be received\n *   based on the current <code>SM_PROTOCOL_VERSION</code>.\n * @memberOf SignalingMessageHandler\n * @private\n * @since 1.0.0\n */\nconst answerAckHandler = (message) => {\n  const { mid, rid, success } = message;\n  const updatedState = Skylink.getSkylinkState(rid);\n  const targetMid = mid;\n\n  dispatchEvent(handshakeProgress({\n    state: HANDSHAKE_PROGRESS.ANSWER_ACK,\n    peerId: targetMid,\n    room: updatedState.room,\n  }));\n\n  updatedState.peerConnections[targetMid].negotiating = false;\n  Skylink.setSkylinkState(updatedState, rid);\n\n  if (!success) {\n    logger.log.ERROR([targetMid, TAGS.SESSION_DESCRIPTION, HANDSHAKE_PROGRESS.ANSWER, MESSAGES.NEGOTIATION_PROGRESS.ERRORS.FAILED_SET_REMOTE_ANSWER]);\n    return;\n  }\n\n  if (!hasAppliedBufferedRemoteOffer(updatedState, targetMid)) {\n    renegotiateIfNeeded(updatedState, targetMid).then((shouldRenegotiate) => {\n      if (shouldRenegotiate) {\n        refreshConnection(updatedState, targetMid)\n          .catch((error) => {\n            logger.log.ERROR([mid, TAGS.SESSION_DESCRIPTION, HANDSHAKE_PROGRESS.ANSWER_ACK, MESSAGES.NEGOTIATION_PROGRESS.ERRORS.FAILED_RENEGOTIATION], error);\n          });\n      }\n    });\n  }\n};\n\nexport default answerAckHandler;\n","import { parseAndSendWelcome, CALLERS } from './commons/enterAndWelcome';\n\nconst welcomeHandler = (message) => {\n  parseAndSendWelcome(message, CALLERS.WELCOME);\n};\n\nexport default welcomeHandler;\n","import Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { candidateProcessingState } from '../../../../skylink-events';\nimport * as constants from '../../../../constants';\nimport PeerConnection from '../../../../peer-connection';\nimport IceConnection from '../../../../ice-connection';\nimport messages from '../../../../messages';\nimport HandleIceCandidateStats from '../../../../skylink-stats/handleIceCandidateStats';\n\n\n/**\n * Function that handles the \"candidate\" socket message received.\n * @param {JSON} message\n * @memberOf SignalingMessageHandler\n * @returns {null}\n * @fires candidateProcessingState\n */\nconst candidateHandler = (message) => {\n  const { candidate, mid, rid } = message;\n  const state = Skylink.getSkylinkState(rid);\n  const { room } = state;\n  const initOptions = Skylink.getInitOptions();\n  const peerConnection = state.peerConnections[mid];\n  const peerEndOfCandidatesCounter = state.peerEndOfCandidatesCounter[mid] || {};\n  const { RTCIceCandidate } = window;\n  const { ICE_CANDIDATE: { CANDIDATE_HANDLER }, PEER_CONNECTION, STATS_MODULE: { HANDLE_ICE_GATHERING_STATS } } = messages;\n  const handleIceCandidateStats = new HandleIceCandidateStats();\n\n  if (!candidate && !message.id) {\n    logger.log.WARN([mid, CANDIDATE_HANDLER.tag, null, CANDIDATE_HANDLER.INVALID_CANDIDATE], message);\n    return null;\n  }\n\n  const nativeCandidate = new RTCIceCandidate({\n    sdpMLineIndex: message.label,\n    candidate,\n    sdpMid: message.id,\n  });\n  const candidateId = `can-${nativeCandidate.foundation}`;\n  const candidateType = nativeCandidate.candidate.split(' ')[7] || '';\n\n  logger.log.DEBUG([mid, CANDIDATE_HANDLER.tag, `${candidateId}:${candidateType}`, CANDIDATE_HANDLER.VALID_CANDIDATE], nativeCandidate);\n\n  peerEndOfCandidatesCounter.len = peerEndOfCandidatesCounter.len || 0;\n  peerEndOfCandidatesCounter.hasSet = false;\n  peerEndOfCandidatesCounter.len += 1;\n\n  Skylink.setSkylinkState(state, rid);\n\n  const candidateProcessingStateEventDetail = {\n    candidate: {\n      candidate: nativeCandidate.candidate,\n      sdpMid: nativeCandidate.sdpMid,\n      sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n    },\n    error: null,\n  };\n\n  dispatchEvent(candidateProcessingState({\n    room,\n    state: constants.CANDIDATE_PROCESSING_STATE.RECEIVED,\n    peerId: mid,\n    candidateId,\n    candidateType,\n    candidate: candidateProcessingStateEventDetail.candidate,\n    error: candidateProcessingStateEventDetail.error,\n  }));\n\n  if (!(peerConnection && peerConnection.signalingState !== constants.PEER_CONNECTION_STATE.CLOSED)) {\n    logger.log.WARN([mid, CANDIDATE_HANDLER.tag, `${candidateId}:${candidateType}`, PEER_CONNECTION.NO_PEER_CONNECTION]);\n\n    candidateProcessingStateEventDetail.error = new Error(PEER_CONNECTION.NO_PEER_CONNECTION);\n    handleIceCandidateStats.send(room.id, HANDLE_ICE_GATHERING_STATS.PROCESS_FAILED, mid, candidateId, candidateProcessingStateEventDetail.candidate, candidateProcessingStateEventDetail.error);\n    dispatchEvent(candidateProcessingState({\n      room,\n      state: constants.CANDIDATE_PROCESSING_STATE.DROPPED,\n      peerId: mid,\n      candidateId,\n      candidateType,\n      candidate: candidateProcessingStateEventDetail.candidate,\n      error: candidateProcessingStateEventDetail.error,\n    }));\n\n    PeerConnection.signalingEndOfCandidates(mid, state);\n    return null;\n  }\n\n  if (initOptions.filterCandidatesType[candidateType]) {\n    if (!(state.hasMCU && initOptions.forceTURN)) {\n      logger.log.WARN([mid, CANDIDATE_HANDLER.tag, `${candidateId}:${candidateType}`, CANDIDATE_HANDLER.FILTERED_CANDIDATE], nativeCandidate);\n\n      candidateProcessingStateEventDetail.error = new Error(CANDIDATE_HANDLER.FILTERED_CANDIDATE);\n      handleIceCandidateStats.send(room.id, HANDLE_ICE_GATHERING_STATS.DROPPED, mid, candidateId, candidateProcessingStateEventDetail.candidate, candidateProcessingStateEventDetail.error);\n      dispatchEvent(candidateProcessingState({\n        room,\n        state: constants.CANDIDATE_PROCESSING_STATE.DROPPED,\n        peerId: mid,\n        candidateId,\n        candidateType,\n        candidate: candidateProcessingStateEventDetail.candidate,\n        error: candidateProcessingStateEventDetail.error,\n      }));\n\n      PeerConnection.signalingEndOfCandidates(mid, state);\n      return null;\n    }\n\n    logger.log.WARN([mid, CANDIDATE_HANDLER.tag, `${candidateId}:${candidateType}`, CANDIDATE_HANDLER.FILTERING_FLAG_NOT_HONOURED], nativeCandidate);\n  }\n\n  if (peerConnection.remoteDescription && peerConnection.remoteDescription.sdp && peerConnection.localDescription && peerConnection.localDescription.sdp) {\n    IceConnection.addIceCandidate(mid, candidateId, candidateType, nativeCandidate, state);\n  } else {\n    IceConnection.addIceCandidateToQueue(mid, candidateId, candidateType, nativeCandidate, state);\n  }\n\n  PeerConnection.signalingEndOfCandidates(mid, state);\n\n  let gatheredCandidates = state.gatheredCandidates[mid];\n  if (!gatheredCandidates) {\n    gatheredCandidates = {\n      sending: { host: [], srflx: [], relay: [] },\n      receiving: { host: [], srflx: [], relay: [] },\n    };\n  }\n\n  gatheredCandidates.receiving[candidateType].push({\n    sdpMid: nativeCandidate.sdpMid,\n    sdpMLineIndex: nativeCandidate.sdpMLineIndex,\n    candidate: nativeCandidate.candidate,\n  });\n\n  state.gatheredCandidates[mid] = gatheredCandidates;\n  Skylink.setSkylinkState(state, rid);\n\n  return null;\n};\n\nexport default candidateHandler;\n","import logger from '../../../../logger';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { GET_PEERS_STATE } from '../../../../constants';\nimport { getPeersStateChange } from '../../../../skylink-events';\n\n/**\n * Function that handles the Signaling Server message from getPeers() method.\n * @param {JSON} message\n * @memberOf SignalingMessageHandler\n * @fires getPeersStateChange\n */\nconst getPeerListHandler = (message) => {\n  const { result, type } = message;\n  const peerList = result;\n  logger.log.INFO(['Server', null, type, 'Received list of peers'], peerList);\n  dispatchEvent(getPeersStateChange({\n    state: GET_PEERS_STATE.DISPATCHED,\n    privilegePeerId: null,\n    peerList,\n  }));\n};\n\nexport default getPeerListHandler;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\n\nclass HandleSessionStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      state: null,\n      contents: null,\n    };\n  }\n\n  send(roomKey, message) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.client_id = roomState.clientId;\n    this.model.state = message.type;\n    this.model.contents = message;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n\n    this.postStats(this.endpoints.session, this.model);\n  }\n}\n\nexport default HandleSessionStats;\n","\nimport Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport HandleSessionStats from '../../../../skylink-stats/handleSessionStats';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { introduceStateChange } from '../../../../skylink-events';\nimport { INTRODUCE_STATE_CHANGE } from '../../../../skylink-events/constants';\n\n/**\n * Function that handles the \"introduceError\" socket message received.\n * @param {JSON} message\n * @memberOf SignalingMessageHandler\n * @fires introduceStateChange\n */\nconst introduceErrorHandler = (message) => {\n  const state = Skylink.getSkylinkState();\n  const { room, user } = state;\n  logger.log.WARN(['Server', null, message.type, `Introduce failed. Reason: ${message.reason}`]);\n\n  const handleSessionStats = new HandleSessionStats();\n  handleSessionStats.send(room.id, message);\n  dispatchEvent(introduceStateChange({\n    state: INTRODUCE_STATE_CHANGE.ERROR,\n    privilegedPeerId: user.sid,\n    receivingPeerId: message.receivingPeerId,\n    sendingPeerId: message.sendingPeerId,\n    reason: message.reason,\n  }));\n};\n\nexport default introduceErrorHandler;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\nimport PeerConnection from '../peer-connection';\nimport logger from '../logger';\nimport MESSAGES from '../messages';\n\nclass HandleIceConnectionStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      peer_id: null,\n      state: null,\n      local_candidate: {},\n      remote_candidate: {},\n    };\n  }\n\n  send(roomKey, state, peerId) {\n    try {\n      const roomState = Skylink.getSkylinkState(roomKey);\n\n      if (!roomState) return;\n\n      this.model.room_id = roomKey;\n      this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n      this.model.peer_id = peerId;\n      this.model.client_id = roomState.clientId;\n      this.model.state = state;\n      this.model.appKey = Skylink.getInitOptions().appKey;\n      this.model.timestamp = (new Date()).toISOString();\n\n      PeerConnection.retrieveStatistics(roomKey, peerId, Skylink.getInitOptions().beSilentOnStatsLogs).then((stats) => {\n        if (stats) {\n          // Parse the selected ICE candidate pair for both local and remote candidate.\n          ['local', 'remote'].forEach((dirType) => {\n            const candidate = stats.selectedCandidatePair[dirType];\n            if (candidate) {\n              const modelCandidate = this.model[`${dirType}_candidate`];\n              modelCandidate.ip_address = candidate.ipAddress || null;\n              modelCandidate.port_number = candidate.portNumber || null;\n              modelCandidate.candidate_type = candidate.candidateType || null;\n              modelCandidate.protocol = candidate.transport || null;\n              modelCandidate.priority = candidate.priority || null;\n\n              // This is only available for the local ICE candidate.\n              if (dirType === 'local') {\n                this.model.local_candidate.network_type = candidate.networkType || null;\n              }\n            }\n          });\n        }\n\n        this.postStats(this.endpoints.iceConnection, this.model);\n      }).catch((ex) => {\n        logger.log.DEBUG(MESSAGES.STATS_MODULE.HANDLE_ICE_CONNECTION_STATS.RETRIEVE_FAILED, ex);\n      });\n    } catch (error) {\n      logger.log.DEBUG(MESSAGES.STATS_MODULE.HANDLE_ICE_CONNECTION_STATS.SEND_FAILED, error);\n    }\n  }\n}\n\nexport default HandleIceConnectionStats;\n","import logger from '../../../../logger';\nimport Skylink from '../../../../index';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport {\n  peerLeft, serverPeerLeft, peerConnectionState, iceConnectionState,\n} from '../../../../skylink-events';\nimport PeerData from '../../../../peer-data';\nimport HandleIceConnectionStats from '../../../../skylink-stats/handleIceConnectionStats';\nimport PeerConnection from '../../../../peer-connection/index';\nimport {\n  PEER_TYPE, PEER_CONNECTION_STATE, ICE_CONNECTION_STATE, SERVER_PEER_TYPE, BROWSER_AGENT, TAGS,\n} from '../../../../constants';\nimport MESSAGES from '../../../../messages';\nimport { isAgent, isVersion } from '../../../../utils/helpers';\n\n/**\n * Checks if peer is connected.\n * @param {SkylinkState} roomState\n * @param {String} peerId\n * @private\n */\nconst isPeerConnected = (roomState, peerId) => {\n  const roomStateObj = roomState;\n\n  if (!roomStateObj) return false;\n\n  if (!roomStateObj.peerConnections[peerId] && !roomStateObj.peerInformations[peerId]) {\n    logger.log.DEBUG([peerId, TAGS.PEER_CONNECTION, null, `${MESSAGES.ROOM.LEAVE_ROOM.DROPPING_HANGUP} - ${MESSAGES.PEER_CONNECTION.NO_PEER_CONNECTION}`]);\n    return false;\n  }\n\n  return true;\n};\n\n/**\n * Sets to true signalingStateClosed and dispatches peer connection state closed.\n * @param {SkylinkState} roomState\n * @param {String} peerId\n * @private\n */\nconst processPeerConnectionState = (roomState, peerId) => {\n  const state = roomState;\n\n  if (state.peerConnections[peerId].signalingStateClosed) return;\n\n  state.peerConnections[peerId].signalingStateClosed = true;\n\n  dispatchEvent(peerConnectionState({\n    peerId,\n    state: PEER_CONNECTION_STATE.CLOSED,\n  }));\n};\n\n/**\n * Sets to true iceConnectionStateClosed and dispatches ICE connection state closed.\n * @param {SkylinkState} roomState\n * @param {String} peerId\n * @private\n */\nconst processIceConnectionState = (roomState, peerId) => {\n  const state = roomState;\n\n  if (state.peerConnections[peerId].iceConnectionStateClosed) return;\n\n  state.peerConnections[peerId].iceConnectionStateClosed = true;\n\n  new HandleIceConnectionStats().send(state.room.id, peerId, roomState);\n\n  dispatchEvent(iceConnectionState({\n    peerId,\n    state: ICE_CONNECTION_STATE.CLOSED,\n  }));\n};\n\n/**\n * Closes a peer connection for a particular peerId.\n * @param {String} roomKey\n * @param {String} peerId\n * @private\n */\nconst closePeerConnection = (roomKey, peerId) => {\n  const roomState = Skylink.getSkylinkState(roomKey);\n  if (roomState.peerConnections[peerId].signalingState === PEER_CONNECTION_STATE.CLOSED) return;\n\n  roomState.peerConnections[peerId].close();\n\n  // Polyfill for safari 11 \"closed\" event not triggered for \"iceConnectionState\" and \"signalingState\".\n  if (isAgent(BROWSER_AGENT.SAFARI) && isVersion(11)) {\n    processPeerConnectionState(roomState, peerId);\n    processIceConnectionState(roomState, peerId);\n  }\n};\n\n/**\n * Clears peer information in SkylinkState.\n * @param {String} roomKey\n * @param {String} peerId\n * @private\n */\nexport const clearPeerInfo = (roomKey, peerId) => {\n  const updatedState = Skylink.getSkylinkState(roomKey);\n\n  // Otherwise stats module fails.\n  setTimeout(() => {\n    delete updatedState.peerConnections[peerId];\n    Skylink.setSkylinkState(updatedState, updatedState.room.id);\n    logger.log.INFO([peerId, TAGS.PEER_CONNECTION, null, MESSAGES.ROOM.LEAVE_ROOM.PEER_LEFT.SUCCESS]);\n  }, 500);\n\n  delete updatedState.peerInformations[peerId];\n  delete updatedState.peerMedias[peerId];\n  delete updatedState.remoteStreams[peerId];\n  delete updatedState.peerMessagesStamps[peerId];\n  delete updatedState.peerEndOfCandidatesCounter[peerId];\n  delete updatedState.peerCandidatesQueue[peerId];\n  delete updatedState.sdpSessions[peerId];\n  delete updatedState.peerStats[peerId];\n  delete updatedState.peerBandwidth[peerId];\n  delete updatedState.gatheredCandidates[peerId];\n  delete updatedState.peerCustomConfigs[peerId];\n  delete updatedState.peerConnStatus[peerId];\n};\n\n/**\n * Check if health timer exists.\n * @param {String} roomKey\n * @param {String} peerId\n * @private\n */\nexport const checksIfHealthTimerExists = (roomKey, peerId) => {\n  const roomState = Skylink.getSkylinkState(roomKey);\n  if (!roomState.peerConnections[peerId]) return;\n\n  closePeerConnection(roomKey, peerId);\n};\n\n/**\n * Triggers peerLeft event and changes state for serverPeerLeft.\n * @param {String} roomKey\n * @param {String} peerId\n * @private\n */\nconst triggerPeerLeftEventAndChangeState = (roomKey, peerId) => {\n  const roomState = Skylink.getSkylinkState(roomKey);\n\n  if (!isPeerConnected(roomState, peerId)) return;\n\n  const { room } = roomState;\n  const peerInfo = PeerData.getPeerInfo(peerId, room);\n\n  if (peerId === PEER_TYPE.MCU) {\n    const updatedState = roomState;\n    dispatchEvent(serverPeerLeft({\n      peerId,\n      serverPeerType: SERVER_PEER_TYPE.MCU,\n      room,\n    }));\n    updatedState.hasMCU = false;\n\n    Skylink.setSkylinkState(updatedState, room.id);\n    return;\n  }\n\n  dispatchEvent(peerLeft({\n    peerId,\n    peerInfo,\n    isSelf: false,\n    room,\n  }));\n};\n\n/**\n * Closes datachannel for a particular room.\n * @param {String} roomKey\n * @param {String} peerId\n * @private\n */\nconst tryCloseDataChannel = (roomKey, peerId) => {\n  const roomState = Skylink.getSkylinkState(roomKey);\n  PeerConnection.closeDataChannel(roomState, peerId);\n};\n\n/**\n * Function that handles the bye Signaling Server message.\n * @param {JSON} message\n * @memberOf SignalingMessageHandler\n * @private\n */\nconst byeHandler = (message) => {\n  const { mid, rid, publisherId } = message;\n  const roomKey = rid;\n  const roomState = Skylink.getSkylinkState(roomKey);\n  let peerId = mid;\n\n  if (roomState.hasMCU) {\n    peerId = publisherId;\n  }\n\n  logger.log.INFO([peerId, TAGS.PEER_CONNECTION, null, MESSAGES.ROOM.LEAVE_ROOM.PEER_LEFT.START]);\n\n  try {\n    triggerPeerLeftEventAndChangeState(roomKey, peerId);\n    checksIfHealthTimerExists(roomKey, peerId);\n    clearPeerInfo(roomKey, peerId);\n    tryCloseDataChannel(roomKey, peerId);\n  } catch (error) {\n    logger.log.DEBUG([peerId, TAGS.ROOM, null, MESSAGES.ROOM.LEAVE_ROOM.PEER_LEFT.ERROR], error);\n  }\n};\n\nexport default byeHandler;\n","/* eslint-disable no-unused-vars */\nimport Skylink from '../../../../../index';\nimport PeerData from '../../../../../peer-data/index';\nimport SessionDescription from '../../../../../session-description';\nimport logger from '../../../../../logger';\nimport handleNegotiationStats from '../../../../../skylink-stats/handleNegotiationStats';\nimport messages from '../../../../../messages';\nimport { HANDSHAKE_PROGRESS } from '../../../../../constants';\nimport PeerMedia from '../../../../../peer-media/index';\nimport { handshakeProgress } from '../../../../../skylink-events';\nimport { dispatchEvent } from '../../../../../utils/skylinkEventManager';\nimport PeerConnection from '../../../../../peer-connection/index';\n\nconst getCommonMessage = (resolve, targetMid, roomState, sessionDescription, restartOfferMsg) => {\n  // TODO: Full implementation to be done from _setLocalAndSendMessage under peer-handshake.js\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  // const initOptions = Skylink.getInitOptions();\n  const {\n    peerConnections, peerConnectionConfig, bufferedLocalOffer, peerPriorityWeight, room,\n  } = state;\n  const { STATS_MODULE: { HANDLE_NEGOTIATION_STATS } } = messages;\n  const { AdapterJS } = window;\n  const peerConnection = peerConnections[targetMid];\n  const sd = {\n    type: sessionDescription.type,\n    sdp: sessionDescription.sdp,\n  };\n\n  peerConnection.processingLocalSDP = true;\n\n  // sd.sdp = SessionDescription.removeSDPFirefoxH264Pref(targetMid, sd, roomState.room.id);\n  // sd.sdp = SessionDescription.setSDPCodecParams(targetMid, sd, roomState.room.id);\n  // sd.sdp = SessionDescription.removeSDPUnknownAptRtx(targetMid, sd, roomState.room.id);\n  // sd.sdp = SessionDescription.removeSDPCodecs(targetMid, sd, roomState.room.id);\n  // sd.sdp = SessionDescription.handleSDPConnectionSettings(targetMid, sd, roomState.room.id, 'local');\n  // sd.sdp = SessionDescription.removeSDPREMBPackets(targetMid, sd, roomState.room.id);\n\n  if (AdapterJS.webrtcDetectedBrowser === 'firefox') {\n    SessionDescription.setOriginalDTLSRole(state, sd, false);\n    sd.sdp = SessionDescription.modifyDTLSRole(state, sessionDescription);\n  }\n\n  if (peerConnectionConfig.disableBundle) {\n    sd.sdp = sd.sdp.replace(/a=group:BUNDLE.*\\r\\n/gi, '');\n  }\n\n  logger.log.INFO([targetMid, 'RTCSessionDescription', sessionDescription.type, 'Local session description updated ->'], sd.sdp);\n\n  if (sessionDescription.type === HANDSHAKE_PROGRESS.OFFER) {\n    handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS.OFFER.offer, targetMid, sessionDescription, false);\n\n    logger.log.INFO([targetMid, 'RTCSessionDescription', sessionDescription.type, 'Local offer saved.']);\n    bufferedLocalOffer[targetMid] = sessionDescription;\n\n    const offer = {\n      type: sd.type,\n      sdp: sd.sdp, // SessionDescription.renderSDPOutput(targetMid, sd, roomState.room.id),\n      mid: state.user.sid,\n      target: targetMid,\n      rid: roomState.room.id,\n      userInfo: PeerData.getUserInfo(roomState.room),\n      weight: peerPriorityWeight,\n      mediaInfoList: PeerMedia.retrieveMediaInfoForOfferAnswer(room, sd),\n    };\n\n    // Merging Restart and Offer messages. The already present keys in offer message will not be overwritten.\n    // Only news keys from restartOfferMsg are added.\n    if (restartOfferMsg && Object.keys(restartOfferMsg).length) {\n      const keys = Object.keys(restartOfferMsg);\n      const currentMessageKeys = Object.keys(offer);\n      for (let keyIndex = 0; keyIndex < keys.length; keyIndex += 1) {\n        const key = keys[keyIndex];\n        if (currentMessageKeys.indexOf(key) === -1) {\n          offer[key] = restartOfferMsg[key];\n        }\n      }\n    }\n\n    resolve(offer);\n  } else {\n    handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS.ANSWER.answer, targetMid, sessionDescription, false);\n\n    const answer = {\n      type: sd.type,\n      sdp: sd.sdp,\n      mid: state.user.sid,\n      target: targetMid,\n      rid: roomState.room.id,\n      userInfo: PeerData.getUserInfo(roomState.room),\n      mediaInfoList: PeerMedia.retrieveMediaInfoForOfferAnswer(room, sd),\n    };\n\n    resolve(answer);\n  }\n};\n\nexport default getCommonMessage;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport PeerConnection from '../index';\nimport MediaStream from '../../media-stream/index';\nimport SessionDescription from '../../session-description';\nimport { HANDSHAKE_PROGRESS, PEER_TYPE } from '../../constants';\nimport getCommonOfferAnswerMessage from '../../server-communication/signaling-server/message-builder/builders/commons/offerAndAnswer';\nimport handleNegotiationStats from '../../skylink-stats/handleNegotiationStats';\nimport MESSAGES from '../../messages';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { handshakeProgress } from '../../skylink-events';\n\nconst { STATS_MODULE: { HANDLE_NEGOTIATION_STATS } } = MESSAGES;\n\nconst onOfferCreated = (resolve, targetMid, roomState, restartOfferMsg, offer) => {\n  const { room } = roomState;\n\n  logger.log.DEBUG([targetMid, null, null, 'Created offer'], offer);\n  handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS.OFFER.create, targetMid, offer, false);\n\n  getCommonOfferAnswerMessage(resolve, targetMid, roomState, offer, restartOfferMsg);\n};\n\nconst onOfferFailed = (reject, targetMid, roomState, error) => {\n  const { room } = roomState;\n\n  logger.log.ERROR([targetMid, null, null, 'Failed creating an offer:'], error);\n  handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS.OFFER.create_error, targetMid, null, false, error);\n  dispatchEvent(handshakeProgress({\n    state: HANDSHAKE_PROGRESS.ERROR,\n    peerId: targetMid,\n    error,\n    room: roomState.room,\n  }));\n  reject(error);\n};\n\n/**\n * @param {SkylinkRoom} currentRoom\n * @param {String} targetMid\n * @param {Boolean} iceRestart\n * @param {object} restartOfferMsg\n * @return {*}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires handshakeProgress\n */\nconst createOffer = (currentRoom, targetMid, iceRestart = false, restartOfferMsg) => {\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const initOptions = Skylink.getInitOptions();\n  const { enableDataChannel } = initOptions;\n  const {\n    peerConnections,\n    // sdpSettings,\n    hasMCU,\n    enableIceRestart,\n    peerInformations,\n    voiceActivityDetection,\n    peerConnStatus,\n    dataChannels,\n  } = state;\n  const { AdapterJS } = window;\n  const peerConnection = peerConnections[targetMid];\n\n  const offerConstraints = {\n    offerToReceiveAudio: !(!state.sdpSettings.connection.audio && targetMid !== PEER_TYPE.MCU) && SessionDescription.getSDPCommonSupports(targetMid, null, currentRoom.id).video,\n    offerToReceiveVideo: !(!state.sdpSettings.connection.video && targetMid !== PEER_TYPE.MCU) && SessionDescription.getSDPCommonSupports(targetMid, null, currentRoom.id).audio,\n    iceRestart: !!((peerInformations[targetMid] || {}).config || {}).enableIceRestart && iceRestart && enableIceRestart,\n    voiceActivityDetection,\n  };\n\n  if (hasMCU && typeof peerConnection.addTransceiver !== 'function') {\n    offerConstraints.offerToReceiveVideo = true;\n  }\n\n  // Add stream only at offer/answer end\n  if (!hasMCU || targetMid === PEER_TYPE.MCU) {\n    MediaStream.addLocalMediaStreams(targetMid, state);\n  }\n\n  if (enableDataChannel && peerInformations[targetMid].config.enableDataChannel) {\n    if (!(dataChannels[targetMid] && dataChannels[targetMid].main)) {\n      PeerConnection.createDataChannel({\n        peerId: targetMid,\n        roomState: state,\n        createAsMessagingChannel: true,\n      });\n      state.peerConnections[targetMid].hasMainChannel = true;\n    }\n  }\n\n  logger.log.DEBUG([targetMid, null, null, 'Creating offer with config:'], offerConstraints);\n\n  peerConnection.endOfCandidates = false;\n  peerConnection.negotiating = true;\n\n  if (peerConnStatus[targetMid]) {\n    state.peerConnStatus[targetMid].sdpConstraints = offerConstraints;\n  }\n\n  Skylink.setSkylinkState(state, currentRoom.id);\n\n  return new Promise((resolve, reject) => {\n    peerConnection.createOffer(AdapterJS.webrtcDetectedType === 'plugin' ? {\n      mandatory: {\n        OfferToReceiveAudio: offerConstraints.offerToReceiveAudio,\n        OfferToReceiveVideo: offerConstraints.offerToReceiveVideo,\n        iceRestart: offerConstraints.iceRestart,\n        voiceActivityDetection: offerConstraints.voiceActivityDetection,\n      },\n    } : offerConstraints)\n      .then(offer => onOfferCreated(resolve, targetMid, state, restartOfferMsg, offer))\n      .catch(error => onOfferFailed(reject, targetMid, state, error));\n  });\n};\n\nexport default createOffer;\n","import {\n  BUNDLE_POLICY, HANDSHAKE_PROGRESS, PEER_TYPE, BROWSER_AGENT,\n} from '../../../constants';\nimport Skylink from '../../../index';\nimport logger from '../../../logger';\nimport callbacks from './callbacks/index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { handshakeProgress } from '../../../skylink-events';\nimport { updateRemoveStream } from '../../../compatibility/index';\n\nconst createNativePeerConnection = (targetMid, constraints, optional, hasScreenShare, currentRoom) => {\n  const initOptions = Skylink.getInitOptions();\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const { AdapterJS } = window;\n  logger.log.DEBUG([targetMid, 'RTCPeerConnection', null, 'Creating peer connection ->'], {\n    constraints,\n    optional,\n  });\n  const { RTCPeerConnection, msRTCPeerConnection } = window;\n  const rtcPeerConnection = new (initOptions.useEdgeWebRTC && msRTCPeerConnection ? window.msRTCPeerConnection : RTCPeerConnection)(constraints, optional);\n  const callbackExtraParams = [rtcPeerConnection, targetMid, state];\n\n  // attributes (added on by Temasys)\n  rtcPeerConnection.setOffer = '';\n  rtcPeerConnection.setAnswer = '';\n  rtcPeerConnection.negotiating = false;\n  rtcPeerConnection.hasStream = false;\n  rtcPeerConnection.hasMainChannel = false;\n  rtcPeerConnection.firefoxStreamId = '';\n  rtcPeerConnection.processingLocalSDP = false;\n  rtcPeerConnection.processingRemoteSDP = false;\n  rtcPeerConnection.gathered = false;\n  rtcPeerConnection.gathering = false;\n  rtcPeerConnection.localStream = null;\n  rtcPeerConnection.localStreamId = null;\n\n  // Used for safari 11\n  rtcPeerConnection.iceConnectionStateClosed = false;\n  rtcPeerConnection.signalingStateClosed = false;\n\n  // candidates\n  state.gatheredCandidates[targetMid] = {\n    sending: { host: [], srflx: [], relay: [] },\n    receiving: { host: [], srflx: [], relay: [] },\n  };\n\n  // self._streamsSession[targetMid] = self._streamsSession[targetMid] || {}; from SkylinkJS\n  state.peerEndOfCandidatesCounter[targetMid] = state.peerEndOfCandidatesCounter[targetMid] || {};\n  state.sdpSessions[targetMid] = { local: {}, remote: {} };\n  state.peerBandwidth[targetMid] = {};\n  // state.peerStats[targetMid] = {}; // initialised only after peerConnationStatus === 'completed'\n\n  // FIXME: ESS-1620 - To check if still needed\n  if (targetMid === PEER_TYPE.MCU) {\n    logger.log.INFO('Creating an empty transceiver of kind video with MCU');\n    if (typeof rtcPeerConnection.addTransceiver === 'function') {\n      rtcPeerConnection.addTransceiver('video');\n    }\n  }\n\n  Skylink.setSkylinkState(state, currentRoom.id);\n\n  if (AdapterJS.webrtcDetectedBrowser === 'firefox') {\n    rtcPeerConnection.removeStream = updateRemoveStream(rtcPeerConnection);\n  }\n\n  /* CALLBACKS */\n  rtcPeerConnection.ontrack = callbacks.ontrack.bind(rtcPeerConnection, ...callbackExtraParams);\n  rtcPeerConnection.ondatachannel = callbacks.ondatachannel.bind(rtcPeerConnection, ...callbackExtraParams);\n  rtcPeerConnection.onicecandidate = callbacks.onicecandidate.bind(rtcPeerConnection, ...callbackExtraParams);\n  rtcPeerConnection.oniceconnectionstatechange = callbacks.oniceconnectionstatechange.bind(rtcPeerConnection, ...callbackExtraParams);\n  rtcPeerConnection.onsignalingstatechange = callbacks.onsignalingstatechange.bind(rtcPeerConnection, ...callbackExtraParams);\n  rtcPeerConnection.onicegatheringstatechange = callbacks.onicegatheringstatechange.bind(rtcPeerConnection, ...callbackExtraParams);\n\n  if (AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.REACT_NATIVE) {\n    rtcPeerConnection.onsenderadded = callbacks.onsenderadded.bind(rtcPeerConnection, ...callbackExtraParams);\n    rtcPeerConnection.onremovetrack = callbacks.onremovetrack.bind(rtcPeerConnection, targetMid, state.room, false);\n  }\n\n  return rtcPeerConnection;\n};\n\n/**\n * Function that creates the Peer Connection.\n * @param {JSON} params\n * @return {RTCPeerConnection} peerConnection\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires handshakeProgress\n */\nconst createPeerConnection = (params) => {\n  let peerConnection = null;\n  const {\n    currentRoom,\n    targetMid,\n    cert,\n    hasScreenShare,\n  } = params;\n  const initOptions = Skylink.getInitOptions();\n  const { filterCandidatesType } = initOptions;\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const {\n    peerConnectionConfig,\n    room,\n  } = state;\n  const constraints = {\n    iceServers: state.room.connection.peerConfig.iceServers,\n    iceTransportPolicy: filterCandidatesType.host && filterCandidatesType.srflx && !filterCandidatesType.relay ? 'relay' : 'all',\n    bundlePolicy: peerConnectionConfig.bundlePolicy === BUNDLE_POLICY.NONE ? BUNDLE_POLICY.BALANCED : peerConnectionConfig.bundlePolicy,\n    rtcpMuxPolicy: peerConnectionConfig.rtcpMuxPolicy,\n    iceCandidatePoolSize: peerConnectionConfig.iceCandidatePoolSize,\n  };\n  const optional = {\n    optional: [\n      { DtlsSrtpKeyAgreement: true },\n      { googIPv6: true },\n    ],\n  };\n\n  if (cert) {\n    constraints.certificates = [cert];\n  }\n\n  if (state.peerConnStatus[targetMid]) {\n    state.peerConnStatus[targetMid].constraints = constraints;\n    state.peerConnStatus[targetMid].optional = optional;\n  }\n\n  Skylink.setSkylinkState(state, currentRoom.id);\n\n  try {\n    peerConnection = createNativePeerConnection(targetMid, constraints, optional, hasScreenShare, currentRoom);\n  } catch (error) {\n    logger.log.ERROR([targetMid, null, null, 'Failed creating peer connection:'], error);\n    peerConnection = null;\n    dispatchEvent(handshakeProgress({\n      state: HANDSHAKE_PROGRESS.ERROR,\n      peerId: targetMid,\n      error,\n      room,\n    }));\n  }\n\n  return peerConnection;\n};\n\nexport default createPeerConnection;\n","import Skylink from '../../../index';\nimport { SDP_SEMANTICS } from '../../../constants';\nimport logger from '../../../logger/index';\nimport createPeerConnection from './createPeerConnection';\nimport HandleIceConnectionStats from '../../../skylink-stats/handleIceConnectionStats';\nimport handleIceGatheringStats from '../../../skylink-stats/handleIceGatheringStats';\n\n/**\n * Function that starts the Peer connection session.\n * @param {object} params - options required to create a PeerConnection\n * @param {SkylinkRoom} params.currentRoom - The currrent room\n * @param {String} params.targetMid - Peer's id\n * @param {Object} params.peerBrowser - Peer's user agent object\n * @param {RTCCertificate} params.cert - Represents a certificate that an RTCPeerConnection uses to authenticate.\n * @param {boolean} params.receiveOnly\n * @param {boolean} params.hasScreenshare - Is screenshare enabled\n * @memberOf PeerConnection.PeerConnectionHelpers\n */\nconst addPeer = (params) => {\n  let connection = null;\n  const {\n    currentRoom,\n    targetMid,\n    peerBrowser,\n    cert,\n    receiveOnly,\n    hasScreenShare,\n  } = params;\n  const initOptions = Skylink.getInitOptions();\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const { peerConnections, room } = state;\n  const handleIceConnectionStats = new HandleIceConnectionStats();\n\n  if (!peerConnections[targetMid]) {\n    state.peerConnStatus[targetMid] = {\n      connected: false,\n      init: false,\n    };\n\n    logger.log.INFO([targetMid, null, null, 'Starting the connection to peer. Options provided:'], {\n      peerBrowser,\n      receiveOnly,\n      enableDataChannel: initOptions.enableDataChannel,\n    });\n\n    connection = createPeerConnection({\n      currentRoom,\n      targetMid,\n      hasScreenShare,\n      cert,\n      sdpSemantics: SDP_SEMANTICS.UNIFIED,\n    });\n\n    try {\n      const config = connection.getConfiguration();\n      // connection.addTransceiver(\"video\");\n      if (config.sdpSemantics === SDP_SEMANTICS.UNIFIED) {\n        logger.log.INFO([targetMid, 'SDP Semantics', null, 'Peer Connection has Unified plan.']);\n      } else if (config.sdpSemantics === SDP_SEMANTICS.PLAN_B) {\n        logger.log.INFO([targetMid, 'SDP Semantics', null, 'Peer Connection has Plan-B.']);\n      } else {\n        logger.log.INFO([targetMid, 'SDP Semantics', null, 'The sdpSemantics parameter is not supported by this browser version.']);\n      }\n    } catch (ex) {\n      logger.log.INFO([targetMid, 'SDP Semantics', null, 'getConfiguration() is not available in this browser version. Ex : '], ex);\n    }\n\n    state.peerConnections[targetMid] = connection;\n    Skylink.setSkylinkState(state, currentRoom.id);\n    handleIceConnectionStats.send(room.id, connection.iceConnectionState, targetMid);\n    handleIceGatheringStats.send(room.id, 'new', targetMid, false);\n  } else {\n    logger.log.WARN([targetMid, null, null, 'Connection to peer has already been made.']);\n  }\n\n  return connection;\n};\n\nexport default addPeer;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport { HANDSHAKE_PROGRESS, PEER_TYPE } from '../../constants';\nimport MediaStream from '../../media-stream/index';\nimport SessionDescription from '../../session-description';\nimport getCommonOfferAnswerMessage from '../../server-communication/signaling-server/message-builder/builders/commons/offerAndAnswer';\nimport handleNegotiationStats from '../../skylink-stats/handleNegotiationStats';\nimport MESSAGES from '../../messages';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { handshakeProgress } from '../../skylink-events';\n\nconst { STATS_MODULE: { HANDLE_NEGOTIATION_STATS } } = MESSAGES;\n\nconst onAnswerCreated = (resolve, targetMid, roomState, answer) => {\n  const { room } = roomState;\n\n  logger.log.DEBUG([targetMid, null, null, 'Created answer'], answer);\n  handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS.ANSWER.create, targetMid, answer, false);\n  getCommonOfferAnswerMessage(resolve, targetMid, roomState, answer);\n};\n\nconst onAnswerFailed = (reject, targetMid, roomState, error) => {\n  const { room } = roomState;\n\n  logger.log.ERROR([targetMid, null, null, 'Failed creating an answer:'], error);\n  handleNegotiationStats.send(room.id, HANDLE_NEGOTIATION_STATS.ANSWER.create_error, targetMid, null, false, error);\n  dispatchEvent(handshakeProgress({\n    state: HANDSHAKE_PROGRESS.ERROR,\n    peerId: targetMid,\n    error,\n    room: roomState.room,\n  }));\n  reject(error);\n};\n\n/**\n * @param {SkylinkState} roomState\n * @param {String} targetMid\n * @return {*}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires handshakeProgress\n */\nconst createAnswer = (roomState, targetMid) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const {\n    peerConnections,\n    hasMCU,\n    peerConnStatus,\n    voiceActivityDetection,\n  } = state;\n  const peerConnection = peerConnections[targetMid];\n  const { AdapterJS } = window;\n\n  logger.log.INFO([targetMid, null, null, 'Creating answer with config:'], roomState.room.connection.sdpConstraints);\n\n  const answerConstraints = AdapterJS.webrtcDetectedBrowser === 'edge' ? {\n    offerToReceiveVideo: !(!state.sdpSettings.connection.audio && targetMid !== PEER_TYPE.MCU) && SessionDescription.getSDPCommonSupports(targetMid, peerConnection.remoteDescription, roomState.room.id).video,\n    offerToReceiveAudio: !(!state.sdpSettings.connection.video && targetMid !== PEER_TYPE.MCU) && SessionDescription.getSDPCommonSupports(targetMid, peerConnection.remoteDescription, roomState.room.id).audio,\n    voiceActivityDetection,\n  } : undefined;\n\n  // Add stream only at offer/answer end\n  if (!hasMCU || targetMid === PEER_TYPE.MCU) {\n    MediaStream.addLocalMediaStreams(targetMid, roomState);\n  }\n\n  if (peerConnStatus[targetMid]) {\n    state.peerConnStatus[targetMid].sdpConstraints = answerConstraints;\n  }\n\n  // No ICE restart constraints for createAnswer as it fails in chrome 48\n  // { iceRestart: true }\n  return new Promise((resolve, reject) => peerConnection.createAnswer(answerConstraints)\n    .then(answer => onAnswerCreated(resolve, targetMid, roomState, answer))\n    .catch(error => onAnswerFailed(reject, targetMid, roomState, error)));\n};\n\nexport default createAnswer;\n","import logger from '../../../logger';\nimport Skylink from '../../../index';\nimport { onDataChannelStateChanged } from '../../../skylink-events';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport PeerConnection from '../..';\n\nimport {\n  PEER_CONNECTION_STATE,\n  DC_PROTOCOL_TYPE,\n  DATA_CHANNEL_MESSAGE_ERROR,\n  DATA_CHANNEL_STATE,\n} from '../../../constants';\n\n/**\n * Function that sends data over the DataChannel connection.\n * @private\n * @memberOf PeerConnection\n * @since 2.0.0\n * @fires onDataChannelStateChanged\n */\nconst sendMessageToDataChannel = (roomState, peerId, data, channelProperty, doNotConvert) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const peerConnection = state.peerConnections[peerId];\n  const dataChannel = state.dataChannels[peerId];\n  let channelProp = channelProperty;\n\n  if (!channelProp || channelProp === peerId) {\n    channelProp = 'main';\n  }\n\n  // TODO: What happens when we want to send binary data over or ArrayBuffers?\n  if (!(typeof data === 'object' && data) && !(data && typeof data === 'string')) {\n    logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Dropping invalid data ->'], data);\n    return null;\n  }\n\n  if (!(peerConnection && peerConnection.signalingState !== PEER_CONNECTION_STATE.CLOSED)) {\n    logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Dropping for sending message as Peer connection does not exists or is closed ->'], data);\n    return null;\n  }\n\n  if (!(dataChannel && dataChannel[channelProp])) {\n    logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Dropping for sending message as Datachannel connection does not exists ->'], data);\n    return null;\n  }\n\n  /* eslint-disable prefer-destructuring */\n  const channelName = dataChannel[channelProp].channelName;\n  const channelType = dataChannel[channelProp].channelType;\n  const readyState = dataChannel[channelProp].channel.readyState;\n  const messageType = typeof data === 'object' && data.type === DC_PROTOCOL_TYPE.MESSAGE ? DATA_CHANNEL_MESSAGE_ERROR.MESSAGE : DATA_CHANNEL_MESSAGE_ERROR.TRANSFER;\n\n  if (readyState !== DATA_CHANNEL_STATE.OPEN) {\n    const notOpenError = new Error(`Failed sending message as Datachannel connection state is not opened. Current readyState is ${readyState}`);\n    logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, notOpenError], data);\n    dispatchEvent(onDataChannelStateChanged({\n      peerId,\n      channelName,\n      channelType,\n      messageType,\n      error: notOpenError,\n      state: DATA_CHANNEL_STATE.SEND_MESSAGE_ERROR,\n      bufferAmount: PeerConnection.getDataChannelBuffer(dataChannel[channelProp].channel),\n    }));\n    throw notOpenError;\n  }\n\n  try {\n    if (!doNotConvert && typeof data === 'object') {\n      logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, `Sending ${data.type} protocol message ->`], data);\n      dataChannel[channelProp].channel.send(JSON.stringify(data));\n    } else {\n      logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, 'Sending data with size ->'], data.size || data.length || data.byteLength);\n      dataChannel[channelProp].channel.send(data);\n    }\n  } catch (error) {\n    logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, 'Failed sending data)'], { error, data });\n    dispatchEvent(onDataChannelStateChanged({\n      peerId,\n      channelName,\n      channelType,\n      messageType,\n      error,\n      state: DATA_CHANNEL_STATE.SEND_MESSAGE_ERROR,\n      bufferAmount: PeerConnection.getDataChannelBuffer(dataChannel[channelProp].channel),\n    }));\n    throw error;\n  }\n  return null;\n};\n\nexport default sendMessageToDataChannel;\n","import { DATA_CHANNEL_STATE, DATA_CHANNEL_TYPE, DC_PROTOCOL_TYPE } from '../../../constants';\nimport Skylink from '../../../index';\nimport logger from '../../../logger';\nimport { onDataChannelStateChanged, onIncomingMessage } from '../../../skylink-events';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport sendMessageToDataChannel from './sendMessageToDataChannel';\nimport PeerData from '../../../peer-data';\nimport PeerConnection from '../../index';\n\n/**\n * Function that handles the \"MESSAGE\" data transfer protocol.\n * @private\n * @lends PeerConnection\n * @param {SkylinkState} roomState\n * @since 2.0.0\n * @fires onIncomingMessage\n */\nconst messageProtocolHandler = (roomState, peerId, data, channelProp) => {\n  const senderPeerId = data.sender || peerId;\n  logger.log.INFO([senderPeerId, 'RTCDataChannel', channelProp, 'Received P2P message from peer:'], data);\n  dispatchEvent(onIncomingMessage({\n    room: roomState.room,\n    message: {\n      targetPeerId: data.target,\n      content: data.data,\n      senderPeerId,\n      isDataChannel: true,\n      isPrivate: data.isPrivate,\n    },\n    isSelf: false,\n    peerId: senderPeerId,\n    peerInfo: PeerData.getPeerInfo(senderPeerId, roomState.room),\n  }));\n};\n\n/**\n * Function that handles the data received from Datachannel and\n * routes to the relevant data transfer protocol handler.\n * @lends PeerConnection\n * @private\n * @since 2.0.0\n * @fires onDataChannelStateChanged\n */\nconst processDataChannelData = (roomState, rawData, peerId, channelName, channelType) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  let transferId = null;\n  let streamId = null;\n  // eslint-disable-next-line no-unused-vars\n  let isStreamChunk = false;\n  const channelProp = channelType === DATA_CHANNEL_TYPE.MESSAGING ? 'main' : channelName;\n\n  // Safe access of _dataChannel object in case dataChannel has been closed unexpectedly | ESS-983\n  /* eslint-disable prefer-destructuring */\n  /* eslint-disable no-prototype-builtins */\n  const objPeerDataChannel = state.dataChannels[peerId] || {};\n  if (objPeerDataChannel.hasOwnProperty(channelProp) && typeof objPeerDataChannel[channelProp] === 'object') {\n    transferId = objPeerDataChannel[channelProp].transferId;\n    streamId = objPeerDataChannel[channelProp].streamId;\n  } else {\n    return null; // dataChannel not avaialble propbably having being closed abruptly | ESS-983\n  }\n\n  if (streamId && state.dataStreams[streamId]) {\n    isStreamChunk = state.dataStreams[streamId].sessionChunkType === 'string' ? typeof rawData === 'string' : typeof rawData === 'object';\n  }\n\n  if (!state.peerConnections[peerId]) {\n    logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Dropping data received from Peer as connection is not present ->'], rawData);\n    return null;\n  }\n\n  if (!(state.dataChannels[peerId] && state.dataChannels[peerId][channelProp])) {\n    logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Dropping data received from Peer as Datachannel connection is not present ->'], rawData);\n    return null;\n  }\n\n  // Expect as string\n  if (typeof rawData === 'string') {\n    try {\n      const protocolData = JSON.parse(rawData);\n      isStreamChunk = false;\n\n      logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, `Received protocol ${protocolData.type} message ->`], protocolData);\n\n      // Ignore ACK, ERROR and CANCEL if there is no data transfer session in-progress\n      if ([DC_PROTOCOL_TYPE.ACK, DC_PROTOCOL_TYPE.ERROR, DC_PROTOCOL_TYPE.CANCEL].indexOf(protocolData.type) > -1\n        && !(transferId && state.dataTransfers[transferId] && state.dataTransfers[transferId].sessions[peerId])) {\n        logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Discarded protocol message as data transfer session is not present ->'], protocolData);\n        return null;\n      }\n\n      // TODO: Complete other DataChannel handlers in the below switch case\n      switch (protocolData.type) {\n        case DC_PROTOCOL_TYPE.WRQ:\n          // Discard iOS bidirectional upload when Datachannel is in-progress for data transfers\n          if (transferId && state.dataTransfers[transferId] && state.dataTransfers[transferId].sessions[peerId]) {\n            logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Rejecting bidirectional data transfer request as it is currently not supported in the SDK ->'], protocolData);\n            sendMessageToDataChannel(roomState, peerId, {\n              type: DC_PROTOCOL_TYPE.ACK,\n              ackN: -1,\n              sender: state.user.sid,\n            }, channelProp);\n            break;\n          }\n          // self._WRQProtocolHandler(peerId, protocolData, channelProp);\n          break;\n        // case self._DC_PROTOCOL_TYPE.ACK:\n        //   self._ACKProtocolHandler(peerId, protocolData, channelProp);\n        //   break;\n        // case self._DC_PROTOCOL_TYPE.ERROR:\n        //   self._ERRORProtocolHandler(peerId, protocolData, channelProp);\n        //   break;\n        // case self._DC_PROTOCOL_TYPE.CANCEL:\n        //   self._CANCELProtocolHandler(peerId, protocolData, channelProp);\n        //   break;\n        case DC_PROTOCOL_TYPE.MESSAGE:\n          messageProtocolHandler(state, peerId, protocolData, channelProp);\n          break;\n        default:\n          logger.log.WARN([peerId, 'RTCDataChannel', channelProp, `Discarded unknown ${protocolData.type} message ->`], protocolData);\n      }\n    } catch (error) {\n      // if (rawData.indexOf('{') > -1 && rawData.indexOf('}') > 0) {\n      //   logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, 'Failed parsing protocol step data error ->'], {\n      //     data: rawData,\n      //     error,\n      //   });\n      //\n\n      dispatchEvent(onDataChannelStateChanged({\n        peerId,\n        channelName,\n        channelType,\n        error,\n        state: DATA_CHANNEL_STATE.ERROR,\n        bufferAmount: PeerConnection.getDataChannelBuffer(state.dataChannels[peerId][channelProp].channel),\n      }));\n      //   throw error;\n      // }\n      //\n      // if (!isStreamChunk && !(transferId && state.dataTransfers[transferId] && state.dataTransfers[transferId].sessions[peerId])) {\n      //   logger.log.WARN([peerId, 'RTCDataChannel', channelProp, 'Discarded data chunk without session ->'], rawData);\n      //   return null;\n      // }\n      //\n      // if (!isStreamChunk && transferId) {\n      //   if (state.dataTransfers[transferId].chunks[state.dataTransfers[transferId].sessions[peerId].ackN]) {\n      //     logger.log.WARN([peerId, 'RTCDataChannel', transferId, 'Dropping data chunk ' + (!isStreamChunk ? '@' +\n      //       state.dataTransfers[transferId].sessions[peerId].ackN : '') + ' as it has already been added ->'], rawData);\n      //     return null;\n      //   }\n      // }\n      //\n      // if (!isStreamChunk ? self._dataTransfers[transferId].dataType === self.DATA_TRANSFER_SESSION_TYPE.DATA_URL : true) {\n      //   log.debug([peerId, 'RTCDataChannel', channelProp, 'Received string data chunk ' + (!isStreamChunk ? '@' +\n      //     self._dataTransfers[transferId].sessions[peerId].ackN : '') + ' with size ->'], rawData.length || rawData.size);\n      //\n      //   self._DATAProtocolHandler(peerId, rawData, self.DATA_TRANSFER_DATA_TYPE.STRING,\n      //     rawData.length || rawData.size || 0, channelProp);\n      //\n      // } else {\n      //   var removeSpaceData = rawData.replace(/\\s|\\r|\\n/g, '');\n      //\n      //   log.debug([peerId, 'RTCDataChannel', channelProp, 'Received binary string data chunk @' +\n      //     self._dataTransfers[transferId].sessions[peerId].ackN + ' with size ->'],\n      //     removeSpaceData.length || removeSpaceData.size);\n      //\n      //   self._DATAProtocolHandler(peerId, self._base64ToBlob(removeSpaceData), self.DATA_TRANSFER_DATA_TYPE.BINARY_STRING,\n      //     removeSpaceData.length || removeSpaceData.size || 0, channelProp);\n      // }\n    }\n  } else {\n    // if (!isStreamChunk && !(transferId && self._dataTransfers[transferId] && self._dataTransfers[transferId].sessions[peerId])) {\n    //   log.warn([peerId, 'RTCDataChannel', channelProp, 'Discarded data chunk without session ->'], rawData);\n    //   return;\n    // }\n    //\n    // if (!isStreamChunk && transferId) {\n    //   if (self._dataTransfers[transferId].chunks[self._dataTransfers[transferId].sessions[peerId].ackN]) {\n    //     log.warn([peerId, 'RTCDataChannel', transferId, 'Dropping data chunk ' + (!isStreamChunk ? '@' +\n    //       self._dataTransfers[transferId].sessions[peerId].ackN : '') + ' as it has already been added ->'], rawData);\n    //     return;\n    //   }\n    // }\n    //\n    // if (rawData instanceof Blob) {\n    //   log.debug([peerId, 'RTCDataChannel', channelProp, 'Received blob data chunk ' + (isStreamChunk ? '' :\n    //     '@' + self._dataTransfers[transferId].sessions[peerId].ackN) + ' with size ->'], rawData.size);\n    //\n    //   self._DATAProtocolHandler(peerId, rawData, self.DATA_TRANSFER_DATA_TYPE.BLOB, rawData.size, channelProp);\n    //\n    // } else {\n    //   var byteArray = rawData;\n    //   var blob = null;\n    //\n    //   // Plugin binary handling\n    //   if (rawData.constructor && rawData.constructor.name === 'Array') {\n    //     // Need to re-parse on some browsers\n    //     byteArray = new Int8Array(rawData);\n    //   }\n    //\n    //   // Fallback for older IE versions\n    //   if (AdapterJS.webrtcDetectedBrowser === 'IE') {\n    //     if (window.BlobBuilder) {\n    //       var bb = new BlobBuilder();\n    //       bb.append(rawData.constructor && rawData.constructor.name === 'ArrayBuffer' ?\n    //         byteArray : (new Uint8Array(byteArray)).buffer);\n    //       blob = bb.getBlob();\n    //     }\n    //   } else {\n    //     blob = new Blob([byteArray]);\n    //   }\n    //\n    //   log.debug([peerId, 'RTCDataChannel', channelProp, 'Received arraybuffer data chunk ' + (isStreamChunk ? '' :\n    //     '@' + self._dataTransfers[transferId].sessions[peerId].ackN) + ' with size ->'], blob.size);\n    //\n    //   self._DATAProtocolHandler(peerId, blob, self.DATA_TRANSFER_DATA_TYPE.ARRAY_BUFFER, blob.size, channelProp);\n    // }\n  }\n  return null;\n};\n\nexport default processDataChannelData;\n","import processDataChannelData from '../processDataChannelData';\n\n/**\n * @param {Object} params\n * @param {Event} event\n * @memberOf PeerConnection.PeerConnectionHelpers.CreateDataChannelCallbacks\n */\nconst onmessage = (params, event) => {\n  const {\n    peerId,\n    channelName,\n    channelType,\n    roomState,\n  } = params;\n\n  processDataChannelData(roomState, event.data, peerId, channelName, channelType);\n};\n\nexport default onmessage;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\n\nclass HandleDataChannelStats extends SkylinkStats {\n  constructor() {\n    super();\n    const { AdapterJS } = window;\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      peer_id: null,\n      state: null,\n      channel_id: null,\n      channel_label: null,\n      channel_type: null,\n      channel_binary_type: null,\n      error: null,\n      agent_name: AdapterJS.webrtcDetectedBrowser,\n      agent_type: AdapterJS.webrtcDetectedType,\n      agent_version: AdapterJS.webrtcDetectedVersion,\n    };\n  }\n\n  send(roomKey, state, peerId, channel, channelProp, error) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.uid) || null;\n    this.model.peer_id = peerId;\n    this.model.client_id = roomState.clientId;\n    this.model.state = state;\n    this.model.channel = channel;\n    this.model.channel_id = channel.id;\n    this.model.channel_label = channel.label;\n    this.model.channel_type = channelProp === 'main' ? 'persistent' : 'temporal';\n    this.model.channel_binary_type = channel.binaryType;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.error = (typeof error === 'string' ? error : (error && error.message)) || null;\n\n    if (this.model.agent_name === 'plugin') {\n      this.model.channel_binary_type = 'int8Array';\n\n      // For IE 10 and below browsers, binary support is not available.\n      if (this.model.agent_name === 'IE' && this.model.agent_version < 11) {\n        this.model.channel_binary_type = 'none';\n      }\n    }\n\n    this.postStats(this.endpoints.dataChannel, this.model);\n  }\n}\n\nexport default HandleDataChannelStats;\n","import onmessage from './onmessage';\nimport onerror from './onerror';\nimport onopen from './onopen';\nimport onbufferedamountlow from './onbufferedamountlow';\nimport onclose from './onclose';\n\n/**\n * @description Callbacks for createDataChannel method\n * @type {{onopen, onmessage, onerror, onbufferedamountlow, onclose}}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @namespace CreateDataChannelCallbacks\n * @private\n */\nconst callbacks = {\n  onopen,\n  onmessage,\n  onerror,\n  onbufferedamountlow,\n  onclose,\n};\n\nexport default callbacks;\n","import { onDataChannelStateChanged } from '../../../../skylink-events';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport logger from '../../../../logger';\nimport { DATA_CHANNEL_STATE } from '../../../../constants';\nimport messages from '../../../../messages';\nimport PeerConnection from '../../../index';\nimport HandleDataChannelStats from '../../../../skylink-stats/handleDataChannelStats';\n\n/**\n * @param {Object} params\n * @fires onDataChannelStateChanged\n * @memberOf PeerConnection.PeerConnectionHelpers.CreateDataChannelCallbacks\n */\nconst onopen = (params) => {\n  const {\n    dataChannel,\n    channelProp,\n    channelName,\n    channelType,\n    peerId,\n    roomState,\n    bufferThreshold,\n  } = params;\n  const handleDataChannelStats = new HandleDataChannelStats();\n  const { room } = roomState;\n  const { STATS_MODULE } = messages;\n\n  logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, 'Datachannel has opened']);\n  dataChannel.bufferedAmountLowThreshold = bufferThreshold || 0;\n  handleDataChannelStats.send(room.id, STATS_MODULE.HANDLE_DATA_CHANNEL_STATS.closed, peerId, dataChannel, channelProp);\n  dispatchEvent(onDataChannelStateChanged({\n    state: DATA_CHANNEL_STATE.OPEN,\n    peerId,\n    channelName,\n    channelType,\n    bufferAmount: PeerConnection.getDataChannelBuffer(dataChannel),\n  }));\n};\n\nexport default onopen;\n","import logger from '../../../../logger';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { onDataChannelStateChanged } from '../../../../skylink-events';\nimport PeerConnection from '../../../index';\nimport { DATA_CHANNEL_STATE } from '../../../../constants';\nimport Skylink from '../../../../index';\nimport HandleDataChannelStats from '../../../../skylink-stats/handleDataChannelStats';\n\n/**\n *\n * @param {Object} params\n * @param {Error} error\n * @fires onDataChannelStateChanged\n * @memberOf PeerConnection.PeerConnectionHelpers.CreateDataChannelCallbacks\n */\nconst onerror = (params, error) => {\n  const {\n    dataChannel,\n    peerId,\n    channelName,\n    channelProp,\n    channelType,\n    roomState,\n  } = params;\n  if (error.error.errorDetail !== 'NONE') {\n    const state = Skylink.getSkylinkState(roomState.room.id);\n    const { room } = state;\n    const handleDataChannelStats = new HandleDataChannelStats();\n\n    logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, 'Datachannel has an exception ->'], error);\n    handleDataChannelStats.send(room.id, DATA_CHANNEL_STATE.ERROR, peerId, dataChannel, channelProp, error);\n    dispatchEvent(onDataChannelStateChanged({\n      state: DATA_CHANNEL_STATE.ERROR,\n      room,\n      peerId,\n      channelName,\n      channelType,\n      bufferAmount: PeerConnection.getDataChannelBuffer(dataChannel),\n      error,\n    }));\n  } else {\n    // \"Transport channel close\" error triggered on calling dataChannel.close()\n    logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, 'Datachannel state ->'], error.error.message);\n  }\n};\n\nexport default onerror;\n","import logger from '../../../../logger';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { onDataChannelStateChanged } from '../../../../skylink-events';\nimport PeerConnection from '../../../index';\nimport { DATA_CHANNEL_STATE } from '../../../../constants';\nimport Skylink from '../../../../index';\n\n/**\n *\n * @param {Object} params\n * @fires onDataChannelStateChanged\n * @memberOf PeerConnection.PeerConnectionHelpers.CreateDataChannelCallbacks\n */\nconst onbufferedamountlow = (params) => {\n  const {\n    dataChannel,\n    peerId,\n    channelName,\n    channelProp,\n    channelType,\n    roomState,\n  } = params;\n\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { room } = state;\n  logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, 'Datachannel buffering data transfer low']);\n\n  dispatchEvent(onDataChannelStateChanged({\n    state: DATA_CHANNEL_STATE.BUFFERED_AMOUNT_LOW,\n    room,\n    peerId,\n    channelName,\n    channelType,\n    bufferAmount: PeerConnection.getDataChannelBuffer(dataChannel),\n  }));\n};\n\nexport default onbufferedamountlow;\n","import logger from '../../../../logger';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { dataTransferState, onDataChannelStateChanged } from '../../../../skylink-events';\nimport {\n  DATA_CHANNEL_STATE, DATA_CHANNEL_TYPE, PEER_CONNECTION_STATE, HANDSHAKE_PROGRESS,\n} from '../../../../constants';\nimport Skylink from '../../../../index';\nimport messages from '../../../../messages';\nimport HandleDataChannelStats from '../../../../skylink-stats/handleDataChannelStats';\nimport PeerConnection from '../../../index';\n\nconst getTransferIDByPeerId = (pid, state) => {\n  const { dataTransfers } = state;\n  const transferIds = Object.keys(dataTransfers);\n\n  for (let i = 0; i < transferIds.length; i += 1) {\n    if (transferIds[i].indexOf(pid) !== -1) {\n      return transferIds[i];\n    }\n  }\n  return null;\n};\n\n/**\n * @param {Object} params\n * @fires onDataChannelStateChanged\n * @fires dataTransferState\n * @memberOf PeerConnection.PeerConnectionHelpers.CreateDataChannelCallbacks\n */\nconst onclose = (params) => {\n  const {\n    dataChannel,\n    peerId,\n    channelName,\n    channelProp,\n    channelType,\n    roomState,\n  } = params;\n  const { DATA_CHANNEL, STATS_MODULE } = messages;\n  const state = Skylink.getSkylinkState(roomState.room.id) || Object.values(Skylink.getSkylinkState())[0]; // to handle leaveAllRooms method\n\n  if (!state) {\n    return;\n  }\n\n  const { room, peerConnections } = state;\n  const transferId = getTransferIDByPeerId(peerId, state);\n  const handleDataChannelStats = new HandleDataChannelStats();\n\n  logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, DATA_CHANNEL.closed]);\n\n  try {\n    handleDataChannelStats.send(room.id, STATS_MODULE.HANDLE_DATA_CHANNEL_STATS.closed, peerId, dataChannel, channelProp);\n    dispatchEvent(onDataChannelStateChanged({\n      state: DATA_CHANNEL_STATE.CLOSED,\n      peerId,\n      room,\n      channelName,\n      channelType,\n      bufferAmount: PeerConnection.getDataChannelBuffer(dataChannel),\n    }));\n\n    // ESS-983 Handling dataChannel unexpected close to trigger dataTransferState Error.\n    if (transferId) {\n      dispatchEvent(dataTransferState({\n        state: DATA_CHANNEL_STATE.ERROR,\n        transferId,\n        peerId,\n        transferInfo: null, // TODO: implement self._getTransferInfo(transferId, peerId, true, false, false) data-transfer\n        error: new Error(DATA_CHANNEL.closed),\n      }));\n    }\n\n    if (peerConnections[peerId] && peerConnections[peerId].remoteDescription\n      && peerConnections[peerId].remoteDescription.sdp && (peerConnections[peerId].remoteDescription.sdp.indexOf(\n      'm=application',\n    ) === -1 || peerConnections[peerId].remoteDescription.sdp.indexOf('m=application 0') > 0)) {\n      return;\n    }\n\n    if (channelType === DATA_CHANNEL_TYPE.MESSAGING) {\n      setTimeout(() => {\n        if (peerConnections[peerId]\n          && peerConnections[peerId].signalingState !== PEER_CONNECTION_STATE.CLOSED\n          && (peerConnections[peerId].localDescription\n            && peerConnections[peerId].localDescription.type === HANDSHAKE_PROGRESS.OFFER)) {\n          logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, DATA_CHANNEL.reviving_dataChannel]);\n\n          PeerConnection.createDataChannel({\n            peerId,\n            dataChannel,\n            bufferThreshold: PeerConnection.getDataChannelBuffer(dataChannel),\n            createAsMessagingChannel: true,\n            roomState: state,\n          });\n          handleDataChannelStats.send(room.id, STATS_MODULE.HANDLE_DATA_CHANNEL_STATS.reconnecting, peerId, { label: channelName }, 'main');\n        }\n      }, 100);\n    }\n  } catch (error) {\n    logger.log.WARN([peerId, 'RTCDataChannel', channelProp, DATA_CHANNEL.closed]);\n  }\n};\n\nexport default onclose;\n","import {\n  DATA_STREAM_STATE,\n  DATA_TRANSFER_STATE,\n  ON_INCOMING_DATA,\n  ON_INCOMING_DATA_REQUEST,\n  ON_INCOMING_DATA_STREAM,\n  ON_INCOMING_DATA_STREAM_STARTED,\n  ON_INCOMING_DATA_STREAM_STOPPED,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @description Event triggered when a data streaming state has changed.\n * @event SkylinkEvents.dataStreamState\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.DATA_STREAM_STATE} detail.state The current data streaming state.\n * @param {String} detail.streamId The data streaming session ID.\n *   Note that this is defined as <code>null</code> when <code>state</code> payload is <code>START_ERROR</code>.\n * @param {String} detail.peerId The Peer ID.\n *   Note that this could be defined as <code>null</code> when <code>state</code> payload is\n *   <code>START_ERROR</code> and there is no Peers to start data streaming with.\n * @param {JSON} detail.streamInfo The data streaming information.\n * @param {Blob|String} [detail.streamInfo.chunk] The data chunk received.\n *   Defined only when <code>state</code> payload is <code>RECEIVED</code> or <code>SENT</code>.\n * @param {Number} detail.streamInfo.chunkSize The data streaming data chunk size received.\n * @param {SkylinkConstants.DATA_TRANSFER_DATA_TYPE} detail.streamInfo.chunkType The data streaming data chunk type received.\n *   The initial data chunks value may change depending on the currently received data chunk type or the\n *   agent supported sending type of data chunks.\n * @param {String} detail.streamInfo.isStringStream The flag if data streaming data chunks are strings.\n * @param {Boolean} detail.streamInfo.isPrivate The flag if data streaming is targeted or not, basing\n *   off the <code>targetPeerId</code> parameter being defined in\n *   {@link Skylink#startStreamingData}.\n * @param {String} detail.streamInfo.senderPeerId The sender Peer ID.\n * @param {Error} [detail.error] The error object.\n *   Defined only when <code>state</code> payload is <code>ERROR</code> or <code>START_ERROR</code>.\n * @ignore\n */\nexport const dataStreamState = detail => new SkylinkEvent(DATA_STREAM_STATE, { detail });\n\n/**\n * @description Event triggered when a data transfer state has changed.\n * @event SkylinkEvents.dataTransferState\n * @param {Object} detail - Event's payload.\n * @param {SkylinkConstants.DATA_TRANSFER_STATE} detail.state The current data transfer state.\n * @param {String} detail.transferId The data transfer ID.\n *   Note that this is defined as <code>null</code> when <code>state</code> payload is <code>START_ERROR</code>.\n * @param {String} detail.peerId The Peer ID.\n *   Note that this could be defined as <code>null</code> when <code>state</code> payload is\n *   <code>START_ERROR</code> and there is no Peers to start data transfer with.\n * @param {JSON} detail.transferInfo The data transfer information.\n * @param {Blob|String} [detail.transferInfo.data] The data object.\n *   Defined only when <code>state</code> payload is <code>UPLOAD_STARTED</code> or\n *   <code>DOWNLOAD_COMPLETED</code>.\n * @param {String} detail.transferInfo.name The data transfer name.\n * @param {Number} detail.transferInfo.size The data transfer data object size.\n * @param {SkylinkConstants.DATA_TRANSFER_SESSION_TYPE} detail.transferInfo.dataType The data transfer session type.\n * @param {SkylinkConstants.DATA_TRANSFER_DATA_TYPE} detail.transferInfo.chunkType The data transfer type of data chunk being used to send to Peer for transfers.\n *   For {@link Skylink#sendBlobData} data transfers, the\n *   initial data chunks value may change depending on the currently received data chunk type or the\n *   agent supported sending type of data chunks.\n *   For {@link Skylink#sendURLData} data transfers, it is\n *   <code>STRING</code> always.\n * @param {String} [detail.transferInfo.mimeType] The data transfer data object MIME type.\n *   Defined only when {@link Skylink#sendBlobData}\n *   data object sent MIME type information is defined.\n * @param {Number} detail.transferInfo.chunkSize The data transfer data chunk size.\n * @param {Number} detail.transferInfo.percentage The data transfer percentage of completion progress.\n * @param {Number} detail.transferInfo.timeout The flag if data transfer is targeted or not, basing\n *   off the <code>targetPeerId</code> parameter being defined in\n *   {@link Skylink#sendURLData} or\n *   {@link Skylink#sendBlobData}.\n * @param {Boolean} detail.transferInfo.isPrivate The flag if message is targeted or not, basing\n *   off the <code>targetPeerId</code> parameter being defined in\n *   {@link Skylink#sendBlobData} or\n *   {@link Skylink#sendURLData}.\n * @param {SkylinkConstants.DATA_TRANSFER_TYPE} detail.transferInfo.direction The data transfer direction.\n * @param {JSON} [detail.error] The error result.\n *   Defined only when <code>state</code> payload is <code>ERROR</code>, <code>CANCEL</code>,\n *   <code>REJECTED</code>, <code>START_ERROR</code> or <code>USER_REJECTED</code>.\n * @param {Error|String} detail.error.message The error object.\n * @param {SkylinkConstants.DATA_TRANSFER_TYPE} detail.error.transferType The data transfer direction from where the error occurred.\n * @ignore\n */\nexport const dataTransferState = detail => new SkylinkEvent(DATA_TRANSFER_STATE, { detail });\n\n/**\n * @description Event triggered when receiving completed data transfer from Peer.\n * @event SkylinkEvents.onIncomingData\n * @param {Object} detail - Event's payload.\n * @param {Blob|String} detail.data The data.\n * @param {String} detail.transferId The data transfer ID.\n * @param {String} detail.peerId The Peer ID.\n * @param {JSON} detail.transferInfo The data transfer information.\n *   Object signature matches the <code>transferInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:dataTransferState|dataTransferStateEvent}\n *   except without the <code>data</code> property.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @ignore\n */\nexport const onIncomingData = detail => new SkylinkEvent(ON_INCOMING_DATA, { detail });\n\n/**\n * @description Event triggered when receiving upload data transfer from Peer.\n * @event SkylinkEvents.onIncomingDataRequest\n * @param {Object} detail - Event's payload.\n * @param {String} detail.transferId The transfer ID.\n * @param {String} detail.peerId The Peer ID.\n * @param {String} detail.transferInfo The data transfer information.\n *   Object signature matches the <code>transferInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:dataTransferState|dataTransferStateEvent}\n *   except without the <code>data</code> property.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @ignore\n */\nexport const onIncomingDataRequest = detail => new SkylinkEvent(ON_INCOMING_DATA_REQUEST, { detail });\n\n/**\n * @description Event triggered when data streaming session has been stopped from Peer to User.\n * @event SkylinkEvents.onIncomingDataStream\n * @param {Object} detail - Event's payload.\n * @param {Blob|String} detail.chunk The data chunk received.\n * @param {String} detail.streamId The data streaming session ID.\n * @param {String} detail.peerId The Peer ID.\n * @param {JSON} detail.streamInfo The data streaming session information.\n *   Object signature matches the <code>streamInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:dataStreamState|dataStreamStateEvent}\n *   except without the <code>chunk</code> property.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @ignore\n */\nexport const onIncomingDataStream = detail => new SkylinkEvent(ON_INCOMING_DATA_STREAM, { detail });\n\n/**\n * @description Event triggered when data streaming session has been started from Peer to User.\n * @event SkylinkEvents.onIncomingDataStreamStarted\n * @param {Object} detail - Event's payload.\n * @param {String} detail.streamId The data streaming session ID.\n * @param {String} detail.peerId The Peer ID.\n * @param {JSON} detail.streamInfo The data streaming session information.\n *   Object signature matches the <code>streamInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:dataStreamState|dataStreamStateEvent}\n *   except without the <code>chunk</code> property.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @ignore\n */\nexport const onIncomingDataStreamStarted = detail => new SkylinkEvent(ON_INCOMING_DATA_STREAM_STARTED, { detail });\n\n/**\n * @description Event triggered when data streaming session has been stopped from Peer to User.\n * @event SkylinkEvents.onIncomingDataStreamStopped\n * @param {Object} detail - Event's payload.\n * @param {String} detail.streamId The data streaming session ID.\n * @param {String} detail.peerId The Peer ID.\n * @param {JSON} detail.streamInfo The data streaming session information.\n *   Object signature matches the <code>streamInfo</code> parameter payload received in the\n *   {@link SkylinkEvents.event:dataStreamState|dataStreamStateEvent}\n *   except without the <code>chunk</code> property.\n * @param {Boolean} detail.isSelf The flag if Peer is User.\n * @ignore\n */\nexport const onIncomingDataStreamStopped = detail => new SkylinkEvent(ON_INCOMING_DATA_STREAM_STOPPED, { detail });\n","import Skylink from '../../../index';\nimport logger from '../../../logger';\nimport sendMessageToDataChannel from './sendMessageToDataChannel';\nimport { DC_PROTOCOL_TYPE, PEER_TYPE } from '../../../constants';\nimport { onIncomingMessage } from '../../../skylink-events';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport PeerData from '../../../peer-data';\nimport { getRoomStateByName } from '../../../utils/helpers';\n\n/**\n * @param message\n * @param {String} targetPeerId\n * @param {SkylinkState} roomState\n * @returns {null}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires onIncomingMessage\n */\nconst sendP2PMessageForRoom = (roomState, message, targetPeerId) => {\n  const initOptions = Skylink.getInitOptions();\n  const {\n    dataChannels,\n    inRoom,\n    user,\n    hasMCU,\n  } = roomState;\n\n  let listOfPeers = Object.keys(dataChannels);\n  let isPrivate = false;\n\n  if (Array.isArray(targetPeerId) && targetPeerId.length) {\n    listOfPeers = targetPeerId;\n    isPrivate = true;\n  } else if (targetPeerId && typeof targetPeerId === 'string') {\n    listOfPeers = [targetPeerId];\n    isPrivate = true;\n  }\n\n  if (!inRoom || !(user && user.sid)) {\n    logger.log.ERROR('Unable to send message as User is not in Room. ->', message);\n    return null;\n  }\n\n  if (!initOptions.enableDataChannel) {\n    logger.log.ERROR('Unable to send message as User does not have DataChannel enabled. ->', message);\n    return null;\n  }\n\n  // Loop out unwanted Peers\n  for (let i = 0; i < listOfPeers.length; i += 1) {\n    const peerId = listOfPeers[i];\n\n    if (!dataChannels[peerId] && !hasMCU) {\n      logger.log.ERROR([peerId, 'RTCDataChannel', null, 'Dropping of sending message to Peer as DataChannel connection does not exist.']);\n      listOfPeers.splice(i, 1);\n      i -= 1;\n    } else if (peerId === PEER_TYPE.MCU) {\n      listOfPeers.splice(i, 1);\n      i -= 1;\n    } else if (!hasMCU) {\n      logger.log.DEBUG([peerId, 'RTCDataChannel', null, `Sending ${isPrivate ? 'private' : ''} P2P message to Peer.`]);\n\n      sendMessageToDataChannel(roomState, peerId, {\n        type: DC_PROTOCOL_TYPE.MESSAGE,\n        isPrivate,\n        sender: user.sid,\n        target: targetPeerId ? peerId : null,\n        data: message,\n      }, 'main');\n    }\n  }\n\n  if (listOfPeers.length === 0) {\n    logger.log.WARN('Currently there are no Peers to send P2P message to.');\n  }\n\n  if (hasMCU) {\n    logger.log.DEBUG([PEER_TYPE.MCU, 'RTCDataChannel', null, `Broadcasting ${isPrivate ? 'private' : ''} P2P message to Peers.`]);\n    sendMessageToDataChannel(roomState, PEER_TYPE.MCU, {\n      type: DC_PROTOCOL_TYPE.MESSAGE,\n      isPrivate,\n      sender: user.sid,\n      target: listOfPeers,\n      data: message,\n    }, 'main');\n  }\n\n  if (targetPeerId || !hasMCU) {\n    dispatchEvent(onIncomingMessage({\n      room: roomState.room,\n      message: {\n        targetPeerId: targetPeerId || null,\n        content: message,\n        senderPeerId: user.sid,\n        isDataChannel: true,\n        isPrivate,\n      },\n      isSelf: true,\n      peerId: user.sid,\n      peerInfo: PeerData.getCurrentSessionInfo(roomState.room),\n    }));\n  }\n\n  return null;\n};\n\nconst sendP2PMessage = (roomName, message, targetPeerId) => {\n  const roomState = getRoomStateByName(roomName);\n  if (roomState) {\n    sendP2PMessageForRoom(roomState, message, targetPeerId);\n  } else {\n    // Global P2P Message - Broadcast to all rooms\n    const roomStates = Skylink.getSkylinkState();\n    const roomKeys = Object.keys(roomStates);\n    for (let i = 0; i < roomKeys.length; i += 1) {\n      const state = roomStates[roomKeys[i]];\n      sendP2PMessageForRoom(state, message, targetPeerId);\n    }\n  }\n};\n\n\nexport default sendP2PMessage;\n","import { DATA_CHANNEL_STATE, TAGS } from '../../../constants';\nimport { onDataChannelStateChanged } from '../../../skylink-events';\nimport MESSAGES from '../../../messages';\nimport HandleDataChannelStats from '../../../skylink-stats/handleDataChannelStats';\nimport logger from '../../../logger';\nimport PeerConnection from '../../index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport Skylink from '../../../index';\n\nconst closeFn = (roomState, peerId, channelNameProp) => {\n  const { dataChannels } = roomState;\n  const targetDataChannel = dataChannels[peerId][channelNameProp];\n  const { channelName, channelType } = targetDataChannel.channelName;\n\n  if (targetDataChannel.readyState !== DATA_CHANNEL_STATE.CLOSED) {\n    const { room } = roomState;\n    const handleDataChannelStats = new HandleDataChannelStats();\n    logger.log.DEBUG([peerId, TAGS.DATA_CHANNEL, channelNameProp, MESSAGES.DATA_CHANNEL.CLOSING]);\n\n    handleDataChannelStats.send(room.id, DATA_CHANNEL_STATE.CLOSING, peerId, targetDataChannel.channel, channelNameProp);\n\n    dispatchEvent(onDataChannelStateChanged({\n      room,\n      peerId,\n      state: DATA_CHANNEL_STATE.CLOSING,\n      channelName,\n      channelType,\n      bufferAmount: PeerConnection.getDataChannelBuffer(targetDataChannel.channel),\n    }));\n\n    targetDataChannel.channel.close();\n\n    delete dataChannels[peerId][channelNameProp];\n  }\n};\n\nconst closeAllDataChannels = (roomState, peerId) => {\n  const { dataChannels } = roomState;\n  const channelNameProp = Object.keys(dataChannels[peerId]);\n  for (let i = 0; i < channelNameProp.length; i += 1) {\n    if (Object.hasOwnProperty.call(dataChannels[peerId], channelNameProp[i])) {\n      closeFn(roomState, peerId, channelNameProp[i]);\n    }\n  }\n\n  delete dataChannels[peerId];\n};\n\n/**\n * Function that closes the datachannel.\n * @param {SkylinkState} roomState\n * @param {String} peerId - The Peer Id.\n * @param {String} [channelProp=main] - The channel property.\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires onDataChannelStateChanged\n */\nconst closeDataChannel = (roomState, peerId, channelProp = 'main') => {\n  try {\n    const updatedState = Skylink.getSkylinkState(roomState.room.id);\n    const { dataChannels, room } = updatedState;\n\n    if (!dataChannels[peerId] || !dataChannels[peerId][channelProp]) {\n      logger.log.WARN([peerId, TAGS.DATA_CHANNEL, channelProp || null,\n        MESSAGES.DATA_CHANNEL.ERRORS.NO_SESSIONS]);\n      return;\n    }\n\n    if (channelProp === 'main') {\n      closeAllDataChannels(updatedState, peerId);\n      return;\n    }\n\n    closeFn(updatedState, peerId, channelProp);\n    Skylink.setSkylinkState(updatedState, room.id);\n  } catch (error) {\n    logger.log.ERROR([peerId, TAGS.DATA_CHANNEL, channelProp || null,\n      MESSAGES.DATA_CHANNEL.ERRORS.FAILED_CLOSING], error);\n  }\n};\n\nexport default closeDataChannel;\n","import SkylinkSignalingServer from '../../../server-communication/signaling-server';\n\nconst sendRestartOfferMsg = (state, peerId, doIceRestart) => {\n  const { room } = state;\n  const signaling = new SkylinkSignalingServer();\n\n  try {\n    const restartOfferMsg = signaling.messageBuilder.getRestartOfferMessage(room.id, peerId, doIceRestart);\n    signaling.offer(room, peerId, doIceRestart, restartOfferMsg);\n    return peerId;\n  } catch (ex) {\n    return [peerId, ex];\n  }\n};\n\nexport default sendRestartOfferMsg;\n","import Skylink from '../../..';\nimport logger from '../../../logger';\nimport { PEER_CONNECTION_STATE } from '../../../constants';\nimport SkylinkSignalingServer from '../../../server-communication/signaling-server';\nimport messages from '../../../messages';\nimport sendRestartOfferMsg from './sendRestartOfferMsg';\n\n/**\n * Function that sends restart message to the signaling server.\n * @param {String} peerId\n * @param {SkylinkState} roomState\n * @param {Object} options\n * @param {Object} options.bandwidth\n * @param {Object} options.googleXBandwidth\n * @return {Promise}\n * @memberOf PeerConnection.PeerConnectionHelpers\n */\nconst restartPeerConnection = (peerId, roomState, options) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { AdapterJS } = window;\n  const {\n    peerConnections, peerCustomConfigs, peerEndOfCandidatesCounter, room, user,\n  } = state;\n  const { doIceRestart, bwOptions } = options;\n  const signaling = new SkylinkSignalingServer();\n  const { PEER_CONNECTION } = messages;\n  const errors = [];\n\n  return new Promise((resolve) => {\n    // reject with wrong peerId\n    if (!peerConnections[peerId]) {\n      logger.log.ERROR([peerId, null, null, PEER_CONNECTION.refresh_peerId_no_match]);\n      errors.push(PEER_CONNECTION.refresh_peerId_no_match);\n      return resolve([peerId, errors]);\n    }\n\n    const peerConnection = peerConnections[peerId];\n    // refresh not supported in edge\n    if (AdapterJS.webrtcDetectedBrowser === 'edge') {\n      logger.log.WARN([peerId, 'RTCPeerConnection', null, PEER_CONNECTION.refresh_not_supported]);\n      errors.push(PEER_CONNECTION.refresh_no_edge_support);\n    }\n\n    if (errors.length !== 0) {\n      return resolve([peerId, errors]);\n    }\n\n    // Let's check if the signalingState is stable first.\n    // In another galaxy or universe, where the local description gets dropped..\n    // In the offerHandler or answerHandler, do the appropriate flags to ignore or drop \"extra\" descriptions\n    if (peerConnection.signalingState === PEER_CONNECTION_STATE.STABLE) {\n      logger.log.INFO([peerId, null, null, 'Sending restart message to signaling server ->'], {\n        iceRestart: doIceRestart,\n        options: bwOptions,\n      });\n\n      peerCustomConfigs[peerId] = peerCustomConfigs[peerId] || {};\n      peerCustomConfigs[peerId].bandwidth = peerCustomConfigs[peerId].bandwidth || {};\n      peerCustomConfigs[peerId].googleXBandwidth = peerCustomConfigs[peerId].googleXBandwidth || {};\n\n      if (bwOptions.bandwidth && typeof bwOptions.bandwidth === 'object') {\n        if (typeof bwOptions.bandwidth.audio === 'number') {\n          peerCustomConfigs[peerId].bandwidth.audio = bwOptions.bandwidth.audio;\n        }\n        if (typeof bwOptions.bandwidth.video === 'number') {\n          peerCustomConfigs[peerId].bandwidth.video = bwOptions.bandwidth.video;\n        }\n        if (typeof bwOptions.bandwidth.data === 'number') {\n          peerCustomConfigs[peerId].bandwidth.data = bwOptions.bandwidth.data;\n        }\n      }\n\n      if (bwOptions.googleXBandwidth && typeof bwOptions.googleXBandwidth === 'object') {\n        if (typeof bwOptions.googleXBandwidth.min === 'number') {\n          peerCustomConfigs[peerId].googleXBandwidth.min = bwOptions.googleXBandwidth.min;\n        }\n        if (typeof bwOptions.googleXBandwidth.max === 'number') {\n          peerCustomConfigs[peerId].googleXBandwidth.max = bwOptions.googleXBandwidth.max;\n        }\n      }\n\n      peerEndOfCandidatesCounter[peerId] = peerEndOfCandidatesCounter[peerId] || {};\n      peerEndOfCandidatesCounter[peerId].len = 0;\n\n      return resolve(sendRestartOfferMsg(state, peerId, doIceRestart));\n    }\n\n    // Checks if the local description is defined first\n    const hasLocalDescription = peerConnection.localDescription && peerConnection.localDescription.sdp;\n    // This is when the state is stable and re-handshaking is possible\n    // This could be due to previous connection handshaking that is already done\n    if (peerConnection.signalingState === PEER_CONNECTION_STATE.HAVE_LOCAL_OFFER && hasLocalDescription) {\n      signaling.sendMessage({\n        type: peerConnection.localDescription.type,\n        sdp: peerConnection.localDescription.sdp,\n        mid: user.sid,\n        target: peerId,\n        rid: room.id,\n        restart: true,\n      });\n      return resolve(peerId);\n    }\n\n    const unableToRestartError = `Failed restarting as peer connection state is ${peerConnection.signalingState} and there is no localDescription set to connection. There could be a handshaking step error.`;\n    logger.log.DEBUG([peerId, 'RTCPeerConnection', null, unableToRestartError], {\n      localDescription: peerConnection.localDescription,\n      remoteDescription: peerConnection.remoteDescription,\n    });\n    errors.push(unableToRestartError);\n\n    resolve([peerId, errors]);\n\n    return null;\n  });\n};\n\nexport default restartPeerConnection;\n","import Skylink from '../../../index';\nimport sendRestartOfferMsg from './sendRestartOfferMsg';\nimport { PEER_TYPE } from '../../../constants';\n\n/**\n * @param {SkylinkState} roomState\n * @param {boolean} [doIceRestart = false]\n * @param {Object} [bwOptions = {}]\n * @param {JSON} bwOptions.bandwidth\n * @param {JSON} bwOptions.googleXBandwidth\n * @returns {Promise}\n * @memberOf PeerConnection.PeerConnectionHelpers\n */\nconst restartMCUConnection = (roomState, doIceRestart, bwOptions) => new Promise((resolve) => {\n  const updatedRoomState = roomState;\n  const initOptions = Skylink.getInitOptions();\n  const { mcuUseRenegoRestart } = initOptions;\n\n  try {\n    if (bwOptions.bandwidth && typeof bwOptions.bandwidth === 'object') {\n      if (typeof bwOptions.bandwidth.audio === 'number') {\n        updatedRoomState.streamsBandwidthSettings.bAS.audio = bwOptions.bandwidth.audio;\n      }\n      if (typeof bwOptions.bandwidth.video === 'number') {\n        updatedRoomState.streamsBandwidthSettings.bAS.video = bwOptions.bandwidth.video;\n      }\n      if (typeof bwOptions.bandwidth.data === 'number') {\n        updatedRoomState.streamsBandwidthSettings.bAS.data = bwOptions.bandwidth.data;\n      }\n    }\n\n    if (bwOptions.googleXBandwidth && typeof bwOptions.googleXBandwidth === 'object') {\n      if (typeof bwOptions.googleXBandwidth.min === 'number') {\n        updatedRoomState.streamsBandwidthSettings.googleX.min = bwOptions.googleXBandwidth.min;\n      }\n      if (typeof bwOptions.googleXBandwidth.max === 'number') {\n        updatedRoomState.streamsBandwidthSettings.googleX.max = bwOptions.googleXBandwidth.max;\n      }\n    }\n\n    if (mcuUseRenegoRestart) {\n      updatedRoomState.peerEndOfCandidatesCounter.MCU = updatedRoomState.peerEndOfCandidatesCounter.MCU || {};\n      updatedRoomState.peerEndOfCandidatesCounter.MCU.len = 0;\n\n      Skylink.setSkylinkState(updatedRoomState);\n      resolve(sendRestartOfferMsg(updatedRoomState, PEER_TYPE.MCU, doIceRestart));\n    }\n  } catch (error) {\n    resolve([PEER_TYPE.MCU, error]);\n  }\n});\n\nexport default restartMCUConnection;\n","import Skylink from '../../..';\nimport logger from '../../../logger';\nimport restartPeerConnection from './restartPeerConnection';\nimport restartMCUConnection from './restartMCUConnection';\n\nconst refreshSinglePeer = (peerId, roomState, options) => {\n  logger.log.INFO([peerId, 'PeerConnection', null, 'Restarting peer connection.']);\n  return restartPeerConnection(peerId, roomState, options);\n};\n\n/**\n * @param {String<Array>}listOfPeers\n * @param {SkylinkState} roomState\n * @param {boolean} [doIceRestart = false]\n * @param {Object} [bwOptions = {}]\n * @param {JSON} bwOptions.bandwidth\n * @param {JSON} bwOptions.googleXBandwidth\n * @returns {Promise}\n * @memberOf PeerConnection.PeerConnectionHelpers\n */\nconst refreshPeerConnection = (listOfPeers, roomState, doIceRestart = false, bwOptions = {}) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { hasMCU } = state;\n\n  try {\n    if (!hasMCU) {\n      const restartPeerConnectionPromises = [];\n      for (let i = 0; i < listOfPeers.length; i += 1) {\n        const peerId = listOfPeers[i];\n        const options = {\n          doIceRestart,\n          bwOptions,\n        };\n        const restartPeerConnectionPromise = refreshSinglePeer(peerId, state, options);\n        restartPeerConnectionPromises.push(restartPeerConnectionPromise);\n      }\n\n      return Promise.all(restartPeerConnectionPromises);\n    }\n\n    return restartMCUConnection(roomState, doIceRestart, bwOptions);\n  } catch (error) {\n    logger.log.ERROR([null, 'RTCPeerConnection', null, 'Failed restarting.'], error);\n    return null;\n  }\n};\n\nexport default refreshPeerConnection;\n","import createOffer from './createOffer';\nimport addPeer from './peer-addition/addPeer';\nimport createAnswer from './createAnswer';\nimport createDataChannel from './data-channel/createDataChannel';\nimport sendP2PMessage from './data-channel/sendP2PMessage';\nimport getPeersInRoom from './getPeersInRoom';\nimport signalingEndOfCandidates from './signalingEndOfCandidates';\nimport getDataChannelBuffer from './data-channel/getDataChannelBuffer';\nimport refreshDataChannel from './data-channel/refreshDataChannel';\nimport closeDataChannel from './data-channel/closeDataChannel';\nimport refreshConnection from './refresh-connection/refreshConnection';\nimport refreshPeerConnection from './refresh-connection/refreshPeerConnection';\nimport restartPeerConnection from './refresh-connection/restartPeerConnection';\nimport buildPeerInformations from './buildPeerInformations';\nimport getConnectionStatus from './getConnectionStatus';\nimport closePeerConnection from './closePeerConnection';\nimport updatePeerInformationsMediaStatus from './updatePeerInformationsMediaStatus';\nimport processNewSender from './processNewSender';\n\n/**\n * @namespace PeerConnectionHelpers\n * @description All helper and utility functions for <code>{@link PeerConnection}</code> class are listed here.\n * @private\n * @memberOf PeerConnection\n * @type {{createOffer, createAnswer, addPeer, createDataChannel, sendP2PMessage, getPeersInRoom, signalingEndOfCandidates, getDataChannelBuffer, refreshDataChannel, closeDataChannel, refreshConnection, refreshPeerConnection, restartPeerConnection, buildPeerInformations, getConnectionStatus, closePeerConnection, updatePeerInformationsMediaStatus, processNewSender  }}\n */\nconst helpers = {\n  createOffer,\n  createAnswer,\n  addPeer,\n  createDataChannel,\n  sendP2PMessage,\n  getPeersInRoom,\n  signalingEndOfCandidates,\n  getDataChannelBuffer,\n  refreshDataChannel,\n  closeDataChannel,\n  refreshConnection,\n  refreshPeerConnection,\n  restartPeerConnection,\n  buildPeerInformations,\n  getConnectionStatus,\n  closePeerConnection,\n  updatePeerInformationsMediaStatus,\n  processNewSender,\n};\n\nexport default helpers;\n","import Skylink from '../../../index';\nimport logger from '../../../logger';\nimport { DATA_CHANNEL_TYPE, PEER_CONNECTION_STATE, DATA_CHANNEL_STATE } from '../../../constants';\nimport callbacks from './callbacks/index';\nimport { onDataChannelStateChanged } from '../../../skylink-events/datachannel-events';\nimport PeerConnection from '../..';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport HandleDataChannelStats from '../../../skylink-stats/handleDataChannelStats';\n\n/* eslint-disable prefer-const */\n/**\n * @param params\n * @returns {null}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires onDataChannelStateChanged\n */\nconst createDataChannel = (params) => {\n  let {\n    peerId,\n    dataChannel,\n    bufferThreshold,\n    createAsMessagingChannel,\n    roomState,\n  } = params;\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { user, peerConnections, dataChannels } = state;\n  const peerConnection = peerConnections[peerId];\n  let channelName = `-_${peerId}`;\n  let channelType = createAsMessagingChannel === true ? DATA_CHANNEL_TYPE.MESSAGING : DATA_CHANNEL_TYPE.DATA;\n  let channelProp = channelType === DATA_CHANNEL_TYPE.MESSAGING ? 'main' : channelName;\n  if (user && user.sid) {\n    channelName = `${user.sid}_${peerId}`;\n  } else {\n    logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, 'Aborting of creating or initializing DataChannel as User does not have Room session']);\n    return null;\n  }\n\n  if (!(peerConnection && peerConnection.signalingState !== PEER_CONNECTION_STATE.CLOSED)) {\n    logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, 'Aborting of creating or initializing Datachannel as Peer connection does not exists']);\n    return null;\n  }\n\n  if (dataChannel && typeof dataChannel === 'object') {\n    channelName = dataChannel.label;\n  } else if (typeof dataChannel === 'string') {\n    channelName = dataChannel;\n    dataChannel = null;\n  }\n\n  if (!dataChannels[peerId]) {\n    channelProp = 'main';\n    channelType = DATA_CHANNEL_TYPE.MESSAGING;\n    dataChannels[peerId] = {};\n    logger.log.DEBUG([peerId, 'RTCDataChannel', channelProp, 'initializing main DataChannel']);\n  } else if (dataChannels[peerId].main && dataChannels[peerId].main.channel.label === channelName) {\n    channelProp = 'main';\n    channelType = DATA_CHANNEL_TYPE.MESSAGING;\n  }\n\n  if (!dataChannel) {\n    try {\n      dataChannel = peerConnection.createDataChannel(channelName, {\n        reliable: true,\n        ordered: true,\n      });\n    } catch (error) {\n      logger.log.ERROR([peerId, 'RTCDataChannel', channelProp, 'Failed creating Datachannel ->'], error);\n\n      const handleDataChannelStats = new HandleDataChannelStats();\n      const { room } = roomState;\n\n      handleDataChannelStats.send(room.id, DATA_CHANNEL_STATE.ERROR, peerId, { label: channelName }, channelProp, error);\n      dispatchEvent(onDataChannelStateChanged({\n        state: DATA_CHANNEL_STATE.CREATE_ERROR,\n        peerId,\n        error,\n        channelName,\n        channelType,\n        buferAmount: PeerConnection.getDataChannelBuffer(dataChannel),\n      }));\n      return null;\n    }\n  }\n\n  const callbackExtraParams = {\n    dataChannel,\n    peerId,\n    channelName,\n    channelProp,\n    channelType,\n    roomState,\n    bufferThreshold,\n  };\n\n  dataChannel.onopen = callbacks.onopen.bind(dataChannel, callbackExtraParams);\n  dataChannel.onmessage = callbacks.onmessage.bind(dataChannel, callbackExtraParams);\n  dataChannel.onerror = callbacks.onerror.bind(dataChannel, callbackExtraParams);\n  dataChannel.onbufferedamountlow = callbacks.onbufferedamountlow.bind(dataChannel, callbackExtraParams);\n  dataChannel.onclose = callbacks.onclose.bind(dataChannel, callbackExtraParams);\n\n  const channel = channelType === DATA_CHANNEL_TYPE.MESSAGING ? 'main' : channelName;\n  state.dataChannels[peerId][channel] = {\n    channelName,\n    channelType,\n    transferId: null,\n    streamId: null,\n    channel: dataChannel,\n  };\n\n  Skylink.setSkylinkState(state, roomState.room.id);\n\n  return null;\n};\n\nexport default createDataChannel;\n","import { getRoomStateByName } from '../../utils/helpers';\nimport PeerData from '../../peer-data';\n\n/**\n * @param {String} roomName\n * @return {Object|null}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @private\n */\nconst getPeersInRoom = (roomName) => {\n  const roomState = getRoomStateByName(roomName);\n  if (roomState) {\n    const listOfPeersInfo = {};\n    const listOfPeers = Object.keys(roomState.peerInformations);\n\n    for (let i = 0; i < listOfPeers.length; i += 1) {\n      listOfPeersInfo[listOfPeers[i]] = Object.assign({}, PeerData.getPeerInfo(listOfPeers[i], roomState.room));\n      listOfPeersInfo[listOfPeers[i]].isSelf = false;\n    }\n\n    if (roomState.user && roomState.user.sid) {\n      listOfPeersInfo[roomState.user.sid] = Object.assign({}, PeerData.getCurrentSessionInfo(roomState.room));\n      listOfPeersInfo[roomState.user.sid].isSelf = true;\n    }\n    return listOfPeersInfo;\n  }\n  return null;\n};\n\nexport default getPeersInRoom;\n","import Skylink from '../../index';\nimport * as constants from '../../constants';\nimport messages from '../../messages';\nimport logger from '../../logger';\nimport IceCandidate from '../../ice-connection';\nimport { isLowerThanVersion } from '../../utils/helpers';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { candidatesGathered } from '../../skylink-events';\n\n/**\n * @param {String} targetMid\n * @param {SkylinkState} roomState\n * @return {null}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @fires candidatesGathered\n */\nconst signalingEndOfCandidates = (targetMid, roomState) => {\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const peerEndOfCandidatesCounter = state.peerEndOfCandidatesCounter[targetMid];\n  const peerConnection = state.peerConnections[targetMid];\n  const peerCandidatesQueue = state.peerCandidatesQueue[targetMid];\n  const peerConnectionConfig = state.peerConnectionConfig[targetMid];\n  const gatheredCandidates = state.gatheredCandidates[targetMid];\n  const { AdapterJS, RTCIceCandidate } = window;\n  const { TAGS } = constants;\n  const { PEER_CONNECTION } = messages;\n\n  if (!peerEndOfCandidatesCounter) {\n    return null;\n  }\n\n  if (\n    // If peer connection exists first and state is not closed.\n    peerConnection && peerConnection.signalingState !== constants.PEER_CONNECTION_STATE.CLOSED\n    // If remote description is set\n    && peerConnection.remoteDescription && peerConnection.remoteDescription.sdp\n    // If end-of-candidates signal is received\n    && typeof peerEndOfCandidatesCounter.expectedLen === 'number'\n    // If all ICE candidates are received\n    && peerEndOfCandidatesCounter.len >= peerEndOfCandidatesCounter.expectedLen\n    // If there is no ICE candidates queue\n    && (peerCandidatesQueue ? peerCandidatesQueue.length === 0 : true)\n    // If it has not been set yet\n    && !peerEndOfCandidatesCounter.hasSet) {\n    logger.log.DEBUG([targetMid, TAGS.PEER_CONNECTION, null, PEER_CONNECTION.end_of_candidates]);\n\n    peerEndOfCandidatesCounter.hasSet = true;\n\n    try {\n      if (AdapterJS.webrtcDetectedBrowser === 'edge') {\n        let mLineCounter = -1;\n        const addedMids = [];\n        const sdpLines = peerConnection.remoteDescription.sdp.split('\\r\\n');\n        let rejected = false;\n\n        for (let i = 0; i < sdpLines.length; i += 1) {\n          if (sdpLines[i].indexOf('m=') === 0) {\n            rejected = sdpLines[i].split(' ')[1] === '0';\n            mLineCounter += 1;\n          } else if (sdpLines[i].indexOf('a=mid:') === 0 && !rejected) {\n            const mid = sdpLines[i].split('a=mid:')[1] || '';\n            if (mid && addedMids.indexOf(mid) === -1) {\n              addedMids.push(mid);\n              IceCandidate.addIceCandidate(targetMid, `endofcan-${(new Date()).getTime()}`, 'endOfCandidates', new RTCIceCandidate({\n                sdpMid: mid,\n                sdpMLineIndex: mLineCounter,\n                candidate: 'candidate:1 1 udp 1 0.0.0.0 9 typ endOfCandidates',\n              }), state);\n              // Start breaking after the first add because of max-bundle option\n              if (peerConnectionConfig.bundlePolicy === constants.BUNDLE_POLICY.MAX_BUNDLE) {\n                break;\n              }\n            }\n          }\n        }\n      } else if (AdapterJS && !isLowerThanVersion(AdapterJS.VERSION, '0.14.0')) {\n        peerConnection.addIceCandidate(null);\n      }\n\n      if (gatheredCandidates) {\n        const candidatesLength = {\n          expected: peerEndOfCandidatesCounter.expectedLen || 0,\n          received: peerEndOfCandidatesCounter.len || 0,\n          processed: gatheredCandidates.receiving.srflx.length + gatheredCandidates.receiving.relay.length + gatheredCandidates.receiving.host.length,\n        };\n        dispatchEvent(candidatesGathered({\n          room: state.room,\n          peerId: targetMid,\n          candidatesLength,\n        }));\n      }\n\n      state.peerEndOfCandidatesCounter[targetMid] = peerEndOfCandidatesCounter;\n      Skylink.setSkylinkState(state, roomState.room.id);\n    } catch (error) {\n      logger.log.ERROR([targetMid, TAGS.PEER_CONNECTION, null, PEER_CONNECTION.end_of_candidate_failure], error);\n    }\n  }\n  return null;\n};\n\nexport default signalingEndOfCandidates;\n","/**\n * Get RTCDataChannel buffer thresholds\n * @param {RTCDataChannel.channel} channel\n * @returns {{bufferedAmountLow: number, bufferedAmountLowThreshold: number}}\n * @memberOf PeerConnection.PeerConnectionHelpers\n */\nconst getDataChannelBuffer = channel => ({\n  bufferedAmountLow: parseInt(channel.bufferedAmountLow, 10) || 0,\n  bufferedAmountLowThreshold: parseInt(channel.bufferedAmountLowThreshold, 10) || 0,\n});\nexport default getDataChannelBuffer;\n","import MESSAGES from '../../../messages';\nimport { isEmptyObj } from '../../../utils/helpers';\nimport PeerConnection from '../../index';\nimport logger from '../../../logger';\nimport { PEER_CONNECTION_STATE, HANDSHAKE_PROGRESS, DATA_CHANNEL_TYPE } from '../../../constants';\n\nconst hasPeerDataChannels = dataChannels => !isEmptyObj(dataChannels);\n\n/**\n * Function that refreshes the main messaging Datachannel.\n * @param {SkylinkState} state\n * @param {String} peerId\n * @memberOf PeerConnection\n */\nconst refreshDataChannel = (state, peerId) => {\n  const { dataChannels, peerConnections } = state;\n\n  if (hasPeerDataChannels(dataChannels) && Object.hasOwnProperty.call(dataChannels, peerId)) {\n    if (Object.hasOwnProperty.call(dataChannels[peerId], 'main')) {\n      const mainDataChannel = dataChannels[peerId].main;\n      const { channelName, channelType } = mainDataChannel;\n      const bufferThreshold = mainDataChannel.channel.bufferedAmountLowThreshold || 0;\n\n      if (channelType === DATA_CHANNEL_TYPE.MESSAGING) {\n        setTimeout(() => {\n          if (Object.hasOwnProperty.call(peerConnections, peerId)) {\n            if (peerConnections[peerId].signalingState !== PEER_CONNECTION_STATE.CLOSED && peerConnections[peerId].localDescription.type === HANDSHAKE_PROGRESS.OFFER) {\n              PeerConnection.closeDataChannel(state, peerId);\n              logger.log.DEBUG([peerId, 'RTCDataChannel', 'main', MESSAGES.DATA_CHANNEL.reviving_dataChannel]);\n              PeerConnection.createDataChannel({\n                roomState: state,\n                peerId,\n                dataChannel: channelName,\n                bufferThreshold,\n                createAsMessagingChannel: true,\n              });\n            }\n          }\n        }, 100);\n      }\n    }\n  } else {\n    logger.log.DEBUG([peerId, 'RTCDataChannel', MESSAGES.DATA_CHANNEL.refresh_error]);\n  }\n};\n\nexport default refreshDataChannel;\n","import { DATA_CHANNEL_STATE } from '../../constants';\n\nconst buildPeerInformations = (userInfo, state) => {\n  const peerInfo = userInfo;\n  const peerId = peerInfo.sid;\n\n  peerInfo.room = state.room.roomName;\n  peerInfo.settings.data = !!(state.dataChannels[peerId] && state.dataChannels[peerId].main && state.dataChannels[peerId].main.channel && state.dataChannels[peerId].main.channel.readyState === DATA_CHANNEL_STATE.OPEN);\n\n  delete peerInfo.publishOnly;\n\n  return peerInfo;\n};\n\nexport default buildPeerInformations;\n","import {\n  rejectPromise, isEmptyArray, isValidPeerId, isAString,\n} from '../../utils/helpers';\nimport messages from '../../messages';\nimport PeerConnectionStatistics from './statistics';\nimport logger from '../../logger';\n\nconst retrieveValidPeerIdsOrErrorMsg = (roomState, peerId) => {\n  const { peerConnections, room } = roomState;\n  const { PEER_CONNECTION } = messages;\n  let peerIds = null;\n  let errorMsg = null;\n\n  if (isEmptyArray(Object.keys(peerConnections))) {\n    errorMsg = PEER_CONNECTION.not_initialised;\n  } else if (Array.isArray(peerId)) {\n    peerIds = peerId;\n    peerIds.forEach((id) => {\n      if (!isValidPeerId(room, id)) {\n        errorMsg = `${PEER_CONNECTION.peerId_does_not_exist} ${id}`;\n      }\n    });\n  } else if (isAString(peerId)) {\n    if (!isValidPeerId(room, peerId)) {\n      errorMsg = `${PEER_CONNECTION.peerId_does_not_exist} ${peerId}`;\n    }\n\n    peerIds = [peerId];\n  } else {\n    peerIds = Object.keys(peerConnections);\n  }\n\n  return {\n    peerIds,\n    errorMsg,\n  };\n};\n\nconst getConnectionStatus = (roomState, peerId = null) => {\n  const { ROOM_STATE } = messages;\n  if (!roomState) {\n    logger.log.WARN(ROOM_STATE.NO_ROOM_NAME);\n    return rejectPromise(ROOM_STATE.NO_ROOM_NAME);\n  }\n\n  const { room } = roomState;\n  const result = retrieveValidPeerIdsOrErrorMsg(roomState, peerId);\n\n  if (result.errorMsg) {\n    logger.log.WARN(result.errorMsg);\n    return rejectPromise(result.errorMsg);\n  }\n\n  const { peerIds } = result;\n  const connectionStatusPromises = [];\n  for (let i = 0; i < peerIds.length; i += 1) {\n    const peerConnectionStatistics = new PeerConnectionStatistics(room.id, peerIds[i]);\n    connectionStatusPromises.push(peerConnectionStatistics.getConnectionStatus());\n  }\n\n  return Promise.all(connectionStatusPromises);\n};\n\nexport default getConnectionStatus;\n","import Skylink from '../../index';\n\nconst closePeerConnection = (roomState, peerId) => {\n  const updatedState = Skylink.getSkylinkState(roomState.room.id);\n  const { peerConnections, room } = updatedState;\n  const { AdapterJS } = window;\n\n  peerConnections[peerId].close();\n\n  // FIXME: Check if needed. Polyfill for safari 11 \"closed\" event not triggered for \"iceConnectionState\" and \"signalingState\".\n  if (AdapterJS.webrtcDetectedType === 'AppleWebKit') {\n    if (!updatedState.peerConnections[peerId].signalingStateClosed) {\n      updatedState.peerConnections[peerId].signalingStateClosed = true;\n      // trigger('peerConnectionState', this.PEER_CONNECTION_STATE.CLOSED, peerId);\n    }\n    if (!updatedState.peerConnections[peerId].iceConnectionStateClosed) {\n      updatedState.peerConnections[peerId].iceConnectionStateClosed = true;\n      // handleIceConnectionStats(ICE_CONNECTION_STATE.CLOSED, peerId);\n      // trigger('iceConnectionState', this.ICE_CONNECTION_STATE.CLOSED, peerId);\n    }\n  }\n\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nexport default closePeerConnection;\n","/* eslint-disable no-nested-ternary */\nimport Skylink from '../../index';\nimport { hasAudioTrack, hasVideoTrack } from '../../utils/helpers';\nimport { MEDIA_STATE } from '../../constants';\n\n// Mobile SDK is sending mediaStatus  - audioMuted, videoMuted as a boolean\n// 2.0 has switched to storing mediaStatus keyed by streamId with -1, 0 ,1 values\nconst buildMediaStatus = (state, peerId, transceiver, stream) => {\n  const { peerMedias, peerInformations } = state;\n  const peerMedia = peerMedias[peerId];\n  const mediaStatus = peerInformations[peerId].mediaStatus || {};\n  Object.values(peerMedia).forEach((mediaInfo) => {\n    if (mediaInfo.transceiverMid === transceiver.mid) {\n      mediaStatus[stream.id] = {\n        audioMuted: hasAudioTrack(stream) ? (mediaInfo.mediaState === MEDIA_STATE.MUTED ? 0 : 1) : -1,\n        videoMuted: hasVideoTrack(stream) ? (mediaInfo.mediaState === MEDIA_STATE.MUTED ? 0 : 1) : -1,\n      };\n    }\n  });\n\n  delete mediaStatus.audioMuted;\n  delete mediaStatus.videoMuted;\n\n  return mediaStatus;\n};\n\nconst updatePeerInformationsMediaStatus = (room, peerId, transceiver, stream) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n  const peerInformation = updatedState.peerInformations[peerId];\n  peerInformation.mediaStatus = buildMediaStatus(updatedState, peerId, transceiver, stream);\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nexport default updatePeerInformationsMediaStatus;\n","import Skylink from '../../index';\n\nconst processNewSender = (state, targetMid, sender) => {\n  const updatedState = state;\n  if (!updatedState.currentRTCRTPSenders[targetMid]) {\n    updatedState.currentRTCRTPSenders[targetMid] = [];\n  }\n  updatedState.currentRTCRTPSenders[targetMid].push(sender);\n  Skylink.setSkylinkState(updatedState, updatedState.room.id);\n};\n\nexport default processNewSender;\n","import logger from '../../../../logger';\nimport Skylink from '../../../../index';\nimport PeerConnection from '../../index';\n\n/* eslint-disable no-param-reassign */\n/**\n * @param {RTCPeerConnection} peerConnection\n * @param {String} targetMid\n * @param {SkylinkState} currentRoomState\n * @param {Event} event\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst ondatachannel = (peerConnection, targetMid, currentRoomState, event) => {\n  const dataChannel = event.channel || event;\n  const initOptions = Skylink.getInitOptions();\n  const state = Skylink.getSkylinkState(currentRoomState.room.id);\n  const { peerInformations } = state;\n  const { enableDataChannel } = initOptions;\n\n  logger.log.DEBUG([targetMid, 'RTCDataChannel', dataChannel.label, 'Received datachannel ->'], dataChannel);\n  if (enableDataChannel && peerInformations[targetMid].config.enableDataChannel) {\n    // if peer does not have main channel, the first item is main\n    if (!peerConnection.hasMainChannel) {\n      peerConnection.hasMainChannel = true;\n    }\n    PeerConnection.createDataChannel({ peerId: targetMid, dataChannel, roomState: currentRoomState });\n  } else {\n    logger.log.WARN([targetMid, 'RTCDataChannel', dataChannel.label, 'Not adding datachannel as enable datachannel is set to false']);\n  }\n};\n\nexport default ondatachannel;\n","import IceConnection from '../../../../ice-connection';\n\n/**\n *\n * @param {RTCPeerConnection} peerConnection\n * @param {String} targetMid\n * @param {SkylinkState} roomState - The current state.\n * @param {Event} rtcIceConnectionEvent\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst onicecandidate = (peerConnection, targetMid, roomState, rtcIceConnectionEvent) => {\n  IceConnection.onIceCandidate(targetMid, rtcIceConnectionEvent.candidate || rtcIceConnectionEvent, roomState.room);\n};\n\nexport default onicecandidate;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\nimport PeerConnection from '../peer-connection';\nimport logger from '../logger';\nimport MESSAGES from '../messages';\n\nconst formatValue = (stats, mediaType, directionType, itemKey) => {\n  const value = stats[mediaType][directionType === 'send' ? 'sending' : 'receiving'][itemKey];\n  if (['number', 'string', 'boolean'].indexOf(typeof value) > -1) {\n    return value;\n  }\n  return null;\n};\n\nconst buildAudioTrackInfo = (stream, track) => ({\n  stream_id: stream.id,\n  id: track.id,\n  label: track.label,\n  muted: !track.enabled,\n});\n\nconst buildVideoTrackInfo = (stream, track, settings) => ({\n  stream_id: stream.id,\n  id: track.id,\n  label: track.label,\n  height: settings.video.resolution.height,\n  width: settings.video.resolution.width,\n  muted: !track.enabled,\n});\n\nclass HandleBandwidthStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      peer_id: null,\n      audio_send: { tracks: [] },\n      audio_recv: {},\n      video_send: { tracks: [] },\n      video_recv: {},\n      error: null,\n    };\n    this.stats = null;\n  }\n\n  gatherSendAudioPacketsStats() {\n    this.model.audio_send.bytes = formatValue(this.stats, 'audio', 'send', 'bytes');\n    this.model.audio_send.packets = formatValue(this.stats, 'audio', 'send', 'packets');\n    this.model.audio_send.echo_return_loss = formatValue(this.stats, 'audio', 'send', 'echoReturnLoss');\n    this.model.audio_send.echo_return_loss_enhancement = formatValue(this.stats, 'audio', 'send', 'echoReturnLossEnhancement');\n    this.model.audio_send.round_trip_time = formatValue(this.stats, 'audio', 'send', 'roundTripTime');\n    this.model.audio_send.audio_level = formatValue(this.stats, 'audio', 'send', 'audioLevel');\n    this.model.audio_send.jitter = formatValue(this.stats, 'audio', 'send', 'jitter');\n  }\n\n  gatherReceiveAudioPacketsStats() {\n    this.model.audio_recv.bytes = formatValue(this.stats, 'audio', 'recv', 'bytes');\n    this.model.audio_recv.packets = formatValue(this.stats, 'audio', 'recv', 'packets');\n    this.model.audio_recv.packets_lost = formatValue(this.stats, 'audio', 'recv', 'packetsLost');\n    this.model.audio_recv.jitter = formatValue(this.stats, 'audio', 'recv', 'jitter');\n    this.model.audio_recv.audio_level = formatValue(this.stats, 'audio', 'recv', 'audioLevel');\n  }\n\n  gatherSendVideoPacketsStats() {\n    this.model.video_send.bytes = formatValue(this.stats, 'video', 'send', 'bytes');\n    this.model.video_send.packets = formatValue(this.stats, 'video', 'send', 'packets');\n    this.model.video_send.nack_count = formatValue(this.stats, 'video', 'send', 'nacks');\n    this.model.video_send.firs_count = formatValue(this.stats, 'video', 'send', 'firs');\n    this.model.video_send.plis_count = formatValue(this.stats, 'video', 'send', 'plis');\n    this.model.video_send.frames_encoded = formatValue(this.stats, 'video', 'send', 'framesEncoded');\n    this.model.video_send.frame_width = formatValue(this.stats, 'video', 'send', 'frameWidth');\n    this.model.video_send.frame_height = formatValue(this.stats, 'video', 'send', 'frameHeight');\n    this.model.video_send.round_trip_time = formatValue(this.stats, 'video', 'send', 'roundTripTime');\n    this.model.video_send.qp_sum = formatValue(this.stats, 'video', 'send', 'qpSum');\n    this.model.video_send.jitter = formatValue(this.stats, 'video', 'send', 'jitter');\n    this.model.video_send.frames = formatValue(this.stats, 'video', 'send', 'frames');\n    this.model.video_send.hugeFrames = formatValue(this.stats, 'video', 'send', 'hugeFramesSent');\n    this.model.video_send.framesPerSecond = formatValue(this.stats, 'video', 'send', 'framesPerSecond');\n  }\n\n  gatherReceiveVideoPacketsStats() {\n    this.model.video_recv.bytes = formatValue(this.stats, 'video', 'recv', 'bytes');\n    this.model.video_recv.packets = formatValue(this.stats, 'video', 'recv', 'packets');\n    this.model.video_recv.packets_lost = formatValue(this.stats, 'video', 'recv', 'packetsLost');\n    this.model.video_recv.nack_count = formatValue(this.stats, 'video', 'recv', 'nacks');\n    this.model.video_recv.firs_count = formatValue(this.stats, 'video', 'recv', 'firs');\n    this.model.video_recv.plis_count = formatValue(this.stats, 'video', 'recv', 'plis');\n    this.model.video_recv.frames_decoded = formatValue(this.stats, 'video', 'recv', 'framesDecoded');\n    this.model.video_recv.qp_sum = formatValue(this.stats, 'video', 'recv', 'qpSum');\n    this.model.video_recv.frames_decoded = formatValue(this.stats, 'video', 'recv', 'framesDecoded');\n    this.model.video_recv.frames_dropped = formatValue(this.stats, 'video', 'recv', 'framesDropped');\n    this.model.video_recv.decoderImplementation = formatValue(this.stats, 'video', 'recv', 'decoderImplementation');\n  }\n\n  buildTrackInfo(roomKey) {\n    const state = Skylink.getSkylinkState(roomKey);\n    const { streams } = state;\n    let streamObjs = [];\n    if (streams.userMedia) {\n      streamObjs = Object.values(Object.values(streams.userMedia));\n    }\n\n    if (streams.screenshare) {\n      streamObjs.push(streams.screenshare);\n    }\n\n    streamObjs.forEach((streamObj) => {\n      if (streamObj) {\n        const stream = streamObj.stream ? streamObj.stream : streamObj[Object.keys(streamObj)[0]].stream;\n        const settings = streamObj.settings ? streamObj.settings : streamObj[Object.keys(streamObj)[0]].settings;\n        const audioTracks = stream.getAudioTracks();\n        const videoTracks = stream.getVideoTracks();\n\n        audioTracks.forEach((audioTrack) => {\n          const audioTrackInfo = buildAudioTrackInfo(stream, audioTrack);\n          this.model.audio_send.tracks.push(audioTrackInfo);\n        });\n\n        videoTracks.forEach((videoTrack) => {\n          const videoTrackInfo = buildVideoTrackInfo(stream, videoTrack, settings);\n          this.model.video_send.tracks.push(videoTrackInfo);\n        });\n      }\n    });\n  }\n\n  send(roomKey, peerConnection, peerId) {\n    const { STATS_MODULE } = MESSAGES;\n    const roomState = Skylink.getSkylinkState(roomKey);\n\n    if (!roomState) {\n      logger.log.DEBUG([peerId, 'Statistics', 'Bandwidth_Stats', STATS_MODULE.HANDLE_BANDWIDTH_STATS.NO_STATE]);\n      return;\n    }\n\n    if (!roomState.streams.userMedia && !roomState.streams.screenshare) {\n      return;\n    }\n\n    this.model.client_id = roomState.clientId;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.peer_id = peerId;\n\n    PeerConnection.retrieveStatistics(roomKey, peerId, Skylink.getInitOptions().beSilentOnStatsLogs).then((stats) => {\n      if (stats) {\n        this.stats = stats;\n        this.gatherSendAudioPacketsStats();\n        this.gatherReceiveAudioPacketsStats();\n        this.gatherSendVideoPacketsStats();\n        this.gatherReceiveVideoPacketsStats();\n        this.buildTrackInfo(roomKey);\n        this.postStats(this.endpoints.bandwidth, this.model);\n      }\n    }).catch((error) => {\n      this.model.error = error ? error.message : null;\n      logger.log.DEBUG(STATS_MODULE.HANDLE_BANDWIDTH_STATS.RETRIEVE_FAILED, error);\n    });\n  }\n}\n\nexport default HandleBandwidthStats;\n","import PeerConnection from '../index';\nimport * as constants from '../../constants';\nimport Skylink from '../../index';\n\nconst instance = {};\n\nclass BandwidthAdjuster {\n  constructor(params) {\n    const { peerConnection, state, targetMid } = params;\n\n    if (instance[targetMid]) {\n      return instance[targetMid];\n    }\n\n    this.peerId = targetMid;\n    this.state = state;\n    this.peerConnection = peerConnection;\n    this.bandwidth = null;\n\n    instance[this.peerId] = this;\n  }\n\n  static formatTotalFn(arr) {\n    let total = 0;\n    for (let i = 0; i < arr.length; i += 1) {\n      total += arr[i];\n    }\n    return total / arr.length;\n  }\n\n  setAdjustmentInterval() {\n    const { bandwidthAdjuster, peerBandwidth, room } = this.state;\n    const { PEER_CONNECTION_STATE } = constants;\n\n    if (this.bandwidth) {\n      return;\n    }\n\n    const bandwidth = {\n      audio: { send: [], recv: [] },\n      video: { send: [], recv: [] },\n    };\n    let currentBlock = 0;\n\n    const adjustmentInterval = setInterval(() => {\n      if (!(this.peerConnection && this.peerConnection.signalingState\n        !== PEER_CONNECTION_STATE.CLOSED) || !bandwidthAdjuster || !peerBandwidth[this.peerId]) {\n        clearInterval(adjustmentInterval);\n        return;\n      }\n\n      PeerConnection.retrieveStatistics(room.id, this.peerId, Skylink.getIniOptions().beSilentOnStatsLogs, true)\n        .then((stats) => {\n          if (!(this.peerConnection && this.peerConnection.signalingState\n            !== PEER_CONNECTION_STATE.CLOSED) || !bandwidthAdjuster) {\n            clearInterval(adjustmentInterval);\n          }\n\n          bandwidth.audio.send.push(stats.audio.sending.bytes * 8);\n          bandwidth.audio.recv.push(stats.audio.receiving.bytes * 8);\n          bandwidth.video.send.push(stats.video.sending.bytes * 8);\n          bandwidth.video.recv.push(stats.video.receiving.bytes * 8);\n\n          currentBlock += 1;\n\n          if (currentBlock === bandwidthAdjuster.interval) {\n            currentBlock = 0;\n            let totalAudioBw = BandwidthAdjuster.formatTotalFn(bandwidth.audio.send);\n            let totalVideoBw = BandwidthAdjuster.formatTotalFn(bandwidth.video.send);\n\n            if (!bandwidthAdjuster.useUploadBwOnly) {\n              totalAudioBw += BandwidthAdjuster.formatTotalFn(bandwidth.audio.recv);\n              totalVideoBw += BandwidthAdjuster.formatTotalFn(bandwidth.video.recv);\n              totalAudioBw /= 2;\n              totalVideoBw /= 2;\n            }\n\n            totalAudioBw = parseInt((totalAudioBw * (bandwidthAdjuster.limitAtPercentage / 100)) / 1000, 10);\n            totalVideoBw = parseInt((totalVideoBw * (bandwidthAdjuster.limitAtPercentage / 100)) / 1000, 10);\n\n            PeerConnection.refreshConnection(this.state, this.peerId, false, {\n              bandwidth: { audio: totalAudioBw, video: totalVideoBw },\n            });\n          }\n        })\n        .catch(() => {\n          bandwidth.audio.send.push(0);\n          bandwidth.audio.recv.push(0);\n          bandwidth.video.send.push(0);\n          bandwidth.video.recv.push(0);\n        });\n    }, 1000);\n\n    this.bandwidth = bandwidth;\n  }\n}\n\nexport default BandwidthAdjuster;\n","import HandleIceConnectionStats from '../../../../skylink-stats/handleIceConnectionStats';\nimport logger from '../../../../logger';\nimport messages from '../../../../messages';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { iceConnectionState } from '../../../../skylink-events';\nimport * as constants from '../../../../constants';\nimport Skylink from '../../../../index';\nimport PeerConnection from '../../../index';\nimport HandleBandwidthStats from '../../../../skylink-stats/handleBandwidthStats';\nimport BandwidthAdjuster from '../../bandwidthAdjuster';\n\nconst isIceConnectionStateCompleted = (pcIceConnectionState) => {\n  const { ICE_CONNECTION_STATE } = constants;\n  return [ICE_CONNECTION_STATE.COMPLETED,\n    ICE_CONNECTION_STATE.CONNECTED].indexOf(pcIceConnectionState) > -1;\n};\n\n/**\n * @param {RTCPeerConnection} peerConnection\n * @param {String} targetMid - The Peer Id\n * @param {SkylinkState} currentRoomState\n * @fires iceConnectionState\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst oniceconnectionstatechange = (peerConnection, targetMid, currentRoomState) => {\n  const { PEER_CONNECTION } = messages;\n  const { ICE_CONNECTION_STATE, PEER_CONNECTION_STATE, BROWSER_AGENT } = constants;\n  const { AdapterJS } = window;\n  const { webrtcDetectedBrowser, webrtcDetectedType } = AdapterJS;\n  const state = Skylink.getSkylinkState(currentRoomState.room.id);\n  const { streams } = state;\n\n  if (!state) {\n    logger.log.DEBUG([targetMid, 'RTCIceConnectionState', null, PEER_CONNECTION.no_room_state]);\n    return;\n  }\n\n  const {\n    hasMCU, bandwidthAdjuster, peerInformations, peerConnStatus, peerStats,\n  } = state;\n  const handleIceConnectionStats = new HandleIceConnectionStats();\n\n  let statsInterval = null;\n  let pcIceConnectionState = peerConnection.iceConnectionState;\n\n  logger.log.DEBUG([targetMid, 'RTCIceConnectionState', null, PEER_CONNECTION.ice_connection_state], pcIceConnectionState);\n\n  if (webrtcDetectedBrowser === 'edge') {\n    if (pcIceConnectionState === 'connecting') {\n      pcIceConnectionState = ICE_CONNECTION_STATE.CHECKING;\n    } else if (pcIceConnectionState === 'new') {\n      pcIceConnectionState = ICE_CONNECTION_STATE.FAILED;\n    }\n  }\n\n  if (webrtcDetectedType === 'AppleWebKit' && pcIceConnectionState === ICE_CONNECTION_STATE.CLOSED) {\n    setTimeout(() => {\n      if (!peerConnection.iceConnectionStateClosed) {\n        handleIceConnectionStats.send(currentRoomState.room.id, ICE_CONNECTION_STATE.CLOSED, targetMid);\n        dispatchEvent(iceConnectionState({\n          state: ICE_CONNECTION_STATE.CLOSED,\n          peerId: targetMid,\n        }));\n      }\n    }, 10);\n    return;\n  }\n\n  if (state && peerConnection.iceConnectionState !== ICE_CONNECTION_STATE.CONNECTED) {\n    handleIceConnectionStats.send(currentRoomState.room.id, peerConnection.iceConnectionState, targetMid);\n  }\n\n  dispatchEvent(iceConnectionState({\n    state: pcIceConnectionState,\n    peerId: targetMid,\n  }));\n\n  if (pcIceConnectionState === ICE_CONNECTION_STATE.FAILED) {\n    if (AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.FIREFOX && !streams.userMedia) { // no audio and video requested will throw ice trickle\n      // failure although ice candidates are exchanged\n      return;\n    }\n    dispatchEvent(iceConnectionState({\n      state: ICE_CONNECTION_STATE.TRICKLE_FAILED,\n      peerId: targetMid,\n    }));\n  }\n\n  if (peerConnStatus && peerConnStatus[targetMid]) {\n    peerConnStatus[targetMid].connected = isIceConnectionStateCompleted(pcIceConnectionState);\n  }\n\n  if (!statsInterval && isIceConnectionStateCompleted(pcIceConnectionState) && !peerStats[targetMid]) {\n    statsInterval = true;\n    peerStats[targetMid] = {};\n\n    logger.log.DEBUG([targetMid, 'RTCStatsReport', null, 'Retrieving first report to tabulate results']);\n\n    // Do an initial getConnectionStatus() to backfill the first retrieval in order to do (currentTotalStats - lastTotalStats).\n    PeerConnection.getConnectionStatus(state, targetMid).then(() => {\n      handleIceConnectionStats.send(currentRoomState.room.id, peerConnection.iceConnectionState, targetMid);\n      statsInterval = setInterval(() => {\n        if (peerConnection.signalingState === PEER_CONNECTION_STATE.CLOSED || peerConnection.iceConnectionState === PEER_CONNECTION_STATE.CLOSED) {\n          clearInterval(statsInterval);\n        } else {\n          new HandleBandwidthStats().send(state.room.id, peerConnection, targetMid);\n        }\n      }, 20000);\n    });\n  }\n\n  if (!hasMCU && isIceConnectionStateCompleted(pcIceConnectionState) && !!bandwidthAdjuster && AdapterJS.webrtcDetectedBrowser !== 'edge'\n        && (((peerInformations[targetMid] || {}).agent || {}).name || 'edge') !== 'edge') {\n    new BandwidthAdjuster({\n      targetMid,\n      state,\n      peerConnection,\n    }).setAdjustmentInterval();\n  }\n};\n\nexport default oniceconnectionstatechange;\n","import ondatachannel from './ondatachannel';\nimport onicecandidate from './onicecandidate';\nimport oniceconnectionstatechange from './oniceconnectionstatechange';\nimport onicegatheringstatechange from './onicegatheringstatechange';\nimport onsignalingstatechange from './onsignalingstatechange';\nimport ontrack from './ontrack';\nimport onremovetrack from './onremovetrack';\nimport onsenderadded from './onsenderadded';\n\n/**\n * @description Callbacks for createPeerConnection method\n * @type {{ondatachannel, onicecandidate, oniceconnectionstatechange, onicegatheringstatechange, onsignalingstatechange, ontrack, onremovetrack, onsenderadded}}\n * @memberOf PeerConnection.PeerConnectionHelpers\n * @namespace CreatePeerConnectionCallbacks\n * @private\n */\nconst callbacks = {\n  ontrack,\n  ondatachannel,\n  onicecandidate,\n  oniceconnectionstatechange,\n  onicegatheringstatechange,\n  onsignalingstatechange,\n  onremovetrack,\n  onsenderadded,\n};\n\nexport default callbacks;\n","import Skylink from '../../../../index';\nimport MediaStream from '../../../../media-stream/index';\nimport callbacks from './index';\nimport logger from '../../../../logger/index';\nimport { TRACK_KIND } from '../../../../constants';\nimport PeerMedia from '../../../../peer-media';\nimport PeerConnection from '../../../index';\n\nconst matchPeerIdWithTransceiverMid = (state, transceiver) => {\n  const { peerMedias, user } = state;\n  const peerIds = Object.keys(peerMedias);\n\n  for (let i = 0; i < peerIds.length; i += 1) {\n    if (peerIds[i] !== user.sid) {\n      const mediaInfos = Object.values(peerMedias[peerIds[i]]);\n      for (let m = 0; m < mediaInfos.length; m += 1) {\n        if (mediaInfos[m].transceiverMid === transceiver.mid) {\n          return peerIds[i];\n        }\n      }\n    }\n  }\n\n  return null;\n};\n\n/**\n * Function that handles the <code>RTCPeerConnection.addTrack</code> remote MediaTrack received.\n * @param {RTCPeerConnection} RTCPeerConnection\n * @param {String} targetMid\n * @param {SkylinkState} currentRoomState\n * @param {RTCTrackEvent} rtcTrackEvent\n * @returns {null}\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst ontrack = (RTCPeerConnection, targetMid, currentRoomState, rtcTrackEvent) => {\n  const state = Skylink.getSkylinkState(currentRoomState.room.id);\n  const {\n    peerConnections, room, hasMCU,\n  } = state;\n  const { receiver } = rtcTrackEvent;\n  const { AdapterJS } = window;\n  const stream = rtcTrackEvent.streams[0];\n\n  // eslint-disable-next-line prefer-const\n  let { transceiver, track } = rtcTrackEvent;\n  let peerId = targetMid;\n\n  if (!stream) {\n    logger.log.WARN('ontrack stream is null');\n    return null;\n  }\n\n  if (AdapterJS.webrtcDetectedBrowser === 'safari') {\n    const transceivers = peerConnections[targetMid].getTransceivers();\n    transceivers.forEach((tscvr) => {\n      if (tscvr.receiver.track.id === receiver.track.id) {\n        transceiver = tscvr;\n      }\n    });\n  }\n\n  if (transceiver.mid === null) {\n    logger.log.WARN('Transceiver mid is null', transceiver);\n  }\n\n  if (!peerConnections[peerId]) return null;\n\n  if (hasMCU) {\n    peerId = matchPeerIdWithTransceiverMid(state, transceiver);\n  }\n\n  const isScreensharing = PeerMedia.isVideoScreenTrack(state, peerId, transceiver.mid);\n  const callbackExtraParams = [peerId, room, isScreensharing];\n  stream.onremovetrack = callbacks.onremovetrack.bind(this, ...callbackExtraParams);\n  PeerMedia.updateStreamIdFromOntrack(state.room, peerId, transceiver.mid, stream.id);\n  PeerConnection.updatePeerInformationsMediaStatus(state.room, peerId, transceiver, stream);\n  MediaStream.updateRemoteStreams(state.room, peerId, stream);\n  MediaStream.onRemoteTrackAdded(stream, currentRoomState, peerId, isScreensharing, track.kind === TRACK_KIND.VIDEO, track.kind === TRACK_KIND.AUDIO);\n\n  return null;\n};\n\nexport default ontrack;\n","import logger from '../../../../logger';\nimport messages from '../../../../messages';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { candidateGenerationState } from '../../../../skylink-events';\n\n/**\n * @param {RTCPeerConnection} peerConnection\n * @param {String} targetMid - The Peer Id\n * @param {SkylinkState} roomState - The current state\n * @fires candidateGenerationState\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst onicegatheringstatechange = (peerConnection, targetMid, roomState) => {\n  const { PEER_CONNECTION } = messages;\n  const { iceGatheringState } = peerConnection;\n\n  logger.log.INFO([targetMid, 'RTCIceGatheringState', null, PEER_CONNECTION.ice_gathering_state], iceGatheringState);\n  dispatchEvent(candidateGenerationState({\n    state: iceGatheringState,\n    room: roomState.room,\n    peerId: targetMid,\n  }));\n};\n\nexport default onicegatheringstatechange;\n","import logger from '../../../../logger';\nimport messages from '../../../../messages';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { peerConnectionState } from '../../../../skylink-events';\nimport * as constants from '../../../../constants';\n\n/**\n *\n * @param {RTCPeerConnection} peerConnection\n * @param {String} targetMid - The Peer Id\n * @param {SkylinkState} roomState - The current state.\n * @fires peerConnectionState\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\n// eslint-disable-next-line no-unused-vars\nconst onsignalingstatechange = (peerConnection, targetMid) => {\n  const { AdapterJS } = window;\n  const { PEER_CONNECTION } = messages;\n  const { PEER_CONNECTION_STATE } = constants;\n  const { signalingState, signalingStateClosed } = peerConnection;\n\n  logger.log.DEBUG([targetMid, 'RTCSignalingState', null, PEER_CONNECTION.peer_connection_state], signalingState);\n\n  if (AdapterJS.webrtcDetectedType === 'AppleWebKit' && signalingState === PEER_CONNECTION_STATE.CLOSED) {\n    setTimeout(() => {\n      if (!signalingStateClosed) {\n        dispatchEvent(peerConnectionState({\n          state: PEER_CONNECTION_STATE.CLOSED,\n          peerId: targetMid,\n        }));\n      }\n    }, 10);\n    return;\n  }\n\n  dispatchEvent(peerConnectionState({\n    state: signalingState,\n    peerId: targetMid,\n  }));\n};\n\nexport default onsignalingstatechange;\n","import { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { onIncomingStream, peerUpdated, streamEnded } from '../../../../skylink-events';\nimport PeerData from '../../../../peer-data';\nimport { getStateByKey, hasVideoTrack } from '../../../../utils/helpers';\nimport { TRACK_KIND, TAGS, BROWSER_AGENT } from '../../../../constants';\nimport logger from '../../../../logger';\nimport MESSAGES from '../../../../messages';\nimport Skylink from '../../../../index';\n\nconst dispatchPeerUpdated = (state, peerId) => {\n  dispatchEvent(peerUpdated({\n    peerId,\n    peerInfo: PeerData.getPeerInfo(peerId, state.room),\n    isSelf: false,\n  }));\n};\n\nconst updateMediaStatus = (state, peerId, streamId) => {\n  const updatedState = state;\n\n  delete updatedState.peerInformations[peerId].mediaStatus[streamId];\n\n  Skylink.setSkylinkState(updatedState, updatedState.room.id);\n};\n\nconst dispatchStreamEndedEvent = (state, peerId, isScreensharing, rtcTrackEvent, stream) => {\n  dispatchEvent(streamEnded({\n    room: state.room,\n    peerId,\n    peerInfo: PeerData.getPeerInfo(peerId, state.room),\n    isSelf: false,\n    isScreensharing,\n    streamId: stream.id,\n    isVideo: rtcTrackEvent.track.kind === TRACK_KIND.VIDEO,\n    isAudio: rtcTrackEvent.track.kind === TRACK_KIND.AUDIO,\n  }));\n};\n\nconst dispatchIncomingCameraStream = (state) => {\n  const { streams, room, user } = state;\n  const userMediaStreams = streams.userMedia ? Object.values(streams.userMedia) : [];\n  userMediaStreams.forEach((streamObj) => {\n    if (hasVideoTrack(streamObj.stream)) {\n      dispatchEvent(onIncomingStream({\n        stream: streamObj.stream,\n        streamId: streamObj.id,\n        peerId: user.sid,\n        room,\n        isSelf: true,\n        peerInfo: PeerData.getCurrentSessionInfo(room),\n        isVideo: true,\n        isAudio: false,\n      }));\n    }\n  });\n};\n\n/**\n * @param {String} peerId\n * @param {String} room\n * @param {boolean} isScreensharing\n * @param {MediaStreamTrackEvent} rtcTrackEvent\n * @fires streamEnded\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst onremovetrack = (peerId, room, isScreensharing, rtcTrackEvent) => {\n  const { AdapterJS } = window;\n  const state = getStateByKey(room.id);\n  const { peerInformations } = state;\n  const { MEDIA_STREAM, PEER_INFORMATIONS } = MESSAGES;\n  const stream = AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.REACT_NATIVE ? rtcTrackEvent.stream : rtcTrackEvent.target;\n\n\n  logger.log.INFO([peerId, TAGS.MEDIA_STREAM, null, MEDIA_STREAM.REMOTE_TRACK_REMOVED], {\n    peerId, isSelf: false, isScreensharing, track: rtcTrackEvent.track,\n  });\n\n  if (!peerInformations[peerId]) {\n    // peerInformations[peerId] will be undefined if onremovetrack is called from byeHandler\n    logger.log.DEBUG([peerId, TAGS.MEDIA_STREAM, null, `${MEDIA_STREAM.ERRORS.DROPPING_ONREMOVETRACK}` - `${PEER_INFORMATIONS.NO_PEER_INFO} ${peerId}`]);\n    return;\n  }\n\n  if (!stream) {\n    logger.log.DEBUG([peerId, TAGS.MEDIA_STREAM, null, `${MEDIA_STREAM.ERRORS.DROPPING_ONREMOVETRACK}` - `${MEDIA_STREAM.NO_STREAM}`]);\n    return;\n  }\n\n  updateMediaStatus(state, peerId, stream.id);\n  dispatchStreamEndedEvent(state, peerId, isScreensharing, rtcTrackEvent, stream);\n\n  if (isScreensharing) {\n    // Dispatch to ensure that the client has a way of retrieving the camera stream. Camera stream was not added to pc and therefore ontrack will not trigger on remote.\n    dispatchIncomingCameraStream(state);\n  }\n\n  dispatchPeerUpdated(state, peerId);\n};\n\nexport default onremovetrack;\n","import Skylink from '../../../../index'; import helpers from '../../index';\n\n/**\n * React Native only callback to retrieve senders from the peer connection as the sender object is not returned from peerConnection.addTrack.\n * @param peerConnection\n * @param targetMid\n * @param currentRoomState\n * @param event\n * @memberOf PeerConnection.PeerConnectionHelpers.CreatePeerConnectionCallbacks\n */\nconst onsenderadded = (peerConnection, targetMid, currentRoomState, event) => {\n  const updatedState = Skylink.getSkylinkState(currentRoomState.room.id);\n  const { sender } = event;\n  helpers.processNewSender(updatedState, targetMid, sender);\n};\n\nexport default onsenderadded;\n","import { getStateByRid } from '../../../../utils/helpers';\nimport * as constants from '../../../../constants';\nimport { streamEnded, onIncomingScreenStream, onIncomingStream } from '../../../../skylink-events';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport PeerData from '../../../../peer-data/index';\nimport Skylink from '../../../../index';\nimport PeerConnectionCallbacks from '../../../../peer-connection/helpers/peer-addition/callbacks';\nimport MediaStream from '../../../../media-stream';\n\n/**\n * Function that handles the \"stream\" socket message received.\n * @param {JSON} message\n * @param {String} message.rid - The room key.\n * @param {SkylinkUser} message.mid - The source peerId.\n * @param {String} message.streamId - The media stream Id.\n * @param {String} message.status - The stream status.\n * @param {Object} message.settings\n * @param {String} message.settings.screenshareId - Id of the screenshare stream.\n * @memberOf SignalingMessageHandler\n */\nconst streamHandler = (message) => {\n  const {\n    mid, rid, status, streamId, settings,\n  } = message;\n  const roomState = getStateByRid(rid);\n  const { room, peerInformations } = roomState;\n\n  if (status === constants.STREAM_STATUS.SCREENSHARE_REPLACE_START) {\n    peerInformations[mid].screenshare = true;\n    Skylink.setSkylinkState(roomState, room.id);\n\n    dispatchEvent(onIncomingScreenStream({\n      room,\n      peerId: mid,\n      isSelf: false,\n      peerInfo: PeerData.getPeerInfo(mid, room),\n      stream: null,\n      isReplace: true,\n      streamId,\n      isVideo: !!settings.audio,\n      isAudio: !!settings.video,\n    }));\n  }\n\n  if (status === constants.STREAM_STATUS.USER_MEDIA_REPLACE_START) {\n    dispatchEvent(onIncomingStream({\n      room,\n      peerId: mid,\n      isSelf: false,\n      peerInfo: PeerData.getPeerInfo(mid, room),\n      stream: null,\n      streamId,\n      isReplace: true,\n      replacedStreamId: settings.replacedStreamId,\n      isVideo: !!settings.audio,\n      isAudio: !!settings.video,\n    }));\n  }\n\n  if (status === constants.STREAM_STATUS.ENDED) {\n    if (settings.isScreensharing) {\n      peerInformations[mid].screenshare = false;\n      Skylink.setSkylinkState(roomState, room.id);\n    }\n\n    dispatchEvent(streamEnded({\n      room,\n      peerId: mid,\n      peerInfo: PeerData.getPeerInfo(mid, room),\n      streamId,\n      isSelf: false,\n      isScreensharing: settings.isScreensharing,\n      options: settings,\n      isVideo: !!settings.audio,\n      isAudio: !!settings.video,\n    }));\n  }\n\n  // Handle stopped streams that are not present in sdp and therefore do not require renegotiation and therefore do not trigger onremovetrack\n  if (status === constants.STREAM_STATUS.REPLACED_STREAM_ENDED) {\n    const remoteStreams = MediaStream.retrieveRemoteStreams(roomState, mid);\n\n    if (!remoteStreams) {\n      return null;\n    }\n\n    const remoteStreamsObj = Object.values(remoteStreams);\n    let stoppedStream = null;\n\n    for (let i = 0; i < remoteStreamsObj.length; i += 1) {\n      if (remoteStreams[i].id === streamId) {\n        stoppedStream = remoteStreamsObj[i];\n        break;\n      }\n    }\n\n    if (!stoppedStream) {\n      return null;\n    }\n\n    const tracks = stoppedStream.getTracks();\n    tracks.forEach((track) => {\n      PeerConnectionCallbacks.onremovetrack(mid, room, streamId, track, false);\n    });\n  }\n\n  return null;\n};\n\nexport default streamHandler;\n","import SkylinkStats from './index';\nimport Skylink from '../index';\n\nclass HandleRecordingStats extends SkylinkStats {\n  constructor() {\n    super();\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      room_id: null,\n      user_id: null,\n      state: null,\n      recording_id: null,\n      recordings: null,\n      error: null,\n    };\n  }\n\n  send(roomKey, state, recordingId, recordings, error) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n\n    this.model.client_id = roomState.clientId;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n    this.model.room_id = roomKey;\n    this.model.user_id = (roomState && roomState.user && roomState.user.sid) || null;\n    this.model.state = state;\n    this.model.recording_id = recordingId;\n    this.model.recordings = recordings;\n    this.error = (typeof error === 'string' ? error : (error && error.message)) || null;\n\n    this.postStats(this.endpoints.recording, this.model);\n  }\n}\n\nexport default HandleRecordingStats;\n","import HandleRecordingStats from '../../../../skylink-stats/handleRecordingStats';\nimport logger from '../../../../logger';\nimport { getStateByRid } from '../../../../utils/helpers';\nimport MESSAGES from '../../../../messages';\nimport Skylink from '../../../../index';\nimport { recordingState } from '../../../../skylink-events';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { PEER_TYPE, RECORDING_STATE, TAGS } from '../../../../constants';\n\nconst handleRecordingStats = new HandleRecordingStats();\n\nconst dispatchRecordingEvent = (state, recordingId, error) => {\n  const detail = {\n    state,\n    recordingId,\n  };\n\n  if (error) {\n    detail.error = error;\n  }\n\n  dispatchEvent(recordingState(detail));\n};\n\n/**\n * Recording successfully started\n * @param {SkylinkState} roomState\n * @param {number} recordingId\n * @private\n */\nconst recordingStarted = (roomState, recordingId) => {\n  const updatedRoomState = Object.assign({}, roomState);\n  const { room } = updatedRoomState;\n\n  logger.log.DEBUG([PEER_TYPE.MCU, TAGS.RECORDING, recordingId, MESSAGES.RECORDING.START_SUCCESS]);\n\n  handleRecordingStats.send(room.id, MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.START, recordingId, null, null);\n\n  updatedRoomState.currentRecordingId = recordingId;\n\n  updatedRoomState.recordings[recordingId] = {\n    active: true,\n    state: RECORDING_STATE.START,\n    startedDateTime: (new Date()).toISOString(),\n    endedDateTime: null,\n    error: null,\n  };\n\n  updatedRoomState.recordingStartInterval = setTimeout(() => {\n    logger.log.INFO([PEER_TYPE.MCU, TAGS.RECORDING, recordingId, MESSAGES.RECORDING.MIN_RECORDING_TIME_REACHED]);\n    updatedRoomState.recordingStartInterval = null;\n  }, 4000);\n\n  Skylink.setSkylinkState(updatedRoomState, room.id);\n  dispatchRecordingEvent(RECORDING_STATE.START, recordingId);\n};\n\n/**\n * Recording successfully stopped\n * @param {SkylinkState} roomState\n * @param {number} recordingId\n * @private\n */\nconst recordingStopped = (roomState, recordingId) => {\n  const updatedRoomState = Object.assign({}, roomState);\n  const { room, recordings } = updatedRoomState;\n\n  handleRecordingStats.send(room.id, MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.STOP, recordingId, null, null);\n\n  if (!recordings[recordingId]) {\n    logger.log.ERROR([PEER_TYPE.MCU, TAGS.RECORDING, recordingId, MESSAGES.RECORDING.ERRORS.SESSION_EMPTY]);\n    return null;\n  }\n\n  updatedRoomState.currentRecordingId = null;\n\n  if (updatedRoomState.recordingStartInterval) {\n    clearTimeout(updatedRoomState.recordingStartInterval);\n    logger.log.WARN([PEER_TYPE.MCU, TAGS.RECORDING, recordingId, MESSAGES.RECORDING.ERRORS.STOP_ABRUPT]);\n    updatedRoomState.recordingStartInterval = null;\n  }\n\n  logger.log.DEBUG([PEER_TYPE.MCU, TAGS.RECORDING, recordingId, MESSAGES.RECORDING.STOP_SUCCESS]);\n\n  updatedRoomState.recordings[recordingId].active = false;\n  updatedRoomState.recordings[recordingId].state = RECORDING_STATE.STOP;\n  updatedRoomState.recordings[recordingId].endedDateTime = (new Date()).toISOString();\n\n  Skylink.setSkylinkState(updatedRoomState, room.id);\n  dispatchRecordingEvent(RECORDING_STATE.STOP, recordingId);\n\n  return null;\n};\n\nconst recordingHandler = (message) => {\n  const {\n    action, rid, recordingId, error,\n  } = message;\n  const roomState = getStateByRid(rid);\n\n  if (action === 'on') {\n    recordingStarted(roomState, recordingId);\n  } else if (action === 'off') {\n    recordingStopped(roomState, recordingId);\n  } else if (action === 'error') {\n    dispatchRecordingEvent(null, recordingId, error);\n    logger.log.ERROR([PEER_TYPE.MCU, TAGS.RECORDING, recordingId, MESSAGES.RECORDING.ERRORS.MCU_RECORDING_ERROR], error);\n    handleRecordingStats.send(roomState.room.id, MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.MCU_RECORDING_ERROR, recordingId, null, error);\n  }\n};\n\nexport default recordingHandler;\n","import Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport messages from '../../../../messages';\nimport { RTMP_STATE, PEER_TYPE } from '../../../../constants';\nimport { getStateByRid } from '../../../../utils/helpers';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { rtmpState } from '../../../../skylink-events';\n\nconst ACTION = {\n  START_SUCCESS: 'startSuccess',\n  STOP_SUCCESS: 'stopSuccess',\n};\n\nconst rtmpSessionStartSuccess = (roomState, message) => {\n  const { rtmpSessions } = roomState;\n  const { rtmpId, peerId, streamId } = message;\n\n  if (!rtmpSessions[rtmpId]) {\n    const updatedState = Object.assign({}, roomState);\n    logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', messages.RTMP.started_success]);\n\n    updatedState.rtmpSessions[rtmpId] = {\n      active: true,\n      state: RTMP_STATE.START,\n      startedDateTime: (new Date()).toISOString(),\n      endedDateTime: null,\n      peerId,\n      streamId,\n    };\n\n    dispatchEvent(rtmpState({\n      state: RTMP_STATE.START,\n      rtmpId,\n      error: null,\n    }));\n\n    Skylink.setSkylinkState(updatedState, updatedState.room.id);\n  }\n  return null;\n};\n\nconst rtmpSessionStopSuccess = (roomState, message) => {\n  const { rtmpSessions } = roomState;\n  const { rtmpId } = message;\n  const updatedState = Object.assign({}, roomState);\n\n  if (!rtmpSessions[rtmpId]) {\n    logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', messages.RTMP.stop_session_empty]);\n    return false;\n  }\n\n  logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', messages.RTMP.stopped_success]);\n\n  updatedState.rtmpSessions[rtmpId].active = false;\n  updatedState.rtmpSessions[rtmpId].state = RTMP_STATE.STOP;\n  updatedState.rtmpSessions[rtmpId].endedDateTime = (new Date()).toISOString();\n\n  dispatchEvent(rtmpState({\n    state: RTMP_STATE.STOP,\n    rtmpId,\n    error: null,\n  }));\n\n  Skylink.setSkylinkState(updatedState, updatedState.room.id);\n  return null;\n};\n\nconst rtmpSessionFailed = (roomState, message) => {\n  const { error, rtmpId } = message;\n  const { rtmpSessions } = roomState;\n  const rtmpError = new Error(error || 'Unkown Error');\n  const updatedState = Object.assign({}, roomState);\n\n  if (!rtmpSessions[rtmpId]) {\n    logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', messages.RTMP.error_session_empty]);\n    return null;\n  }\n\n  logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', messages.RTMP.error_session]);\n\n  updatedState.rtmpSessions[rtmpId].state = RTMP_STATE.ERROR;\n  updatedState.rtmpSessions[rtmpId].error = rtmpError;\n\n  if (rtmpSessions[rtmpId].active) {\n    logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', messages.RTMP.error_Session_abrupt]);\n    updatedState.rtmpSessions[rtmpId].active = false;\n  }\n\n  dispatchEvent(rtmpState({\n    state: RTMP_STATE.ERROR,\n    rtmpId,\n    error: rtmpError,\n  }));\n\n  Skylink.setSkylinkState(updatedState, updatedState.room.id);\n  return null;\n};\n\nconst rtmpHandler = (message) => {\n  const { action, rid } = message;\n  const roomState = getStateByRid(rid);\n\n  logger.log.DEBUG([PEER_TYPE.MCU, 'RTMP', null, messages.RTMP.message_received_from_sig]);\n\n  if (action === ACTION.START_SUCCESS) {\n    rtmpSessionStartSuccess(roomState, message);\n  } else if (action === ACTION.STOP_SUCCESS) {\n    rtmpSessionStopSuccess(roomState, message);\n  } else {\n    rtmpSessionFailed(roomState, message);\n  }\n};\n\nexport default rtmpHandler;\n","import PeerData from '../../../../../peer-data';\nimport { dispatchEvent } from '../../../../../utils/skylinkEventManager';\nimport { peerUpdated, streamMuted } from '../../../../../skylink-events';\nimport { TRACK_KIND } from '../../../../../constants';\n\nconst dispatchMediaStateChangeEvents = (state, streamId, peerId, kind, isScreensharing) => {\n  const peerInfo = PeerData.getPeerInfo(peerId, state.room);\n\n  dispatchEvent(streamMuted({\n    isSelf: false,\n    peerId,\n    peerInfo,\n    streamId,\n    isAudio: kind === TRACK_KIND.AUDIO,\n    isVideo: kind === TRACK_KIND.VIDEO,\n    isScreensharing,\n  }));\n\n  dispatchEvent(peerUpdated({\n    isSelf: false,\n    peerId,\n    peerInfo,\n  }));\n};\n\nexport default dispatchMediaStateChangeEvents;\n","import dispatchMediaStateChangeEvents from './dispatchMediaStateChangeEvents';\n\nconst mediaInfoEventHelpers = {\n  dispatchMediaStateChangeEvents,\n};\n\nexport default mediaInfoEventHelpers;\n","import Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport MESSAGES from '../../../../messages';\nimport {\n  MEDIA_STATE, MEDIA_STATUS, TAGS, TRACK_KIND,\n} from '../../../../constants';\nimport PeerMedia from '../../../../peer-media';\nimport mediaInfoEventHelpers from './helpers/mediaInfoEventHelpers';\n\nconst audioStateChangeHandler = (targetMid, message) => {\n  const {\n    type, rid, mediaId, mediaState, transceiverMid,\n  } = message;\n  const updatedState = Skylink.getSkylinkState(rid);\n  const { room } = updatedState;\n  const streamId = PeerMedia.retrieveStreamId(room, targetMid, mediaId, transceiverMid);\n  const stamp = (new Date()).toISOString();\n\n  logger.log.INFO([targetMid, TAGS.SIG_SERVER, type, MESSAGES.MEDIA_INFO.AUDIO_STATE_CHANGE, mediaState, streamId], message);\n\n  if (!updatedState.peerInformations[targetMid]) {\n    logger.log.WARN([targetMid, TAGS.PEER_INFORMATION, type, `${MESSAGES.PEER_INFORMATIONS.NO_PEER_INFO} ${targetMid}`]);\n    return;\n  }\n\n  if (updatedState.peerMessagesStamps[targetMid]) {\n    if (stamp < updatedState.peerMessagesStamps[targetMid].audioMuted) {\n      logger.log.WARN([targetMid, TAGS.SIG_SERVER, type, MESSAGES.SIGNALING.OUTDATED_MSG], message);\n      return;\n    }\n    updatedState.peerMessagesStamps[targetMid].audioMuted = stamp;\n  }\n\n  if (!updatedState.peerInformations[targetMid].mediaStatus[streamId]) {\n    updatedState.peerInformations[targetMid].mediaStatus[streamId] = {};\n  }\n\n  updatedState.peerInformations[targetMid].mediaStatus[streamId].audioMuted = (mediaState === MEDIA_STATE.MUTED || mediaState === MEDIA_STATE.STOPPED) ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE;\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  mediaInfoEventHelpers.dispatchMediaStateChangeEvents(updatedState, streamId, targetMid, TRACK_KIND.AUDIO, false);\n};\n\nexport default audioStateChangeHandler;\n","import Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport MESSAGES from '../../../../messages';\nimport {\n  MEDIA_STATUS, TAGS, MEDIA_STATE, TRACK_KIND, MEDIA_TYPE,\n} from '../../../../constants';\nimport PeerMedia from '../../../../peer-media/index';\nimport mediaInfoEventHelpers from './helpers/mediaInfoEventHelpers';\n\nconst videoStateChangeHandler = (targetMid, message) => {\n  const {\n    type, rid, mediaId, mediaState, transceiverMid, mediaType,\n  } = message;\n  const updatedState = Skylink.getSkylinkState(rid);\n  const { room } = updatedState;\n  const streamId = PeerMedia.retrieveStreamId(room, targetMid, mediaId, transceiverMid);\n  const stamp = (new Date()).toISOString();\n\n  logger.log.INFO([targetMid, TAGS.SIG_SERVER, type, MESSAGES.MEDIA_INFO.VIDEO_STATE_CHANGE, mediaState, streamId], message);\n\n  if (!updatedState.peerInformations[targetMid]) {\n    logger.log.WARN([targetMid, TAGS.PEER_INFORMATION, type, `${MESSAGES.PEER_INFORMATIONS.NO_PEER_INFO} ${targetMid}`]);\n    return;\n  }\n\n  if (updatedState.peerMessagesStamps[targetMid]) {\n    if (stamp < updatedState.peerMessagesStamps[targetMid].videoMuted) {\n      logger.log.WARN([targetMid, TAGS.SIG_SERVER, type, MESSAGES.SIGNALING.OUTDATED_MSG], message);\n      return;\n    }\n    updatedState.peerMessagesStamps[targetMid].videoMuted = stamp;\n  }\n  if (!updatedState.peerInformations[targetMid].mediaStatus[streamId]) {\n    updatedState.peerInformations[targetMid].mediaStatus[streamId] = {};\n  }\n  updatedState.peerInformations[targetMid].mediaStatus[streamId].videoMuted = (mediaState === MEDIA_STATE.MUTED || mediaState === MEDIA_STATE.STOPPED) ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE;\n\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  mediaInfoEventHelpers.dispatchMediaStateChangeEvents(updatedState, streamId, targetMid, TRACK_KIND.VIDEO, mediaType === MEDIA_TYPE.VIDEO_SCREEN);\n};\n\nexport default videoStateChangeHandler;\n","import {\n  MEDIA_TYPE, MEDIA_INFO, TAGS, MEDIA_STATE,\n} from '../../../../constants';\nimport MESSAGES from '../../../../messages';\nimport PeerMedia from '../../../../peer-media/index';\nimport Skylink from '../../../../index';\nimport audioStateChangeHandler from './audioStateChangeHandler';\nimport videoStateChangeHandler from './videoStateChangeHandler';\nimport logger from '../../../../logger/index';\n\nconst addNewPeerMediaInfo = (state, message) => {\n  const updatedState = state;\n  const { mediaId, publisherId } = message;\n  updatedState.peerMedias[publisherId] = updatedState.peerMedias[publisherId] || {};\n\n  if (!updatedState.peerMedias[publisherId][mediaId]) {\n    updatedState.peerMedias[publisherId][mediaId] = message;\n    Skylink.setSkylinkState(updatedState, updatedState.room.id);\n    return true;\n  }\n\n  return false;\n};\n\nconst processOtherChanges = (targetMid, message, key) => {\n  logger.log.WARN([targetMid, TAGS.SIG_SERVER, `${MESSAGES.MEDIA_INFO.WARN.READ_ONLY_VALUE} ${key}`], message);\n};\n\nconst processTransceiverMidChange = (targetMid, message) => {\n  const {\n    rid, mediaId, transceiverMid,\n  } = message;\n  const state = Skylink.getSkylinkState(rid);\n  PeerMedia.updatePeerMediaInfo(state.room, targetMid, mediaId, MEDIA_INFO.TRANSCEIVER_MID, transceiverMid);\n};\n\nconst processUnavailableStream = (room, mediaType, targetMid, message) => {\n  const { mediaId } = message;\n\n  PeerMedia.setMediaStateToUnavailable(room, targetMid, mediaId);\n  PeerMedia.deleteUnavailableMedia(room, targetMid, mediaId);\n};\n\nconst processMediaStateChange = (room, mediaType, targetMid, message) => {\n  if (message.mediaState === MEDIA_STATE.UNAVAILABLE) {\n    processUnavailableStream(room, mediaType, targetMid, message);\n  } else {\n    switch (mediaType) {\n      case MEDIA_TYPE.VIDEO_SCREEN:\n      case MEDIA_TYPE.VIDEO_CAMERA:\n      case MEDIA_TYPE.VIDEO_OTHER:\n      case MEDIA_TYPE.VIDEO: videoStateChangeHandler(targetMid, message); break;\n      case MEDIA_TYPE.AUDIO_MIC:\n      case MEDIA_TYPE.AUDIO: audioStateChangeHandler(targetMid, message); break;\n      default: logger.log.ERROR([targetMid, TAGS.SIG_SERVER, `${MESSAGES.MEDIA_INFO.WARN.INVALID_MEDIA_TYPE} ${mediaType}`], message);\n    }\n  }\n};\n\nconst valueChanged = (roomKey, peerId, mediaId, key, newValue) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { peerMedias } = state;\n  const mediaInfo = peerMedias[peerId][mediaId];\n\n  return mediaInfo[key] && mediaInfo[key] !== newValue;\n};\n\nconst mediaInfoEventHandler = (message) => {\n  const {\n    mid, rid, mediaType, mediaId, publisherId,\n  } = message;\n  const state = Skylink.getSkylinkState(rid);\n  const { hasMCU, room } = state;\n  const targetMid = hasMCU ? publisherId : mid;\n\n  try {\n    if (!addNewPeerMediaInfo(state, message)) {\n      const mediaInfoKeys = Object.values(MEDIA_INFO);\n\n      for (let k = 0; k < mediaInfoKeys.length; k += 1) {\n        if (valueChanged(rid, targetMid, mediaId, mediaInfoKeys[k], message[mediaInfoKeys[k]])) {\n          PeerMedia.updatePeerMediaInfo(state.room, targetMid, mediaId, mediaInfoKeys[k], message[mediaInfoKeys[k]]);\n\n          if (mediaInfoKeys[k] === MEDIA_INFO.MEDIA_STATE) {\n            processMediaStateChange(room, mediaType, targetMid, message);\n            return;\n          }\n\n          if (mediaInfoKeys[k] === MEDIA_INFO.TRANSCEIVER_MID) {\n            processTransceiverMidChange(targetMid, message);\n            return;\n          }\n\n          processOtherChanges(targetMid, message, mediaInfoKeys[k]);\n        }\n      }\n    }\n  } catch (err) {\n    logger.log.ERROR([targetMid, TAGS.SIG_SERVER, MESSAGES.MEDIA_INFO.FAILED_PROCESSING_MEDIA_INFO_EVENT], err);\n  }\n};\n\nexport default mediaInfoEventHandler;\n","import dispatchMediaStateChangeEvents from './dispatchMediaStateChangeEvents';\nimport shouldDropMessage from './shouldDropMessage';\n\nconst muteEventHelpers = {\n  dispatchMuteEvents: dispatchMediaStateChangeEvents,\n  shouldDropMessage,\n};\n\nexport default muteEventHelpers;\n","import PeerData from '../../../../../peer-data/index';\nimport { TAGS, SDK_VERSION } from '../../../../../constants';\nimport logger from '../../../../../logger/index';\nimport MESSAGES from '../../../../../messages';\n\nconst shouldDropMessage = (state, peerId) => {\n  const peerInfo = PeerData.getPeerInfo(peerId, state.room);\n\n  if (peerInfo.agent.SDKVersion && peerInfo.agent.SDKVersion === SDK_VERSION) {\n    logger.log.INFO([peerId, TAGS.SIG_SERVER, null, MESSAGES.SIGNALING.DROPPING_MUTE_EVENT]);\n    return true;\n  }\n\n  return false;\n};\n\nexport default shouldDropMessage;\n","import userMessageHandler from './userMessageHandler';\nimport inRoom from './inRoomHandler';\nimport enter from './enterHandler';\nimport offer from './offerHandler';\nimport answer from './answerHandler';\nimport answerAck from './answerAckHandler';\nimport welcome from './welcomeHandler';\nimport candidate from './candidateHandler';\nimport getPeerList from './getPeerListHandler';\nimport introduceError from './introduceErrorHandler';\nimport bye from './byeHandler';\nimport stream from './streamHandler';\nimport recording from './recordingHandler';\nimport redirect from './redirectHandler';\nimport rtmp from './rtmpHandler';\nimport setUserData from './setUserDataHandler';\nimport mediaInfoEvent from './mediaInfoEventHandler';\nimport muteVideoEvent from './muteVideoEventHandler';\nimport muteAudioEvent from './muteAudioEventHandler';\nimport storedMessages from './storedMessagesHandler';\n\nconst handlers = {\n  userMessageHandler,\n  answer,\n  answerAck,\n  inRoom,\n  enter,\n  offer,\n  welcome,\n  candidate,\n  getPeerList,\n  introduceError,\n  stream,\n  bye,\n  recording,\n  redirect,\n  rtmp,\n  muteVideoEvent,\n  muteAudioEvent,\n  setUserData,\n  mediaInfoEvent,\n  storedMessages,\n};\n\nexport default handlers;\n","import logger from '../../../../logger';\nimport { SYSTEM_ACTION } from '../../../../constants';\nimport { disconnect } from '../../../../utils/helpers';\nimport SkylinkStates from '../../../../skylink-states';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { systemAction } from '../../../../skylink-events';\nimport Skylink from '../../../../index';\n\n/**\n * Handles the \"redirect\" message from the Signaling server.\n * @param {JSON} message\n * @private\n */\nexport const redirectHandler = (message) => {\n  logger.log.INFO(['Server', null, message.type, 'System action warning:'], message);\n\n  if (Object.keys((new SkylinkStates()).getAllStates()).length > 1 && message.action === SYSTEM_ACTION.REJECT) {\n    disconnect();\n  }\n\n  if (message.reason === 'toClose') {\n    // eslint-disable-next-line no-param-reassign\n    message.reason = 'toclose';\n  }\n\n  Skylink.removeSkylinkState(Skylink.getSkylinkState(message.rid));\n  // removeRoomStateByState(new SkylinkStates().getState(message.rid));\n\n  dispatchEvent(systemAction({\n    action: message.action,\n    info: message.info,\n    reason: message.reason,\n    rid: message.rid,\n  }));\n};\n\nexport default redirectHandler;\n","import Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport MESSAGES from '../../../../messages';\nimport { MEDIA_STATUS, TAGS } from '../../../../constants';\nimport muteEventHelpers from './helpers/muteEventHelpers';\n\nconst muteVideoEventHandler = (message) => {\n  const {\n    type, mid, muted, rid, stamp, streamId,\n  } = message;\n  const targetMid = mid;\n  const updatedState = Skylink.getSkylinkState(rid);\n  const { room } = updatedState;\n\n  if (muteEventHelpers.shouldDropMessage(updatedState, targetMid)) {\n    return;\n  }\n\n  logger.log.INFO([targetMid, null, type, MESSAGES.MEDIA_STREAM.VIDEO_MUTED, muted, streamId], message);\n\n  if (!updatedState.peerInformations[targetMid]) {\n    logger.log.WARN([targetMid, TAGS.PEER_INFORMATION, type, `${MESSAGES.PEER_INFORMATIONS.NO_PEER_INFO} ${targetMid}`]);\n    return;\n  }\n\n  if (updatedState.peerMessagesStamps[targetMid]) {\n    if (stamp < updatedState.peerMessagesStamps[targetMid].videoMuted) {\n      logger.log.WARN([targetMid, TAGS.SIG_SERVER, type, MESSAGES.SIGNALING.OUTDATED_MSG], message);\n      return;\n    }\n    updatedState.peerMessagesStamps[targetMid].videoMuted = stamp;\n  }\n  if (!updatedState.peerInformations[targetMid].mediaStatus[streamId]) {\n    updatedState.peerInformations[targetMid].mediaStatus[streamId] = {};\n  }\n  updatedState.peerInformations[targetMid].mediaStatus[streamId].videoMuted = muted ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE;\n\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  muteEventHelpers.dispatchMuteEvents(updatedState, streamId, targetMid);\n};\n\nexport default muteVideoEventHandler;\n","import { MEDIA_STATUS, TAGS } from '../../../../constants';\nimport Skylink from '../../../../index';\nimport logger from '../../../../logger';\nimport MESSAGES from '../../../../messages';\nimport muteEventHelpers from './helpers/muteEventHelpers';\n\nconst muteAudioEventHandler = (message) => {\n  const {\n    type, mid, rid, muted, stamp, streamId,\n  } = message;\n  const targetMid = mid;\n  const updatedState = Skylink.getSkylinkState(rid);\n  const { room } = updatedState;\n\n  if (muteEventHelpers.shouldDropMessage(updatedState, targetMid)) {\n    return;\n  }\n\n  logger.log.INFO([targetMid, TAGS.SIG_SERVER, type, MESSAGES.MEDIA_STREAM.AUDIO_MUTED, muted, streamId], message);\n\n  if (!updatedState.peerInformations[targetMid]) {\n    logger.log.WARN([targetMid, TAGS.PEER_INFORMATION, type, `${MESSAGES.PEER_INFORMATIONS.NO_PEER_INFO} ${targetMid}`]);\n    return;\n  }\n\n  if (updatedState.peerMessagesStamps[targetMid]) {\n    if (stamp < updatedState.peerMessagesStamps[targetMid].audioMuted) {\n      logger.log.WARN([targetMid, TAGS.SIG_SERVER, type, MESSAGES.SIGNALING.OUTDATED_MSG], message);\n      return;\n    }\n    updatedState.peerMessagesStamps[targetMid].audioMuted = stamp;\n  }\n  if (!updatedState.peerInformations[targetMid].mediaStatus[streamId]) {\n    updatedState.peerInformations[targetMid].mediaStatus[streamId] = {};\n  }\n  updatedState.peerInformations[targetMid].mediaStatus[streamId].audioMuted = muted ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE;\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  muteEventHelpers.dispatchMuteEvents(updatedState, streamId, targetMid);\n};\n\nexport default muteAudioEventHandler;\n","import logger from '../../../../logger/index';\nimport Skylink from '../../../../index';\nimport { dispatchEvent } from '../../../../utils/skylinkEventManager';\nimport { peerUpdated } from '../../../../skylink-events';\nimport PeerData from '../../../../peer-data/index';\nimport { isANumber } from '../../../../utils/helpers';\nimport MESSAGES from '../../../../messages';\n\n/**\n * Function that handles the \"updateUserEvent\" socket message received.\n * See confluence docs for the \"updateUserEvent\" expected properties to be received\n *   based on the current <code>SM_PROTOCOL_VERSION</code>.\n * @param {JSON} message\n * @param {String} message.type - SIG_MESSAGE_TYPE\n * @param {String} message.mid - The source peerId.\n * @param {String} message.rid - The roomkey.\n * @param {String|Object} message.userData - The updated peer userData.\n * @param {Number} message.stamp - The time stamp for the current updateUserEvent userData.\n * @member SignalingMessageHandler\n * @fires peerUpdated\n * @private\n */\nconst setUserDataHandler = (message) => {\n  const {\n    type, mid, rid, userData, stamp,\n  } = message;\n  const state = Skylink.getSkylinkState(rid);\n  const { peerInformations, peerMessagesStamps } = state;\n  const targetMid = mid;\n  const { PEER_INFORMATIONS } = MESSAGES;\n\n  let parsedUserData = userData.replace(/&quot;/g, '\"');\n\n  try {\n    parsedUserData = JSON.parse(parsedUserData);\n  } catch (err) {\n    logger.log.INFO([targetMid, null, type, `${PEER_INFORMATIONS.USER_DATA_NOT_JSON}`], parsedUserData);\n  } finally {\n    logger.log.INFO([targetMid, null, type, `${PEER_INFORMATIONS.UPDATE_USER_DATA}`], parsedUserData);\n  }\n\n  if (!peerInformations[targetMid]) {\n    logger.log.INFO([targetMid, null, type, `${PEER_INFORMATIONS.NO_PEER_INFO} ${targetMid}`]);\n    return;\n  }\n\n  if (peerMessagesStamps[targetMid] && isANumber(stamp)) {\n    if (stamp < peerMessagesStamps[targetMid].userData) {\n      logger.log.WARN([targetMid, null, type, `${PEER_INFORMATIONS.OUTDATED_MSG}`], message);\n      return;\n    }\n    peerMessagesStamps[targetMid].userData = stamp;\n  }\n\n  peerInformations[targetMid].userData = parsedUserData || {};\n\n  dispatchEvent(peerUpdated({\n    peerId: targetMid,\n    peerInfo: PeerData.getPeerInfo(targetMid, state.room),\n    isSelf: false,\n  }));\n};\n\nexport default setUserDataHandler;\n","import AsyncMessaging from '../../../../features/messaging/async-messaging';\n\n/**\n * Function that handles the \"storedMessages\" socket message received.\n * @param {JSON} message\n * @memberOf SignalingMessageHandler\n */\nconst storedMessagesHandler = (message) => {\n  AsyncMessaging.processStoredMessages(message);\n};\n\nexport default storedMessagesHandler;\n","/* eslint-disable class-methods-use-this */\nimport handlers from './handlers/index';\n\n/**\n * @class\n * @classdesc Class representing a SignalingMessageHandler instance.\n * @namespace SignalingMessageHandler\n * @private\n */\nclass SignalingMessageHandler {\n  userMessageHandler(...args) {\n    handlers.userMessageHandler(...args);\n  }\n\n  answerHandler(...args) {\n    handlers.answer(...args);\n  }\n\n  answerAckHandler(...args) {\n    handlers.answerAck(...args);\n  }\n\n  inRoomHandler(...args) {\n    handlers.inRoom(...args);\n  }\n\n  enterRoomHandler(...args) {\n    handlers.enter(...args);\n  }\n\n  offerHandler(...args) {\n    handlers.offer(...args);\n  }\n\n  welcomeHandler(...args) {\n    handlers.welcome(...args);\n  }\n\n  candidateHandler(...args) {\n    handlers.candidate(...args);\n  }\n\n  getPeerListHandler(...args) {\n    handlers.getPeerList(...args);\n  }\n\n  introduceErrorHandler(...args) {\n    handlers.introduceError(...args);\n  }\n\n  byeHandler(...args) {\n    handlers.bye(...args);\n  }\n\n  streamHandler(...args) {\n    handlers.stream(...args);\n  }\n\n  recordingHandler(...args) {\n    handlers.recording(...args);\n  }\n\n  redirectHandler(...args) {\n    handlers.redirect(...args);\n  }\n\n  rtmpHandler(...args) {\n    handlers.rtmp(...args);\n  }\n\n  setUserDataHandler(...args) {\n    handlers.setUserData(...args);\n  }\n\n  mediaInfoEventHandler(...args) {\n    handlers.mediaInfoEvent(...args);\n  }\n\n  muteAudioEventHandler(...args) {\n    handlers.muteAudioEvent(...args);\n  }\n\n  muteVideoEventHandler(...args) {\n    handlers.muteVideoEvent(...args);\n  }\n\n  storedMessagesHandler(...args) {\n    handlers.storedMessages(...args);\n  }\n}\n\nexport default SignalingMessageHandler;\n","import joinRoomMessage from './joinRoomMessage';\nimport enterRoomMessage from './enterRoomMessage';\nimport welcomeMessage from './welcomeMessage';\nimport offerMessage from './offerMessage';\nimport answerMessage from './answerMessage';\nimport answerAckMessage from './answerAckMessage';\nimport candidateMessage from './candidateMessage';\nimport setUserDataMessage from './setUserDataMessage';\nimport getPeerListMessage from './getPeerListMessage';\nimport restartOfferMessage from './restartOfferMessage';\nimport streamMessage from './streamMessage';\nimport recordingMessage from './recordingMessage';\nimport rtmpMessage from './rtmpMessage';\nimport byeMessage from './byeMessage';\nimport roomLockMessage from './roomLockMeessage';\nimport mediaInfoEventMessage from './mediaInfoEventMessage';\nimport muteAudioEventMessage from './muteAudioEventMessage';\nimport muteVideoEventMessage from './muteVideoEventMessage';\nimport getStoredMessagesMessage from './getStoredMessagesMessage';\nimport userMessagesMessage from './getUserMessages';\n\nconst messageBuilders = {\n  joinRoom: joinRoomMessage,\n  enterRoom: enterRoomMessage,\n  welcome: welcomeMessage,\n  offer: offerMessage,\n  answer: answerMessage,\n  answerAck: answerAckMessage,\n  candidate: candidateMessage,\n  setUserData: setUserDataMessage,\n  getPeerList: getPeerListMessage,\n  restartOffer: restartOfferMessage,\n  stream: streamMessage,\n  recording: recordingMessage,\n  rtmp: rtmpMessage,\n  bye: byeMessage,\n  roomLock: roomLockMessage,\n  mediaInfoEvent: mediaInfoEventMessage,\n  muteAudioEvent: muteAudioEventMessage,\n  muteVideoEvent: muteVideoEventMessage,\n  getStoredMessages: getStoredMessagesMessage,\n  userMessages: userMessagesMessage,\n};\n\nexport default messageBuilders;\n","import Skylink from '../../../../index';\nimport { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst getJoinRoomMessage = (roomState) => {\n  const { room } = roomState;\n  const state = Skylink.getSkylinkState(room.id);\n  const initOptions = Skylink.getInitOptions();\n  return {\n    type: SIG_MESSAGE_TYPE.JOIN_ROOM,\n    uid: state.user.uid,\n    cid: state.key,\n    rid: room.id,\n    userCred: state.user.token,\n    timeStamp: state.user.timeStamp,\n    apiOwner: state.appKeyOwner,\n    roomCred: room.token,\n    start: room.startDateTime,\n    len: room.duration,\n    isPrivileged: state.isPrivileged,\n    autoIntroduce: state.autoIntroduce,\n    key: initOptions.appKey,\n  };\n};\n\nexport default getJoinRoomMessage;\n","import Skylink from '../../../../index';\nimport {\n  SIG_MESSAGE_TYPE, SM_PROTOCOL_VERSION, DT_PROTOCOL_VERSION, PEER_TYPE,\n} from '../../../../constants';\nimport PeerData from '../../../../peer-data/index';\n\nexport const getEnterRoomMessage = (roomState) => {\n  // FIXME: Welcome and Enter are exactly same but for targetMid which is extra in welcomeMsg. @Ishan to merge code for Welcome and Enter\n  const { room } = roomState;\n  const state = Skylink.getSkylinkState(room.id);\n  const initOptions = Skylink.getInitOptions();\n  const {\n    user, peerPriorityWeight, enableIceRestart, hasMCU,\n  } = state;\n  const { enableDataChannel } = initOptions;\n  const { AdapterJS } = window;\n  const userInfo = PeerData.getUserInfo(room);\n  const enterMsg = {\n    type: SIG_MESSAGE_TYPE.ENTER,\n    mid: user.sid,\n    rid: room.id,\n    agent: AdapterJS.webrtcDetectedBrowser,\n    version: (AdapterJS.webrtcDetectedVersion || 0).toString(),\n    os: window.navigator.platform,\n    userInfo,\n    receiveOnly: PeerData.getCurrentSessionInfo(room).config.receiveOnly,\n    weight: peerPriorityWeight,\n    temasysPluginVersion: AdapterJS.WebRTCPlugin.plugin ? AdapterJS.WebRTCPlugin.plugin.VERSION : null,\n    enableDataChannel,\n    enableIceRestart,\n    SMProtocolVersion: SM_PROTOCOL_VERSION,\n    DTProtocolVersion: DT_PROTOCOL_VERSION,\n  };\n\n  if (hasMCU) {\n    enterMsg.target = PEER_TYPE.MCU;\n    enterMsg.publisherId = user.sid;\n  }\n\n  return enterMsg;\n};\n\nexport default getEnterRoomMessage;\n","import Skylink from '../../../../index';\nimport { SIG_MESSAGE_TYPE, SM_PROTOCOL_VERSION, DT_PROTOCOL_VERSION } from '../../../../constants';\nimport PeerData from '../../../../peer-data/index';\n\nconst getWelcomeMessage = (currentRoom, targetMid) => {\n  // FIXME: Welcome and Enter are exactly same but for targetMid which is extra in welcomeMsg. @Ishan to merge code for Welcome and Enter\n  const state = Skylink.getSkylinkState(currentRoom.id);\n  const initOptions = Skylink.getInitOptions();\n  const {\n    user, peerPriorityWeight, enableIceRestart, room,\n  } = state;\n  const { enableDataChannel } = initOptions;\n  const { AdapterJS } = window;\n  const userInfo = PeerData.getUserInfo(room);\n\n  return {\n    type: SIG_MESSAGE_TYPE.WELCOME,\n    mid: user.sid,\n    rid: room.id,\n    agent: AdapterJS.webrtcDetectedBrowser,\n    version: (AdapterJS.webrtcDetectedVersion || 0).toString(),\n    os: window.navigator.platform,\n    userInfo,\n    receiveOnly: PeerData.getCurrentSessionInfo(room).config.receiveOnly,\n    weight: peerPriorityWeight,\n    temasysPluginVersion: AdapterJS.WebRTCPlugin.plugin ? AdapterJS.WebRTCPlugin.plugin.VERSION : null,\n    enableDataChannel,\n    enableIceRestart,\n    SMProtocolVersion: SM_PROTOCOL_VERSION,\n    DTProtocolVersion: DT_PROTOCOL_VERSION,\n    target: targetMid,\n  };\n};\n\nexport default getWelcomeMessage;\n","import PeerConnection from '../../../../peer-connection/index';\n\nconst getOfferMessage = (...args) => PeerConnection.createOffer(...args);\n\nexport default getOfferMessage;\n","import PeerConnection from '../../../../peer-connection/index';\n\nconst getAnswerMessage = (...args) => PeerConnection.createAnswer(...args);\n\nexport default getAnswerMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst answerAckMessage = (state, targetMid, isSuccess) => {\n  const { room, user } = state;\n\n  return {\n    type: SIG_MESSAGE_TYPE.ANSWER_ACK,\n    rid: room.id,\n    mid: user.sid,\n    target: targetMid,\n    success: isSuccess,\n  };\n};\n\nexport default answerAckMessage;\n","import Skylink from '../../../../index';\nimport { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst candidateMessage = (targetMid, roomState, candidate) => {\n  const rid = roomState.room.id;\n  const state = Skylink.getSkylinkState(rid);\n  return {\n    type: SIG_MESSAGE_TYPE.CANDIDATE,\n    label: candidate.sdpMLineIndex,\n    id: candidate.sdpMid,\n    candidate: candidate.candidate,\n    mid: state.user.sid,\n    target: targetMid,\n    rid,\n  };\n};\n\nexport default candidateMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\nimport { isAString } from '../../../../utils/helpers';\n\n/**\n * @typedef userDataMessage\n * @property {SkylinkConstants.SIG_MESSAGE_TYPE.UPDATE_USER} type\n * @property {SkylinkUser.sid} mid\n * @property {SkylinkRoom.id} rid\n * @property {SkylinkUser.userData} userData\n * @property {Number} state\n */\n/**\n * @param {SkylinkState} roomState\n * @returns {userDataMessage}\n * @memberOf SignalingMessageBuilder\n * @private\n */\nconst setUserDataMessage = roomState => ({\n  type: SIG_MESSAGE_TYPE.UPDATE_USER,\n  mid: roomState.user.sid,\n  rid: roomState.room.id,\n  userData: isAString(roomState.userData) ? roomState.userData : JSON.stringify(roomState.userData),\n  stamp: (new Date()).getTime(),\n});\n\nexport default setUserDataMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\n\n/**\n * @typedef peerListMessage\n * @property {SkylinkConstants.SIG_MESSAGE_TYPE.GET_PEERS} type\n * @property {boolean} showAll\n */\n\n/**\n * @param {boolean} showAll\n * @return {peerListMessage}\n * @memberOf SignalingMessageBuilder\n * @private\n */\nconst getPeerListMessage = showAll => ({\n  type: SIG_MESSAGE_TYPE.GET_PEERS,\n  showAll,\n});\n\nexport default getPeerListMessage;\n","import Skylink from '../../../../index';\nimport { SIG_MESSAGE_TYPE, SM_PROTOCOL_VERSION, DT_PROTOCOL_VERSION } from '../../../../constants';\nimport PeerData from '../../../../peer-data/index';\n\nconst restartOfferMessage = (roomKey, peerId, doIceRestart) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { AdapterJS } = window;\n  const initOptions = Skylink.getInitOptions();\n  const {\n    user, room, enableIceRestart, peerInformations, peerPriorityWeight,\n  } = state;\n\n  return {\n    type: SIG_MESSAGE_TYPE.RESTART,\n    mid: user.sid,\n    rid: room.id,\n    agent: AdapterJS.webrtcDetectedBrowser,\n    version: (AdapterJS.webrtcDetectedVersion || 0).toString(),\n    os: window.navigator.platform,\n    userInfo: PeerData.getUserInfo(room),\n    target: peerId,\n    weight: peerPriorityWeight,\n    receiveOnly: PeerData.getCurrentSessionInfo(room).config.receiveOnly,\n    publishOnly: PeerData.getCurrentSessionInfo(room).config.publishOnly,\n    enableDataChannel: initOptions.enableDataChannel,\n    enableIceRestart,\n    doIceRestart: doIceRestart === true && enableIceRestart && peerInformations[peerId]\n      && peerInformations[peerId].config.enableIceRestart,\n    isRestartResend: false,\n    temasysPluginVersion: AdapterJS.WebRTCPlugin.plugin ? AdapterJS.WebRTCPlugin.plugin.VERSION : null,\n    SMProtocolVersion: SM_PROTOCOL_VERSION,\n    DTProtocolVersion: DT_PROTOCOL_VERSION,\n  };\n};\n\nexport default restartOfferMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\n/**\n * Function that builds the 'stream' socket message.\n * @param {String} roomKey - The room rid.\n * @param {SkylinkUser} user - The peer sending the streamMessage.\n * @param {MediaStream} stream - The media stream.\n * @param {String} status - The stream status.\n * @param {Object} options\n * @param {String} options.isScreensharing - The flag if the ended stream is a screensharing stream.\n * @returns {JSON}\n * @memberOf SignalingMessageBuilder\n */\nconst streamMessage = (roomKey, user, stream, status, options) => ({\n  type: SIG_MESSAGE_TYPE.STREAM,\n  mid: user.sid,\n  rid: roomKey,\n  status,\n  streamId: stream.id,\n  settings: options,\n});\n\nexport default streamMessage;\n","import { PEER_TYPE } from '../../../../constants';\n\nconst recordingMessage = (rid, type) => ({\n  type,\n  rid,\n  target: PEER_TYPE.MCU,\n});\n\nexport default recordingMessage;\n","import { SIG_MESSAGE_TYPE, PEER_TYPE } from '../../../../constants';\n\nconst rtmpMessage = (type, rid, mid, rtmpId, streamId = null, endpoint = null) => {\n  const message = {\n    type,\n    rid,\n    rtmpId,\n    streamId,\n    endpoint,\n    mid,\n    target: PEER_TYPE.MCU,\n  };\n\n  if (type === SIG_MESSAGE_TYPE.STOP_RTMP) {\n    delete message.endpoint;\n    delete message.streamId;\n  }\n\n  return message;\n};\n\nexport default rtmpMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst byeMessage = (state, peerId) => {\n  const { room, user, hasMCU } = state;\n  const byeMsg = {\n    type: SIG_MESSAGE_TYPE.BYE,\n    rid: room.id,\n    mid: user.sid,\n    target: peerId,\n  };\n\n  if (hasMCU) {\n    byeMsg.publisherId = user.sid;\n  }\n\n  return byeMsg;\n};\n\nexport default byeMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst roomLockMessage = (roomState) => {\n  const { user, room, roomLocked } = roomState;\n\n  return {\n    type: SIG_MESSAGE_TYPE.ROOM_LOCK,\n    mid: user.sid,\n    rid: room.id,\n    lock: roomLocked,\n  };\n};\n\nexport default roomLockMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst mediaInfoEventMessage = (roomState, peerId, mediaInfo) => ({\n  type: SIG_MESSAGE_TYPE.MEDIA_INFO_EVENT,\n  rid: roomState.room.id,\n  mid: mediaInfo.publisherId,\n  target: peerId,\n  publisherId: mediaInfo.publisherId,\n  mediaId: mediaInfo.mediaId,\n  mediaType: mediaInfo.mediaType,\n  mediaState: mediaInfo.mediaState,\n  transceiverMid: mediaInfo.transceiverMid,\n});\n\nexport default mediaInfoEventMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\nimport Skylink from '../../../../index';\n\nconst muteAudioEventMessage = (room, streamId) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const { user, streamsMutedSettings } = roomState;\n\n  return {\n    type: SIG_MESSAGE_TYPE.MUTE_AUDIO_EVENT,\n    mid: user.sid,\n    rid: room.id,\n    muted: streamsMutedSettings[streamId].audioMuted,\n    stamp: (new Date()).getTime(),\n    streamId,\n  };\n};\n\nexport default muteAudioEventMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\nimport Skylink from '../../../../index';\n\nconst muteVideoEventMessage = (room, streamId) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const { user, streamsMutedSettings } = roomState;\n\n  return {\n    type: SIG_MESSAGE_TYPE.MUTE_VIDEO_EVENT,\n    mid: user.sid,\n    rid: room.id,\n    muted: streamsMutedSettings[streamId].videoMuted,\n    stamp: (new Date()).getTime(),\n    streamId,\n  };\n};\n\nexport default muteVideoEventMessage;\n","import { SIG_MESSAGE_TYPE } from '../../../../constants';\n\nconst getStoredMessagesMessage = (roomState) => {\n  const { user, room } = roomState;\n  return {\n    mid: user.sid,\n    rid: room.id,\n    target: user.sid,\n    type: SIG_MESSAGE_TYPE.GET_STORED_MESSAGES,\n  };\n};\n\nexport default getStoredMessagesMessage;\n","import { generateUUID } from '../../../../utils/helpers';\nimport { SIG_MESSAGE_TYPE, TAGS } from '../../../../constants';\nimport logger from '../../../../logger';\nimport MESSAGES from '../../../../messages';\n\nconst getUserMessages = (roomState, config, message) => {\n  const signalingReadyMessages = [];\n  const { user, room } = roomState;\n  const {\n    listOfPeers, isPrivate, isPersistent, secretId,\n  } = config;\n\n  const messageBody = {\n    data: message,\n    mid: user.sid,\n    rid: room.id,\n    msgId: generateUUID(),\n    type: SIG_MESSAGE_TYPE.MESSAGE,\n  };\n\n  if (secretId) {\n    messageBody.secretId = secretId;\n  }\n\n  if (isPrivate) {\n    for (let i = 0; i < listOfPeers.length; i += 1) {\n      const peerId = listOfPeers[i];\n      const mBody = Object.assign({}, messageBody);\n      mBody.target = peerId;\n      signalingReadyMessages.push(mBody);\n      logger.log.DEBUG([peerId, TAGS.MESSAGING, null, MESSAGES.MESSAGING.PRIVATE_MESSAGE], { message });\n    }\n  } else {\n    if (isPersistent) {\n      messageBody.isPersistent = isPersistent;\n    }\n\n    signalingReadyMessages.push(messageBody);\n    logger.log.DEBUG([null, TAGS.MESSAGING, null, MESSAGES.MESSAGING.BROADCAST_MESSAGE], { message });\n  }\n\n  return signalingReadyMessages;\n};\n\nexport default getUserMessages;\n","import messageBuilders from './builders/index';\n\n/**\n * @class\n * @classdesc Class representing a SignalingMessageBuilder instance.\n * @namespace SignalingMessageBuilder\n * @private\n */\nclass SignalingMessageBuilder {\n  constructor() {\n    this.messageBuilders = messageBuilders;\n  }\n\n  getJoinRoomMessage(...args) {\n    return this.messageBuilders.joinRoom(...args);\n  }\n\n  getWelcomeMessage(...args) {\n    return this.messageBuilders.welcome(...args);\n  }\n\n  getEnterRoomMessage(...args) {\n    return this.messageBuilders.enterRoom(...args);\n  }\n\n  getAnswerMessage(...args) {\n    return this.messageBuilders.answer(...args);\n  }\n\n  getAnswerAckMessage(...args) {\n    return this.messageBuilders.answerAck(...args);\n  }\n\n  getOfferMessage(...args) {\n    return this.messageBuilders.offer(...args);\n  }\n\n  getCandidateMessage(...args) {\n    return this.messageBuilders.candidate(...args);\n  }\n\n  getSetUserDataMessage(roomState) {\n    return this.messageBuilders.setUserData(roomState);\n  }\n\n  getPeerListMessage(...args) {\n    return this.messageBuilders.getPeerList(...args);\n  }\n\n  getRestartOfferMessage(...args) {\n    return this.messageBuilders.restartOffer(...args);\n  }\n\n  getStreamMessage(...args) {\n    return this.messageBuilders.stream(...args);\n  }\n\n  getRecordingMessage(...args) {\n    return this.messageBuilders.recording(...args);\n  }\n\n  getPeerMessagesForSignaling(...args) {\n    return this.messageBuilders.signalingMessages(...args);\n  }\n\n  getMuteAudioMessage(...args) {\n    return this.messageBuilders.muteAudioEvent(...args);\n  }\n\n  getMuteVideoMessage(...args) {\n    return this.messageBuilders.muteVideoEvent(...args);\n  }\n\n  getRTMPMessage(...args) {\n    return this.messageBuilders.rtmp(...args);\n  }\n\n  getByeMessage(...args) {\n    return this.messageBuilders.bye(...args);\n  }\n\n  getRoomLockMessage(...args) {\n    return this.messageBuilders.roomLock(...args);\n  }\n\n  getMediaInfoEventMessage(...args) {\n    return this.messageBuilders.mediaInfoEvent(...args);\n  }\n\n  getGetStoredMessagesMessage(...args) {\n    return this.messageBuilders.getStoredMessages(...args);\n  }\n\n  getUserMessages(...args) {\n    return this.messageBuilders.userMessages(...args);\n  }\n}\n\nexport default SignalingMessageBuilder;\n","import clone from 'clone';\nimport {\n  createSocket,\n  sendChannelMessage,\n  processSignalingMessage,\n  setSocketCallbacks,\n  shouldBufferMessage,\n} from './signaling-server-helpers';\nimport logger from '../../logger';\nimport SignalingMessageHandler from './message-handler/index';\nimport SignalingMessageBuilder from './message-builder/index';\nimport {\n  socketError, channelMessage, handshakeProgress,\n} from '../../skylink-events';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport Skylink from '../../index';\nimport MESSAGES from '../../messages';\nimport { TAGS, SOCKET_ERROR, HANDSHAKE_PROGRESS } from '../../constants';\n\nconst SOCKET_TYPE = {\n  POLLING: 'Polling',\n  WEBSOCKET: 'WebSocket',\n  XHR_POLLING: 'xhr-polling',\n  JSONP_POLLING: 'jsonp-polling',\n};\n\nlet instance = null;\n\n/**\n * @class\n * @classdesc Singleton class that represents a signaling server\n * @private\n */\nclass SkylinkSignalingServer {\n  constructor() {\n    if (!instance) {\n      instance = this;\n    }\n    /**\n     * Stores the WebSocket object\n     * @type {WebSocket}\n     */\n    this.socket = null;\n    /**\n     * Stores the number of socket reconnect attempts\n     * @type {number}\n     */\n    this.attempts = 0;\n    /**\n     * Current timestamp\n     * @type {number}\n     */\n    this.timestamp = new Date().valueOf();\n    /**\n     * Handler for incoming messages on the socket\n     * @type {SignalingMessageHandler}\n     */\n    this.messageHandler = new SignalingMessageHandler();\n    /**\n     * Handler for outbound messages via the socket\n     * @type {SignalingMessageBuilder}\n     */\n    this.messageBuilder = new SignalingMessageBuilder();\n    /**\n     * Config needed for create a socket and establishing a socket connection with the Signaling Server\n     * @type {{protocol: Window.location.protocol, socketType: string, signalingServerProtocol: Window.location.protocol, socketSession: {finalAttempts: number, attempts: number}, fallbackType: null, signalingServerPort: null}}\n     */\n    this.config = null;\n    return instance;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  resetSocketConfig(protocol) {\n    return {\n      protocol,\n      socketType: !window.WebSocket ? SOCKET_TYPE.POLLING : SOCKET_TYPE.WEBSOCKET,\n      signalingServerProtocol: protocol,\n      socketSession: {\n        finalAttempts: 0,\n        attempts: 0,\n      },\n      fallbackType: null,\n      signalingServerPort: null,\n      socketTimeout: false,\n    };\n  }\n\n  /**\n   * Method that creates a socket - Returns the same instance of socket if already created.\n   * @param {SkylinkRoom.id} roomKey\n   * @fires socketError\n   * @return {Promise}\n   */\n  createSocket(roomKey) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n    roomState.socketSession = this.resetSocketConfig(roomState.signalingServerProtocol);\n    Skylink.setSkylinkState(roomState, roomKey);\n\n    return new Promise((resolve, reject) => {\n      try {\n        if (this.socket !== null && this.socket instanceof window.io.Socket && this.socket.connected) {\n          resolve();\n        } else {\n          this.tryCreateSocket(roomKey, resolve, reject);\n        }\n      } catch (ex) {\n        this.handleCreateSocketFailure(roomKey, resolve, reject, ex);\n      }\n    });\n  }\n\n  tryCreateSocket(roomKey, resolve, reject) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n    const { socketSession } = roomState;\n\n    this.socket = createSocket({\n      config: socketSession,\n      roomKey,\n    });\n\n    setSocketCallbacks(roomKey, this, resolve, reject);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  handleCreateSocketFailure(roomKey, resolve, reject, error) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n    const { socketSession } = roomState;\n    logger.log.ERROR(MESSAGES.INIT.SOCKET_CREATE_FAILED, error);\n\n    dispatchEvent(socketError({\n      session: clone(socketSession),\n      errorCode: SOCKET_ERROR.CONNECTION_FAILED,\n      type: socketSession.fallbackType,\n      error,\n    }));\n\n    reject(error);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  dispatchHandshakeProgress(roomState, state) {\n    dispatchEvent(handshakeProgress({\n      peerId: roomState.user.sid,\n      state: HANDSHAKE_PROGRESS[state],\n      error: null,\n      room: roomState.room,\n    }));\n  }\n\n  /**\n   *\n   * @param args\n   */\n  answer(...args) {\n    return this.messageBuilder.getAnswerMessage(...args).then((answer) => {\n      const state = args[0];\n      this.sendMessage(answer);\n      this.dispatchHandshakeProgress(state, 'ANSWER');\n      return answer;\n    });\n  }\n\n  answerAck(...args) {\n    const answerAck = this.messageBuilder.getAnswerAckMessage(...args);\n    const roomState = args[0];\n    this.sendMessage(answerAck);\n    this.dispatchHandshakeProgress(roomState, 'ANSWER_ACK');\n  }\n\n  /**\n   *\n   * @param args\n   */\n  enterRoom(...args) {\n    const enter = this.messageBuilder.getEnterRoomMessage(...args);\n    this.sendMessage(enter);\n    this.dispatchHandshakeProgress(...args, 'ENTER');\n  }\n\n  joinRoom(...args) {\n    const join = this.messageBuilder.getJoinRoomMessage(...args);\n    this.sendMessage(join);\n  }\n\n  offer(...args) {\n    const room = args[0];\n    const peerId = args[1];\n    const state = Skylink.getSkylinkState(room.id);\n    if (state.peerConnections[peerId].negotiating) {\n      logger.log.DEBUG([peerId, TAGS.SIG_SERVER, null, `${MESSAGES.SIGNALING.ABORTING_OFFER}`]);\n      return;\n    }\n\n    this.messageBuilder.getOfferMessage(...args).then((offer) => {\n      this.sendMessage(offer);\n      this.dispatchHandshakeProgress(state, 'OFFER');\n    });\n  }\n\n  welcome(...args) {\n    const welcome = this.messageBuilder.getWelcomeMessage(...args);\n    this.sendMessage(welcome);\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  noop() {\n    return null;\n  }\n\n  sendCandidate(...args) {\n    const candidate = this.messageBuilder.getCandidateMessage(...args);\n    if (candidate) {\n      this.sendMessage(candidate);\n    }\n  }\n\n  /**\n   * @param {SkylinkState} roomState\n   */\n  setUserData(roomState) {\n    const userData = this.messageBuilder.getSetUserDataMessage(roomState);\n    if (userData) {\n      this.sendMessage(userData);\n    }\n  }\n\n  /**\n   * @param {boolean} showAll\n   */\n  getPeerList(showAll) {\n    const peers = this.messageBuilder.getPeerListMessage(showAll);\n    if (peers) {\n      this.sendMessage(peers);\n    }\n  }\n\n  stream(...args) {\n    const stream = this.messageBuilder.getStreamMessage(...args);\n    if (stream) {\n      this.sendMessage(stream);\n    }\n  }\n\n  recording(...args) {\n    const recordingMessage = this.messageBuilder.getRecordingMessage(...args);\n    this.sendMessage(recordingMessage);\n  }\n\n  rtmp(...args) {\n    const rtmpMessage = this.messageBuilder.getRTMPMessage(...args);\n    this.sendMessage(rtmpMessage);\n  }\n\n  muteAudioEvent(roomState, streamIds) {\n    const muteAudio = this.messageBuilder.getMuteAudioMessage(roomState, streamIds);\n    if (muteAudio) {\n      this.sendMessage(muteAudio);\n    }\n  }\n\n  muteVideoEvent(roomState, streamId) {\n    const muteVideo = this.messageBuilder.getMuteVideoMessage(roomState, streamId);\n    if (muteVideo) {\n      this.sendMessage(muteVideo);\n    }\n  }\n\n  roomLock(roomState) {\n    const roomLock = this.messageBuilder.getRoomLockMessage(roomState);\n    if (roomLock) {\n      this.sendMessage(roomLock);\n    }\n  }\n\n  bye(...args) {\n    const byeMessage = this.messageBuilder.getByeMessage(...args);\n    this.sendMessage(byeMessage);\n  }\n\n  mediaInfoEvent(roomState, peerId, mediaInfo) {\n    const mInfo = this.messageBuilder.getMediaInfoEventMessage(roomState, peerId, mediaInfo);\n    if (mInfo) {\n      this.sendMessage(mInfo);\n    }\n  }\n\n  getStoredMessages(roomState) {\n    const history = this.messageBuilder.getGetStoredMessagesMessage(roomState);\n    if (history) {\n      this.sendMessage(history);\n    }\n  }\n\n  onMessage(message) {\n    const roomState = Skylink.getSkylinkState(JSON.parse(message).rid);\n    if (!roomState) {\n      return; // FIXME: to handle multi room when the last peer has left one room and that roomState has been removed but the socket channel is still open as the peer is still in the other room\n    }\n    const { socketSession } = roomState;\n    dispatchEvent(channelMessage({\n      message,\n      socketSession: clone(socketSession),\n    }));\n    processSignalingMessage(this.messageHandler, JSON.parse(message));\n  }\n\n  sendMessage(message) {\n    if (!shouldBufferMessage(message)) {\n      logger.log.INFO(['SIG SERVER', null, message.type, 'sent']);\n      sendChannelMessage(this.socket, message);\n    }\n  }\n\n  sendUserMessage(roomState, config, message) {\n    const peerMessages = this.messageBuilder.getUserMessages(roomState, config, message);\n    if (Array.isArray(peerMessages) && peerMessages.length) {\n      peerMessages.map((peerMessage) => {\n        this.sendMessage(peerMessage);\n        return null;\n      });\n    }\n  }\n\n  updateAttempts(roomKey, key, attempts) {\n    this.attempts = attempts;\n\n    const state = Skylink.getSkylinkState(roomKey);\n    const { socketSession } = state;\n    socketSession.socketSession[key] = attempts;\n\n    Skylink.setSkylinkState(state, roomKey);\n  }\n\n  getAttempts() {\n    return this.attempts;\n  }\n}\n\nexport default SkylinkSignalingServer;\n","import retrieveTransceiverMid from './retrieveTransceiverMid';\nimport retrieveMediaState from './retrieveMediaState';\nimport retrieveMediaId from './retrieveMediaId';\nimport buildPeerMediaInfo from './buildPeerMediaInfo';\nimport retrieveStreamIdOfTrack from './retrieveStreamIdOfTrack';\nimport retrieveTracks from './retrieveTracks';\nimport updatePeerMediaInfo from './updatePeerMediaInfo';\nimport sendMediaInfoMsg from './sendMediaInfoMsg';\nimport parseSDPForTransceiverMid from './parseSDPForTransceiverMid';\nimport retrieveValueGivenTransceiverMid from './retrieveValueGivenTransceiverMid';\nimport retrieveFormattedMediaInfo from './retrieveFormattedMediaInfo';\nimport resetPeerMedia from './resetPeerMedia';\nimport populatePeerMediaInfo from './populatePeerMediaInfo';\nimport processOnRemoveTrack from './processOnRemoveTrack';\n\nconst helpers = {\n  retrieveTransceiverMid,\n  retrieveMediaState,\n  retrieveMediaId,\n  buildPeerMediaInfo,\n  retrieveStreamIdOfTrack,\n  retrieveTracks,\n  updatePeerMediaInfo,\n  sendMediaInfoMsg,\n  parseSDPForTransceiverMid,\n  retrieveValueGivenTransceiverMid,\n  retrieveFormattedMediaInfo,\n  resetPeerMedia,\n  populatePeerMediaInfo,\n  processOnRemoveTrack,\n};\n\nexport default helpers;\n","import SkylinkSignalingServer from '../../server-communication/signaling-server/index';\nimport Skylink from '../../index';\nimport { PEER_TYPE } from '../../constants';\n\nconst sendMediaInfoMsg = (room, updatedMediaInfo) => {\n  const signaling = new SkylinkSignalingServer();\n  const state = Skylink.getSkylinkState(room.id);\n  const { user, hasMCU, peerConnections } = state;\n  const peerIds = hasMCU ? [PEER_TYPE.MCU] : Object.keys(peerConnections).filter(peerId => (peerId !== user.sid) && (peerId !== PEER_TYPE.MCU));\n\n  peerIds.forEach((target) => {\n    signaling.mediaInfoEvent(state, target, updatedMediaInfo);\n  });\n};\n\nexport default sendMediaInfoMsg;\n","import SessionDescription from '../../session-description';\nimport helpers from './index';\nimport { MEDIA_INFO, MEDIA_STATE } from '../../constants';\nimport Skylink from '../../index';\n\nconst parseSDPForTransceiverMid = (room, peerId, sessionDescription) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerMedias } = state;\n  const { beSilentOnParseLogs } = Skylink.getInitOptions();\n  const mediaInfos = Object.values(peerMedias[peerId]);\n  const mediaMids = SessionDescription.getTransceiverMid(sessionDescription, beSilentOnParseLogs);\n  const audioMids = mediaMids.audio;\n  const videoMids = mediaMids.video;\n\n  for (let m = 0; m < mediaInfos.length; m += 1) {\n    const mediaInfo = mediaInfos[m];\n    // If mediaState is unavailable, there is no corresponding transceiverMid in the SDP and mediaInfo.transceiverMid will be 'null'. mediaInfo.transceiverMid cannot be 'null'.\n    mediaInfo.transceiverMid = mediaInfo.mediaState === MEDIA_STATE.UNAVAILABLE ? mediaInfo.transceiverMid : null;\n    for (let a = 0; a < audioMids.length; a += 1) {\n      if (audioMids[a].streamId === mediaInfo.streamId && (audioMids[a].direction === 'sendonly' || audioMids[a].direction === 'sendrecv')) {\n        helpers.updatePeerMediaInfo(room, peerId, false, mediaInfo.mediaId, MEDIA_INFO.TRANSCEIVER_MID, audioMids[a].transceiverMid);\n        break;\n      }\n    }\n\n    for (let v = 0; v < videoMids.length; v += 1) {\n      if (videoMids[v].streamId === mediaInfo.streamId && (videoMids[v].direction === 'sendonly' || videoMids[v].direction === 'sendrecv')) {\n        helpers.updatePeerMediaInfo(room, peerId, false, mediaInfo.mediaId, MEDIA_INFO.TRANSCEIVER_MID, videoMids[v].transceiverMid);\n        break;\n      }\n    }\n  }\n};\n\nexport default parseSDPForTransceiverMid;\n","const retrieveValueGivenTransceiverMid = (state, peerId, transceiverMid, key) => {\n  const { peerMedias } = state;\n  const mediaInfos = Object.values(peerMedias[peerId]);\n  for (let m = 0; m < mediaInfos.length; m += 1) {\n    if (mediaInfos[m].transceiverMid === transceiverMid) {\n      return mediaInfos[m][key];\n    }\n  }\n\n  return null;\n};\n\nexport default retrieveValueGivenTransceiverMid;\n","import clone from 'clone';\nimport Skylink from '../../index';\n\nconst retrieveFormattedMediaInfo = (room, peerId) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { peerMedias } = state;\n  const mediaInfos = Object.values(peerMedias[peerId]);\n  const formattedMediaInfos = [];\n\n  for (let m = 0; m < mediaInfos.length; m += 1) {\n    const mediaInfo = mediaInfos[m];\n    const clonedMediaInfo = clone(mediaInfo);\n    delete clonedMediaInfo.trackId;\n    delete clonedMediaInfo.streamId;\n    formattedMediaInfos.push(clonedMediaInfo);\n  }\n\n  return formattedMediaInfos;\n};\n\nexport default retrieveFormattedMediaInfo;\n","import Skylink from '../../index';\n\nconst resetPeerMedia = (room, peerId) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n  const peerMedia = updatedState.peerMedias[peerId];\n\n  if (peerMedia) {\n    updatedState.peerMedias[peerId] = {};\n  }\n\n  return updatedState;\n};\n\nexport default resetPeerMedia;\n","import { isEmptyObj } from '../../utils/helpers';\n\n// peerMedia will have a previous state if setPeerMediaInfo is called from renegotiation\nconst peerMediaHasPreviousState = (clonedPeerMedia, mediaId) => !isEmptyObj(clonedPeerMedia) && clonedPeerMedia[mediaId];\n\nconst populatePeerMediaInfo = (updatedState, clonedPeerMedia, mediaInfo) => {\n  const peerMedia = updatedState.peerMedias[mediaInfo.publisherId] || {};\n  peerMedia[mediaInfo.mediaId] = mediaInfo;\n\n  if (peerMediaHasPreviousState(clonedPeerMedia, mediaInfo.mediaId)) {\n    peerMedia[mediaInfo.mediaId].streamId = (mediaInfo.transceiverMid === clonedPeerMedia[mediaInfo.mediaId].transceiverMid) ? clonedPeerMedia[mediaInfo.mediaId].streamId : '';\n  }\n\n  return peerMedia;\n};\n\nexport default populatePeerMediaInfo;\n","import {\n  BROWSER_AGENT, MEDIA_TYPE, TAGS, TRACK_KIND,\n} from '../../constants';\nimport PeerConnectionCallbacks from '../../peer-connection/helpers/peer-addition/callbacks';\nimport logger from '../../logger';\nimport MESSAGES from '../../messages';\n\nconst processOnRemoveTrack = (state, peerId, clonedMediaInfo) => {\n  // This method is required because react native android does not have a way for the remote to register onremovetrack event\n  // onremovetrack needs to be caught in the renegotiation when the remote calls stopStreams and sends an offer\n  // the removed track/stream will be set to unavailable\n  // Although react native ios has didRemoveReceiver callback, and onremovetrack can be artificially attached to the peerConnection to process\n  // a stopped stream, the type of stream is not identifiable i.e is screenshare or not.\n  // Therefore react native ios and android will implement the same workaround for now.\n  const { AdapterJS } = window;\n  if (AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.REACT_NATIVE && clonedMediaInfo) {\n    const { room } = state;\n    const trackInfo = {\n      track: {\n        id: null,\n        kind: null,\n      },\n    };\n    const stream = {\n      id: null,\n    };\n    trackInfo.track.id = clonedMediaInfo.trackId;\n    trackInfo.track.kind = (clonedMediaInfo.mediaType === MEDIA_TYPE.AUDIO || clonedMediaInfo.mediaType === MEDIA_TYPE.AUDIO_MIC) ? TRACK_KIND.AUDIO : TRACK_KIND.VIDEO;\n    stream.id = clonedMediaInfo.streamId;\n    trackInfo.stream = stream;\n    if (!(trackInfo.track.id || trackInfo.track.kind || stream.id)) {\n      logger.log.DEBUG([peerId, TAGS.MEDIA_STREAM, null, `${MESSAGES.BROWSER_AGENT.REACT_NATIVE.ERRORS.DROPPING_ONREMOVETRACK}`], trackInfo);\n      return;\n    }\n    PeerConnectionCallbacks.onremovetrack(peerId, room, clonedMediaInfo.mediaType === MEDIA_TYPE.VIDEO_SCREEN, trackInfo);\n  }\n};\n\nexport default processOnRemoveTrack;\n","import clone from 'clone';\nimport Skylink from '../index';\nimport helpers from './helpers/index';\nimport {\n  MEDIA_TYPE, MEDIA_INFO, TAGS, TRACK_KIND, MEDIA_STATE, PEER_TYPE,\n} from '../constants';\nimport logger from '../logger';\nimport MESSAGES from '../messages';\nimport { mediaInfoDeleted } from '../skylink-events';\nimport { dispatchEvent } from '../utils/skylinkEventManager';\nimport { isEmptyArray } from '../utils/helpers';\n\nclass PeerMedia {\n  /**\n   * Method that updates local media info with user sid returned from inRoom message. There is no user.sid information prior to inRoom message.\n   * @param room\n   * @param sid\n   * @private\n   */\n  static updatePeerMediaWithUserSid(room, sid) {\n    const updatedState = Skylink.getSkylinkState(room.id);\n\n    updatedState.peerMedias[sid] = Object.assign({}, updatedState.peerMedias.null);\n    delete updatedState.peerMedias.null;\n    Skylink.setSkylinkState(updatedState, room.id);\n    Object.keys(updatedState.peerMedias[sid]).forEach((mediaId) => {\n      helpers.updatePeerMediaInfo(room, sid, false, mediaId, MEDIA_INFO.PUBLISHER_ID, sid);\n    });\n  }\n\n  /**\n   * Method that updates the stream id of the remote peer in the peer media info\n   * @param room\n   * @param peerId\n   * @param transceiverMid\n   * @param streamId\n   */\n  static updateStreamIdFromOntrack(room, peerId, transceiverMid, streamId) {\n    const state = Skylink.getSkylinkState(room.id);\n    const mediaId = helpers.retrieveValueGivenTransceiverMid(state, peerId, transceiverMid, MEDIA_INFO.MEDIA_ID);\n    helpers.updatePeerMediaInfo(room, peerId, false, mediaId, MEDIA_INFO.STREAM_ID, streamId);\n  }\n\n  /**\n   * Method that checks if a transceiver mid corresponds to a screen stream\n   * @param state\n   * @param peerId\n   * @param transceiverMid\n   * @returns {boolean}\n   */\n  static isVideoScreenTrack(state, peerId, transceiverMid) {\n    const { peerMedias } = state;\n    const mediaInfos = Object.values(peerMedias[peerId]);\n\n    for (let m = 0; m < mediaInfos.length; m += 1) {\n      if (mediaInfos[m].transceiverMid === transceiverMid) {\n        return mediaInfos[m].mediaType === MEDIA_TYPE.VIDEO_SCREEN;\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Method that updates the peer media info state to unavailable.\n   * @param room\n   * @param peerId\n   * @param mediaId\n   */\n  static setMediaStateToUnavailable(room, peerId, mediaId) {\n    helpers.updatePeerMediaInfo(room, peerId, false, mediaId, MEDIA_INFO.MEDIA_STATE, MEDIA_STATE.UNAVAILABLE);\n  }\n\n  /**\n   * Method that removes mediaInfo that has mediaState set to unavailable.\n   * @param {SkylinkRoom} room\n   * @param {String} peerId\n   * @param {String|null} mediaId\n   */\n  static deleteUnavailableMedia(room, peerId, mediaId = null) {\n    const updatedState = Skylink.getSkylinkState(room.id);\n\n    if (peerId === PEER_TYPE.MCU || !updatedState.peerMedias[peerId]) {\n      return;\n    }\n\n    let clonedMediaInfo;\n    if (!mediaId) {\n      const mediaInfos = updatedState.peerMedias[peerId];\n      Object.values(mediaInfos).forEach((mInfo) => {\n        if (mInfo.mediaState === MEDIA_STATE.UNAVAILABLE) {\n          clonedMediaInfo = clone(mInfo);\n          delete updatedState.peerMedias[peerId][mInfo.mediaId];\n        }\n      });\n    } else {\n      clonedMediaInfo = clone(updatedState.peerMedias[peerId][mediaId]);\n      delete updatedState.peerMedias[peerId][mediaId];\n    }\n\n    Skylink.setSkylinkState(updatedState, room.id);\n\n    helpers.processOnRemoveTrack(updatedState, peerId, clonedMediaInfo);\n\n    if (clonedMediaInfo) {\n      dispatchEvent(mediaInfoDeleted({\n        mediaInfo: clonedMediaInfo,\n      }));\n    }\n  }\n\n  /**\n   * Method that updates the peer media info.\n   * @param room\n   * @param peerId\n   * @param mediaId\n   * @param key\n   * @param value\n   * @private\n   */\n  static updatePeerMediaInfo(room, peerId, mediaId, key, value) {\n    helpers.updatePeerMediaInfo(room, peerId, true, mediaId, key, value);\n  }\n\n  /**\n   * Method that updates the transceiver mid value of local media info after set local description.\n   * // TODO: remove as it is no longer called\n   * @param room\n   * @param peerId\n   * @private\n   */\n  static updateTransceiverMid(room, peerId) {\n    try {\n      const tracks = helpers.retrieveTracks(room);\n      tracks.forEach((track) => {\n        const transceiverMid = helpers.retrieveTransceiverMid(room, track);\n        const streamId = helpers.retrieveStreamIdOfTrack(room, track);\n        const mediaId = helpers.retrieveMediaId(track.kind, streamId);\n        helpers.updatePeerMediaInfo(room, peerId, false, mediaId, MEDIA_INFO.TRANSCEIVER_MID, transceiverMid);\n      });\n    } catch (err) {\n      logger.log.ERROR([peerId, TAGS.PEER_MEDIA, null, MESSAGES.MEDIA_INFO.ERRORS.FAILED_UPDATING_TRANSCEIVER_MID], err);\n    }\n  }\n\n  /**\n   * Method that sets the remote peer media info from the offer.\n   * @param room\n   * @param targetMid\n   * @param mediaInfoList\n   */\n  static setPeerMediaInfo(room, targetMid, mediaInfoList = []) {\n    try {\n      const state = Skylink.getSkylinkState(room.id);\n\n      if (targetMid === PEER_TYPE.MCU && !isEmptyArray(mediaInfoList)) { // targetMid needs to be obtained from\n        // mediaInfoList\n        const targetPeerIds = [];\n        mediaInfoList.forEach((mediaInfo) => {\n          if (targetPeerIds.indexOf(mediaInfo.publisherId) === -1) {\n            targetPeerIds.push(mediaInfo.publisherId);\n          }\n        });\n        targetPeerIds.forEach(peerId => this.setPeerMediaInfo(room, peerId, mediaInfoList));\n      } else if (targetMid !== PEER_TYPE.MCU) {\n        const clonedPeerMedia = clone(state.peerMedias[targetMid]) || {};\n        const updatedState = helpers.resetPeerMedia(room, targetMid);\n        mediaInfoList.forEach((mediaInfo) => {\n          updatedState.peerMedias[mediaInfo.publisherId] = helpers.populatePeerMediaInfo(updatedState, clonedPeerMedia, mediaInfo);\n        });\n        Skylink.setSkylinkState(updatedState, room.id);\n      }\n    } catch (err) {\n      logger.log.ERROR([targetMid, TAGS.PEER_MEDIA, null, MESSAGES.MEDIA_INFO.ERRORS.FAILED_SETTING_PEER_MEDIA_INFO]);\n    }\n  }\n\n  /**\n   * Method that returns the streamId from the peer media info.\n   * @param room\n   * @param peerId\n   * @param mediaId\n   * @param transceiverMid\n   * @returns {String} streamId\n   */\n  static retrieveStreamId(room, peerId, mediaId, transceiverMid) {\n    const state = Skylink.getSkylinkState(room.id);\n    const { peerMedias } = state;\n    const mediaInfo = peerMedias[peerId][mediaId];\n    const streamId = mediaInfo.transceiverMid === transceiverMid ? mediaInfo.streamId : null;\n\n    if (!streamId) {\n      logger.log.ERROR([peerId, TAGS.PEER_MEDIA, null, MESSAGES.MEDIA_INFO.ERRORS.NO_ASSOCIATED_STREAM_ID]);\n    }\n\n    return streamId;\n  }\n\n  /**\n   * Method that returns the mediaId\n   * @param trackKind\n   * @param streamId\n   * @returns {String} mediaId\n   */\n  static retrieveMediaId(trackKind, streamId) {\n    return helpers.retrieveMediaId(trackKind, streamId);\n  }\n\n  /**\n   * Method that returns the local media info format for offer and answer message.\n   * @param room\n   * @param peerId\n   * @param sessionDescription\n   * @returns {object} mediaInfo\n   * @private\n   */\n  static retrieveMediaInfoForOfferAnswer(room, sessionDescription) {\n    const state = Skylink.getSkylinkState(room.id);\n    const peerId = state.user.sid;\n\n    helpers.parseSDPForTransceiverMid(room, peerId, sessionDescription);\n    return helpers.retrieveFormattedMediaInfo(room, peerId);\n  }\n\n  /**\n   * Method that processes the peer media and adds it to the state after successfully obtaining the stream from getUserMedia. MediaInfoEvent is not dispatched.\n   * @param room\n   * @param peerId\n   * @param stream\n   * @param isScreensharing\n   * @param dispatchEvt - The flag if the update should dispatch mediaInfoEvent signaling message.\n   * @private\n   */\n  static processPeerMedia(room, peerId, stream, isScreensharing, dispatchEvt = false) {\n    const updatedState = Skylink.getSkylinkState(room.id);\n    const peerMedia = updatedState.peerMedias[peerId] || {};\n    const tracks = stream.getTracks();\n    let mediaId = null;\n\n    try {\n      tracks.forEach((track) => {\n        mediaId = helpers.retrieveMediaId(track.kind, stream.id);\n        // eslint-disable-next-line no-nested-ternary\n        peerMedia[mediaId] = helpers.buildPeerMediaInfo(room, peerId, track, stream.id, track.kind === TRACK_KIND.AUDIO ? MEDIA_TYPE.AUDIO_MIC : (isScreensharing ? MEDIA_TYPE.VIDEO_SCREEN : MEDIA_TYPE.VIDEO_CAMERA));\n        helpers.updatePeerMediaInfo(room, peerId, dispatchEvt, mediaId, null, null, peerMedia[mediaId]);\n      });\n    } catch (err) {\n      logger.log.ERROR([peerId, TAGS.MEDIA_INFO, MESSAGES.MEDIA_INFO.ERRORS.FAILED_PROCESSING_PEER_MEDIA], err);\n    }\n  }\n}\n\nexport default PeerMedia;\n","/* eslint-disable no-nested-ternary */\nimport logger from '../../logger';\nimport MESSAGES from '../../messages';\nimport {\n  isABoolean, isANumber, isAObj, hasAudioTrack, hasVideoTrack, isEmptyArray,\n} from '../../utils/helpers';\nimport SkylinkSignalingServer from '../../server-communication/signaling-server/index';\nimport { localMediaMuted, peerUpdated, streamMuted } from '../../skylink-events';\nimport { dispatchEvent, addEventListener, removeEventListener } from '../../utils/skylinkEventManager';\nimport PeerData from '../../peer-data/index';\nimport Skylink from '../../index';\nimport {\n  MEDIA_STATUS, MEDIA_INFO, MEDIA_STATE, TRACK_KIND, EVENTS, HANDSHAKE_PROGRESS, PEER_TYPE,\n} from '../../constants';\nimport PeerMedia from '../../peer-media/index';\n\nconst dispatchStreamMutedEvent = (room, stream, isScreensharing) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  dispatchEvent(streamMuted({\n    isSelf: true,\n    peerId: roomState.user.sid,\n    peerInfo: PeerData.getUserInfo(room),\n    streamId: stream.id,\n    isScreensharing,\n    isAudio: hasAudioTrack(stream),\n    isVideo: hasVideoTrack(stream),\n  }));\n};\n\nconst dispatchPeerUpdatedEvent = (room) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const isSelf = true;\n  const peerId = roomState.user.sid;\n  const peerInfo = PeerData.getCurrentSessionInfo(room);\n\n  dispatchEvent(peerUpdated({\n    isSelf,\n    peerId,\n    peerInfo,\n  }));\n};\n\nconst getAudioTracks = stream => stream.getAudioTracks();\n\nconst getVideoTracks = stream => stream.getVideoTracks();\n\nconst dispatchLocalMediaMutedEvent = (hasToggledVideo, hasToggledAudio, stream, roomKey, isScreensharing = false) => {\n  const state = Skylink.getSkylinkState(roomKey);\n\n  if ((hasVideoTrack(stream) && hasToggledVideo) || (hasAudioTrack(stream) && hasToggledAudio)) {\n    dispatchEvent(localMediaMuted({\n      streamId: stream.id,\n      isScreensharing,\n      mediaStatus: state.streamsMediaStatus[stream.id],\n    }));\n  }\n\n  return true;\n};\n\nconst retrieveOriginalActiveStreamId = (roomState, currentActiveStreamId, replacedStreamIds) => {\n  let originalActiveStreamId = currentActiveStreamId;\n  const { streams: { userMedia } } = roomState;\n  const pReplacedStreamIds = replacedStreamIds || Object.keys(userMedia).filter(streamId => userMedia[streamId].isReplaced);\n\n  if (pReplacedStreamIds.length === 0) {\n    return originalActiveStreamId;\n  }\n\n  if (pReplacedStreamIds.indexOf(originalActiveStreamId) > -1) {\n    pReplacedStreamIds.splice(pReplacedStreamIds.indexOf(originalActiveStreamId), 1);\n  }\n\n  if (pReplacedStreamIds.length > 1) {\n    for (let i = 0; i < pReplacedStreamIds.length; i += 1) {\n      if (userMedia[pReplacedStreamIds[i]].newStream && userMedia[pReplacedStreamIds[i]].newStream.id === originalActiveStreamId) {\n        originalActiveStreamId = pReplacedStreamIds[i];\n        retrieveOriginalActiveStreamId(roomState, originalActiveStreamId, pReplacedStreamIds);\n        break;\n      }\n    }\n  }\n\n  return pReplacedStreamIds[0];\n};\n\nconst updateMediaInfo = (hasToggledVideo, hasToggledAudio, room, streamId) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const originalStreamId = retrieveOriginalActiveStreamId(roomState, streamId);\n  const { streamsMutedSettings } = roomState;\n\n  if (hasToggledVideo) {\n    const mediaId = PeerMedia.retrieveMediaId(TRACK_KIND.VIDEO, originalStreamId);\n    PeerMedia.updatePeerMediaInfo(room, roomState.user.sid, mediaId, MEDIA_INFO.MEDIA_STATE, streamsMutedSettings[originalStreamId].videoMuted ? MEDIA_STATE.MUTED : MEDIA_STATE.ACTIVE);\n  }\n\n  if (hasToggledAudio) {\n    const mediaId = PeerMedia.retrieveMediaId(TRACK_KIND.AUDIO, originalStreamId);\n    setTimeout(() => PeerMedia.updatePeerMediaInfo(room, roomState.user.sid, mediaId, MEDIA_INFO.MEDIA_STATE, streamsMutedSettings[originalStreamId].audioMuted ? MEDIA_STATE.MUTED : MEDIA_STATE.ACTIVE), hasToggledVideo ? 1050 : 0);\n  }\n};\n\n// eslint-disable-next-line no-unused-vars\nconst sendSigMsgs = (hasToggledVideo, hasToggledAudio, room, streamId) => {\n  const roomState = Skylink.getSkylinkState(room.id);\n  const signaling = new SkylinkSignalingServer();\n  const originalStreamId = retrieveOriginalActiveStreamId(roomState, streamId);\n\n  if (hasToggledVideo) {\n    signaling.muteVideoEvent(room, originalStreamId);\n  }\n\n  if (hasToggledAudio) {\n    setTimeout(() => signaling.muteAudioEvent(room, originalStreamId), hasToggledVideo ? 1050 : 0);\n  }\n};\n\nconst muteFn = (stream, state) => {\n  const updatedState = state;\n  const { room } = updatedState;\n  const audioTracks = getAudioTracks(stream);\n  const videoTracks = getVideoTracks(stream);\n  updatedState.streamsMediaStatus[stream.id].audioMuted = MEDIA_STATUS.UNAVAILABLE;\n  updatedState.streamsMediaStatus[stream.id].videoMuted = MEDIA_STATUS.UNAVAILABLE;\n\n  audioTracks.forEach((audioTrack) => {\n    // eslint-disable-next-line no-param-reassign\n    audioTrack.enabled = !updatedState.streamsMutedSettings[stream.id].audioMuted;\n    updatedState.streamsMediaStatus[stream.id].audioMuted = updatedState.streamsMutedSettings[stream.id].audioMuted ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE;\n  });\n\n  videoTracks.forEach((videoTrack) => {\n    // eslint-disable-next-line no-param-reassign\n    videoTrack.enabled = !updatedState.streamsMutedSettings[stream.id].videoMuted;\n    updatedState.streamsMediaStatus[stream.id].videoMuted = updatedState.streamsMutedSettings[stream.id].videoMuted ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE;\n  });\n\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  logger.log.DEBUG(MESSAGES.MEDIA_STREAM.UPDATE_MEDIA_STATUS, updatedState.streamsMediaStatus, stream.id);\n};\n\nconst retrieveToggleState = (state, options, streamId) => {\n  const { streams, streamsMutedSettings } = state;\n  let hasToggledAudio = false;\n  let hasToggledVideo = false;\n\n  if (streams.screenshare && streams.screenshare.id === streamId && streamsMutedSettings[streamId].videoMuted !== options.videoMuted) {\n    hasToggledVideo = true;\n  } else if (streams.userMedia && streams.userMedia[streamId]) {\n    if (hasAudioTrack(streams.userMedia[streamId].stream) && streamsMutedSettings[streamId].audioMuted !== options.audioMuted) {\n      hasToggledAudio = true;\n    }\n\n    if (hasVideoTrack(streams.userMedia[streamId].stream) && streamsMutedSettings[streamId].videoMuted !== options.videoMuted) {\n      hasToggledVideo = true;\n    }\n  }\n\n  return {\n    hasToggledAudio,\n    hasToggledVideo,\n  };\n};\n\nconst updateStreamsMutedSettings = (state, toggleState, streamId) => {\n  const updatedState = state;\n  const { room } = updatedState;\n\n  if (toggleState.hasToggledAudio) {\n    updatedState.streamsMutedSettings[streamId].audioMuted = !updatedState.streamsMutedSettings[streamId].audioMuted;\n  }\n\n  if (toggleState.hasToggledVideo) {\n    updatedState.streamsMutedSettings[streamId].videoMuted = !updatedState.streamsMutedSettings[streamId].videoMuted;\n  }\n\n  logger.log.DEBUG(MESSAGES.MEDIA_STREAM.UPDATE_MUTED_SETTINGS, updatedState.streamsMutedSettings, streamId);\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nconst startMuteEvents = (roomKey, streamId, options) => {\n  const roomState = Skylink.getSkylinkState(roomKey);\n  const {\n    streams, room, peerConnections, peerInformations,\n  } = roomState;\n  const toggleState = retrieveToggleState(roomState, options, streamId);\n  const { hasToggledAudio, hasToggledVideo } = toggleState;\n  let mutedStream = null;\n  let isScreensharing = false;\n\n  if (streams.userMedia && streams.userMedia[streamId]) {\n    mutedStream = streams.userMedia[streamId].stream;\n  } else if (streams.screenshare && streams.screenshare.id === streamId) {\n    mutedStream = streams.screenshare.stream;\n    isScreensharing = true;\n  }\n\n  if (!mutedStream) {\n    return;\n  }\n\n  updateStreamsMutedSettings(roomState, toggleState, streamId);\n  muteFn(mutedStream, roomState);\n  dispatchLocalMediaMutedEvent(hasToggledVideo, hasToggledAudio, mutedStream, room.id, isScreensharing);\n  dispatchPeerUpdatedEvent(room);\n  dispatchStreamMutedEvent(room, mutedStream, isScreensharing);\n  // TODO: remove audioMuteEvent and videoMuteEvent\n  // sendSigMsgs(hasToggledVideo, hasToggledAudio, room, streamId);\n\n  // wait for at least 1 connection before sending mediaInfoEvent otherwise sig message will be dropped at sendMediaInfoMsg if there are no\n  // connections\n  if ((!peerConnections[PEER_TYPE.MCU] && isEmptyArray(Object.keys(peerConnections))) || (peerConnections[PEER_TYPE.MCU] && isEmptyArray(Object.keys(peerInformations)))) { // no P2P peers || no MCU peers\n    const updateMediaInfoAndRemoveListener = (evt) => {\n      const { state } = evt.detail;\n      if (state === HANDSHAKE_PROGRESS.ANSWER_ACK) {\n        updateMediaInfo(hasToggledVideo, hasToggledAudio, room, streamId);\n        removeEventListener(EVENTS.HANDSHAKE_PROGRESS, updateMediaInfoAndRemoveListener);\n      }\n    };\n\n    addEventListener(EVENTS.HANDSHAKE_PROGRESS, updateMediaInfoAndRemoveListener);\n  } else {\n    // Workaround for sendStream with mute option and existing peerConnections throwing \"no streamId\" error message:\n    // delay sending the mediaInfoEvent sig message to ensure that ontrack on the remote is fired and the streamId is populated in mediaInfo\n    // before mediaInfoEvent is received\n    setTimeout(() => {\n      updateMediaInfo(hasToggledVideo, hasToggledAudio, room, streamId);\n    }, 500);\n  }\n};\n\nconst retrieveMutedSetting = (mediaMutedOption) => {\n  switch (mediaMutedOption) {\n    case 1:\n      return false;\n    case 0:\n      return true;\n    default:\n      return true;\n  }\n};\n\nconst isValidStreamId = (streamId, state) => {\n  const { streams } = state;\n  let isValid = false;\n\n  Object.keys(streams.userMedia).forEach((gumStreamId) => {\n    if (gumStreamId === streamId) {\n      isValid = true;\n    }\n  });\n\n  if (streams.screenshare && streams.screenshare.id === streamId) {\n    isValid = true;\n  }\n\n  return isValid;\n};\n\n/**\n * @param {SkylinkState} roomState\n * @param {boolean} options\n * @param {boolean} options.audioMuted\n * @param {boolean} options.videoMuted\n * @param {String} streamId\n * @memberOf MediaStreamHelpers\n * @fires streamMuted, peerUpdated, localMediaMuted\n */\nconst muteStreams = (roomState, options, streamId = null) => {\n  const {\n    streams, room,\n  } = roomState;\n\n  if (!isAObj(options)) {\n    logger.log.ERROR(MESSAGES.MEDIA_STREAM.ERRORS.INVALID_MUTE_OPTIONS, options);\n    return;\n  }\n\n  if (!streams.userMedia && !streams.screenshare) {\n    logger.log.WARN(MESSAGES.MEDIA_STREAM.ERRORS.NO_STREAM);\n    return;\n  }\n\n  if (streamId && !isValidStreamId(streamId, roomState)) {\n    logger.log.ERROR(MESSAGES.MEDIA_STREAM.ERRORS.INVALID_MUTE_OPTIONS, options);\n    return;\n  }\n\n  const fOptions = {\n    audioMuted: isABoolean(options.audioMuted) ? options.audioMuted : (isANumber(options.audioMuted) ? retrieveMutedSetting(options.audioMuted) : true),\n    videoMuted: isABoolean(options.videoMuted) ? options.videoMuted : (isANumber(options.videoMuted) ? retrieveMutedSetting(options.videoMuted) : true),\n  };\n\n  let streamIdsThatCanBeMuted = [];\n  if (streamId && ((streams.userMedia[streamId] && !streams.userMedia[streamId].isReplaced) || (streams.screenshare.id === streamId && !streams.screenshare.isReplaced))) {\n    streamIdsThatCanBeMuted.push(streamId);\n  } else {\n    streamIdsThatCanBeMuted = Object.keys(streams.userMedia).filter(id => !streams.userMedia[id].isReplaced);\n    if (streams.screenshare && !streams.screenshare.isReplaced) {\n      streamIdsThatCanBeMuted.push(streams.screenshare.id);\n    }\n  }\n\n  if (isEmptyArray(streamIdsThatCanBeMuted)) {\n    logger.log.ERROR(MESSAGES.MEDIA_STREAM.ERRORS.NO_STREAMS_MUTED, options);\n    return;\n  }\n\n  const streamIdsToMute = Object.values(streamIdsThatCanBeMuted).filter(sId => (retrieveToggleState(roomState, fOptions, sId).hasToggledAudio || retrieveToggleState(roomState, fOptions, sId).hasToggledVideo));\n\n  streamIdsToMute.forEach((streamIdToMute, i) => {\n    setTimeout(() => startMuteEvents(room.id, streamIdToMute, fOptions), i === 0 ? 0 : 1050);\n    // TODO: Implement peerUpdatedEvent timeout here?\n  });\n};\n\nexport default muteStreams;\n","import Skylink from '../../index';\nimport { isEmptyArray } from '../../utils/helpers';\nimport helpers from '../../peer-connection/helpers/index';\n\nconst isSenderTrackAndTrackMatched = (senderTrack, tracks) => {\n  for (let x = 0; x < tracks.length; x += 1) {\n    if (senderTrack.id === tracks[x].id) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nconst isStreamOnPC = (peerConnection, stream) => {\n  const transceivers = peerConnection.getTransceivers ? peerConnection.getTransceivers() : [];\n  const tracks = stream.getTracks();\n\n  if (isEmptyArray(transceivers)) {\n    return false;\n  }\n\n  for (let i = 0; i < transceivers.length; i += 1) {\n    if (transceivers[i].sender.track && isSenderTrackAndTrackMatched(transceivers[i].sender.track, tracks)) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nconst addTracksToPC = (state, peerId, stream, peerConnection) => {\n  const updatedState = state;\n  const tracks = stream.getTracks();\n  for (let track = 0; track < tracks.length; track += 1) {\n    const sender = peerConnection.addTrack(tracks[track], stream);\n    if (sender) {\n      helpers.processNewSender(updatedState, peerId, sender);\n    }\n  }\n\n  Skylink.setSkylinkState(updatedState, updatedState.room.id);\n};\n\nconst addUserMediaStreams = (state, peerId, userMediaStreams, peerConnection) => {\n  const streamIds = Object.keys(userMediaStreams);\n  for (let x = 0; x < streamIds.length; x += 1) {\n    const { stream } = userMediaStreams[streamIds[x]];\n    if (!isStreamOnPC(peerConnection, stream)) {\n      addTracksToPC(state, peerId, stream, peerConnection);\n    }\n  }\n};\n\nconst addScreenshareStream = (state, peerId, screenshareStream, peerConnection) => {\n  const { stream } = screenshareStream;\n  if (!isStreamOnPC(peerConnection, stream)) {\n    addTracksToPC(state, peerId, stream, peerConnection);\n  }\n};\n\n/**\n * Function that sets User's Stream to send to Peer connection.\n * Priority for <code>shareScreen()</code> Stream over <code>{@link MediaStream.getUserMedia}</code> Stream.\n * @param {String} targetMid - The mid of the target peer\n * @param {SkylinkState} roomState - Skylink State of current room\n * @memberOf MediaStreamHelpers\n * @private\n */\nconst addLocalMediaStreams = (targetMid, roomState) => {\n  // TODO: Full implementation (cross-browser) not done. Refer to stream-media.js for checks on AJS\n  const state = Skylink.getSkylinkState(roomState.room.id);\n  const { peerConnections, streams } = state;\n  const peerConnection = peerConnections[targetMid];\n\n  if (streams.userMedia) {\n    addUserMediaStreams(state, targetMid, streams.userMedia, peerConnection);\n  }\n\n  if (streams.screenshare) {\n    addScreenshareStream(state, targetMid, streams.screenshare, peerConnection);\n  }\n};\n\nexport default addLocalMediaStreams;\n","import logger from '../../logger';\nimport MESSAGES from '../../messages';\nimport { TAGS } from '../../constants';\n\nconst getTrackSender = (state, peerId, trackId, mediaType) => {\n  const { peerConnections } = state;\n  const senders = peerConnections[peerId].getSenders();\n  let trackSender = null;\n\n  if (!trackId) {\n    return trackSender;\n  }\n  senders.forEach((sender) => {\n    if (sender.track && (sender.track.id === trackId) && (sender.track.kind === mediaType)) {\n      trackSender = sender;\n    }\n  });\n\n  return trackSender;\n};\n\n/**\n * Function that replaces a track screensharing track.\n * @param {MediaStream} oldStream - The stream to be replaced with newStream\n * @param {MediaStream} newStream - The new stream\n * @param {String} peerId - The PeerId\n * @param {SkylinkState} state\n * @private\n */\nconst replaceTrack = (oldStream, newStream, peerId, state) => {\n  const oldVideoTrack = oldStream.getVideoTracks()[0];\n  const oldAudioTrack = oldStream.getAudioTracks()[0];\n  const videoSender = getTrackSender(state, peerId, oldVideoTrack ? oldVideoTrack.id : null, 'video');\n  const audioSender = getTrackSender(state, peerId, oldAudioTrack ? oldAudioTrack.id : null, 'audio');\n  const newVideoTrack = newStream.getVideoTracks()[0];\n  const newAudioTrack = newStream.getAudioTracks()[0];\n\n  try {\n    if (oldVideoTrack && newVideoTrack && videoSender) {\n      videoSender.replaceTrack(newVideoTrack);\n    }\n\n    if (oldAudioTrack && newAudioTrack && audioSender) {\n      audioSender.replaceTrack(newAudioTrack);\n    }\n  } catch (error) {\n    logger.log.ERROR([peerId, TAGS.PEER_CONNECTION, null, MESSAGES.PEER_CONNECTION.ERRORS.REPLACE_TRACK], error);\n  }\n};\n\nexport default replaceTrack;\n","import {\n  isAObj, isAFunction, hasVideoTrack, hasAudioTrack,\n} from '../../utils/helpers';\nimport logger from '../../logger';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport PeerData from '../../peer-data';\nimport { peerUpdated, onIncomingStream } from '../../skylink-events';\nimport PeerConnection from '../../peer-connection/index';\nimport MediaStream from '../index';\nimport MESSAGES from '../../messages';\n\nconst dispatchEvents = (roomState, stream) => {\n  const { user, room } = roomState;\n  const isSelf = true;\n  const peerId = user.sid;\n  const peerInfo = PeerData.getCurrentSessionInfo(room);\n\n  dispatchEvent(onIncomingStream({\n    room,\n    stream,\n    streamId: stream.id,\n    isSelf,\n    peerId,\n    peerInfo,\n    isScreensharing: false,\n    isVideo: hasVideoTrack(stream),\n    isAudio: hasAudioTrack(stream),\n  }));\n\n  dispatchEvent(peerUpdated({\n    isSelf,\n    peerId,\n    peerInfo,\n  }));\n};\n\nconst dispatchEventsToLocalEnd = (roomState, streams) => {\n  for (let i = 0; i < streams.length; i += 1) {\n    if (streams[i]) {\n      if (Array.isArray(streams[i])) {\n        for (let x = 0; x < streams[i].length; x += 1) {\n          if (streams[i][x]) {\n            dispatchEvents(roomState, streams[i][x]);\n          }\n        }\n      } else {\n        dispatchEvents(roomState, streams[i]);\n      }\n    }\n  }\n};\n\nconst restartFn = (roomState, streams, resolve, reject) => {\n  const { AdapterJS } = window;\n  const { peerConnections, hasMCU } = roomState;\n\n  if (AdapterJS.webrtcDetectedBrowser === 'edge') {\n    reject(new Error(MESSAGES.PEER_CONNECTION.refresh_no_edge_support));\n  }\n\n  try {\n    dispatchEventsToLocalEnd(roomState, streams);\n\n    if (Object.keys(peerConnections).length > 0 || hasMCU) {\n      const refreshPeerConnectionPromise = PeerConnection.refreshPeerConnection(Object.keys(peerConnections), roomState, false, {});\n\n      refreshPeerConnectionPromise.then(() => {\n        resolve(streams);\n      }).catch((error) => {\n        logger.log.ERROR(MESSAGES.PEER_CONNECTION.ERRORS.REFRESH);\n        reject(error);\n      });\n    } else {\n      logger.log.WARN(MESSAGES.ROOM.ERRORS.NO_PEERS);\n      resolve(streams);\n    }\n  } catch (error) {\n    logger.log.ERROR(error);\n  }\n};\n\nconst processMediaOptions = (roomState, stream, resolve, reject) => {\n  const getUserMediaPromise = MediaStream.getUserMedia(roomState, stream);\n\n  return getUserMediaPromise.then((userMediaStreams) => {\n    restartFn(roomState, userMediaStreams, resolve, reject);\n  }).catch((error) => {\n    reject(error);\n  });\n};\n\nconst processMediaStream = (roomState, stream, resolve, reject) => {\n  const usePrefetchedStreamPromise = MediaStream.usePrefetchedStream(roomState.room.id, stream);\n\n  return usePrefetchedStreamPromise.then((prefetchedStreams) => {\n    restartFn(roomState, prefetchedStreams, resolve, reject);\n  }).catch((error) => {\n    reject(error);\n  });\n};\n\nconst processMediaStreamArray = (roomState, streams, resolve, reject) => {\n  const usePrefetchedStreamsPromises = [];\n\n  streams.forEach((stream) => {\n    usePrefetchedStreamsPromises.push(MediaStream.usePrefetchedStream(roomState.room.id, stream));\n  });\n\n  return Promise.all(usePrefetchedStreamsPromises)\n    .then((results) => {\n      restartFn(roomState, results, resolve, reject);\n    })\n    .catch((error) => {\n      reject(error);\n    });\n};\n\n/**\n * Function that sends a MediaStream if provided or gets and sends an new getUserMedia stream.\n * @param {SkylinkState} roomState\n * @param {MediaStream|Object} options\n * @memberOf MediaStreamHelpers\n * @fires onIncomingStream, peerUpdated\n */\n// eslint-disable-next-line consistent-return\nconst sendStream = (roomState, options = null) => new Promise((resolve, reject) => {\n  if (!roomState) {\n    return reject(new Error(MESSAGES.ROOM_STATE.NO_ROOM_NAME));\n  }\n\n  const { inRoom } = roomState;\n  const { AdapterJS } = window;\n  const isNotObjOrNullOrPlugin = (!isAObj(options) || options === null) && !(AdapterJS && AdapterJS.WebRTCPlugin && AdapterJS.WebRTCPlugin.plugin);\n\n  if (!inRoom) {\n    logger.log.WARN(MESSAGES.ROOM.ERRORS.NOT_IN_ROOM);\n    return reject(new Error(`${MESSAGES.ROOM.ERRORS.NOT_IN_ROOM}`));\n  }\n\n  if (isNotObjOrNullOrPlugin) {\n    return reject(new Error(`${MESSAGES.MEDIA_STREAM.ERRORS.INVALID_GUM_OPTIONS} ${options}`));\n  }\n\n  let isTypeStream = false;\n\n  try {\n    if (Array.isArray(options)) {\n      let isArrayOfTypeStream = true;\n      options.forEach((item) => {\n        if (!isAFunction(item.getAudioTracks) || !isAFunction(item.getVideoTracks)) {\n          isArrayOfTypeStream = false;\n        }\n      });\n\n      if (!isArrayOfTypeStream) {\n        return reject(new Error(MESSAGES.MEDIA_STREAM.ERRORS.INVALID_MEDIA_STREAM_ARRAY));\n      }\n\n      return processMediaStreamArray(roomState, options, resolve, reject);\n    }\n\n    isTypeStream = options ? (isAFunction(options.getAudioTracks) || isAFunction(options.getVideoTracks)) : false;\n    if (isTypeStream) {\n      return processMediaStream(roomState, options, resolve, reject);\n    }\n\n    return processMediaOptions(roomState, options, resolve, reject);\n  } catch (error) {\n    logger.log.ERROR(MESSAGES.MEDIA_STREAM.ERRORS.SEND_STREAM, error);\n  }\n});\n\nexport default sendStream;\n","import { isAFunction } from '../../utils/helpers';\n\nconst getOutputSources = (sources) => {\n  const outputSources = {\n    audio: {\n      input: [],\n      output: [],\n    },\n    video: {\n      input: [],\n    },\n  };\n\n  sources.forEach((sourceItem) => {\n    const item = {\n      deviceId: sourceItem.deviceId || sourceItem.sourceId || 'default',\n      label: sourceItem.label,\n      groupId: sourceItem.groupId || null,\n    };\n\n    item.label = item.label || `Source for ${item.deviceId}`;\n\n    if (['audio', 'audioinput'].indexOf(sourceItem.kind) > -1) {\n      outputSources.audio.input.push(item);\n    } else if (['video', 'videoinput'].indexOf(sourceItem.kind) > -1) {\n      outputSources.video.input.push(item);\n    } else if (sourceItem.kind === 'audiooutput') {\n      outputSources.audio.output.push(item);\n    }\n  });\n\n  return outputSources;\n};\n\n/**\n * Function that returns the camera and microphone sources.\n * @return {Promise}\n * @return {Object} outputSources\n * @return {Object} outputSources.audio The list of audio input (microphone) and output (speakers) sources.\n * @return {Array} outputSources.audio.input The list of audio input (microphone) sources.\n * @return {Object} outputSources.audio.input.#index The audio input source item.\n * @return {String} outputSources.audio.input.#index.deviceId The audio input source item device ID.\n * @return {String} outputSources.audio.input.#index.label The audio input source item device label name.\n * @return {String} [outputSources.audio.input.#index.groupId] The audio input source item device physical device ID.\n * <small>Note that there can be different <code>deviceId</code> due to differing sources but can share a\n * <code>groupId</code> because it's the same device.</small>\n * @return {Array} outputSources.audio.output The list of audio output (speakers) sources.\n * @return {Object} outputSources.audio.output.#index The audio output source item.\n * <small>Object signature matches <code>outputSources.audio.input.#index</code> format.</small>\n * @return {Object} outputSources.video The list of video input (camera) sources.\n * @return {Array} outputSources.video.input The list of video input (camera) sources.\n * @return {Object} outputSources.video.input.#index The video input source item.\n * <small>Object signature matches <code>callback.success.audio.input.#index</code> format.</small>\n * @memberOf MediaStreamHelpers\n */\nconst getStreamSources = () => {\n  const { navigator } = window;\n\n  return new Promise((resolve, reject) => {\n    if (navigator.mediaDevices && isAFunction(navigator.mediaDevices.enumerateDevices)) {\n      navigator.mediaDevices.enumerateDevices()\n        .then((devices) => {\n          resolve(getOutputSources(devices));\n        });\n    } else {\n      reject(getOutputSources([]));\n    }\n  });\n};\n\nexport default getStreamSources;\n","import Skylink from '../../index';\nimport helpers from './index';\n\nconst buildStreamObject = (room, user, stream, settings) => ({\n  id: stream.id,\n  stream,\n  isReplaced: false,\n  settings: settings.settings,\n  constraints: settings.getUserMediaSettings,\n});\n\nconst addStreamToState = (room, stream, settings, isScreensharing) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n  const streamKey = isScreensharing ? 'screenshare' : 'userMedia';\n\n  if (isScreensharing) {\n    updatedState.streams[streamKey] = buildStreamObject(updatedState.room, updatedState.user, stream, settings);\n  } else {\n    updatedState.streams[streamKey] = updatedState.streams[streamKey] ? updatedState.streams[streamKey] : {};\n    updatedState.streams[streamKey][stream.id] = buildStreamObject(updatedState.room, updatedState.user, stream, settings);\n  }\n\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nconst processNewStream = (room, stream, settings, isScreensharing) => {\n  addStreamToState(room, stream, settings, isScreensharing);\n  helpers.updateStreamsMutedSettings(room.id, settings, stream);\n  helpers.updateStreamsMediaStatus(room.id, settings, stream);\n};\n\nexport default processNewStream;\n","import parseMediaOptions from './parseMediaOptions';\nimport processStreamInState from './processStreamInState';\nimport parseStreamSettings from './parseStreamSettings';\nimport prepMediaAccessRequest from './prepMediaAccessRequest';\nimport addLocalMediaStreams from './addLocalMediaStreams';\nimport onRemoteTrackAdded from './onRemoteTrackAdded';\nimport onStreamAccessError from './onStreamAccessError';\nimport replaceTrack from './replaceTrack';\nimport muteStreams from './muteStreams';\nimport sendStream from './sendStream';\nimport getStreamSources from './getStreamSources';\nimport getStreams from './getStreams';\nimport getScreenSources from './getScreenSources';\nimport updateStreamsMediaStatus from './updateStreamsMediaStatus';\nimport updateRemoteStreams from './updateRemoteStreams';\nimport retrieveVideoStreams from './retrieveVideoStreams';\nimport splitAudioAndVideoStream from './splitAudioAndVideoStream';\nimport processNewStream from './processNewStream';\nimport updateStreamsMutedSettings from './updateStreamsMutedSettings';\nimport onStreamAccessSuccess from './onStreamAccessSuccess';\n\n/**\n * @namespace MediaStreamHelpers\n * @description All helper and utility functions for <code>{@link MediaStream}</code> class are listed here.\n * @private\n * @type {{parseMediaOptions, processStreamInState, parseStreamSettings, prepMediaAccessRequest, addLocalMediaStreams, onRemoteTrackAdded, onStreamAccessError, buildPeerStreamsInfo, replaceTrack, muteStreams, getStreamSources, sendStream, getStreams, getScreenSources, updateStreamsMediaStatus, updateRemoteStreams, retrieveVideoStreams, splitAudioAndVideoStream, processNewStream, updateStreamsMutedSettings, onStreamAccessSuccess}}\n */\nconst helpers = {\n  parseMediaOptions,\n  processStreamInState,\n  parseStreamSettings,\n  prepMediaAccessRequest,\n  addLocalMediaStreams,\n  onRemoteTrackAdded,\n  onStreamAccessError,\n  replaceTrack,\n  muteStreams,\n  sendStream,\n  getStreamSources,\n  getStreams,\n  getScreenSources,\n  updateStreamsMediaStatus,\n  updateRemoteStreams,\n  retrieveVideoStreams,\n  splitAudioAndVideoStream,\n  processNewStream,\n  updateStreamsMutedSettings,\n  onStreamAccessSuccess,\n};\n\nexport default helpers;\n","import helpers from './index';\nimport Skylink from '../../index';\nimport MESSAGES from '../../messages';\nimport logger from '../../logger';\nimport { mediaAccessSuccess } from '../../skylink-events';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport PeerMedia from '../../peer-media/index';\nimport { TAGS } from '../../constants';\nimport { hasAudioTrack, hasVideoTrack } from '../../utils/helpers';\n\nconst isStreamInState = (state, stream) => {\n  const { streams } = state;\n\n  if (!streams.userMedia && !streams.screenshare) {\n    return false;\n  }\n\n  const streamObjs = streams.userMedia ? Object.values(streams.userMedia) : [];\n  if (streamObjs.some(streamObj => streamObj.id === stream.id)) {\n    return true;\n  }\n\n  return streams.screenshare && streams.screenshare.id === stream.id;\n};\n\n/**\n * Function that processes the streams object in the state.\n * @param {MediaStream} stream - User MediaStream object\n * @param {GetUserMediaOptions} settings - Options used to get the peer-media stream\n * @param {SkylinkRoom.id} roomkey - Room's id\n * @param {boolean} [isScreensharing=false] isScreensharing\n * @param {boolean} [isAudioFallback=false] isAudioFallback\n * @memberOf MediaStreamHelpers\n * @fires mediaAccessSuccess\n * @private\n * */\nconst processStreamInState = (stream = null, settings = {}, roomkey, isScreensharing = false, isAudioFallback = false) => {\n  if (!stream) return;\n  const updatedState = Skylink.getSkylinkState(roomkey);\n\n  if (isStreamInState(updatedState, stream)) {\n    return;\n  }\n\n  helpers.processNewStream(updatedState.room, stream, settings, isScreensharing);\n  PeerMedia.processPeerMedia(updatedState.room, updatedState.user.sid, stream, isScreensharing);\n\n  if (isAudioFallback) {\n    logger.log.DEBUG([updatedState.user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.FALLBACK_SUCCESS]);\n  }\n\n  if (isScreensharing) {\n    logger.log.DEBUG([updatedState.user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.START_SCREEN_SUCCESS]);\n  }\n\n  dispatchEvent(mediaAccessSuccess({\n    stream,\n    isScreensharing,\n    isAudioFallback,\n    streamId: stream.id,\n    isAudio: hasAudioTrack(stream),\n    isVideo: hasVideoTrack(stream),\n  }));\n};\n\nexport default processStreamInState;\n","import clone from 'clone';\nimport { VIDEO_RESOLUTION, TRACK_KIND } from '../../constants';\n\n/**\n * Parse the options provided to make sure they are compatible\n * @param {GetUserMediaOptions} options\n * @param {String|null} type - The type of stream i.e. audio or video\n * @memberOf MediaStreamHelpers\n * @private\n * @return {{settings: {audio: boolean, video: boolean}, mutedSettings: {shouldAudioMuted: boolean, shouldVideoMuted: boolean}, getUserMediaSettings: {audio: boolean, video: boolean}}}\n */\nconst parseStreamSettings = (options, type = null) => {\n  const { AdapterJS } = window;\n  const settings = {\n    settings: { audio: false, video: false },\n    mutedSettings: { shouldAudioMuted: false, shouldVideoMuted: false },\n    getUserMediaSettings: { audio: false, video: false },\n  };\n\n  if ((options.audio && !type) || (options.audio && type === TRACK_KIND.AUDIO)) {\n    // For Edge to work since they do not support the advanced constraints yet\n    settings.settings.audio = {\n      stereo: false,\n      exactConstraints: !!options.useExactConstraints,\n      echoCancellation: true,\n    };\n    settings.getUserMediaSettings.audio = {\n      echoCancellation: true,\n    };\n\n    if (typeof options.audio === 'object') {\n      if (typeof options.audio.stereo === 'boolean') {\n        settings.settings.audio.stereo = options.audio.stereo;\n      }\n\n      if (typeof options.audio.useinbandfec === 'boolean') {\n        settings.settings.audio.useinbandfec = options.audio.useinbandfec;\n      }\n\n      if (typeof options.audio.usedtx === 'boolean') {\n        settings.settings.audio.usedtx = options.audio.usedtx;\n      }\n\n      if (typeof options.audio.maxplaybackrate === 'number'\n        && options.audio.maxplaybackrate >= 8000 && options.audio.maxplaybackrate <= 48000) {\n        settings.settings.audio.maxplaybackrate = options.audio.maxplaybackrate;\n      }\n\n      if (typeof options.audio.mute === 'boolean') {\n        settings.mutedSettings.shouldAudioMuted = options.audio.mute;\n      }\n\n      // Not supported in Edge browser features\n      if (AdapterJS.webrtcDetectedBrowser !== 'edge') {\n        if (typeof options.audio.echoCancellation === 'boolean') {\n          settings.settings.audio.echoCancellation = options.audio.echoCancellation;\n          settings.getUserMediaSettings.audio.echoCancellation = options.audio.echoCancellation;\n        }\n\n        if (Array.isArray(options.audio.optional)) {\n          settings.settings.audio.optional = clone(options.audio.optional);\n          settings.getUserMediaSettings.audio.optional = clone(options.audio.optional);\n        }\n\n        if (options.audio.deviceId && typeof options.audio.deviceId === 'string'\n          && AdapterJS.webrtcDetectedBrowser !== 'firefox') {\n          settings.settings.audio.deviceId = options.audio.deviceId;\n          settings.getUserMediaSettings.audio.deviceId = options.useExactConstraints\n            ? { exact: options.audio.deviceId } : { ideal: options.audio.deviceId };\n        }\n      }\n    }\n\n    if (AdapterJS.webrtcDetectedBrowser === 'edge') {\n      settings.getUserMediaSettings.audio = true;\n    }\n  }\n\n  if ((options.video && !type) || (options.video && type === TRACK_KIND.VIDEO)) {\n    // For Edge to work since they do not support the advanced constraints yet\n    settings.settings.video = {\n      resolution: clone(VIDEO_RESOLUTION.VGA),\n      // screenshare: false,\n      exactConstraints: !!options.useExactConstraints,\n    };\n    settings.getUserMediaSettings.video = {};\n\n    if (typeof options.video === 'object') {\n      if (typeof options.video.mute === 'boolean') {\n        settings.mutedSettings.shouldVideoMuted = options.video.mute;\n      }\n\n      if (Array.isArray(options.video.optional)) {\n        settings.settings.video.optional = clone(options.video.optional);\n        settings.getUserMediaSettings.video.optional = clone(options.video.optional);\n      }\n\n      if (options.video.deviceId && typeof options.video.deviceId === 'string') {\n        settings.settings.video.deviceId = options.video.deviceId;\n        settings.getUserMediaSettings.video.deviceId = options.useExactConstraints\n          ? { exact: options.video.deviceId } : { ideal: options.video.deviceId };\n      }\n\n      if (options.video.resolution && typeof options.video.resolution === 'object') {\n        if ((options.video.resolution.width && typeof options.video.resolution.width === 'object')\n          || typeof options.video.resolution.width === 'number') {\n          settings.settings.video.resolution.width = options.video.resolution.width;\n        }\n        if ((options.video.resolution.height && typeof options.video.resolution.height === 'object')\n          || typeof options.video.resolution.height === 'number') {\n          settings.settings.video.resolution.height = options.video.resolution.height;\n        }\n      }\n\n      /* eslint-disable no-nested-ternary */\n      /* eslint-disable no-mixed-operators */\n      settings.getUserMediaSettings.video.width = typeof settings.settings.video.resolution.width === 'object'\n        ? settings.settings.video.resolution.width : (options.useExactConstraints\n          ? { exact: settings.settings.video.resolution.width } : { max: settings.settings.video.resolution.width });\n\n      settings.getUserMediaSettings.video.height = typeof settings.settings.video.resolution.height === 'object'\n        ? settings.settings.video.resolution.height : (options.useExactConstraints\n          ? { exact: settings.settings.video.resolution.height } : { max: settings.settings.video.resolution.height });\n\n      if ((options.video.frameRate && typeof options.video.frameRate === 'object')\n        || typeof options.video.frameRate === 'number' && AdapterJS.webrtcDetectedType !== 'plugin') {\n        settings.settings.video.frameRate = options.video.frameRate;\n        settings.getUserMediaSettings.video.frameRate = typeof settings.settings.video.frameRate === 'object'\n          ? settings.settings.video.frameRate : (options.useExactConstraints\n            ? { exact: settings.settings.video.frameRate } : { max: settings.settings.video.frameRate });\n      }\n\n      if (options.video.facingMode && ['string', 'object'].indexOf(typeof options.video.facingMode) > -1 && AdapterJS.webrtcDetectedType === 'plugin') {\n        settings.settings.video.facingMode = options.video.facingMode;\n        settings.getUserMediaSettings.video.facingMode = typeof settings.settings.video.facingMode === 'object'\n          ? settings.settings.video.facingMode : (options.useExactConstraints\n            ? { exact: settings.settings.video.facingMode } : { max: settings.settings.video.facingMode });\n      }\n    } else {\n      settings.getUserMediaSettings.video = {\n        width: options.useExactConstraints ? { exact: settings.settings.video.resolution.width }\n          : { max: settings.settings.video.resolution.width },\n        height: options.useExactConstraints ? { exact: settings.settings.video.resolution.height }\n          : { max: settings.settings.video.resolution.height },\n      };\n    }\n\n    if (AdapterJS.webrtcDetectedBrowser === 'edge') {\n      settings.settings.video = {\n        // screenshare: false,\n        exactConstraints: !!options.useExactConstraints,\n      };\n      settings.getUserMediaSettings.video = true;\n    }\n  }\n\n  return settings;\n};\n\nexport default parseStreamSettings;\n","import helpers from './index';\nimport messages from '../../messages';\nimport { TRACK_KIND } from '../../constants';\nimport muteStreams from './muteStreams';\nimport Skylink from '../../index';\n\n/**\n * @description Helper function for {@link MediaStream.getUserMedia}\n * @param {GetUserMediaOptions} params - The camera Stream configuration options.\n * @memberOf MediaStreamHelpers\n * @return {Promise}\n */\nconst prepMediaAccessRequest = params => new Promise((resolve, reject) => {\n  const { roomKey, ...rest } = params;\n  const audioSettings = helpers.parseStreamSettings(rest, TRACK_KIND.AUDIO);\n  const videoSettings = helpers.parseStreamSettings(rest, TRACK_KIND.VIDEO);\n  const { AdapterJS } = window;\n\n  if (!audioSettings.getUserMediaSettings.audio && !videoSettings.getUserMediaSettings.video) {\n    reject(messages.MEDIA_STREAM.ERRORS.INVALID_GUM_OPTIONS);\n  }\n\n  AdapterJS.webRTCReady(() => {\n    window.navigator.mediaDevices.getUserMedia({ audio: audioSettings.getUserMediaSettings.audio, video: videoSettings.getUserMediaSettings.video }).then((stream) => {\n      const isAudioFallback = false;\n\n      const streams = helpers.onStreamAccessSuccess(roomKey, stream, audioSettings, videoSettings, isAudioFallback);\n      const state = Skylink.getSkylinkState(roomKey);\n      if (streams[0] && audioSettings.mutedSettings.shouldAudioMuted) {\n        muteStreams(state, { audioMuted: audioSettings.mutedSettings.shouldAudioMuted, videoMuted: videoSettings.mutedSettings.shouldVideoMuted }, streams[0].id);\n      }\n\n      if (streams[1] && videoSettings.mutedSettings.shouldVideoMuted) {\n        muteStreams(state, { audioMuted: audioSettings.mutedSettings.shouldAudioMuted, videoMuted: videoSettings.mutedSettings.shouldVideoMuted }, streams[1].id);\n      }\n\n      resolve(streams);\n    }).catch(error => helpers.onStreamAccessError(error, reject, resolve, roomKey, audioSettings, videoSettings));\n  });\n});\n\nexport default prepMediaAccessRequest;\n","import { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { onIncomingStream, peerUpdated, onIncomingScreenStream } from '../../skylink-events/index';\nimport PeerData from '../../peer-data/index';\n\n/**\n * Function that handles the <code>RTCPeerConnection.ontrack</code> event on remote stream added.\n * @param {MediaStream} stream - {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaStream}\n * @param {SkylinkState} currentRoomState - Current room state\n * @param {String} targetMid - The mid of the target peer\n * @param {boolean} isScreensharing - The flag if incoming stream is a screenshare stream.\n * @param {boolean} isVideo - The flag if incoming stream has a video track.\n * @param {boolean} isAudio- The flag if incoming stream has an audio track.\n * @memberOf MediaStreamHelpers\n * @fires onIncomingStream\n * @fires peerUpdated\n * @private\n */\nconst onRemoteTrackAdded = (stream, currentRoomState, targetMid, isScreensharing, isVideo, isAudio) => {\n  const { user, hasMCU, room } = currentRoomState;\n  const dispatchOnIncomingStream = (detail) => { dispatchEvent(onIncomingStream(detail)); };\n  const dispatchOnIncomingScreenStream = (detail) => {\n    // eslint-disable-next-line no-param-reassign\n    detail.isReplace = false;\n    dispatchEvent(onIncomingScreenStream(detail));\n  };\n  const methods = { dispatchOnIncomingStream, dispatchOnIncomingScreenStream };\n  const dispatch = { methodName: isScreensharing ? 'dispatchOnIncomingScreenStream' : 'dispatchOnIncomingStream' };\n  const detail = {\n    stream,\n    peerId: targetMid,\n    room,\n    isSelf: hasMCU ? (targetMid === user.sid || false) : false,\n    peerInfo: PeerData.getPeerInfo(targetMid, room),\n    streamId: stream.id,\n    isVideo,\n    isAudio,\n  };\n\n  methods[dispatch.methodName](detail);\n\n  dispatchEvent(peerUpdated({\n    peerId: targetMid,\n    peerInfo: PeerData.getPeerInfo(targetMid, room),\n    isSelf: hasMCU ? (targetMid === user.sid || false) : false,\n    room,\n  }));\n};\n\nexport default onRemoteTrackAdded;\n","/* eslint-disable consistent-return */\nimport Skylink from '../../index';\nimport logger from '../../logger';\nimport messages from '../../messages';\nimport { MEDIA_ACCESS_FALLBACK_STATE, TAGS } from '../../constants';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { mediaAccessError, mediaAccessFallback } from '../../skylink-events';\nimport helpers from './index';\n\n/**\n *\n * @param {Error} error - The error object.\n * @param {Function} reject - Reject function from promise.\n * @param {String} roomKey - The room rid.\n * @param {JSON} audioSettings - The audio media options.\n * @param {JSON} videoSettings - The video media options.\n * @param {object} resolve - The resolved promise.\n * @return {Promise<MediaStream | never>}\n * @memberOf MediaStreamHelpers\n * @fires mediaAccessError\n * @fires mediaAccessFallback\n */\nconst onStreamAccessError = (error, reject, resolve, roomKey, audioSettings, videoSettings) => {\n  const initOptions = Skylink.getInitOptions();\n  const state = Skylink.getSkylinkState(roomKey);\n  const { audioFallback } = initOptions;\n\n  if (audioSettings.settings.audio && videoSettings.settings.video && audioFallback) {\n    const isAudioFallback = true;\n    logger.log.DEBUG([state.user.sid, TAGS.MEDIA_STREAM, null, messages.MEDIA_STREAM.START_FALLBACK]);\n    dispatchEvent(mediaAccessFallback({\n      error,\n      state: MEDIA_ACCESS_FALLBACK_STATE.FALLBACKING,\n      isAudioFallback,\n    }));\n\n    return window.navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => helpers.onStreamAccessSuccess(roomKey, stream, audioSettings, videoSettings, isAudioFallback, resolve)).catch((fallbackError) => {\n      logger.log.ERROR([state.user.sid, TAGS.MEDIA_STREAM, null, messages.MEDIA_STREAM.ERRORS.FALLBACK, fallbackError]);\n      dispatchEvent(mediaAccessError({\n        error: fallbackError,\n        isAudioFallbackError: true,\n      }));\n      dispatchEvent(mediaAccessFallback({\n        error,\n        state: MEDIA_ACCESS_FALLBACK_STATE.ERROR,\n        isAudioFallback,\n      }));\n\n      reject(fallbackError);\n    });\n  }\n\n  logger.log.ERROR([state.user.sid, TAGS.MEDIA_STREAM, null, messages.MEDIA_STREAM.ERRORS.GET_USER_MEDIA], error);\n  dispatchEvent(mediaAccessError({\n    error,\n    isAudioFallbackError: false,\n  }));\n\n  reject(error);\n};\n\nexport default onStreamAccessError;\n","/**\n * Function that returns all active user streams including screenshare stream if present.\n * @param {SkylinkState} roomState\n * @return {streamList} streamList\n * @memberOf MediaStreamHelpers\n */\nconst getStreams = (roomState) => {\n  const { streams: { userMedia, screenshare } } = roomState;\n  const streamList = {\n    userMedia: null,\n    screenshare: null,\n  };\n\n  if (!userMedia && !screenshare) {\n    return streamList;\n  }\n\n  if (userMedia) {\n    const streamIds = Object.keys(userMedia);\n    streamList.userMedia = {};\n    streamIds.forEach((streamId) => {\n      streamList.userMedia[streamId] = userMedia[streamId].stream;\n    });\n  }\n\n  if (screenshare) {\n    streamList.screenshare = screenshare.stream;\n  }\n\n  return streamList;\n};\n\nexport default getStreams;\n","import logger from '../../logger';\n\nconst getScreenSources = () => new Promise((resolve) => {\n  const { navigator, AdapterJS } = window;\n  const outputSources = {\n    mediaSource: [],\n    mediaSourceInput: [],\n  };\n\n  // For chrome android 59+ has screensharing support behind chrome://flags (needs to be enabled by user)\n  // Reference: https://bugs.chromium.org/p/chromium/issues/detail?id=487935\n  if (navigator.userAgent.toLowerCase().indexOf('android') > -1) {\n    if (AdapterJS.webrtcDetectedBrowser === 'chrome' && AdapterJS.webrtcDetectedVersion >= 59) {\n      outputSources.mediaSource = ['screen'];\n    }\n    resolve(outputSources);\n    return null;\n  }\n\n  // TODO: Check if AdapterJS.webrtcDetectedType === 'plugin' is needed for IE/Safari Commercial support. If they do not support gDM method, then we will need a plugin\n\n  if ((AdapterJS.webrtcDetectedBrowser === 'chrome' && AdapterJS.webrtcDetectedVersion >= 34)\n      || (AdapterJS.webrtcDetectedBrowser === 'firefox' && AdapterJS.webrtcDetectedVersion >= 38)\n      || (AdapterJS.webrtcDetectedBrowser === 'opera' && AdapterJS.webrtcDetectedVersion >= 21)) {\n    // Just warn users for those who did not configure the Opera screensharing extension settings, it will not work!\n    if (AdapterJS.webrtcDetectedBrowser === 'opera' && !(AdapterJS.extensionInfo\n        && AdapterJS.extensionInfo.opera && AdapterJS.extensionInfo.opera.extensionId)) {\n      logger.log.WARN('Please ensure that your application allows Opera screensharing!');\n    }\n\n    outputSources.mediaSource = ['window', 'screen'];\n\n    // Chrome 52+ and Opera 39+ supports tab and audio\n    // Reference: https://developer.chrome.com/extensions/desktopCapture\n    if ((AdapterJS.webrtcDetectedBrowser === 'chrome' && AdapterJS.webrtcDetectedVersion >= 52)\n        || (AdapterJS.webrtcDetectedBrowser === 'opera' && AdapterJS.webrtcDetectedVersion >= 39)) {\n      outputSources.mediaSource.push('tab', 'audio');\n\n      // Firefox supports some other sources\n      // Reference: http://fluffy.github.io/w3c-screen-share/#screen-based-video-constraints\n      //            https://bugzilla.mozilla.org/show_bug.cgi?id=1313758\n      //            https://bugzilla.mozilla.org/show_bug.cgi?id=1037405\n      //            https://bugzilla.mozilla.org/show_bug.cgi?id=1313758\n    } else if (AdapterJS.webrtcDetectedBrowser === 'firefox') {\n      outputSources.mediaSource.push('browser', 'camera', 'application');\n    }\n  }\n  resolve(outputSources);\n  return null;\n});\n\nexport default getScreenSources;\n","/* eslint-disable no-nested-ternary */\nimport Skylink from '../../index';\nimport { MEDIA_STATUS } from '../../constants';\n\nconst updateStreamsMediaStatus = (roomKey, settings, stream) => {\n  const updatedState = Skylink.getSkylinkState(roomKey);\n  const { room, streamsMediaStatus } = updatedState;\n  const { mutedSettings: { shouldAudioMuted }, settings: { audio, video } } = settings;\n\n  streamsMediaStatus[stream.id] = {};\n  streamsMediaStatus[stream.id].audioMuted = audio ? (shouldAudioMuted ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE) : MEDIA_STATUS.UNAVAILABLE;\n  streamsMediaStatus[stream.id].videoMuted = video ? (shouldAudioMuted ? MEDIA_STATUS.MUTED : MEDIA_STATUS.ACTIVE) : MEDIA_STATUS.UNAVAILABLE;\n\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nexport default updateStreamsMediaStatus;\n","import Skylink from '../../index';\n\nconst updateRemoteStreams = (room, peerId, stream) => {\n  const updatedState = Skylink.getSkylinkState(room.id);\n\n  updatedState.remoteStreams[peerId] = updatedState.remoteStreams[peerId] || {};\n  updatedState.remoteStreams[peerId][stream.id] = stream;\n\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nexport default updateRemoteStreams;\n","import Skylink from '../../index';\n\nconst retrieveVideoStreams = (room) => {\n  const state = Skylink.getSkylinkState(room.id);\n  const { streams } = state;\n  const videoStreams = [];\n  Object.values(streams.userMedia).forEach((streamObj) => {\n    if (streamObj.stream.getVideoTracks().length > 0) {\n      videoStreams.push(streamObj.stream);\n    }\n  });\n\n  return videoStreams;\n};\n\nexport default retrieveVideoStreams;\n","import { hasAudioTrack, hasVideoTrack } from '../../utils/helpers';\n\nconst splitAudioAndVideoStream = (stream) => {\n  const { MediaStream } = window;\n  const streams = [];\n  const audioTracks = stream.getAudioTracks();\n  const videoTracks = stream.getVideoTracks();\n\n  if (hasAudioTrack(stream)) {\n    streams.push(new MediaStream(audioTracks));\n  } else {\n    streams.push(null);\n  }\n\n  if (hasVideoTrack(stream)) {\n    streams.push(new MediaStream(videoTracks));\n  } else {\n    streams.push(null);\n  }\n\n  return streams;\n};\n\nexport default splitAudioAndVideoStream;\n","import Skylink from '../../index';\n\nconst updateStreamsMutedSettings = (roomKey, settings, stream) => {\n  const updatedState = Skylink.getSkylinkState(roomKey);\n  const { room, streamsMutedSettings } = updatedState;\n  const { audio, video } = settings.settings;\n\n  streamsMutedSettings[stream.id] = {};\n  streamsMutedSettings[stream.id].audioMuted = !audio;\n  streamsMutedSettings[stream.id].videoMuted = !video;\n\n  Skylink.setSkylinkState(updatedState, room.id);\n};\n\nexport default updateStreamsMutedSettings;\n","import helpers from './index';\nimport { hasAudioTrack } from '../../utils/helpers';\n\nconst onStreamAccessSuccess = (roomKey, stream, audioSettings, videoSettings, isAudioFallback) => {\n  const isScreensharing = false;\n  const streams = helpers.splitAudioAndVideoStream(stream);\n\n  streams.forEach((st) => {\n    if (!st) return;\n    helpers.processStreamInState(st, hasAudioTrack(st) ? audioSettings : videoSettings, roomKey, isScreensharing, isAudioFallback);\n  });\n\n  return streams;\n};\n\nexport default onStreamAccessSuccess;\n","import Skylink from '../index';\nimport logger from '../logger';\nimport MESSAGES from '../messages';\nimport mediaStreamHelpers from '../media-stream/helpers/index';\nimport SkylinkSignalingServer from '../server-communication/signaling-server/index';\nimport { BROWSER_AGENT } from '../constants';\n\n/**\n * @namespace UtilHelpers\n * @description Util helper functions\n * @private\n */\n\n/**\n * Function that tests if an object is empty.\n * @param {Object} obj\n * @return {boolean}\n * @memberOf UtilHelpers\n */\nexport const isEmptyObj = (obj) => {\n  const keys = Object.keys(obj);\n  return keys.length === 0;\n};\n\n/**\n * Function that tests if an array is empty.\n * @param {Array} array\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isEmptyArray = array => array.length === 0;\n\n/**\n * Function that tests if a string is an empty string.\n * @param string\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isEmptyString = string => string === '';\n\n/**\n * Function that tests if type is 'Object'.\n * @param {*} param\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isAObj = param => typeof param === 'object' && param !== null;\n\n/**\n * Function that tests if type is 'Null'.\n * @param {*} param\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isNull = param => typeof param === 'object' && param == null;\n\n/**\n * Function that tests if type is 'Number'.\n * @param {*} param\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isANumber = param => typeof param === 'number';\n\n/**\n * Function that tests if type is 'Function'.\n * @param {*} param\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isAFunction = param => typeof param === 'function';\n\n/**\n * Function that tests if type is 'Boolean'.\n * @param {Object|boolean}\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isABoolean = obj => typeof obj !== 'undefined' && typeof obj === 'boolean';\n\n/**\n * Function that tests if type is 'String'.\n * @param {*} param\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isAString = param => typeof param === 'string';\n\n/**\n * Function that tests if a param is null, undefined or a string.\n * @param param\n * @param paramName\n * @param methodName\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const getParamValidity = (param, paramName, methodName) => {\n  let proceed = true;\n  if (param === null || typeof param === 'undefined' || !isAString(param)) {\n    logger.log.ERROR(`${methodName}: ${paramName} is null, undefined or not a string.`);\n    proceed = false;\n  }\n  return proceed;\n};\n\n/**\n * Function that returns the Skylink state.\n * @param {SkylinkRoom.id} rid\n * @returns {SkylinkState|null} state\n * @memberOf UtilHelpers\n */\nexport const getStateByRid = (rid) => {\n  const proceed = getParamValidity(rid, 'roomId', 'getStateByRid');\n  if (proceed) {\n    const states = Skylink.getSkylinkState();\n    const roomKeys = Object.keys(states);\n    let roomState = null;\n    for (let i = 0; i < roomKeys.length; i += 1) {\n      const key = roomKeys[i];\n      if (key === rid) {\n        roomState = states[key];\n        break;\n      }\n    }\n    return roomState;\n  }\n  logger.log.ERROR(`getRoomStateByRid: ${MESSAGES.ROOM_STATE.NOT_FOUND} - ${rid}`);\n  return null;\n};\n\n/**\n * Function that returns the Skylink state.\n * @param {String} roomkey - The room key.\n * @returns {SkylinkState}\n * @memberOf UtilHelpers\n */\nexport const getStateByKey = roomkey => getStateByRid(roomkey);\n\n/**\n * Function that returns the room state.\n * @param {String} roomName - The room name.\n * @returns {SkylinkState|null} - The room state.\n * @memberOf UtilHelpers\n */\nexport const getRoomStateByName = (roomName) => {\n  const proceed = getParamValidity(roomName, 'roomName', 'getRoomStateByName');\n  let matchedRoomState = null;\n  if (proceed) {\n    const state = Skylink.getSkylinkState();\n    const roomKeys = Object.keys(state);\n    for (let i = 0; i < roomKeys.length; i += 1) {\n      const roomState = state[roomKeys[i]];\n      if (roomState.room.roomName.toLowerCase() === roomName.toLowerCase()) {\n        matchedRoomState = roomState;\n        break;\n      }\n    }\n  }\n  if (!matchedRoomState) {\n    logger.log.ERROR(`getRoomStateByName: ${MESSAGES.ROOM_STATE.NOT_FOUND} - ${roomName}`);\n  }\n  return matchedRoomState;\n};\n\n/**\n * Function that checks the agent version compatibility.\n * @param {String} agentVer\n * @param {String} requiredVer\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isLowerThanVersion = (agentVer, requiredVer) => {\n  const partsA = (agentVer || '').split('.');\n  const partsB = (requiredVer || '').split('.');\n\n  for (let i = 0; i < partsB.length; i += 1) {\n    if ((partsA[i] || '0') < (partsB[i] || '0')) {\n      return true;\n    }\n  }\n  return false;\n};\n\n/**\n * Disconnects from the signaling server.\n * @memberOf UtilHelpers\n */\nexport const disconnect = () => {\n  try {\n    new SkylinkSignalingServer().socket.disconnect();\n  } catch (error) {\n    logger.log.ERROR(error);\n  }\n};\n\n/**\n * Function that generates an <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\">UUID</a> (Unique ID).\n * @returns {String} Returns a generated UUID (Unique ID).\n * @memberOf UtilHelpers\n */\nexport const generateUUID = () => {\n  /* eslint-disable no-bitwise */\n  let d = new Date().getTime();\n  const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n    const r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === 'x' ? r : (r && 0x7 | 0x8)).toString(16);\n  });\n  return uuid;\n};\n\n/**\n * Function that returns the getUserMedia stream when the user had not joined a room (is stateless)\n * @param {Object} options\n * @returns {Promise}\n * @memberOf UtilHelpers\n */\nexport const statelessGetUserMedia = options => new Promise((resolve, reject) => {\n  const { navigator } = window;\n  if (!options || !isAObj(options)) {\n    reject(new Error(`${MESSAGES.MEDIA_STREAM.ERRORS.INVALID_GUM_OPTIONS} ${options}`));\n  }\n\n  navigator.mediaDevices.getUserMedia(options).then((stream) => {\n    const streams = mediaStreamHelpers.splitAudioAndVideoStream(stream);\n    resolve(streams);\n  }).catch((error) => {\n    reject(error);\n  });\n});\n\n/**\n * Function that always returns are rejected Promise.\n * @param {String} errorMsg\n * @returns {Promise}\n * @memberOf UtilHelpers\n */\nexport const rejectPromise = errorMsg => new Promise((resolve, reject) => {\n  reject(new Error(errorMsg));\n});\n\n/**\n * Function that updates the replaced state of the streams\n * @param {MediaStream} replacedStream\n * @param {MediaStream} newStream\n * @param {SkylinkState} state\n * @param {boolean} isReplaced\n * @memberOf UtilHelpers\n */\nexport const updateReplacedStreamInState = (replacedStream, newStream, state, isReplaced) => {\n  const { streams, room } = state;\n  const streamObjs = Object.values(streams.userMedia);\n  for (let i = 0; i < streamObjs.length; i += 1) {\n    if (streamObjs[i].id === replacedStream.id) {\n      streamObjs[i].isReplaced = isReplaced;\n      streamObjs[i].newStream = newStream;\n    }\n  }\n\n  Skylink.setSkylinkState(state, room.id);\n};\n\n/**\n * Function that checks if the peerId exists on the peerConnection\n * @param {SkylinkRoom} room\n * @param {String} peerId\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isValidPeerId = (room, peerId) => {\n  const state = Skylink.getSkylinkState(room.id);\n\n  const { peerConnections } = state;\n  const peerIds = Object.keys(peerConnections);\n\n  let isValid = false;\n  peerIds.forEach((validPeerId) => {\n    if (validPeerId === peerId) {\n      isValid = true;\n    }\n  });\n\n  return isValid;\n};\n\n/**\n * Function that checks if a media stream has an audio track.\n * @param {MediaStream} stream\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const hasAudioTrack = stream => stream.getAudioTracks().length > 0;\n\n/**\n * Function that checks if a media stream has a video track.\n * @param {MediaStream} stream\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const hasVideoTrack = stream => stream.getVideoTracks().length > 0;\n\n/**\n * Function that checks the browser agent.\n * @param {String} agent\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isAgent = (agent) => {\n  const { AdapterJS } = window;\n  switch (agent) {\n    case BROWSER_AGENT.CHROME:\n      return AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.CHROME;\n    case BROWSER_AGENT.SAFARI:\n      return AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.SAFARI;\n    case BROWSER_AGENT.FIREFOX:\n      return AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.FIREFOX;\n    default:\n      logger.log.DEBUG(MESSAGES.UTILS.INVALID_BROWSER_AGENT);\n      return false;\n  }\n};\n\n/**\n * Function that checks the browser version.\n * @param {number} version\n * @returns {boolean}\n * @memberOf UtilHelpers\n */\nexport const isVersion = (version) => {\n  const { AdapterJS } = window;\n  return AdapterJS.webrtcDetectedVersion === version;\n};\n\n/**\n * Function that generates a timestamp in UNIX format.\n * @returns {number}\n * @memberOf UtilHelpers\n */\nexport const generateUNIXTimeStamp = () => Math.round(new Date().getTime() / 1000);\n\n/**\n * Function that parses UNIX timestamp and returns timestamp in ISO string.\n * @param timestamp\n * @returns {string}\n * @memberOf UtilHelpers\n */\nexport const parseUNIXTimeStamp = timestamp => new Date(timestamp).toISOString();\n\n/**\n * Function that generates a timestamp in ISO string format.\n * @returns {string}\n * @memberOf UtilHelpers\n */\nexport const generateISOStringTimesStamp = () => new Date().toISOString();\n","import logger from '../logger/index';\nimport { TAGS, EVENTS } from '../constants';\nimport { isAFunction } from './helpers';\nimport MESSAGES from '../messages';\n\nclass SkylinkEventManager {\n  constructor() {\n    this.events = {};\n    this.privateEvents = {};\n  }\n\n  addPrivateEventListener(eventName, callback) {\n    this.addListener(eventName, callback, true);\n  }\n\n  addEventListener(eventName, callback) {\n    this.addListener(eventName, callback, false);\n  }\n\n  addListener(eventName, callback, isPrivate) {\n    try {\n      const key = isPrivate ? 'privateEvents' : 'events';\n\n      if (!isAFunction(callback)) {\n        logger.log.DEBUG([null, TAGS.SKYLINK_EVENT, eventName, MESSAGES.LOGGER.INVALID_CB]);\n        return;\n      }\n\n      if (!this[key][eventName]) {\n        this[key][eventName] = {};\n      }\n\n      if (!this[key][eventName].callbacks) {\n        this[key][eventName].callbacks = [];\n      }\n\n      this[key][eventName].callbacks.push(callback);\n\n      if (!isPrivate) {\n        logger.log.DEBUG([null, TAGS.SKYLINK_EVENT, eventName, MESSAGES.LOGGER.EVENT_REGISTERED]);\n      }\n    } catch (err) {\n      logger.log.ERROR([null, TAGS.SKYLINK_EVENT, eventName, MESSAGES.LOGGER.EVENT_REGISTER_ERROR], err);\n    }\n  }\n\n  dispatchEvent(evt) {\n    if (evt.name === EVENTS.LOGGED_ON_CONSOLE) {\n      return;\n    }\n\n    let allEventCallbacks = [];\n    if (!this.events[evt.name]) {\n      logger.log.DEBUG([null, TAGS.SKYLINK_EVENT, evt.name, MESSAGES.LOGGER.EVENT_DISPATCHED]);\n    } else {\n      const userCallbacks = this.events[evt.name].callbacks;\n      allEventCallbacks = allEventCallbacks.concat(userCallbacks);\n    }\n\n    if (this.privateEvents[evt.name]) {\n      const privateCallbacks = this.privateEvents[evt.name] ? this.privateEvents[evt.name].callbacks : [];\n      allEventCallbacks = allEventCallbacks.concat(privateCallbacks);\n    }\n\n    allEventCallbacks.forEach((callback) => {\n      try {\n        callback(evt.detail);\n      } catch (err) {\n        logger.log.ERROR([null, TAGS.SKYLINK_EVENT, evt.name, MESSAGES.LOGGER.EVENT_DISPATCH_ERROR], err);\n      }\n    });\n  }\n\n  removeEventListener(eventName, callback) {\n    this.removeListener(eventName, callback, false);\n  }\n\n  removePrivateEventListener(eventName, callback) {\n    this.removeListener(eventName, callback, true);\n  }\n\n  removeListener(eventName, callback, isPrivate) {\n    const key = isPrivate ? 'privateEvents' : 'events';\n\n    if (!isPrivate && !(this.events[eventName] && this.events[eventName].callbacks)) {\n      logger.log.WARN([null, TAGS.SKYLINK_EVENT, eventName, MESSAGES.LOGGER.EVENT_UNREGISTERED]);\n      return;\n    }\n\n    try {\n      this[key][eventName].callbacks.forEach((cb, i) => {\n        if (cb === callback) {\n          delete this[key][eventName].callbacks[i];\n\n          if (!isPrivate) {\n            logger.log.DEBUG([null, TAGS.SKYLINK_EVENT, eventName, MESSAGES.LOGGER.EVENT_UNREGISTERED]);\n          }\n        }\n      });\n    } catch (err) {\n      logger.log.ERROR([null, TAGS.SKYLINK_EVENT, eventName, MESSAGES.LOGGER.EVENT_DISPATCH_ERROR], err);\n    }\n  }\n}\n\nconst skylinkEventManager = new SkylinkEventManager();\nconst addEventListener = skylinkEventManager.addPrivateEventListener.bind(skylinkEventManager);\nconst removeEventListener = skylinkEventManager.removePrivateEventListener.bind(skylinkEventManager);\nconst dispatchEvent = skylinkEventManager.dispatchEvent.bind(skylinkEventManager);\n\nexport default skylinkEventManager;\nexport { addEventListener, removeEventListener, dispatchEvent };\n","import { loggedOnConsole } from '../skylink-events';\nimport { dispatchEvent } from '../utils/skylinkEventManager';\nimport SkylinkLogger from './index';\n\nconst logMethods = [\n  'trace',\n  'debug',\n  'info',\n  'warn',\n  'error',\n];\n\nconst LEVEL_STORAGE_KEY = 'loglevel:skylinkjs';\n\nconst checkSupport = (methodName) => {\n  let hasSupport = true;\n  if (typeof console === 'undefined') {\n    hasSupport = false;\n  } else if (typeof console[methodName] === 'undefined') { // eslint-disable-line no-console\n    hasSupport = false;\n  }\n  return hasSupport;\n};\n\nconst getFormattedMessage = (message) => {\n  let log = 'SkylinkJS -';\n  if (Array.isArray(message)) {\n    // fragment1 - peerId\n    // fragment2 - tag\n    // fragment3 - additional info / state\n    const [fragment1, fragment2, fragment3, messageString] = message;\n    log += fragment1 ? ` [${fragment1}]` : ' -';\n    // eslint-disable-next-line no-nested-ternary\n    log += fragment2 ? ` <<${fragment2}>>` : (fragment1 ? '' : ' <<Method>>');\n    if (fragment3) {\n      if (Array.isArray(fragment3)) {\n        for (let i = 0; i < fragment3.length; i += 1) {\n          log += ` (${fragment3[i]})`;\n        }\n      } else {\n        log += ` (${fragment3})`;\n      }\n    }\n    log += ` ${messageString}`;\n  } else {\n    log += ` ${message}`;\n  }\n  return log;\n};\n\nexport const logFn = (logger, level, message, debugObject = null) => {\n  const datetime = `[${(new Date()).toISOString()}]`;\n  const currentLevel = logger.level;\n  const { logLevels } = logger;\n  if (currentLevel <= level && currentLevel !== logLevels.SILENT) {\n    const methodName = logMethods[level];\n    const hasSupport = checkSupport(methodName);\n\n    if (!hasSupport) {\n      return;\n    }\n\n    const formattedMessage = getFormattedMessage(message);\n    if (checkSupport(methodName)) {\n      console[methodName](datetime, formattedMessage, debugObject || ''); // eslint-disable-line no-console\n      dispatchEvent(loggedOnConsole({ level: methodName, message: formattedMessage, debugObject }));\n    }\n\n    if (SkylinkLogger.storeLogs) {\n      const logItems = [datetime, methodName.toUpperCase(), formattedMessage];\n      if (debugObject) {\n        logItems.push(debugObject);\n      }\n      SkylinkLogger.storedLogs.push(logItems);\n    }\n  }\n};\n\nexport const persistLogLevel = (level) => {\n  window.localStorage.setItem(LEVEL_STORAGE_KEY, level);\n};\n\nexport const getPersistedLevel = (logLevels) => {\n  const level = window.localStorage.getItem(LEVEL_STORAGE_KEY);\n  return level !== null && !Number.isNaN(+level) ? +level : logLevels.ERROR;\n};\n","/* eslint-disable import/prefer-default-export */\nimport {\n  LOGGED_ON_CONSOLE,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.loggedOnConsole\n * @description Event triggered when Skylink logs to browser's console.\n * @param {Object} detail - Event's payload.\n * @param {JSON} detail.level - The log level.\n * @param {String} detail.message - The log message.\n * @param {JSON} detail.debugObject - A JavaScript object to be logged to help with analysis.\n */\nexport const loggedOnConsole = (detail = {}) => new SkylinkEvent(LOGGED_ON_CONSOLE, { detail });\n","import { logFn, persistLogLevel, getPersistedLevel } from './log-helpers';\nimport MESSAGES from '../messages';\n\n/**\n * @classdesc Class used for logging messages on the console. Exports a singleton logger object.\n * @class SkylinkLogger\n * @public\n * @example\n * import { SkylinkLogger } from 'skylinkjs';\n *\n * const skylinkLogger = new SkylinkLogger();\n */\nclass SkylinkLogger {\n  constructor() {\n    /**\n     * @description List of log levels.\n     * @type {Object} logLevels\n     * @property {number} TRACE - All logs.\n     * @property {number} DEBUG\n     * @property {number} INFO\n     * @property {number} WARN\n     * @property {number} ERROR\n     * @property {number} SILENT - No logs.\n     */\n    this.logLevels = {\n      TRACE: 0, // All Logs\n      DEBUG: 1,\n      INFO: 2,\n      WARN: 3,\n      ERROR: 4, // Ideal level for Production Env.\n      SILENT: 5, // No logging\n    };\n\n    this.level = getPersistedLevel(this.logLevels);\n\n    /**\n     * @description The flag that enables the store logs function.\n     * @type {boolean}\n     */\n    this.storeLogs = false;\n\n    /**\n     * @description The stored logs when storeLogs flag is set to true.\n     * @type {Array.<logItems>} The array of stored logs\n     */\n    this.storedLogs = [];\n  }\n\n  /**\n   * @description Method that sets the log level.\n   * @param {number} level - The log level to be set. REF: {@link SkylinkLogger#logLevels|logLevels}\n   * @param {Boolean} storeLogs - The flag if logs should be stored.\n   * @public\n   * @example\n   * skylinkLogger.setLogLevels(skylinkLogger.logLevels.TRACE);\n   * @alias SkylinkLogger#setLevel\n   */\n  setLevel(level = this.levels.ERROR, storeLogs) {\n    if (typeof level === 'number') {\n      this.level = level;\n      persistLogLevel(this.level);\n    } else {\n      this.level = this.levels.ERROR;\n    }\n\n    if (storeLogs) {\n      this.storeLogs = storeLogs;\n    }\n  }\n\n  /**\n   * @description Enables logging with highest level (TRACE).\n   * @public\n   * @alias SkylinkLogger#enableAll\n   */\n  enableAll() {\n    this.setLevel(this.logLevels.TRACE);\n  }\n\n  /**\n   * @description Disables all logging with lowest level (SILENT).\n   * @public\n   * @alias SkylinkLogger#disableAll\n   */\n  disableAll() {\n    this.setLevel(this.logLevels.SILENT);\n  }\n\n  getLogs() {\n    if (this.storeLogs) {\n      return this.storedLogs;\n    }\n\n    this.log.WARN(MESSAGES.LOGGER.LOGS_NOT_STORED);\n    return null;\n  }\n\n  clearLogs() {\n    this.log.INFO(MESSAGES.LOGGER.LOGS_CLEARED);\n    this.storedLogs = [];\n  }\n}\n\n/**\n * @type {SkylinkLogger}\n * @private\n */\nconst logger = new SkylinkLogger();\n\n/**\n * @description Method to trigger a log\n * @type {{TRACE: SkylinkLogger.log.TRACE, DEBUG: SkylinkLogger.log.DEBUG, INFO: SkylinkLogger.log.INFO, WARN: SkylinkLogger.log.WARN, ERROR: SkylinkLogger.log.ERROR}}\n * @private\n */\nSkylinkLogger.prototype.log = {\n  TRACE: (...params) => {\n    logFn(logger, logger.logLevels.TRACE, ...params);\n  },\n  DEBUG: (...params) => {\n    logFn(logger, logger.logLevels.DEBUG, ...params);\n  },\n  INFO: (...params) => {\n    logFn(logger, logger.logLevels.INFO, ...params);\n  },\n  WARN: (...params) => {\n    logFn(logger, logger.logLevels.WARN, ...params);\n  },\n  ERROR: (...params) => {\n    logFn(logger, logger.logLevels.ERROR, ...params);\n  },\n};\n\nexport default logger;\n","/* eslint-disable prefer-template */\n/* eslint-disable no-useless-escape */\n/* eslint-disable no-continue */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-prototype-builtins */\n/* eslint-disable no-nested-ternary */\n/* eslint-disable no-restricted-syntax */\nimport * as constants from '../../constants';\nimport Skylink from '../../index';\n\nconst parseFn = (sessionDescription, type, codecName, samplingRate, settings) => {\n  const mLine = sessionDescription.sdp.match(new RegExp('m=' + type + '\\ .*\\r\\n', 'gi'));\n  // Find the m= line\n  if (Array.isArray(mLine) && mLine.length > 0) {\n    const codecsList = sessionDescription.sdp.match(new RegExp('a=rtpmap:.*\\ ' + codecName + '\\/'\n      + (samplingRate ? samplingRate + (type === 'audio' ? '[\\/]*.*' : '.*') : '.*') + '\\r\\n', 'gi'));\n    // Get the list of codecs related to it\n    if (Array.isArray(codecsList) && codecsList.length > 0) {\n      for (let i = 0; i < codecsList.length; i += 1) {\n        const payload = (codecsList[i].split('a=rtpmap:')[1] || '').split(' ')[0];\n        if (!payload) {\n          continue;\n        }\n        const fmtpLine = sessionDescription.sdp.match(new RegExp('a=fmtp:' + payload + '\\ .*\\r\\n', 'gi'));\n        let updatedFmtpLine = 'a=fmtp:' + payload + ' ';\n        const addedKeys = [];\n        // Check if a=fmtp: line exists\n        if (Array.isArray(fmtpLine) && fmtpLine.length > 0) {\n          const fmtpParts = (fmtpLine[0].split('a=fmtp:' + payload + ' ')[1] || '').replace(/ /g, '').replace(/\\r\\n/g, '').split(';');\n          for (let j = 0; j < fmtpParts.length; j += 1) {\n            if (!fmtpParts[j]) {\n              continue;\n            }\n            const keyAndValue = fmtpParts[j].split('=');\n            if (settings.hasOwnProperty(keyAndValue[0])) {\n              // Dont append parameter key+value if boolean and false\n              updatedFmtpLine += typeof settings[keyAndValue[0]] === 'boolean' ? (settings[keyAndValue[0]]\n                ? keyAndValue[0] + '=1;' : '') : keyAndValue[0] + '=' + settings[keyAndValue[0]] + ';';\n            } else {\n              updatedFmtpLine += fmtpParts[j] + ';';\n            }\n            addedKeys.push(keyAndValue[0]);\n          }\n          sessionDescription.sdp = sessionDescription.sdp.replace(fmtpLine[0], '');\n        }\n        for (const key in settings) {\n          if (settings.hasOwnProperty(key) && addedKeys.indexOf(key) === -1) {\n            // Dont append parameter key+value if boolean and false\n            updatedFmtpLine += typeof settings[key] === 'boolean' ? (settings[key] ? key + '=1;' : '') : key + '=' + settings[key] + ';';\n            addedKeys.push(key);\n          }\n        }\n        if (updatedFmtpLine !== 'a=fmtp:' + payload + ' ') {\n          sessionDescription.sdp = sessionDescription.sdp.replace(codecsList[i], codecsList[i] + updatedFmtpLine + '\\r\\n');\n        }\n      }\n    }\n  }\n};\n\nconst setSDPCodecParams = (targetMid, sessionDescription, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const initOptions = Skylink.getInitOptions();\n\n  // Set audio codecs -> OPUS\n  // RFC: https://tools.ietf.org/html/draft-ietf-payload-rtp-opus-11\n  parseFn(sessionDescription, 'audio', constants.AUDIO_CODEC.OPUS, 48000, (() => {\n    const opusOptions = {};\n    // let audioSettings = state.streams.screenshare ? state.streams.screenshare.settings.audio : (state.streams.userMedia ? state.streams.userMedia.settings.audio : {});\n    // TODO: check if settings across different streams are the same\n    // FIXME: Quickfix to pass in first stream\n    const streamIds = Object.keys(state.streams.userMedia);\n    let audioSettings = state.streams.userMedia ? state.streams.userMedia[streamIds[0]].settings.audio : {};\n    audioSettings = audioSettings && typeof audioSettings === 'object' ? audioSettings : {};\n    if (typeof initOptions.codecParams.audio.opus.stereo === 'boolean') {\n      opusOptions.stereo = initOptions.codecParams.audio.opus.stereo;\n    } else if (typeof audioSettings.stereo === 'boolean') {\n      opusOptions.stereo = audioSettings.stereo;\n    }\n    if (typeof initOptions.codecParams.audio.opus['sprop-stereo'] === 'boolean') {\n      opusOptions['sprop-stereo'] = initOptions.codecParams.audio.opus['sprop-stereo'];\n    } else if (typeof audioSettings.stereo === 'boolean') {\n      opusOptions['sprop-stereo'] = audioSettings.stereo;\n    }\n    if (typeof initOptions.codecParams.audio.opus.usedtx === 'boolean') {\n      opusOptions.usedtx = initOptions.codecParams.audio.opus.usedtx;\n    } else if (typeof audioSettings.usedtx === 'boolean') {\n      opusOptions.usedtx = audioSettings.usedtx;\n    }\n    if (typeof initOptions.codecParams.audio.opus.useinbandfec === 'boolean') {\n      opusOptions.useinbandfec = initOptions.codecParams.audio.opus.useinbandfec;\n    } else if (typeof audioSettings.useinbandfec === 'boolean') {\n      opusOptions.useinbandfec = audioSettings.useinbandfec;\n    }\n    if (typeof initOptions.codecParams.audio.opus.maxplaybackrate === 'number') {\n      opusOptions.maxplaybackrate = initOptions.codecParams.audio.opus.maxplaybackrate;\n    } else if (typeof audioSettings.maxplaybackrate === 'number') {\n      opusOptions.maxplaybackrate = audioSettings.maxplaybackrate;\n    }\n    if (typeof initOptions.codecParams.audio.opus.minptime === 'number') {\n      opusOptions.minptime = initOptions.codecParams.audio.opus.minptime;\n    } else if (typeof audioSettings.minptime === 'number') {\n      opusOptions.minptime = audioSettings.minptime;\n    }\n    // Possible future params: sprop-maxcapturerate, maxaveragebitrate, sprop-stereo, cbr\n    // NOT recommended: maxptime, ptime, rate, minptime\n    return opusOptions;\n  })());\n\n  // RFC: https://tools.ietf.org/html/rfc4733\n  // Future: Set telephone-event: 100 0-15,66,70\n\n  // RFC: https://tools.ietf.org/html/draft-ietf-payload-vp8-17\n  // Set video codecs -> VP8\n  parseFn(sessionDescription, 'video', constants.VIDEO_CODEC.VP8, null, (() => {\n    const vp8Options = {};\n    // NOT recommended: max-fr, max-fs (all are codec decoder capabilities)\n    if (typeof initOptions.codecParams.video.vp8.maxFr === 'number') {\n      vp8Options['max-fr'] = initOptions.codecParams.video.vp8.maxFr;\n    }\n    if (typeof initOptions.codecParams.video.vp8.maxFs === 'number') {\n      vp8Options['max-fs'] = initOptions.codecParams.video.vp8.maxFs;\n    }\n    return vp8Options;\n  })());\n\n  // RFC: https://tools.ietf.org/html/draft-ietf-payload-vp9-02\n  // Set video codecs -> VP9\n  parseFn(sessionDescription, 'video', constants.VIDEO_CODEC.VP9, null, (() => {\n    const vp9Options = {};\n    // NOT recommended: max-fr, max-fs (all are codec decoder capabilities)\n    if (typeof initOptions.codecParams.video.vp9.maxFr === 'number') {\n      vp9Options['max-fr'] = initOptions.codecParams.video.vp9.maxFr;\n    }\n    if (typeof initOptions.codecParams.video.vp9.maxFs === 'number') {\n      vp9Options['max-fs'] = initOptions.codecParams.video.vp9.maxFs;\n    }\n    return vp9Options;\n  })());\n\n  // RFC: https://tools.ietf.org/html/rfc6184\n  // Set the video codecs -> H264\n  parseFn(sessionDescription, 'video', constants.VIDEO_CODEC.H264, null, (() => {\n    const h264Options = {};\n    if (typeof initOptions.codecParams.video.h264.levelAsymmetryAllowed === 'string') {\n      h264Options['profile-level-id'] = initOptions.codecParams.video.h264.profileLevelId;\n    }\n    if (typeof initOptions.codecParams.video.h264.levelAsymmetryAllowed === 'boolean') {\n      h264Options['level-asymmetry-allowed'] = initOptions.codecParams.video.h264.levelAsymmetryAllowed;\n    }\n    if (typeof initOptions.codecParams.video.h264.packetizationMode === 'boolean') {\n      h264Options['packetization-mode'] = initOptions.codecParams.video.h264.packetizationMode;\n    }\n    // Possible future params (remove if they are decoder/encoder capabilities or info):\n    //   max-recv-level, max-mbps, max-smbps, max-fs, max-cpb, max-dpb, max-br,\n    //   max-mbps, max-smbps, max-fs, max-cpb, max-dpb, max-br, redundant-pic-cap, sprop-parameter-sets,\n    //   sprop-level-parameter-sets, use-level-src-parameter-sets, in-band-parameter-sets,\n    //   sprop-interleaving-depth, sprop-deint-buf-req, deint-buf-cap, sprop-init-buf-time,\n    //   sprop-max-don-diff, max-rcmd-nalu-size, sar-understood, sar-supported\n    //   NOT recommended: profile-level-id (WebRTC uses \"42e00a\" for the moment)\n    //   https://bugs.chromium.org/p/chromium/issues/detail?id=645599\n    return h264Options;\n  })());\n\n  return sessionDescription.sdp;\n};\n\nexport default setSDPCodecParams;\n","/* eslint-disable no-useless-escape */\n/* eslint-disable no-param-reassign */\n/* eslint-disable prefer-template */\nconst formatRtx = (str) => {\n  (str.match(/a=rtpmap:.*\\ rtx\\/.*\\r\\n/gi) || []).forEach((line) => {\n    const payload = (line.split('a=rtpmap:')[1] || '').split(' ')[0] || '';\n    const fmtpLine = (str.match(new RegExp('a=fmtp:' + payload + '\\ .*\\r\\n', 'gi')) || [])[0];\n\n    if (!fmtpLine) {\n      str = str.replace(new RegExp(line, 'g'), '');\n      return;\n    }\n\n    const codecPayload = (fmtpLine.split(' apt=')[1] || '').replace(/\\r\\n/gi, '');\n    const rtmpLine = str.match(new RegExp('a=rtpmap:' + codecPayload + '\\ .*\\r\\n', 'gi'));\n\n    if (!rtmpLine) {\n      str = str.replace(new RegExp(line, 'g'), '');\n      str = str.replace(new RegExp(fmtpLine, 'g'), '');\n    }\n  });\n\n  return str;\n};\n\n// Remove unmapped fmtp and rtcp-fb lines\nconst formatFmtpRtcpFb = (str) => {\n  (str.match(/a=(fmtp|rtcp-fb):.*\\ rtx\\/.*\\r\\n/gi) || []).forEach((line) => {\n    const payload = (line.split('a=' + (line.indexOf('rtcp') > 0 ? 'rtcp-fb' : 'fmtp'))[1] || '').split(' ')[0] || '';\n    const rtmpLine = str.match(new RegExp('a=rtpmap:' + payload + '\\ .*\\r\\n', 'gi'));\n\n    if (!rtmpLine) {\n      str = str.replace(new RegExp(line, 'g'), '');\n    }\n  });\n\n  return str;\n};\n\nconst removeSDPUnknownAptRtx = (targetMid, sessionDescription) => {\n  const mediaLines = sessionDescription.sdp.split('m=');\n\n  // Remove unmapped rtx lines\n  // Remove rtx or apt= lines that prevent connections for browsers without VP8 or VP9 support\n  // See: https://bugs.chromium.org/p/webrtc/issues/detail?id=3962\n  for (let m = 0; m < mediaLines.length; m += 1) {\n    mediaLines[m] = formatRtx(mediaLines[m]);\n    mediaLines[m] = formatFmtpRtcpFb(mediaLines[m]);\n  }\n\n  return mediaLines.join('m=');\n};\n\nexport default removeSDPUnknownAptRtx;\n","import getSDPCommonSupports from './getSDPCommonSupports';\nimport getSDPCodecsSupport from './getSDPCodecsSupport';\nimport getCodecsSupport from './getCodecsSupport';\nimport setSDPCodecParams from './setSDPCodecParams';\nimport removeSDPFilteredCandidates from './removeSDPFilteredCandidates';\nimport setSDPCodec from './setSDPCodec';\nimport setSDPBitrate from './setSDPBitrate';\nimport removeSDPCodecs from './removeSDPCodecs';\nimport removeSDPREMBPackets from './removeSDPREMBPackets';\nimport handleSDPConnectionSettings from './handleSDPConnectionSettings';\nimport removeSDPUnknownAptRtx from './removeSDPUnknownAptRtx';\nimport removeSDPFirefoxH264Pref from './removeSDPFirefoxH264Pref';\nimport renderSDPOutput from './renderSDPOutput';\nimport getSDPICECandidates from './getSDPICECandidates';\nimport getSDPSelectedCodec from './getSDPSelectedCodec';\nimport setOriginalDTLSRole from './setOriginalDTLSRole';\nimport modifyDTLSRole from './modifyDTLSRole';\nimport getTransceiverMid from './getTransceiverMid';\n\nconst helpers = {\n  getSDPCommonSupports,\n  getSDPCodecsSupport,\n  getCodecsSupport,\n  setSDPCodecParams,\n  removeSDPFilteredCandidates,\n  setSDPCodec,\n  setSDPBitrate,\n  removeSDPCodecs,\n  removeSDPREMBPackets,\n  handleSDPConnectionSettings,\n  removeSDPUnknownAptRtx,\n  removeSDPFirefoxH264Pref,\n  renderSDPOutput,\n  getSDPICECandidates,\n  getSDPSelectedCodec,\n  setOriginalDTLSRole,\n  modifyDTLSRole,\n  getTransceiverMid,\n};\n\nexport default helpers;\n","import logger from '../../logger';\n\nconst getSDPCodecsSupport = (targetMid, sessionDescription, beSilentOnParseLogs) => {\n  const codecs = { audio: {}, video: {} };\n\n  if (!(sessionDescription && sessionDescription.sdp)) {\n    return codecs;\n  }\n\n  const sdpLines = sessionDescription.sdp.split('\\r\\n');\n  let mediaType = '';\n\n  for (let i = 0; i < sdpLines.length; i += 1) {\n    /* eslint-disable prefer-destructuring */\n    /* eslint-disable no-continue */\n    if (sdpLines[i].indexOf('m=') === 0) {\n      mediaType = (sdpLines[i].split('m=')[1] || '').split(' ')[0];\n      continue;\n    }\n\n    if (sdpLines[i].indexOf('a=rtpmap:') === 0) {\n      const parts = (sdpLines[i].split(' ')[1] || '').split('/');\n      const codec = (parts[0] || '').toLowerCase();\n      const info = parts[1] + (parts[2] ? `/${parts[2]}` : '');\n\n      if (['ulpfec', 'red', 'telephone-event', 'cn', 'rtx'].indexOf(codec) > -1) {\n        continue;\n      }\n\n      codecs[mediaType][codec] = codecs[mediaType][codec] || [];\n\n      if (codecs[mediaType][codec].indexOf(info) === -1) {\n        codecs[mediaType][codec].push(info);\n      }\n    }\n  }\n\n  if (!beSilentOnParseLogs) {\n    logger.log.INFO([targetMid || null, 'RTCSessionDescription', sessionDescription.type, 'Parsed codecs support ->'], codecs);\n  }\n\n  return codecs;\n};\n\nexport default getSDPCodecsSupport;\n","import Skylink from '../../index';\nimport * as constants from '../../constants';\nimport SessionDescription from '../index';\n\nconst getCodecsSupport = roomKey => new Promise((resolve, reject) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const { beSilentOnParseLogs } = Skylink.getInitOptions();\n  const updatedState = state;\n  const { AdapterJS, RTCRtpSender, RTCPeerConnection } = window;\n\n  if (state.currentCodecSupport) {\n    resolve(state.currentCodecSupport);\n  }\n\n  updatedState.currentCodecSupport = { audio: {}, video: {} };\n\n  // Safari 11 REQUIRES a stream first before connection works, hence let's spoof it for now\n  if (AdapterJS.webrtcDetectedType === 'AppleWebKit') {\n    updatedState.currentCodecSupport.audio = {\n      opus: ['48000/2'],\n    };\n    updatedState.currentCodecSupport.video = {\n      h264: ['48000'],\n    };\n    resolve(updatedState.currentCodecSupport);\n  }\n\n  try {\n    if (window.webrtcDetectedBrowser === 'edge') {\n      const { codecs } = RTCRtpSender.getCapabilities();\n\n      for (let i = 0; i < codecs.length; i += 1) {\n        if (['audio', 'video'].indexOf(codecs[i].kind) > -1 && codecs[i].name) {\n          const codec = codecs[i].name.toLowerCase();\n          updatedState.currentCodecSupport[codecs[i].kind][codec] = codecs[i].clockRate + (codecs[i].numChannels > 1 ? `/${codecs[i].numChannels}` : '');\n        }\n      }\n      // Ignore .fecMechanisms for now\n      resolve(updatedState.currentCodecSupport);\n    } else {\n      const pc = new RTCPeerConnection(null);\n      const offerConstraints = AdapterJS.webrtcDetectedType !== 'plugin' ? {\n        offerToReceiveAudio: true,\n        offerToReceiveVideo: true,\n      } : {\n        mandatory: {\n          OfferToReceiveVideo: true,\n          OfferToReceiveAudio: true,\n        },\n      };\n\n      // Prevent errors and proceed with create offer still...\n      try {\n        const channel = pc.createDataChannel('test');\n        updatedState.binaryChunkType = channel.binaryType || state.binaryChunkType;\n        updatedState.binaryChunkType = state.binaryChunkType.toLowerCase().indexOf('array') > -1 ? constants.DATA_TRANSFER_DATA_TYPE.ARRAY_BUFFER : state.binaryChunkType;\n        // Set the value according to the property\n        const prop = Object.keys(constants.DATA_TRANSFER_DATA_TYPE);\n        for (let i = 0; i < prop.length; i += 1) {\n          // eslint-disable-next-line no-prototype-builtins\n          if (constants.DATA_TRANSFER_DATA_TYPE.hasOwnProperty(prop)\n              && state.binaryChunkType.toLowerCase() === constants.DATA_TRANSFER_DATA_TYPE[prop].toLowerCase()) {\n            updatedState.binaryChunkType = constants.DATA_TRANSFER_DATA_TYPE[prop];\n            break;\n          }\n        }\n        // eslint-disable-next-line no-empty\n      } catch (e) {}\n\n      pc.createOffer(offerConstraints)\n        .then((offer) => {\n          updatedState.currentCodecSupport = SessionDescription.getSDPCodecsSupport(null, offer, beSilentOnParseLogs);\n          resolve(updatedState.currentCodecSupport);\n        })\n        .catch((error) => {\n          reject(error);\n        });\n    }\n  } catch (error) {\n    reject(error);\n  }\n});\n\nexport default getCodecsSupport;\n","import Skylink from '../../index';\nimport logger from '../../logger';\nimport { PEER_TYPE, HANDSHAKE_PROGRESS } from '../../constants';\n\n/* eslint-disable no-param-reassign */\nconst removeSDPFilteredCandidates = (targetMid, sessionDescription, roomKey) => {\n  const initOptions = Skylink.getInitOptions();\n  const state = Skylink.getSkylinkState(roomKey);\n  // Handle Firefox MCU Peer ICE candidates\n  if (targetMid === PEER_TYPE.MCU && sessionDescription.type === HANDSHAKE_PROGRESS.ANSWER\n    && window.webrtcDetectedBrowser === 'firefox') {\n    sessionDescription.sdp = sessionDescription.sdp.replace(/ generation 0/g, '');\n    sessionDescription.sdp = sessionDescription.sdp.replace(/ udp /g, ' UDP ');\n  }\n\n  if (initOptions.forceTURN && state.hasMCU) {\n    logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Not filtering ICE candidates as '\n    + 'TURN connections are enforced as MCU is present (and act as a TURN itself) so filtering of ICE candidate '\n    + 'flags are not honoured']);\n    return sessionDescription.sdp;\n  }\n\n  if (initOptions.filterCandidatesType.host) {\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Removing \"host\" ICE candidates.']);\n    sessionDescription.sdp = sessionDescription.sdp.replace(/a=candidate:.*host.*\\r\\n/g, '');\n  }\n\n  if (initOptions.filterCandidatesType.srflx) {\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Removing \"srflx\" ICE candidates.']);\n    sessionDescription.sdp = sessionDescription.sdp.replace(/a=candidate:.*srflx.*\\r\\n/g, '');\n  }\n\n  if (initOptions.filterCandidatesType.relay) {\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Removing \"relay\" ICE candidates.']);\n    sessionDescription.sdp = sessionDescription.sdp.replace(/a=candidate:.*relay.*\\r\\n/g, '');\n  }\n  // sessionDescription.sdp = sessionDescription.sdp.replace(/a=candidate:(?!.*relay.*).*\\r\\n/g, '');\n  return sessionDescription.sdp;\n};\n\nexport default removeSDPFilteredCandidates;\n","/* eslint-disable prefer-template */\n/* eslint-disable no-useless-escape */\n/* eslint-disable no-continue */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-else-return */\n/* eslint-disable consistent-return */\nimport Skylink from '../../index';\nimport logger from '../../logger';\nimport * as constants from '../../constants';\n\nconst setSDPCodec = (targetMid, sessionDescription, roomKey, overrideSettings) => {\n  const initOptions = Skylink.getInitOptions(roomKey);\n  const parseFn = (type, codecSettings) => {\n    const codec = typeof codecSettings === 'object' ? codecSettings.codec : codecSettings;\n    let samplingRate = typeof codecSettings === 'object' ? codecSettings.samplingRate : null;\n    let channels = typeof codecSettings === 'object' ? codecSettings.channels : null;\n\n    if (codec === constants[type === 'audio' ? 'AUDIO_CODEC' : 'VIDEO_CODEC'].AUTO) {\n      logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type, `Not preferring any codec for ${type} streaming. Using browser selection.`]);\n      return;\n    }\n\n    const mLine = sessionDescription.sdp.match(new RegExp('m=' + type + ' .*\\r\\n', 'gi'));\n\n    if (!(Array.isArray(mLine) && mLine.length > 0)) {\n      logger.log.ERROR([targetMid, 'RTCSessionDesription', sessionDescription.type, `Not preferring any codec for ${type} streaming as m= line is not found.`]);\n      return;\n    }\n\n    const setLineFn = (codecsList, isSROk, isChnlsOk) => {\n      if (Array.isArray(codecsList) && codecsList.length > 0) {\n        if (!isSROk) {\n          samplingRate = null;\n        }\n        if (!isChnlsOk) {\n          channels = null;\n        }\n        logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Preferring \"' + codec + '\" (samplingRate: ' + (samplingRate || 'n/a') + ', channels: ' + (channels || 'n/a') + ') for \"' + type + '\" streaming.']);\n\n        let line = mLine[0];\n        const lineParts = line.replace('\\r\\n', '').split(' ');\n        // Set the m=x x UDP/xxx\n        line = lineParts[0] + ' ' + lineParts[1] + ' ' + lineParts[2] + ' ';\n        // Remove them to leave the codecs only\n        lineParts.splice(0, 3);\n        // Loop for the codecs list to append first\n        for (let i = 0; i < codecsList.length; i += 1) {\n          const parts = (codecsList[i].split('a=rtpmap:')[1] || '').split(' ');\n          if (parts.length < 2) {\n            continue;\n          }\n          line += parts[0] + ' ';\n        }\n        // Loop for later fallback codecs to append\n        for (let j = 0; j < lineParts.length; j += 1) {\n          if (line.indexOf(' ' + lineParts[j]) > 0) {\n            lineParts.splice(j, 1);\n            j -= 1;\n          } else if (sessionDescription.sdp.match(new RegExp('a=rtpmap:' + lineParts[j] + '\\ ' + codec + '/.*\\r\\n', 'gi'))) {\n            line += lineParts[j] + ' ';\n            lineParts.splice(j, 1);\n            j -= 1;\n          }\n        }\n        // Append the rest of the codecs\n        line += lineParts.join(' ') + '\\r\\n';\n        sessionDescription.sdp = sessionDescription.sdp.replace(mLine[0], line);\n        return true;\n      }\n    };\n\n    // If samplingRate & channels\n    if (samplingRate) {\n      if (type === 'audio' && channels && setLineFn(sessionDescription.sdp.match(new RegExp('a=rtpmap:.*\\ '\n        + codec + '\\/' + samplingRate + (channels === 1 ? '[\\/1]*' : '\\/' + channels) + '\\r\\n', 'gi')), true, true)) {\n        return;\n      } else if (setLineFn(sessionDescription.sdp.match(new RegExp('a=rtpmap:.*\\ ' + codec + '\\/' + samplingRate + '[\\/]*.*\\r\\n', 'gi')), true)) {\n        return;\n      }\n    }\n    if (type === 'audio' && channels && setLineFn(sessionDescription.sdp.match(new RegExp('a=rtpmap:.*\\ ' + codec + '\\/.*\\/' + channels + '\\r\\n', 'gi')), false, true)) {\n      return;\n    }\n\n    setLineFn(sessionDescription.sdp.match(new RegExp('a=rtpmap:.*\\ ' + codec + '\\/.*\\r\\n', 'gi')));\n  };\n\n  parseFn('audio', overrideSettings ? overrideSettings.audio : initOptions.audioCodec);\n  parseFn('video', overrideSettings ? overrideSettings.video : initOptions.videoCodec);\n\n  return sessionDescription.sdp;\n};\n\nexport default setSDPCodec;\n","/* eslint-disable prefer-template */\n/* eslint-disable prefer-destructuring */\nimport Skylink from '../../index';\nimport logger from '../../logger';\n\n// alternative to munging is to implement RTCRtpSender.setParameters()\nconst setSDPBitrate = (targetMid, sessionDescription, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const sdpLines = sessionDescription.sdp.split('\\r\\n');\n  const parseFn = function (type, bw) {\n    let mLineType = type;\n    let mLineIndex = -1;\n    let cLineIndex = -1;\n\n    if (type === 'data') {\n      mLineType = 'application';\n    }\n\n    for (let i = 0; i < sdpLines.length; i += 1) {\n      if (sdpLines[i].indexOf('m=' + mLineType) === 0) {\n        mLineIndex = i;\n      } else if (mLineIndex > 0) {\n        if (sdpLines[i].indexOf('m=') === 0) {\n          break;\n        }\n\n        if (sdpLines[i].indexOf('c=') === 0) {\n          cLineIndex = i;\n          // Remove previous b:AS settings\n        } else if (sdpLines[i].indexOf('b=AS:') === 0 || sdpLines[i].indexOf('b:TIAS:') === 0) {\n          sdpLines.splice(i, 1);\n          i -= 1;\n        }\n      }\n    }\n\n    if (!(typeof bw === 'number' && bw > 0)) {\n      logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type, `Not limiting ${type} bandwidth`]);\n      return;\n    }\n\n    if (cLineIndex === -1) {\n      logger.log.ERROR([targetMid, 'RTCSessionDesription', sessionDescription.type, `Failed setting ${type} bandwidth as c-line is missing.`]);\n      return;\n    }\n\n    // Follow RFC 4566, that the b-line should follow after c-line.\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, `Limiting maximum sending ${type} bandwidth ->`], bw);\n    sdpLines.splice(cLineIndex + 1, 0, window.webrtcDetectedBrowser === 'firefox' ? 'b=TIAS:' + (bw * 1000 * (window.webrtcDetectedVersion > 52 && window.webrtcDetectedVersion < 55 ? 1000 : 1)).toFixed(0) : 'b=AS:' + bw);\n  };\n\n  let bASAudioBw = state.streamsBandwidthSettings.bAS.audio;\n  let bASVideoBw = state.streamsBandwidthSettings.bAS.video;\n  let bASDataBw = state.streamsBandwidthSettings.bAS.data;\n  let googleXMinBw = state.streamsBandwidthSettings.googleX.min;\n  let googleXMaxBw = state.streamsBandwidthSettings.googleX.max;\n\n  if (state.peerCustomConfigs[targetMid]) {\n    if (state.peerCustomConfigs[targetMid].bandwidth\n      && typeof state.peerCustomConfigs[targetMid].bandwidth === 'object') {\n      if (typeof state.peerCustomConfigs[targetMid].bandwidth.audio === 'number') {\n        bASAudioBw = state.peerCustomConfigs[targetMid].bandwidth.audio;\n      }\n      if (typeof state.peerCustomConfigs[targetMid].bandwidth.video === 'number') {\n        bASVideoBw = state.peerCustomConfigs[targetMid].bandwidth.video;\n      }\n      if (typeof state.peerCustomConfigs[targetMid].bandwidth.data === 'number') {\n        bASDataBw = state.peerCustomConfigs[targetMid].bandwidth.data;\n      }\n    }\n    if (state.peerCustomConfigs[targetMid].googleXBandwidth && typeof state.peerCustomConfigs[targetMid].googleXBandwidth === 'object') {\n      if (typeof state.peerCustomConfigs[targetMid].googleXBandwidth.min === 'number') {\n        googleXMinBw = state.peerCustomConfigs[targetMid].googleXBandwidth.min;\n      }\n      if (typeof state.peerCustomConfigs[targetMid].googleXBandwidth.max === 'number') {\n        googleXMaxBw = state.peerCustomConfigs[targetMid].googleXBandwidth.max;\n      }\n    }\n  }\n\n  parseFn('audio', bASAudioBw);\n  parseFn('video', bASVideoBw);\n  parseFn('data', bASDataBw);\n\n  // Sets the experimental google bandwidth\n  if ((typeof googleXMinBw === 'number') || (typeof googleXMaxBw === 'number')) {\n    let codec = null;\n    let codecRtpMapLineIndex = -1;\n    let codecFmtpLineIndex = -1;\n\n    for (let j = 0; j < sdpLines.length; j += 1) {\n      if (sdpLines[j].indexOf('m=video') === 0) {\n        codec = sdpLines[j].split(' ')[3];\n      } else if (codec) {\n        if (sdpLines[j].indexOf('m=') === 0) {\n          break;\n        }\n\n        if (sdpLines[j].indexOf('a=rtpmap:' + codec + ' ') === 0) {\n          codecRtpMapLineIndex = j;\n        } else if (sdpLines[j].indexOf('a=fmtp:' + codec + ' ') === 0) {\n          sdpLines[j] = sdpLines[j].replace(/x-google-(min|max)-bitrate=[0-9]*[;]*/gi, '');\n          codecFmtpLineIndex = j;\n          break;\n        }\n      }\n    }\n\n    if (codecRtpMapLineIndex > -1) {\n      let xGoogleParams = '';\n\n      if (typeof googleXMinBw === 'number') {\n        xGoogleParams += 'x-google-min-bitrate=' + googleXMinBw + ';';\n      }\n\n      if (typeof googleXMaxBw === 'number') {\n        xGoogleParams += 'x-google-max-bitrate=' + googleXMaxBw + ';';\n      }\n\n      logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Limiting x-google-bitrate ->'], xGoogleParams);\n\n      if (codecFmtpLineIndex > -1) {\n        sdpLines[codecFmtpLineIndex] += (sdpLines[codecFmtpLineIndex].split(' ')[1] ? ';' : '') + xGoogleParams;\n      } else {\n        sdpLines.splice(codecRtpMapLineIndex + 1, 0, 'a=fmtp:' + codec + ' ' + xGoogleParams);\n      }\n    }\n  }\n\n  return sdpLines.join('\\r\\n');\n};\n\nexport default setSDPBitrate;\n","/* eslint-disable prefer-template,no-param-reassign */\nimport PeerData from '../../peer-data';\nimport Skylink from '../../index';\nimport logger from '../../logger';\n\nconst removeSDPCodecs = (targetMid, sessionDescription, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  const audioSettings = PeerData.getCurrentSessionInfo(state.room).settings.audio;\n  const initOptions = Skylink.getInitOptions();\n\n  const parseFn = (type, codec) => {\n    const payloadList = sessionDescription.sdp.match(new RegExp('a=rtpmap:(\\\\d*)\\\\ ' + codec + '.*', 'gi'));\n\n    if (!(Array.isArray(payloadList) && payloadList.length > 0)) {\n      logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type, `Not removing ${codec} as it does not exists.`]);\n      return;\n    }\n\n    for (let i = 0; i < payloadList.length; i += 1) {\n      const payload = payloadList[i].split(' ')[0].split(':')[1];\n\n      logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type,\n        'Removing \"' + codec + '\" payload ->'], payload);\n\n      sessionDescription.sdp = sessionDescription.sdp.replace(new RegExp('a=rtpmap:' + payload + '\\\\ .*\\\\r\\\\n', 'g'), '');\n      sessionDescription.sdp = sessionDescription.sdp.replace(new RegExp('a=fmtp:' + payload + '\\\\ .*\\\\r\\\\n', 'g'), '');\n      sessionDescription.sdp = sessionDescription.sdp.replace(new RegExp('a=rtpmap:\\\\d+ rtx\\\\/\\\\d+\\\\r\\\\na=fmtp:\\\\d+ apt=' + payload + '\\\\r\\\\n', 'g'), '');\n\n      // Remove the m-line codec\n      const sdpLines = sessionDescription.sdp.split('\\r\\n');\n\n      for (let j = 0; j < sdpLines.length; j += 1) {\n        if (sdpLines[j].indexOf('m=' + type) === 0) {\n          const parts = sdpLines[j].split(' ');\n\n          if (parts.indexOf(payload) >= 3) {\n            parts.splice(parts.indexOf(payload), 1);\n          }\n\n          sdpLines[j] = parts.join(' ');\n          break;\n        }\n      }\n\n      sessionDescription.sdp = sdpLines.join('\\r\\n');\n    }\n  };\n\n  if (initOptions.disableVideoFecCodecs) {\n    if (state.hasMCU) {\n      logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type,\n        'Not removing \"ulpfec\" or \"red\" codecs as connected to MCU to prevent connectivity issues.']);\n    } else {\n      parseFn('video', 'red');\n      parseFn('video', 'ulpfec');\n    }\n  }\n\n  if (initOptions.disableComfortNoiseCodec && audioSettings && typeof audioSettings === 'object' && audioSettings.stereo) {\n    parseFn('audio', 'CN');\n  }\n\n  if (window.webrtcDetectedBrowser === 'edge' && (((state.peerInformations[targetMid] || {}).agent || {}).name || 'unknown').name !== 'edge') {\n    // eslint-disable-next-line no-useless-escape\n    sessionDescription.sdp = sessionDescription.sdp.replace(/a=rtcp-fb:.*\\ x-message\\ .*\\r\\n/gi, '');\n  }\n\n  return sessionDescription.sdp;\n};\n\nexport default removeSDPCodecs;\n","import Skylink from '../../index';\nimport logger from '../../logger';\n\nconst removeSDPREMBPackets = (targetMid, sessionDescription) => {\n  const initOptions = Skylink.getInitOptions();\n  if (!initOptions.disableREMB) {\n    return sessionDescription.sdp;\n  }\n\n  logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Removing REMB packets.']);\n  return sessionDescription.sdp.replace(/a=rtcp-fb:\\d+ goog-remb\\r\\n/g, '');\n};\n\nexport default removeSDPREMBPackets;\n","/* eslint-disable no-continue,no-nested-ternary */\nimport clone from 'clone';\nimport Skylink from '../../index';\nimport logger from '../../logger';\nimport PeerData from '../../peer-data';\nimport { PEER_TYPE, BUNDLE_POLICY, HANDSHAKE_PROGRESS } from '../../constants';\nimport SessionDescription from '../index';\n\nconst handleSDPConnectionSettings = (targetMid, sessionDescription, roomKey, direction) => {\n  const state = Skylink.getSkylinkState(roomKey);\n\n  if (!state.sdpSessions[targetMid]) {\n    return sessionDescription.sdp;\n  }\n\n  const sessionDescriptionStr = sessionDescription.sdp;\n  const sdpLines = sessionDescriptionStr.split('\\r\\n');\n  const peerAgent = ((state.peerInformations[targetMid] || {}).agent || {}).name || '';\n  const bundleLineMids = [];\n  const settings = clone(state.sdpSettings);\n  let mediaType = '';\n  let bundleLineIndex = -1;\n  let mLineIndex = -1;\n\n  if (targetMid === PEER_TYPE.MCU) {\n    settings.connection.audio = true;\n    settings.connection.video = true;\n    settings.connection.data = true;\n  }\n\n  // Patches for MCU sending empty video stream despite audio+video is not sending at all\n  // Apply as a=inactive when supported\n  if (state.hasMCU) {\n    const peerStreamSettings = clone(PeerData.getPeerInfo(targetMid, state.room)).settings || {};\n    settings.direction.audio.receive = targetMid === PEER_TYPE.MCU ? true : !!peerStreamSettings.audio;\n    settings.direction.audio.send = targetMid === PEER_TYPE.MCU;\n    settings.direction.video.receive = targetMid === PEER_TYPE.MCU ? true : !!peerStreamSettings.video;\n    settings.direction.video.send = targetMid === PEER_TYPE.MCU;\n  }\n\n  if (direction === 'remote') {\n    const offerCodecs = SessionDescription.getSDPCommonSupports(targetMid, sessionDescription, roomKey);\n\n    if (!offerCodecs.audio) {\n      settings.connection.audio = false;\n    }\n\n    if (!offerCodecs.video) {\n      settings.connection.video = false;\n    }\n  }\n\n  // ANSWERER: Reject only the m= lines. Returned rejected m= lines as well.\n  // OFFERER: Remove m= lines\n\n  state.sdpSessions[targetMid][direction].mLines = [];\n  state.sdpSessions[targetMid][direction].bundleLine = '';\n  state.sdpSessions[targetMid][direction].connection = {\n    audio: null,\n    video: null,\n    data: null,\n  };\n\n  for (let i = 0; i < sdpLines.length; i += 1) {\n    // Cache the a=group:BUNDLE line used for remote answer from Edge later\n    if (sdpLines[i].indexOf('a=group:BUNDLE') === 0) {\n      state.sdpSessions[targetMid][direction].bundleLine = sdpLines[i];\n      bundleLineIndex = i;\n\n      // Check if there's a need to reject m= line\n    } else if (sdpLines[i].indexOf('m=') === 0) {\n      mediaType = (sdpLines[i].split('m=')[1] || '').split(' ')[0] || '';\n      mediaType = mediaType === 'application' ? 'data' : mediaType;\n      mLineIndex += 1;\n\n      state.sdpSessions[targetMid][direction].mLines[mLineIndex] = sdpLines[i];\n\n      // Check if there is missing unsupported video codecs support and reject it regardles of MCU Peer or not\n      if (!settings.connection[mediaType]) {\n        logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, `Removing rejected m=${mediaType} line ->`], sdpLines[i]);\n\n        // Check if answerer and we do not have the power to remove the m line if index is 0\n        // Set as a=inactive because we do not have that power to reject it somehow.\n        // first m= line cannot be rejected for BUNDLE\n        if (state.peerConnectionConfig.bundlePolicy === BUNDLE_POLICY.MAX_BUNDLE && bundleLineIndex > -1 && mLineIndex === 0 && (direction === 'remote' ? sessionDescription.type === HANDSHAKE_PROGRESS.OFFER : sessionDescription.type === HANDSHAKE_PROGRESS.ANSWER)) {\n          logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type, `Not removing rejected m='${mediaType} line ->`], sdpLines[i]);\n          settings.connection[mediaType] = true;\n          if (['audio', 'video'].indexOf(mediaType) > -1) {\n            settings.direction[mediaType].send = false;\n            settings.direction[mediaType].receive = false;\n          }\n          continue;\n        }\n\n        if (window.webrtcDetectedBrowser === 'edge') {\n          sdpLines.splice(i, 1);\n          i -= 1;\n          continue;\n        } else if (direction === 'remote' || sessionDescription.type === HANDSHAKE_PROGRESS.ANSWER) {\n          const parts = sdpLines[i].split(' ');\n          parts[1] = 0;\n          sdpLines[i] = parts.join(' ');\n          continue;\n        }\n      }\n    }\n\n    if (mediaType) {\n      // Remove lines if we are rejecting the media and ensure unless (rejectVideoMedia is true), MCU has to enable those m= lines\n      if (!settings.connection[mediaType]) {\n        sdpLines.splice(i, 1);\n        i -= 1;\n\n        // Store the mids session description\n      } else if (sdpLines[i].indexOf('a=mid:') === 0) {\n        bundleLineMids.push(sdpLines[i].split('a=mid:')[1] || '');\n\n        // Configure direction a=sendonly etc for local sessiondescription\n      } else if (mediaType && ['a=sendrecv', 'a=sendonly', 'a=recvonly'].indexOf(sdpLines[i]) > -1) {\n        if (['audio', 'video'].indexOf(mediaType) === -1) {\n          state.sdpSessions[targetMid][direction].connection.data = sdpLines[i];\n          continue;\n        }\n\n        if (direction === 'local') {\n          if (settings.direction[mediaType].send && !settings.direction[mediaType].receive) {\n            sdpLines[i] = sdpLines[i].indexOf('send') > -1 ? 'a=sendonly' : 'a=inactive';\n          } else if (!settings.direction[mediaType].send && settings.direction[mediaType].receive) {\n            sdpLines[i] = sdpLines[i].indexOf('recv') > -1 ? 'a=recvonly' : 'a=inactive';\n          } else if (!settings.direction[mediaType].send && !settings.direction[mediaType].receive) {\n            // MCU currently does not support a=inactive flag.. what do we do here?\n            sdpLines[i] = 'a=inactive';\n          }\n\n          // Handle Chrome bundle bug. - See: https://bugs.chromium.org/p/webrtc/issues/detail?id=6280\n          if (!state.hasMCU && window.webrtcDetectedBrowser !== 'firefox' && peerAgent === 'firefox'\n            && sessionDescription.type === HANDSHAKE_PROGRESS.OFFER && sdpLines[i] === 'a=recvonly') {\n            logger.log.WARN([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Overriding any original settings to receive only to send and receive to resolve chrome BUNDLE errors.']);\n            sdpLines[i] = 'a=sendrecv';\n            settings.direction[mediaType].send = true;\n            settings.direction[mediaType].receive = true;\n          }\n          // Patch for incorrect responses\n        } else if (sessionDescription.type === HANDSHAKE_PROGRESS.ANSWER) {\n          const localOfferRes = state.sdpSessions[targetMid].local.connection[mediaType];\n          // Parse a=sendonly response\n          if (localOfferRes === 'a=sendonly') {\n            sdpLines[i] = ['a=inactive', 'a=recvonly'].indexOf(sdpLines[i]) === -1 ? (sdpLines[i] === 'a=sendonly' ? 'a=inactive' : 'a=recvonly') : sdpLines[i];\n            // Parse a=recvonly\n          } else if (localOfferRes === 'a=recvonly') {\n            sdpLines[i] = ['a=inactive', 'a=sendonly'].indexOf(sdpLines[i]) === -1 ? (sdpLines[i] === 'a=recvonly' ? 'a=inactive' : 'a=sendonly') : sdpLines[i];\n            // Parse a=sendrecv\n          } else if (localOfferRes === 'a=inactive') {\n            sdpLines[i] = 'a=inactive';\n          }\n        }\n        state.sdpSessions[targetMid][direction].connection[mediaType] = sdpLines[i];\n      }\n    }\n\n    // Remove weird empty characters for Edge case.. :(\n    // eslint-disable-next-line\n    if (!(sdpLines[i] || '').replace(/\\n|\\r|\\s|\\ /gi, '')) {\n      sdpLines.splice(i, 1);\n      i -= 1;\n    }\n  }\n\n  // Fix chrome \"offerToReceiveAudio\" local offer not removing audio BUNDLE\n  if (bundleLineIndex > -1) {\n    if (state.peerConnectionConfig.bundlePolicy === BUNDLE_POLICY.MAX_BUNDLE) {\n      // eslint-disable-next-line\n      sdpLines[bundleLineIndex] = 'a=group:BUNDLE ' + bundleLineMids.join(' ');\n      // Remove a=group:BUNDLE line\n    } else if (state.peerConnectionConfig.bundlePolicy === BUNDLE_POLICY.NONE) {\n      sdpLines.splice(bundleLineIndex, 1);\n    }\n  }\n\n  // Append empty space below\n  if (window.webrtcDetectedBrowser !== 'edge') {\n    if (!sdpLines[sdpLines.length - 1].replace(/\\n|\\r|\\s/gi, '')) {\n      sdpLines[sdpLines.length - 1] = '';\n    } else {\n      sdpLines.push('');\n    }\n  }\n\n  logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Handling connection lines and direction ->'], settings);\n\n  return sdpLines.join('\\r\\n');\n};\n\nexport default handleSDPConnectionSettings;\n","import logger from '../../logger';\n\nconst removeSDPFirefoxH264Pref = (targetMid, sessionDescription) => {\n  logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Removing Firefox experimental H264 flag to ensure interopability reliability']);\n  return sessionDescription.sdp.replace(/a=fmtp:0 profile-level-id=0x42e00c;packetization-mode=1\\r\\n/g, '');\n};\n\nexport default removeSDPFirefoxH264Pref;\n","/* eslint-disable prefer-template */\n/* eslint-disable prefer-destructuring */\n/* eslint-disable consistent-return */\nimport Skylink from '../../index';\nimport logger from '../../logger';\nimport * as constants from '../../constants';\n\nconst renderSDPOutput = (targetMid, sessionDescription, roomKey) => {\n  const state = Skylink.getSkylinkState(roomKey);\n  let localStream = null;\n  let localStreamId = null;\n\n  if (!(sessionDescription && sessionDescription.sdp)) {\n    return;\n  }\n\n  if (!state.peerConnections[targetMid]) {\n    return sessionDescription.sdp;\n  }\n\n  if (state.peerConnections[targetMid].localStream) {\n    localStream = state.peerConnections[targetMid].localStream;\n    localStreamId = state.peerConnections[targetMid].localStreamId || state.peerConnections[targetMid].localStream.id;\n  }\n\n  const sdpLines = sessionDescription.sdp.split('\\r\\n');\n  // Parse and replace with the correct msid to prevent unwanted streams.\n  // Making it simple without replacing with the track IDs or labels, neither setting prefixing \"mslabel\" and \"label\" as required labels.\n  if (localStream) {\n    let mediaType = '';\n\n    for (let i = 0; i < sdpLines.length; i += 1) {\n      if (sdpLines[i].indexOf('m=') === 0) {\n        mediaType = (sdpLines[i].split('m=')[1] || '').split(' ')[0] || '';\n        mediaType = ['audio', 'video'].indexOf(mediaType) === -1 ? '' : mediaType;\n      } else if (mediaType) {\n        if (sdpLines[i].indexOf('a=msid:') === 0) {\n          const msidParts = sdpLines[i].split(' ');\n          msidParts[0] = 'a=msid:' + localStreamId;\n          sdpLines[i] = msidParts.join(' ');\n        } else if (sdpLines[i].indexOf('a=ssrc:') === 0) {\n          let ssrcParts = null;\n\n          // Replace for \"msid:\" and \"mslabel:\"\n          if (sdpLines[i].indexOf(' msid:') > 0) {\n            ssrcParts = sdpLines[i].split(' msid:');\n          } else if (sdpLines[i].indexOf(' mslabel:') > 0) {\n            ssrcParts = sdpLines[i].split(' mslabel:');\n          }\n\n          if (ssrcParts) {\n            const ssrcMsidParts = (ssrcParts[1] || '').split(' ');\n            ssrcMsidParts[0] = localStreamId;\n            ssrcParts[1] = ssrcMsidParts.join(' ');\n\n            if (sdpLines[i].indexOf(' msid:') > 0) {\n              sdpLines[i] = ssrcParts.join(' msid:');\n            } else if (sdpLines[i].indexOf(' mslabel:') > 0) {\n              sdpLines[i] = ssrcParts.join(' mslabel:');\n            }\n          }\n        }\n      }\n    }\n  }\n\n  // Replace the bundle policy to prevent complete removal of m= lines for some cases that do not accept missing m= lines except edge.\n  if (sessionDescription.type === constants.HANDSHAKE_PROGRESS.ANSWER && state.sdpSessions[targetMid]) {\n    let mLineIndex = -1;\n\n    for (let j = 0; j < sdpLines.length; j += 1) {\n      if (sdpLines[j].indexOf('a=group:BUNDLE') === 0 && state.sdpSessions[targetMid].remote.bundleLine && state.peerConnectionConfig.bundlePolicy === constants.BUNDLE_POLICY.MAX_BUNDLE) {\n        sdpLines[j] = state.sdpSessions[targetMid].remote.bundleLine;\n      } else if (sdpLines[j].indexOf('m=') === 0) {\n        mLineIndex += 1;\n        const compareA = sdpLines[j].split(' ');\n        const compareB = (state.sdpSessions[targetMid].remote.mLines[mLineIndex] || '').split(' ');\n\n        if (compareA[0] && compareB[0] && compareA[0] !== compareB[0]) {\n          compareB[1] = 0;\n          logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Appending middle rejected m= line ->'], compareB.join(' '));\n          sdpLines.splice(j, 0, compareB.join(' '));\n          j += 1;\n          mLineIndex += 1;\n        }\n      }\n    }\n\n    while (state.sdpSessions[targetMid].remote.mLines[mLineIndex + 1]) {\n      mLineIndex += 1;\n      let appendIndex = sdpLines.length;\n      if (!sdpLines[appendIndex - 1].replace(/\\s/gi, '')) {\n        appendIndex -= 1;\n      }\n      const parts = (state.sdpSessions[targetMid].remote.mLines[mLineIndex] || '').split(' ');\n      parts[1] = 0;\n      logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type,\n        'Appending later rejected m= line ->'], parts.join(' '));\n      sdpLines.splice(appendIndex, 0, parts.join(' '));\n    }\n  }\n\n  // Ensure for chrome case to have empty \"\" at last line or it will return invalid SDP errors\n  if (window.webrtcDetectedBrowser === 'edge' && sessionDescription.type === constants.HANDSHAKE_PROGRESS.OFFER && !sdpLines[sdpLines.length - 1].replace(/\\s/gi, '')) {\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type, 'Removing last empty space for Edge browsers']);\n    sdpLines.splice(sdpLines.length - 1, 1);\n  }\n\n  logger.log.INFO([targetMid, 'RTCSessionDescription', sessionDescription.type, 'Formatted output ->'], sdpLines.join('\\r\\n'));\n\n  return sdpLines.join('\\r\\n');\n};\n\nexport default renderSDPOutput;\n","import logger from '../../logger/index';\n\nconst getSDPICECandidates = (targetMid, sessionDescription, beSilentOnParseLogs) => {\n  const { RTCIceCandidate } = window;\n  // TODO: implement getSDPICECandidates\n  const candidates = {\n    host: [],\n    srflx: [],\n    relay: [],\n  };\n\n  if (!(sessionDescription && sessionDescription.sdp)) {\n    return candidates;\n  }\n\n  sessionDescription.sdp.split('m=').forEach((mediaItem, index) => {\n    // Ignore the v=0 lines etc..\n    if (index === 0) {\n      return;\n    }\n\n    // Remove a=mid: and \\r\\n\n    const sdpMid = ((mediaItem.match(/a=mid:.*\\r\\n/gi) || [])[0] || '').replace(/a=mid:/gi, '').replace(/\\r\\n/, '');\n    const sdpMLineIndex = index - 1;\n\n    (mediaItem.match(/a=candidate:.*\\r\\n/gi) || []).forEach((item) => {\n      // Remove \\r\\n for candidate type being set at the end of candidate DOM string.\n      const canType = (item.split(' ')[7] || 'host').replace(/\\r\\n/g, '');\n      candidates[canType] = candidates[canType] || [];\n      candidates[canType].push(new RTCIceCandidate({\n        sdpMid,\n        sdpMLineIndex,\n        // Remove initial \"a=\" in a=candidate\n        candidate: (item.split('a=')[1] || '').replace(/\\r\\n/g, ''),\n      }));\n    });\n  });\n\n  if (!beSilentOnParseLogs) {\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type,\n      'Parsing session description ICE candidates ->'], candidates);\n  }\n\n  return candidates;\n};\n\nexport default getSDPICECandidates;\n","/* eslint-disable prefer-destructuring,no-continue */\nimport logger from '../../logger/index';\n\nconst getSDPSelectedCodec = (targetMid, sessionDescription, type, beSilentOnParseLogs) => {\n  // TODO implement getSDPSelectedCodec\n  const codecInfo = {\n    name: null,\n    implementation: null,\n    clockRate: null,\n    channels: null,\n    payloadType: null,\n    params: null,\n  };\n\n  if (!(sessionDescription && sessionDescription.sdp)) {\n    return codecInfo;\n  }\n\n  sessionDescription.sdp.split('m=').forEach((mediaItem, index) => {\n    if (index === 0 || mediaItem.indexOf(`${type} `) !== 0) {\n      return;\n    }\n\n    const codecs = (mediaItem.split('\\r\\n')[0] || '').split(' ');\n    // Remove audio[0] 65266[1] UDP/TLS/RTP/SAVPF[2]\n    codecs.splice(0, 3);\n\n    for (let i = 0; i < codecs.length; i += 1) {\n      const match = mediaItem.match(new RegExp(`a=rtpmap:${codecs[i]}.*\\r\\n`, 'gi'));\n\n      if (!match) {\n        continue;\n      }\n\n      // Format: codec/clockRate/channels\n      const parts = ((match[0] || '').replace(/\\r\\n/g, '').split(' ')[1] || '').split('/');\n\n      // Ignore rtcp codecs, dtmf or comfort noise\n      if (['red', 'ulpfec', 'telephone-event', 'cn', 'rtx'].indexOf(parts[0].toLowerCase()) > -1) {\n        continue;\n      }\n\n      codecInfo.name = parts[0];\n      codecInfo.clockRate = parseInt(parts[1], 10) || 0;\n      codecInfo.channels = parseInt(parts[2] || '1', 10) || 1;\n      codecInfo.payloadType = parseInt(codecs[i], 10);\n      codecInfo.params = '';\n\n      // Get the list of codec parameters\n      const params = mediaItem.match(new RegExp(`a=fmtp:${codecs[i]}.*\\r\\n`, 'gi')) || [];\n      params.forEach((paramItem) => {\n        codecInfo.params += paramItem.replace(new RegExp(`a=fmtp:${codecs[i]}`, 'gi'), '').replace(/ /g, '').replace(/\\r\\n/g, '');\n      });\n      break;\n    }\n  });\n\n  if (!beSilentOnParseLogs) {\n    logger.log.INFO([targetMid, 'RTCSessionDesription', sessionDescription.type,\n      `Parsing session description \"${type}\" codecs ->`], codecInfo);\n  }\n\n  return codecInfo;\n};\n\nexport default getSDPSelectedCodec;\n","import Skylink from '../../index';\n\n/**\n * Function sets the original DTLS role which was negotiated on first offer/ansswer exchange\n * This needs to be done until https://bugzilla.mozilla.org/show_bug.cgi?id=1240897 is released in Firefox 68\n * Estimated release date for Firefox 68 : 2019-07-09 (https://wiki.mozilla.org/Release_Management/Calendar)\n * @private\n */\nconst setOriginalDTLSRole = (state, sessionDescription, isRemote) => {\n  const { room } = state;\n  const { type } = sessionDescription;\n  const invertRoleMap = { active: 'passive', passive: 'active' };\n  const aSetupPattern = sessionDescription.sdp.match(/a=setup:([a-z]+)/);\n\n  if (state.originalDTLSRole !== null || type === 'offer') {\n    return;\n  }\n\n  if (!aSetupPattern) {\n    return;\n  }\n\n  const role = aSetupPattern[1];\n  // eslint-disable-next-line\n  state.originalDTLSRole = isRemote ? invertRoleMap[role] : role;\n  Skylink.setSkylinkState(state, room.id);\n};\n\nexport default setOriginalDTLSRole;\n","/* eslint-disable no-param-reassign */\n/**\n * Function that modifies the DTLS role in answer sdp\n * This needs to be done until https://bugzilla.mozilla.org/show_bug.cgi?id=1240897 is released in Firefox 68\n * Estimated release date for Firefox 68 : 2019-07-09 (https://wiki.mozilla.org/Release_Management/Calendar)\n * @private\n */\nconst modifyDTLSRole = (state, sessionDescription) => {\n  const { originalDTLSRole } = state;\n  const { type } = sessionDescription;\n\n  if (originalDTLSRole === null || type === 'offer') {\n    return sessionDescription.sdp;\n  }\n\n  sessionDescription.sdp = sessionDescription.sdp.replace(/a=setup:[a-z]+/g, `a=setup:${originalDTLSRole}`);\n\n  return sessionDescription.sdp;\n};\n\nexport default modifyDTLSRole;\n","/* eslint-disable prefer-destructuring */\nimport logger from '../../logger';\n\nconst getTransceiverMid = (sessionDescription, beSilentOnParseLogs) => {\n  const results = {\n    audio: [],\n    video: [],\n  };\n\n  sessionDescription.sdp.split('m=').forEach((mediaItem, index) => {\n    const msidLines = mediaItem.split(/\\n/);\n    const mediaType = msidLines[0].split(' ')[0];\n    if (mediaType === 'application' || index === 0) {\n      return;\n    }\n    let parsedMline = {};\n    for (let i = 0; i < msidLines.length; i += 1) {\n      if (msidLines[i].match(/a=recvonly|a=sendonly|a=sendrecv|a=inactive/)) {\n        const array = msidLines[i].split('=');\n        parsedMline.direction = array[1].trim();\n      }\n\n      if (msidLines[i].match(/a=mid:*/)) {\n        parsedMline.transceiverMid = msidLines[i].split(/:/)[1].trim();\n      }\n      if (msidLines[i].match(/a=msid:([\\w|-|{]+)/)) { // include '{' character for firefox sdp parsing\n        const array = msidLines[i].split(' ');\n        const firstItem = array[0].split(/:/)[1].trim();\n        parsedMline.streamId = firstItem === '-' ? '' : firstItem;\n        parsedMline.trackId = array[1].trim();\n      }\n      if (parsedMline.transceiverMid && parsedMline.streamId && parsedMline.trackId) {\n        results[mediaType].push(parsedMline);\n        parsedMline = {};\n      }\n    }\n  });\n\n  if (!beSilentOnParseLogs) {\n    logger.log.INFO([null, 'RTCSessionDesription', sessionDescription.type,\n      `Parsing session description \"${sessionDescription.type}\" transceivers ->`], results);\n  }\n\n  return results;\n};\n\nexport default getTransceiverMid;\n","import helpers from './helpers/index';\n\nclass SessionDescription {\n  static getSDPCommonSupports(...args) {\n    return helpers.getSDPCommonSupports(...args);\n  }\n\n  static getCodecsSupport(...args) {\n    return helpers.getCodecsSupport(...args);\n  }\n\n  static setSDPCodecParams(...args) {\n    return helpers.setSDPCodecParams(...args);\n  }\n\n  static removeSDPFilteredCandidates(...args) {\n    return helpers.removeSDPFilteredCandidates(...args);\n  }\n\n  static setSDPCodec(...args) {\n    return helpers.setSDPCodec(...args);\n  }\n\n  static setSDPBitrate(...args) {\n    return helpers.setSDPBitrate(...args);\n  }\n\n  static removeSDPCodecs(...args) {\n    return helpers.removeSDPCodecs(...args);\n  }\n\n  static removeSDPREMBPackets(...args) {\n    return helpers.removeSDPREMBPackets(...args);\n  }\n\n  static handleSDPConnectionSettings(...args) {\n    return helpers.handleSDPConnectionSettings(...args);\n  }\n\n  static removeSDPUnknownAptRtx(...args) {\n    return helpers.removeSDPUnknownAptRtx(...args);\n  }\n\n  static getSDPCodecsSupport(...args) {\n    return helpers.getSDPCodecsSupport(...args);\n  }\n\n  static removeSDPFirefoxH264Pref(...args) {\n    return helpers.removeSDPFirefoxH264Pref(...args);\n  }\n\n  static renderSDPOutput(...args) {\n    return helpers.renderSDPOutput(...args);\n  }\n\n  static getSDPICECandidates(...args) {\n    return helpers.getSDPICECandidates(...args);\n  }\n\n  static getSDPSelectedCodec(...args) {\n    return helpers.getSDPSelectedCodec(...args);\n  }\n\n  static setOriginalDTLSRole(...args) {\n    return helpers.setOriginalDTLSRole(...args);\n  }\n\n  static modifyDTLSRole(...args) {\n    return helpers.modifyDTLSRole(...args);\n  }\n\n  static getTransceiverMid(...args) {\n    return helpers.getTransceiverMid(...args);\n  }\n}\n\nexport default SessionDescription;\n","/* eslint-disable prefer-destructuring */\nimport parsers from './index';\nimport { BROWSER_AGENT } from '../../../../constants';\n\nconst formatCanTypeFn = (type) => {\n  if (type === 'relay') {\n    return 'relayed';\n  } if (type === 'host' || type.indexOf('host') > -1) {\n    return 'local';\n  } if (type === 'srflx') {\n    return 'serverreflexive';\n  } if (type === 'prflx') {\n    return 'peerreflexive';\n  }\n  return type;\n};\n\n/**\n * Function that parses the raw stats from the RTCIceCandidatePairStats dictionary.\n * @param {SkylinkState} roomState - The room state.\n * @param {Object} output - Stats output object that stores the parsed stats values.\n * @param {RTCPeerConnection} peerConnection - The peer connection.\n * @param {String} peerId - The peer Id.\n * @param {boolean} isAutoBwStats - The flag if auto bandwidth adjustment is true.\n * @memberOf PeerConnectionStatisticsParsers\n */\nconst parseSelectedCandidatePair = (roomState, output, type, value, peerConnection, peerId, isAutoBwStats) => {\n  const { peerBandwidth, peerStats } = roomState;\n  const { raw, selectedCandidatePair } = output;\n  const { AdapterJS } = window;\n\n  const keys = Object.keys(output.raw);\n  let transportStats = null;\n  let selectedLocalCandidateId = null;\n  let selectedRemoteCandidateId = null;\n\n  if (AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.CHROME) {\n    // selectedCandidatePairId can only be obtained from RTCTransportStats and is needed to identify selected candidate pair\n    for (let i = 0; i < keys.length; i += 1) {\n      if (raw[keys[i]].type === 'transport') {\n        transportStats = raw[keys[i]];\n      }\n    }\n  } else if (AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.FIREFOX) {\n    // FF has not implemented RTCTransportStats report and uses .selected available in the  'candidate-pair' stats report\n    transportStats = {};\n  }\n\n  if (transportStats) {\n    for (let i = 0; i < keys.length; i += 1) {\n      const statsReport = raw[keys[i]];\n      if ((statsReport.type === 'candidate-pair' && statsReport.id === transportStats.selectedCandidatePairId) || (statsReport.type === 'candidate-pair' && statsReport.selected)) {\n        const candidatePairStats = statsReport;\n        selectedLocalCandidateId = candidatePairStats.localCandidateId;\n        selectedRemoteCandidateId = candidatePairStats.remoteCandidateId;\n\n        selectedCandidatePair.id = candidatePairStats.id;\n        selectedCandidatePair.writable = candidatePairStats.writable;\n        selectedCandidatePair.priority = candidatePairStats.priority;\n        selectedCandidatePair.nominated = candidatePairStats.nominated;\n\n        const prevStats = isAutoBwStats ? peerBandwidth[peerId][statsReport.id] : peerStats[peerId][statsReport.id];\n        // FF has not implemented the following stats\n        const totalRoundTripTime = parseInt(statsReport.totalRoundTripTime || '0', 10);\n        selectedCandidatePair.totalRoundTripTime = totalRoundTripTime;\n        selectedCandidatePair.roundTripTime = parsers.tabulateStats(prevStats, statsReport, 'totalRoundTripTime');\n\n        const consentRequestsSent = parseInt(statsReport.consentRequestsSent || '0', 10);\n        selectedCandidatePair.consentRequests.totalSent = consentRequestsSent;\n        selectedCandidatePair.consentRequests.sent = parsers.tabulateStats(prevStats, statsReport, 'consentRequestsSent');\n\n        const requestsReceived = parseInt(statsReport.requestsReceived || '0', 10);\n        selectedCandidatePair.requests.totalReceived = requestsReceived;\n        selectedCandidatePair.requests.received = parsers.tabulateStats(prevStats, statsReport, 'requestsReceived');\n\n        const requestsSent = parseInt(statsReport.requestsSent || '0', 10);\n        selectedCandidatePair.requests.totalSent = requestsSent;\n        selectedCandidatePair.requests.sent = parsers.tabulateStats(prevStats, statsReport, 'requestsSent');\n\n        const responsesSent = parseInt(statsReport.responsesSent || '0', 10);\n        selectedCandidatePair.responses.totalSent = responsesSent;\n        selectedCandidatePair.responses.sent = parsers.tabulateStats(prevStats, statsReport, 'responsesSent');\n\n        const responsesReceived = parseInt(statsReport.responsesReceived || '0', 10);\n        selectedCandidatePair.responses.totalReceived = responsesReceived;\n        selectedCandidatePair.responses.received = parsers.tabulateStats(prevStats, statsReport, 'responsesReceived');\n      }\n    }\n  }\n\n  if (selectedLocalCandidateId && selectedRemoteCandidateId) {\n    if (type === 'remote-candidate') {\n      const remoteCandidateStats = value;\n      if (remoteCandidateStats.id === selectedRemoteCandidateId) {\n        // FF uses address instead of ip\n        selectedCandidatePair.remote.ipAddress = remoteCandidateStats.ip ? remoteCandidateStats.ip : remoteCandidateStats.address;\n        selectedCandidatePair.remote.portNumber = remoteCandidateStats.port;\n        selectedCandidatePair.remote.transport = remoteCandidateStats.protocol;\n        selectedCandidatePair.remote.priority = remoteCandidateStats.priority;\n        selectedCandidatePair.remote.candidateType = formatCanTypeFn(remoteCandidateStats.candidateType);\n      }\n    }\n\n    if (type === 'local-candidate') {\n      const localCandidateStats = value;\n      if (localCandidateStats.id === selectedLocalCandidateId) {\n        selectedCandidatePair.local.ipAddress = localCandidateStats.ip ? localCandidateStats.ip : localCandidateStats.address;\n        selectedCandidatePair.local.portNumber = localCandidateStats.port;\n        selectedCandidatePair.local.transport = localCandidateStats.protocol;\n        selectedCandidatePair.local.priority = localCandidateStats.priority;\n        selectedCandidatePair.local.networkType = localCandidateStats.networkType;\n        selectedCandidatePair.local.candidateType = formatCanTypeFn(localCandidateStats.candidateType);\n      }\n    }\n  }\n};\n\nexport default parseSelectedCandidatePair;\n","import parseSelectedCandidatePair from './parseSelectedCandidatePair';\nimport parseCertificates from './parseCertificates';\nimport tabulateStats from './tabulateStats';\nimport parseAudio from './parseAudio';\nimport parseVideo from './parseVideo';\nimport parseMedia from './parseMedia';\n\n/**\n * @namespace PeerConnectionStatisticsParsers\n * @description Parser functions for PeerConnectionStatistics\n * @private\n * @type {{parseVideo: parseVideo, parseAudio: parseAudio, tabulateStats: tabulateStats, parseSelectedCandidatePair: parseSelectedCandidatePair, parseCertificates: parseCertificates, parseMedia: parseMedia}}\n */\nconst parsers = {\n  parseSelectedCandidatePair,\n  parseCertificates,\n  tabulateStats,\n  parseAudio,\n  parseVideo,\n  parseMedia,\n};\n\nexport default parsers;\n","/**\n * Function that parses the raw stats from the RTCCertificateStats dictionary.\n * @param {Object} output - Stats output object that stores the parsed stats values.\n * @param {Object} stats - Stats object.\n * @memberOf PeerConnectionStatisticsParsers\n */\nconst parseCertificates = (output, stats) => {\n  const { certificate, raw } = output;\n  const keys = Object.keys(output.raw);\n  let transportStats = null;\n\n  for (let i = 0; i < keys.length; i += 1) {\n    if (raw[keys[i]].type === 'transport') {\n      transportStats = raw[keys[i]];\n    }\n  }\n\n  if (transportStats) {\n    certificate.srtpCipher = transportStats.srtpCipher;\n    certificate.dtlsCipher = transportStats.dtlsCipher;\n    certificate.tlsVersion = transportStats.tlsVersion;\n\n    const { localCertificateId, remoteCertificateId } = transportStats;\n\n    if (stats.id === localCertificateId) {\n      certificate.local = {};\n      certificate.local.base64Certificate = stats.base64Certificate;\n      certificate.local.fingerprintAlgorithm = stats.fingerprintAlgorithm;\n    } else if (stats.id === remoteCertificateId) {\n      certificate.remote = {};\n      certificate.remote.base64Certificate = stats.base64Certificate;\n      certificate.remote.fingerprintAlgorithm = stats.fingerprintAlgorithm;\n    }\n  }\n};\n\nexport default parseCertificates;\n","/**\n * Function that derives that stats value using the formula Total Current Value - Total Prev Value\n * @param {Object} prevStats - The stats object from the previous retrieval.\n * @param {Object} stats - The stats object.\n * @param {String} prop - Stats dictionary identifier.\n * @return {number}\n * @memberOf PeerConnectionStatisticsParsers\n * was _parseConnectionStats in 0.6.x\n */\nconst tabulateStats = (prevStats = null, stats, prop) => {\n  const nTime = stats.timestamp;\n  const oTime = prevStats ? prevStats.timestamp || 0 : 0;\n  const nVal = parseFloat(stats[prop] || '0', 10);\n  const oVal = parseFloat(prevStats ? prevStats[prop] || '0' : '0', 10);\n\n  if ((new Date(nTime).getTime()) === (new Date(oTime).getTime())) {\n    return nVal;\n  }\n\n  return parseFloat(((nVal - oVal) / (nTime - oTime) * 1000).toFixed(3) || '0', 10);\n};\n\nexport default tabulateStats;\n","import parsers from './index';\nimport logger from '../../../../logger';\nimport { TAGS } from '../../../../constants';\nimport messages from '../../../../messages';\nimport { isANumber } from '../../../../utils/helpers';\n\n/**\n * @typedef {Object} audioStats - The Peer connection audio streaming statistics.\n * @property {JSON} audioStats.sending The Peer connection sending audio streaming statistics.\n * @property {number} audioStats.sending.bytes The Peer connection current sending audio streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {number} audioStats.sending.totalBytes The Peer connection total sending audio streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {number} audioStats.sending.packets The Peer connection current sending audio streaming packets.\n * @property {number} audioStats.sending.totalPackets The Peer connection total sending audio streaming packets.\n * @property {number} audioStats.sending.ssrc The Peer connection sending audio streaming RTP packets SSRC.\n * @property {number} audioStats.sending.roundTripTime The Peer connection sending audio streaming round-trip delay time.\n * @property {number} audioStats.sending.jitter The Peer connection sending audio streaming RTP packets jitter in seconds.\n * @property {number} audioStats.sending.retransmittedBytesSent The total number of bytes that were retransmitted for this SSRC, only including\n *   payload bytes. This is a subset of bytesSent.\n * @property {number} audioStats.sending.retransmittedPacketsSent The total number of packets that were retransmitted for this SSRC. This is a subset of packetsSent.\n * @property {JSON} [audioStats.sending.codec] - The Peer connection sending audio streaming selected codec information.\n *   Defined as <code>null</code> if local session description is not available before parsing.\n * @property {String} audioStats.sending.codec.name The Peer connection sending audio streaming selected codec name.\n * @property {number} audioStats.sending.codec.payloadType The Peer connection sending audio streaming selected codec payload type.\n * @property {String} [audioStats.sending.codec.implementation] - The Peer connection sending audio streaming selected codec implementation.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {number} [audioStats.sending.codec.channels] - The Peer connection sending audio streaming selected codec channels (2 for stereo).\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing,\n *   and this is usually present in <code>statistics.audio</code> property.\n * @property {number} [audioStats.sending.codec.clockRate] - The Peer connection sending audio streaming selected codec media sampling rate.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {String} [audioStats.sending.codec.params] - The Peer connection sending audio streaming selected codec parameters.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {number} [audioStats.sending.audioLevel] - The Peer connection audio level of the media source.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {number} [audioStats.sending.totalSamplesDuration] - The Peer connection sending audio total duration in seconds.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {number} [audioStats.sending.echoReturnLoss] - The Peer connection sending audio streaming echo return loss in db (decibels).\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {number} [audioStats.sending.echoReturnLossEnhancement] - The Peer connection sending audio streaming\n *   echo return loss enhancement db (decibels).\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {JSON} audioStats.receiving The Peer connection receiving audio streaming statistics.\n * @property {number} audioStats.receiving.bytes The Peer connection current sending audio streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {number} audioStats.receiving.totalBytes The Peer connection total sending audio streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {number} audioStats.receiving.packets The Peer connection current receiving audio streaming packets.\n * @property {number} audioStats.receiving.totalPackets The Peer connection total receiving audio streaming packets.\n * @property {number} audioStats.receiving.packetsLost The Peer connection current receiving audio streaming packets lost.\n * @property {number} audioStats.receiving.fractionLost The Peer connection current receiving audio streaming fraction packets lost.\n * @property {number} audioStats.receiving.totalPacketsLost The Peer connection total receiving audio streaming packets lost.\n * @property {number} audioStats.receiving.ssrc The Peer connection receiving audio streaming RTP packets SSRC.\n * @property {Number} audioStats.receiving.jitter The Peer connection receiving audio streaming RTP packets jitter in seconds.\n *   Defined as <code>0</code> if it's not present in original raw statistics before parsing.\n * @property {Number} audioStats.receiving.totalSamplesReceived The Peer connection total number of audio samples that\n * have been received.\n * @property {number} [audioStats.receiving.totalSamplesDuration] - The Peer connection receiving audio total duration in seconds.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {JSON} [audioStats.receiving.codec] - The Peer connection receiving audio streaming selected codec information.\n *   Defined as <code>null</code> if remote session description is not available before parsing.\n *   Note that if the value is polyfilled, the value may not be accurate since the remote Peer can override the selected codec.\n *   The value is derived from the remote session description.\n * @property {String} audioStats.receiving.codec.name The Peer connection receiving audio streaming selected codec name.\n * @property {Number} audioStats.receiving.codec.payloadType The Peer connection receiving audio streaming selected codec payload type.\n * @property {String} [audioStats.receiving.codec.implementation] - The Peer connection receiving audio streaming selected codec implementation.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {Number} [audioStats.receiving.codec.channels] - The Peer connection receiving audio streaming selected codec channels (2 for stereo).\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing,\n *   and this is usually present in <code>statistics.audio</code> property.\n * @property {Number} [audioStats.receiving.codec.clockRate] - The Peer connection receiving audio streaming selected codec media sampling rate.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {String} [audioStats.receiving.codec.params] - The Peer connection receiving audio streaming selected codec parameters.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n * @property {Number} [audioStats.receiving.audioLevel] - The Peer connection receiving audio streaming audio level.\n *   Defined as <code>null</code> if it's not available in original raw statistics.before parsing.\n */\n\nconst parseReceiving = (output, value, prevStats) => {\n  const parsedStats = output.audio.receiving;\n\n  const packetsReceived = parseInt(value.packetsReceived || '0', 10);\n  parsedStats.totalPackets = packetsReceived;\n  parsedStats.packets = parsers.tabulateStats(prevStats, value, 'packetsReceived');\n\n  const bytesReceived = parseInt(value.bytesReceived || '0', 10);\n  parsedStats.totalBytes = bytesReceived;\n  parsedStats.bytes = parsers.tabulateStats(prevStats, value, 'bytesReceived');\n\n  const packetsLost = parseInt(value.packetsLost || '0', 10);\n  parsedStats.totalPacketsLost = packetsLost;\n  parsedStats.packetsLost = parsers.tabulateStats(prevStats, value, 'packetsLost');\n\n  parsedStats.jitter = parseInt(value.jitter || '0', 10);\n  parsedStats.ssrc = value.ssrc;\n\n  const { trackId } = value;\n  const audioReceiver = output.raw[trackId];\n\n  if (audioReceiver) {\n    parsedStats.audioLevel = parseFloat(audioReceiver.audioLevel).toFixed(5);\n    parsedStats.totalSamplesReceived = parseInt(audioReceiver.totalSamplesReceived || '0', 10);\n    parsedStats.totalSamplesDuration = parseInt(audioReceiver.totalSamplesDuration || '0', 10);\n\n    // Available but unexposed stats\n    // parsedStats.totalAudioLevel = parseFloat(audioReceiver.totalAudioLevel || '0');\n    // parsedStats.jitterBufferDelay = parseInt(audioReceiver.jitterBufferDelay || '0', 10);\n    // parsedStats.jitterBufferEmittedCount = parseInt(audioReceiver.jitterBufferEmittedCount || '0', 10);\n    // parsedStats.concealedSamples = parseInt(audioReceiver.concealedSamples || '0', 10);\n    // parsedStats.silentConcealedSamples = parseInt(audioReceiver.silentConcealedSamples || '0', 10);\n    // parsedStats.concealmentEvents = parseInt(audioReceiver.concealmentEvents || '0', 10);\n    // parsedStats.insertedSamplesForDeceleration = parseInt(audioReceiver.insertedSamplesForDeceleration || '0', 10);\n    // parsedStats.removedSamplesForAcceleration = parseInt(audioReceiver.removedSamplesForAcceleration || '0', 10);\n  }\n};\n\nconst parseSending = (output, value, prevStats) => {\n  const parsedStats = output.audio.sending;\n\n  if (value.bytesSent) {\n    const bytesSent = parseInt(value.bytesSent || '0', 10);\n    parsedStats.totalBytes = bytesSent;\n    parsedStats.bytes = parsers.tabulateStats(prevStats, value, 'bytesSent');\n  }\n\n  if (value.packetsSent) {\n    const packetsSent = parseInt(value.packetsSent || '0', 10);\n    parsedStats.totalPackets = packetsSent;\n    parsedStats.packets = parsers.tabulateStats(prevStats, value, 'packetsSent');\n  }\n\n  if (value.retransmittedBytesSent || isANumber(value.retransmittedBytesSent)) {\n    const retransmittedBytesSent = parseInt(value.retransmittedBytesSent || '0', 10);\n    parsedStats.totalRetransmittedBytesSent = retransmittedBytesSent;\n    parsedStats.retransmittedBytesSent = parsers.tabulateStats(prevStats, value, 'retransmittedBytesSent');\n  }\n\n  if (value.retransmittedPacketsSent || isANumber(value.retransmittedPacketsSent)) {\n    const retransmittedPacketsSent = parseInt(value.retransmittedPacketsSent || '0', 10);\n    parsedStats.totalRetransmittedPacketsSent = retransmittedPacketsSent;\n    parsedStats.retransmittedPacketsSent = parsers.tabulateStats(prevStats, value, 'retransmittedPacketsSent');\n  }\n\n  parsedStats.ssrc = value.ssrc;\n\n  if (value.jitter) {\n    parsedStats.jitter = parseInt(value.jitter || '0', 10);\n  }\n\n  if (value.roundTripTime) {\n    parsedStats.roundTripTime = parseInt(value.roundTripTime || '0', 10);\n  }\n\n  const { trackId, mediaSourceId } = value;\n  const audioSender = output.raw[trackId];\n  if (audioSender) {\n    parsedStats.echoReturnLoss = parseInt(audioSender.echoReturnLoss || '0', 10);\n    parsedStats.echoReturnLossEnhancement = parseInt(audioSender.echoReturnLossEnhancement || '0', 10);\n  }\n\n  // Available but unexposed stats\n  // parsedStats.totalAudioLevel = parseFloat(audioSender.totalAudioLevel || '0');\n\n  const audioSource = output.raw[mediaSourceId];\n\n  if (audioSource) {\n    parsedStats.audioLevel = parseFloat(audioSource.audioLevel).toFixed(5);\n    parsedStats.totalSamplesDuration = parseInt(audioSource.totalSamplesDuration || '0', 10);\n  }\n};\n\n/**\n * Function that parses the raw stats from the RTCInboundRtpStreamStats and RTCOutboundRtpStreamStats dictionary.\n * @param {SkylinkState} state - The room state.\n * @param {Object} output - Stats output object that stores the parsed stats values.\n * @param {String} type - Stats dictionary identifier.\n * @param {RTCPeerConnection} value - Stats value.\n * @param {String} peerId - The peer Id.\n * @param {Boolean} isAutoBwStats - The flag if auto bandwidth adjustment is true.\n * @param {String} direction - The direction of the media flow, i.e. sending or receiving\n * @memberOf PeerConnectionStatisticsParsers\n */\nconst parseAudio = (state, output, type, value, peerId, isAutoBwStats, direction) => {\n  const { peerBandwidth, peerStats } = state;\n  const prevStats = isAutoBwStats ? peerBandwidth[peerId][value.id] : peerStats[peerId][value.id];\n  switch (direction) {\n    case 'receiving':\n      parseReceiving(output, value, prevStats);\n      break;\n    case 'sending':\n      parseSending(output, value, prevStats);\n      break;\n    default:\n      logger.log.DEBUG([peerId, TAGS.STATS_MODULE, null, messages.STATS_MODULE.ERRORS.PARSE_FAILED]);\n  }\n};\n\nexport default parseAudio;\n","import parsers from './index';\nimport logger from '../../../../logger';\nimport { TAGS } from '../../../../constants';\nimport messages from '../../../../messages';\n\n/**\n * @typedef videoStats - The Peer connection video streaming statistics.\n * @property {JSON} videoStats.sending The Peer connection sending video streaming statistics.\n * @property {Number} videoStats.sending.ssrc The Peer connection sending video streaming RTP packets SSRC.\n * @property {Number} videoStats.sending.bytes The Peer connection current sending video streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {Number} videoStats.sending.totalBytes The Peer connection total sending video streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {Number} videoStats.sending.packets The Peer connection current sending video streaming packets.\n * @property {Number} videoStats.sending.totalPackets The Peer connection total sending video streaming packets.\n * @property {Number} videoStats.sending.roundTripTime The Peer connection sending video streaming Round-trip delay time.\n *   Defined as <code>0</code> if it's not present in original raw statistics before parsing.\n * @property {Number} videoStats.sending.jitter <blockquote class=\"info\">\n *   This property has been deprecated and would be removed in future releases\n *   as it should not be in <code>sending</code> property.\n *   </blockquote> The Peer connection sending video streaming RTP packets jitter in seconds.\n *   Defined as <code>0</code> if it's not present in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.qpSum] - The Peer connection sending video streaming sum of the QP values of frames passed.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.frames] - The Peer connection sending video streaming frames.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.frameWidth] - The Peer connection sending video streaming frame width.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.frameHeight] - The Peer connection sending video streaming frame height.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.hugeFramesSent] - The Peer connection sending video streaming number\n * of huge frames sent by this RTP stream. Huge frames, by definition, are frames that have an encoded size at least 2.5 times the average size of the frames.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.framesPerSecond] - The Peer connection sending video streaming fps.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.framesEncoded] - The Peer connection sending video streaming frames encoded.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.nacks] - The Peer connection current sending video streaming nacks.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.totalNacks] - The Peer connection total sending video streaming nacks.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.plis] - The Peer connection current sending video streaming plis.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.totalPlis] - The Peer connection total sending video streaming plis.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.firs] - The Peer connection current sending video streaming firs.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.totalFirs] - The Peer connection total sending video streaming firs.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {JSON} [videoStats.sending.codec] - The Peer connection sending video streaming selected codec information.\n *   Defined as <code>null</code> if local session description is not available before parsing.\n * @property {String} videoStats.sending.codec.name The Peer connection sending video streaming selected codec name.\n * @property {Number} videoStats.sending.codec.payloadType The Peer connection sending video streaming selected codec payload type.\n * @property {String} [videoStats.sending.codec.implementation] - The Peer connection sending video streaming selected codec implementation.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.sending.codec.channels] - The Peer connection sending video streaming selected codec channels (2 for stereo).\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing,\n *   and this is usually present in <code>statistics.audio</code> property.\n * @property {Number} [videoStats.sending.codec.clockRate] - The Peer connection sending video streaming selected codec media sampling rate.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {String} [videoStats.sending.codec.params] - The Peer connection sending video streaming selected codec parameters.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {JSON} videoStats.receiving The Peer connection receiving video streaming statistics.\n * @property {Number} videoStats.receiving.ssrc The Peer connection receiving video streaming RTP packets SSRC.\n * @property {Number} videoStats.receiving.bytes The Peer connection current receiving video streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {Number} videoStats.receiving.totalBytes The Peer connection total receiving video streaming bytes.\n *   Note that value is in bytes so you have to convert that to bits for displaying for an example kbps.\n * @property {Number} videoStats.receiving.packets The Peer connection current receiving video streaming packets.\n * @property {Number} videoStats.receiving.totalPackets The Peer connection total receiving video streaming packets.\n * @property {Number} videoStats.receiving.packetsLost The Peer connection current receiving video streaming packets lost.\n * @property {Number} videoStats.receiving.totalPacketsLost The Peer connection total receiving video streaming packets lost.\n * @property {Number} [videoStats.receiving.frames] - The Peer connection receiving video streaming frames.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.frameWidth] - The Peer connection sending video streaming frame width.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.frameHeight] - The Peer connection sending video streaming frame height.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.framesDecoded] - The Peer connection receiving video streaming frames decoded.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.framesDroped] - The Peer connection receiving video streaming frames dropped.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.nacks] - The Peer connection current receiving video streaming nacks.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.totalNacks] - The Peer connection total receiving video streaming nacks.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.plis] - The Peer connection current receiving video streaming plis.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.totalPlis] - The Peer connection total receiving video streaming plis.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.firs] - The Peer connection current receiving video streaming firs.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.totalFirs] - The Peer connection total receiving video streaming firs.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {JSON} [videoStats.receiving.codec] - The Peer connection receiving video streaming selected codec information.\n *   Defined as <code>null</code> if remote session description is not available before parsing.\n *   Note that if the value is polyfilled, the value may not be accurate since the remote Peer can override the selected codec.\n *   The value is derived from the remote session description.\n * @property {String} videoStats.receiving.codec.name The Peer connection receiving video streaming selected codec name.\n * @property {Number} videoStats.receiving.codec.payloadType The Peer connection receiving video streaming selected codec payload type.\n * @property {String} [videoStats.receiving.codec.implementation] - The Peer connection receiving video streaming selected codec implementation.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {Number} [videoStats.receiving.codec.channels] - The Peer connection receiving video streaming selected codec channels (2 for stereo).\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing,\n *   and this is usually present in <code>statistics.audio</code> property.\n * @property {Number} [videoStats.receiving.codec.clockRate] - The Peer connection receiving video streaming selected codec media sampling rate.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n * @property {String} [videoStats.receiving.codec.params] - The Peer connection receiving video streaming selected codec parameters.\n *   Defined as <code>null</code> if it's not available in original raw statistics before parsing.\n */\n\nconst parseReceiving = (output, value, prevStats) => {\n  const parsedStats = output.video.receiving;\n\n  if (value.bytesReceived) {\n    const bytesReceived = parseInt(value.bytesReceived || '0', 10);\n    parsedStats.totalBytes = bytesReceived;\n    parsedStats.bytes = parsers.tabulateStats(prevStats, value, 'bytesReceived');\n  }\n\n  if (value.packetsReceived) {\n    const packetsReceived = parseInt(value.packetsReceived || '0', 10);\n    parsedStats.totalPackets = packetsReceived;\n    parsedStats.packets = parsers.tabulateStats(prevStats, value, 'packetsReceived');\n  }\n\n  if (Number.isInteger(value.packetsLost)) {\n    const packetsLost = parseInt(value.packetsLost || '0', 10);\n    parsedStats.totalPacketsLost = packetsLost;\n    parsedStats.packetsLost = parsers.tabulateStats(prevStats, value, 'packetsLost');\n  }\n\n  if (Number.isInteger(value.firCount)) {\n    const firsSent = parseInt(value.firCount || '0', 10);\n    parsedStats.totalFirs = firsSent;\n    parsedStats.firs = parsers.tabulateStats(prevStats, value, 'firCount');\n  }\n\n  if (Number.isInteger(value.nackCount)) {\n    const nacksSent = parseInt(value.nackCount || '0', 10);\n    parsedStats.totalNacks = nacksSent;\n    parsedStats.nacks = parsers.tabulateStats(prevStats, value, 'nackCount');\n  }\n\n  if (value.pliCount || Number.isInteger(value.pliCount)) {\n    const plisSent = parseInt(value.pliCount || '0', 10);\n    parsedStats.totalPlis = plisSent;\n    parsedStats.plis = parsers.tabulateStats(prevStats, value, 'pliCount');\n  }\n\n  parsedStats.ssrc = value.ssrc;\n  parsedStats.qpSum = parseInt(value.qpSum || '0', 10);\n  parsedStats.decoderImplementation = value.decoderImplementation;\n\n  const { trackId } = value;\n  const videoReceiver = output.raw[trackId];\n\n  if (videoReceiver) {\n    parsedStats.framesDropped = parseFloat(videoReceiver.framesDropped || '0');\n    parsedStats.frames = parseInt(videoReceiver.framesReceived || '0', 10);\n    parsedStats.framesDecoded = parseInt(videoReceiver.framesDecoded || '0', 10);\n    parsedStats.frameWidth = parseInt(videoReceiver.frameWidth || '0', 10);\n    parsedStats.frameHeight = parseInt(videoReceiver.frameHeight || '0', 10);\n  }\n};\n\nconst parseSending = (output, value, prevStats) => {\n  const parsedStats = output.video.sending;\n\n  if (value.bytesSent) {\n    const bytesSent = parseInt(value.bytesSent || '0', 10);\n    parsedStats.totalBytes = bytesSent;\n    parsedStats.bytes = parsers.tabulateStats(prevStats, value, 'bytesSent');\n  }\n\n  if (value.packetsSent) {\n    const packetsSent = parseInt(value.packetsSent || '0', 10);\n    parsedStats.totalPackets = packetsSent;\n    parsedStats.packets = parsers.tabulateStats(prevStats, value, 'packetsSent');\n  }\n\n  if (Number.isInteger(value.firCount)) {\n    const firsReceived = parseInt(value.firCount || '0', 10);\n    parsedStats.totalFirs = firsReceived;\n    parsedStats.firs = parsers.tabulateStats(prevStats, value, 'firCount');\n  }\n\n  if (Number.isInteger(value.nackCount)) {\n    const nacksReceived = parseInt(value.nackCount || '0', 10);\n    parsedStats.totalNacks = nacksReceived;\n    parsedStats.nacks = parsers.tabulateStats(prevStats, value, 'nackCount');\n  }\n\n  if (Number.isInteger(value.pliCount)) {\n    const plisReceived = parseInt(value.pliCount || '0', 10);\n    parsedStats.totalPlis = plisReceived;\n    parsedStats.plis = parsers.tabulateStats(prevStats, value, 'pliCount');\n  }\n\n  if (value.jitter) {\n    parsedStats.jitter = parseInt(value.jitter || '0', 10);\n  }\n\n  if (value.roundTripTime) {\n    parsedStats.roundTripTime = parseInt(value.roundTripTime || '0', 10);\n  }\n\n  if (Number.isInteger(value.framesEncoded)) {\n    parsedStats.framesEncoded = parseInt(value.framesEncoded || '0', 10);\n  }\n\n  parsedStats.ssrc = value.ssrc;\n  parsedStats.qpSum = parseInt(value.qpSum || '0', 10);\n\n  const { trackId, mediaSourceId } = value;\n  const videoSender = output.raw[trackId];\n\n  if (videoSender) {\n    parsedStats.frameWidth = parseInt(videoSender.frameWidth || '0', 10);\n    parsedStats.frameHeight = parseInt(videoSender.frameHeight || '0', 10);\n    parsedStats.frames = parseInt(videoSender.framesSent || '0', 10);\n    parsedStats.hugeFramesSent = parseInt(videoSender.hugeFramesSent || '0', 10);\n  }\n\n  const videoSource = output.raw[mediaSourceId];\n\n  if (videoSource) {\n    parsedStats.framesPerSecond = parseInt(videoSource.framesPerSecond || '0', 10);\n  }\n};\n\n/**\n * Function that parses the raw stats from the RTCInboundRtpStreamStats and RTCOutboundRtpStreamStats dictionary.\n * @param {SkylinkState} state - The room state.\n * @param {Object} output - Stats output object that stores the parsed stats values.\n * @param {String} type - Stats dictionary identifier.\n * @param {RTCPeerConnection} value - Stats value.\n * @param {String} peerId - The peer Id.\n * @param {Boolean} isAutoBwStats - The flag if auto bandwidth adjustment is true.\n * @param {String} direction - The direction of the media flow, i.e. sending or receiving\n * @memberOf PeerConnectionStatisticsParsers\n */\nconst parseVideo = (state, output, type, value, peerId, isAutoBwStats, direction) => {\n  const { peerBandwidth, peerStats } = state;\n  const prevStats = isAutoBwStats ? peerBandwidth[peerId][value.id] : peerStats[peerId][value.id];\n  switch (direction) {\n    case 'receiving':\n      parseReceiving(output, value, prevStats);\n      break;\n    case 'sending':\n      parseSending(output, value, prevStats);\n      break;\n    default:\n      logger.log.DEBUG([peerId, TAGS.STATS_MODULE, null, messages.STATS_MODULE.ERRORS.PARSE_FAILED]);\n  }\n};\n\nexport default parseVideo;\n","import parsers from './index';\nimport { TAGS, TRACK_KIND } from '../../../../constants';\nimport logger from '../../../../logger';\nimport messages from '../../../../messages';\n\nconst parseMedia = (state, output, type, value, peerConnection, peerId, isAutoBwStats, direction) => {\n  const trackKind = value.kind || value.mediaType; // Safari uses mediaType key\n\n  if (trackKind === TRACK_KIND.AUDIO) {\n    parsers.parseAudio(state, output, type, value, peerId, isAutoBwStats, direction);\n  } else if (trackKind === TRACK_KIND.VIDEO) {\n    parsers.parseVideo(state, output, type, value, peerId, isAutoBwStats, direction);\n  } else {\n    logger.log.DEBUG([this.peerId, TAGS.STATS_MODULE, null, messages.STATS_MODULE.INVALID_TRACK_KIND], value);\n  }\n};\n\nexport default parseMedia;\n","import Skylink from '../../../index';\nimport SessionDescription from '../../../session-description';\nimport logger from '../../../logger';\nimport messages from '../../../messages';\nimport {\n  GET_CONNECTION_STATUS_STATE, DATA_CHANNEL_TYPE, TAGS, BROWSER_AGENT,\n} from '../../../constants';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { getConnectionStatusStateChange } from '../../../skylink-events/peer-events';\nimport parsers from './parsers/index';\nimport { isEmptyObj } from '../../../utils/helpers';\n\n/**\n * @classdesc This class is used to fetch the statistics for a RTCPeerConnection\n * @class\n * @private\n */\nclass PeerConnectionStatistics {\n  constructor(roomKey, peerId) {\n    /**\n     * The current skylink state of the room\n     * @type {SkylinkState}\n     */\n    this.roomState = Skylink.getSkylinkState(roomKey);\n    /**\n     * Current RTCPeerConnection based on the peerId\n     * @type {RTCPeerConnection}\n     */\n    this.peerConnection = this.roomState.peerConnections[peerId] || null;\n    this.peerConnStatus = this.roomState.peerConnStatus[peerId] || null;\n    this.dataChannel = this.roomState.dataChannels[peerId] || null;\n    this.peerId = peerId;\n    this.roomKey = roomKey;\n    this.output = {\n      peerId,\n      raw: {},\n      connection: {},\n      audio: {\n        sending: {},\n        receiving: {},\n      },\n      video: {\n        sending: {},\n        receiving: {},\n      },\n      selectedCandidatePair: {\n        id: null,\n        local: {},\n        remote: {},\n        consentRequests: {},\n        responses: {},\n        requests: {},\n      },\n      certificate: {},\n    };\n    this.beSilentOnLogs = Skylink.getInitOptions().beSilentOnStatsLogs;\n    this.beSilentOnParseLogs = Skylink.getInitOptions().beSilentOnParseLogs;\n    this.isAutoBwStats = false;\n    this.bandwidth = null;\n  }\n\n  /**\n   * Helper function for getting RTC Connection Statistics\n   * @returns {Promise<statistics>}\n   */\n  getConnectionStatus() {\n    return this.getStatistics(false, false);\n  }\n\n  getStatsSuccess(promiseResolve, promiseReject, stats) {\n    const { AdapterJS } = window;\n    if (!stats && AdapterJS.webrtcDetectedBrowser === BROWSER_AGENT.REACT_NATIVE) {\n      // get stats in react native will resolve with 'null'\n      promiseResolve(this.output);\n      return;\n    }\n    const { peerBandwidth, peerStats, room } = this.roomState;\n    // TODO: Need to do full implementation of success function\n    if (typeof stats.forEach === 'function') {\n      stats.forEach((item, prop) => {\n        this.output.raw[prop] = item;\n      });\n    } else {\n      this.output.raw = stats;\n    }\n\n    try {\n      if (isEmptyObj(peerStats)) {\n        logger.log.DEBUG([this.peerId, TAGS.STATS_MODULE, null, messages.STATS_MODULE.STATS_DISCARDED]);\n        return;\n      }\n\n      const rawEntries = Object.entries(this.output.raw);\n      rawEntries.forEach((entry) => {\n        const key = entry[0];\n        const value = entry[1];\n        const { type } = value;\n        switch (type) {\n          case 'remote-inbound-rtp': // sender stats\n          case 'outbound-rtp':\n          case 'inbound-rtp':\n            if (type === 'inbound-rtp') {\n              parsers.parseMedia(this.roomState, this.output, type, value, this.peerConnection, this.peerId, this.isAutoBwStats, 'receiving');\n            } else {\n              parsers.parseMedia(this.roomState, this.output, type, value, this.peerConnection, this.peerId, this.isAutoBwStats, 'sending');\n            }\n            break;\n          case 'certificate':\n            parsers.parseCertificates(this.output, value);\n            break;\n          case 'local-candidate':\n          case 'remote-candidate':\n            parsers.parseSelectedCandidatePair(this.roomState, this.output, type, value, this.peerConnection, this.peerId, this.isAutoBwStats);\n            break;\n          case 'media-source':\n            parsers.parseSelectedCandidatePair(this.roomState, this.output, type, value, this.peerConnection, this.peerId, this.isAutoBwStats);\n            break;\n          default:\n            // do nothing\n        }\n\n        if (this.isAutoBwStats && !peerBandwidth[this.peerId][key]) {\n          peerBandwidth[this.peerId][key] = this.output.raw[key];\n        } else if (!this.isAutoBwStats && !peerStats[this.peerId][key]) {\n          peerStats[this.peerId][key] = this.output.raw[key];\n        }\n\n        Skylink.setSkylinkState(this.roomState, room.id);\n      });\n    } catch (err) {\n      this.getStatsFailure(promiseReject, messages.STATS_MODULE.ERRORS.PARSE_FAILED, err);\n    }\n\n    dispatchEvent(getConnectionStatusStateChange({\n      state: GET_CONNECTION_STATUS_STATE.RETRIEVE_SUCCESS,\n      peerId: this.peerId,\n      stats: this.output,\n    }));\n\n    promiseResolve(this.output);\n  }\n\n  getStatsFailure(promiseReject, errorMsg, error) {\n    const errMsg = errorMsg || messages.STATS_MODULE.RETRIEVE_STATS_FAILED;\n\n    if (!this.beSilentOnLogs) {\n      logger.log.ERROR([this.peerId, TAGS.STATS_MODULE, null, errMsg], error);\n      dispatchEvent(getConnectionStatusStateChange({\n        state: GET_CONNECTION_STATUS_STATE.RETRIEVE_ERROR,\n        peerId: this.peerId,\n        error,\n      }));\n    }\n    promiseReject(error);\n  }\n\n  /**\n   * Fetch webRTC stats of a RTCPeerConnection\n   * @param beSilentOnLogs\n   * @param isAutoBwStats\n   * @return {Promise<statistics>}\n   * @fires getConnectionStatusStateChange\n   */\n  // eslint-disable-next-line consistent-return\n  getStatistics(beSilentOnLogs = false, isAutoBwStats = false) {\n    const { STATS_MODULE } = messages;\n    return new Promise((resolve, reject) => {\n      if (!this.roomState.peerStats[this.peerId] && !isAutoBwStats) {\n        logger.log.WARN(STATS_MODULE.NOT_INITIATED);\n        resolve(null);\n      } else {\n        this.beSilentOnLogs = beSilentOnLogs;\n        this.isAutoBwStats = isAutoBwStats;\n\n        try {\n          // obtain stats from SDP that are not available in stats report or not complete\n          this.gatherRTCPeerConnectionDetails();\n          this.gatherSDPIceCandidates();\n          this.gatherSDPCodecs();\n          this.gatherRTCDataChannelDetails();\n        } catch (err) {\n          logger.log.WARN([this.peerId, TAGS.STATS_MODULE, null, messages.STATS_MODULE.ERRORS.PARSE_FAILED], err);\n        }\n\n        if (typeof this.peerConnection.getStats !== 'function') {\n          this.getStatsFailure(reject, messages.PEER_CONNECTION.getstats_api_not_available);\n        }\n\n        dispatchEvent(getConnectionStatusStateChange({\n          state: GET_CONNECTION_STATUS_STATE.RETRIEVING,\n          peerId: this.peerId,\n        }));\n\n        this.peerConnection.getStats()\n          .then((stats) => { this.getStatsSuccess(resolve, reject, stats); })\n          .catch((error) => {\n            if (error.message === messages.STATS_MODULE.ERRORS.STATS_IS_NULL) {\n              logger.log.WARN([this.peerId, TAGS.STATS_MODULE, null, messages.STATS_MODULE.ERRORS.RETRIEVE_STATS_FAILED], error.message);\n              return;\n            }\n            this.getStatsFailure(reject, null, error);\n          });\n      }\n    });\n  }\n\n  /**\n   * Formats output object with RTCPeerConnection details\n   * @private\n   */\n  gatherRTCPeerConnectionDetails() {\n    const { peerConnection } = this;\n    this.output.connection.iceConnectionState = peerConnection.iceConnectionState;\n    this.output.connection.iceGatheringState = peerConnection.iceGatheringState;\n    this.output.connection.signalingState = peerConnection.signalingState;\n\n    this.output.connection.remoteDescription = {\n      type: (peerConnection.remoteDescription && peerConnection.remoteDescription.type) || '',\n      sdp: (peerConnection.remoteDescription && peerConnection.remoteDescription.sdp) || '',\n    };\n\n    this.output.connection.localDescription = {\n      type: (peerConnection.localDescription && peerConnection.localDescription.type) || '',\n      sdp: (peerConnection.localDescription && peerConnection.localDescription.sdp) || '',\n    };\n\n    this.output.connection.constraints = this.peerConnStatus ? this.peerConnStatus.constraints : null;\n    this.output.connection.optional = this.peerConnStatus ? this.peerConnStatus.optional : null;\n    this.output.connection.sdpConstraints = this.peerConnStatus ? this.peerConnStatus.sdpConstraints : null;\n  }\n\n  /**\n   * Formats output object with Ice Candidate details\n   * @private\n   */\n  gatherSDPIceCandidates() {\n    const { peerConnection, beSilentOnParseLogs } = this;\n    this.output.connection.candidates = {\n      sending: SessionDescription.getSDPICECandidates(this.peerId, peerConnection.localDescription, beSilentOnParseLogs),\n      receiving: SessionDescription.getSDPICECandidates(this.peerId, peerConnection.remoteDescription, beSilentOnParseLogs),\n    };\n  }\n\n  /**\n   * Formats output object with SDP codecs\n   * @private\n   */\n  gatherSDPCodecs() {\n    const { peerConnection, beSilentOnParseLogs } = this;\n    this.output.audio.sending.codec = SessionDescription.getSDPSelectedCodec(this.peerId, peerConnection.remoteDescription, 'audio', beSilentOnParseLogs);\n    this.output.video.sending.codec = SessionDescription.getSDPSelectedCodec(this.peerId, peerConnection.remoteDescription, 'video', beSilentOnParseLogs);\n    this.output.audio.receiving.codec = SessionDescription.getSDPSelectedCodec(this.peerId, peerConnection.localDescription, 'audio', beSilentOnParseLogs);\n    this.output.video.receiving.codec = SessionDescription.getSDPSelectedCodec(this.peerId, peerConnection.localDescription, 'video', beSilentOnParseLogs);\n  }\n\n  /**\n   * Formats output object with RTCDataChannel details\n   * @private\n   */\n  gatherRTCDataChannelDetails() {\n    const { dataChannel } = this;\n    if (dataChannel) {\n      const dcKeys = Object.keys(dataChannel);\n\n      this.output.connection.dataChannels = {};\n\n      dcKeys.forEach((prop) => {\n        const channel = dataChannel[prop];\n        this.output.connection.dataChannels[channel.channel.label] = {\n          label: channel.channel.label,\n          readyState: channel.channel.readyState,\n          channelType: DATA_CHANNEL_TYPE[prop === 'main' ? 'MESSAGING' : 'DATA'],\n          currentTransferId: channel.transferId || null,\n          currentStreamId: channel.streamId || null,\n        };\n      });\n    }\n  }\n}\n\nexport default PeerConnectionStatistics;\n","import handleScreenStreamStates from './updateScreenStreamState';\nimport { MEDIA_TYPE, TAGS } from '../../../constants';\nimport { isEmptyObj } from '../../../utils/helpers';\nimport stopStreamHelpers from '../../../media-stream/helpers/stopStream';\nimport logger from '../../../logger';\nimport MESSAGES from '../../../messages';\n\nconst retrievePeersScreenStreamId = (state) => {\n  const { peerMedias, user } = state;\n  const peersScreenStreamId = {};\n\n  const peerIds = Object.keys(peerMedias).filter(peerId => peerId !== user.sid);\n  for (let i = 0; i < peerIds.length; i += 1) {\n    const peerId = peerIds[i];\n    Object.values(peerMedias[peerId]).forEach((mInfo) => {\n      if (mInfo.mediaType === MEDIA_TYPE.VIDEO_SCREEN) {\n        peersScreenStreamId[peerId] = mInfo.streamId;\n      }\n    });\n  }\n\n  return peersScreenStreamId;\n};\n\nconst retrievePeerScreenStream = (state) => {\n  const { remoteStreams } = state;\n  const peersScreenStreamId = retrievePeersScreenStreamId(state);\n\n  if (isEmptyObj(peersScreenStreamId)) {\n    return null;\n  }\n\n  const peersScreenStream = {};\n\n  Object.keys(peersScreenStreamId).forEach((peerId) => {\n    const peerRemoteStreams = Object.values(remoteStreams[peerId]);\n    // eslint-disable-next-line prefer-destructuring\n    peersScreenStream[peerId] = peerRemoteStreams.filter(stream => stream.id === peersScreenStreamId[peerId].id);\n  });\n\n  return peersScreenStream;\n};\n\nconst stopScreenStream = (room, screenStream, peerId, fromLeaveRoom = false) => {\n  const isScreensharing = true;\n  stopStreamHelpers.prepStopStreams(room.id, screenStream.id, fromLeaveRoom, isScreensharing)\n    .then(() => logger.log.DEBUG([peerId, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.STOP_SCREEN_SUCCESS}`]))\n    .catch(error => logger.log.DEBUG([peerId, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.ERRORS.STOP_SCREEN}`], error));\n};\n\nconst addScreenStreamCallbacks = (state, stream) => {\n  const tracks = stream.getTracks();\n  tracks.forEach((track) => {\n    // eslint-disable-next-line no-param-reassign\n    track.onended = () => stopScreenStream(state.room, stream, state.user.sid);\n  });\n};\n\nconst helpers = {\n  handleScreenStreamStates,\n  addScreenStreamCallbacks,\n  retrievePeersScreenStreamId,\n  retrievePeerScreenStream,\n  stopScreenStream,\n};\n\nexport default helpers;\n","import helpers from '../../../media-stream/helpers';\nimport Skylink from '../../../index';\nimport { dispatchEvent } from '../../../utils/skylinkEventManager';\nimport { onIncomingScreenStream } from '../../../skylink-events';\nimport PeerData from '../../../peer-data';\nimport { TRACK_KIND } from '../../../constants';\nimport PeerMedia from '../../../peer-media';\n\nconst addScreenStreamToState = (state, stream) => {\n  const { room, user } = state;\n  const settings = helpers.parseStreamSettings({ video: true });\n  const isScreensharing = true;\n  const isAudioFallback = false;\n  helpers.processStreamInState(stream, settings, room.id, isScreensharing, isAudioFallback);\n\n  dispatchEvent(onIncomingScreenStream({\n    stream,\n    peerId: user.sid,\n    room,\n    isSelf: true,\n    peerInfo: PeerData.getCurrentSessionInfo(room),\n    streamId: stream.id,\n    isVideo: stream.getVideoTracks().length > 0,\n    isAudio: stream.getAudioTracks().length > 0,\n  }));\n};\n\nconst removeScreenStreamFromState = (state) => {\n  const { room, streams } = state;\n  streams.screenshare = null;\n  Skylink.setSkylinkState(state, room.id);\n};\n\nconst setScreenStateToUnavailable = (state, stream) => {\n  const { user, room } = state;\n  const mediaId = PeerMedia.retrieveMediaId(TRACK_KIND.VIDEO, stream.id);\n  PeerMedia.setMediaStateToUnavailable(room, user.sid, mediaId);\n};\n\nexport default {\n  addScreenStreamToState,\n  removeScreenStreamFromState,\n  setScreenStateToUnavailable,\n};\n","import PeerConnectionStatistics from './helpers/statistics';\nimport helpers from './helpers/index';\nimport screenshareHelpers from '../features/screen-sharing/helpers/index';\n\n/**\n * @classdesc Class that represents a PeerConnection\n * @class\n * @private\n */\nclass PeerConnection {\n  /**\n   * @static\n   * @param {object} params - options required to create a PeerConnection\n   * @param {SkylinkRoom} params.currentRoom - The currrent state\n   * @param {String} params.targetMid - Peer's id\n   * @param {Object} params.peerBrowser - Peer's user agent object\n   * @param {RTCCertificate} params.cert - Represents a certificate that an RTCPeerConnection uses to authenticate.\n   * @param {boolean} receiveOnly\n   * @param {boolean} hasScreenshare - Is screenshare enabled\n   */\n  static addPeer(params) {\n    helpers.addPeer(params);\n  }\n\n  /**\n   * @static\n   * @param args\n   */\n  static createOffer(...args) {\n    return helpers.createOffer(...args);\n  }\n\n  /**\n   * @static\n   * @param args\n   */\n  static createAnswer(...args) {\n    return helpers.createAnswer(...args);\n  }\n\n  /**\n   * @static\n   * @param args\n   */\n  static createDataChannel(...args) {\n    return helpers.createDataChannel(...args);\n  }\n\n  /**\n   * @static\n   * @param args\n   */\n  static sendP2PMessage(...args) {\n    return helpers.sendP2PMessage(...args);\n  }\n\n  /**\n   * @static\n   * @param args\n   */\n  static getPeersInRoom(...args) {\n    return helpers.getPeersInRoom(...args);\n  }\n\n  /**\n   * Get webRTC statistics via the getStats() method of RTCPeerConnection inside a Room\n   * @param {SkylinkRoom.id} roomKey\n   * @param {String} peerId\n   * @param {boolean} beSilentOnLogs\n   * @param {boolean} isAutoBwStats - The flag if retrieveStatistics is called from BandwidthAdjuster\n   * @static\n   * @return {Promise}\n   */\n  static retrieveStatistics(roomKey, peerId, beSilentOnLogs, isAutoBwStats) {\n    const peerConnectionStatistics = new PeerConnectionStatistics(roomKey, peerId);\n    return peerConnectionStatistics.getStatistics(beSilentOnLogs, isAutoBwStats);\n  }\n\n  /**\n   * @static\n   * @param args\n   */\n  static signalingEndOfCandidates(...args) {\n    return helpers.signalingEndOfCandidates(...args);\n  }\n\n  /**\n   * Get RTCPeerConnection status\n   * @param {SkylinkState} roomState\n   * @param {String|Array} peerId\n   * @static\n   * @return {Promise<statistics>}\n   */\n  static getConnectionStatus(roomState, peerId) {\n    return helpers.getConnectionStatus(roomState, peerId);\n  }\n\n  /**\n   * Get RTCDataChannel buffer thresholds\n   * @param {RTCDataChannel.channel} channel\n   * @static\n   * @return {{bufferedAmountLow: number, bufferedAmountLowThreshold: number}}\n   */\n  static getDataChannelBuffer(channel) {\n    return helpers.getDataChannelBuffer(channel);\n  }\n\n  static refreshDataChannel(roomState, peerId) {\n    return helpers.refreshDataChannel(roomState, peerId);\n  }\n\n  static closeDataChannel(roomState, peerId) {\n    return helpers.closeDataChannel(roomState, peerId);\n  }\n\n  static refreshConnection(roomState, targetPeerId, iceRestart, options, callback) {\n    return helpers.refreshConnection(roomState, targetPeerId, iceRestart, options, callback);\n  }\n\n  static refreshPeerConnection(listOfPeers, roomState, doIceRestart, bwOptions) {\n    return helpers.refreshPeerConnection(listOfPeers, roomState, doIceRestart, bwOptions);\n  }\n\n  static getPeerScreenshare(roomState) {\n    return screenshareHelpers.retrievePeerScreenStream(roomState);\n  }\n\n  static buildPeerInformations(...args) {\n    return helpers.buildPeerInformations(...args);\n  }\n\n  static closePeerConnection(roomState, peerId) {\n    return helpers.closePeerConnection(roomState, peerId);\n  }\n\n  static updatePeerInformationsMediaStatus(roomState, peerId, transceiverMid, stream) {\n    return helpers.updatePeerInformationsMediaStatus(roomState, peerId, transceiverMid, stream);\n  }\n}\n\nexport default PeerConnection;\n","import PeerConnection from '../../peer-connection';\nimport SkylinkSignalingServer from '../../server-communication/signaling-server';\nimport mediaStreamHelpers from '../../media-stream/helpers/index';\nimport logger from '../../logger';\nimport MESSAGES from '../../messages';\nimport { isEmptyObj, isAString, updateReplacedStreamInState } from '../../utils/helpers';\nimport screenshareHelpers from './helpers/index';\nimport { TAGS } from '../../constants';\n\nconst screensharingInstance = {};\n\n/**\n * @classdesc Class used for handling Screensharing.\n * @class\n * @private\n */\nclass ScreenSharing {\n  constructor(roomState) {\n    const { room } = roomState;\n\n    if (screensharingInstance[room.id]) {\n      return screensharingInstance[room.id];\n    }\n\n    this.roomState = roomState;\n    this.stream = null;\n    this.signaling = new SkylinkSignalingServer();\n    this.isReplace = null;\n    this.streamId = null;\n\n    screensharingInstance[room.id] = this;\n  }\n\n  streamExists() {\n    const streamList = mediaStreamHelpers.getStreams(this.roomState, this.roomState.room.name);\n    const streamIds = Object.keys(streamList.userMedia);\n\n    for (let i = 0; i < streamIds.length; i += 1) {\n      if (streamIds[i] === this.streamId) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  hasMoreThanOneVideoStream() {\n    return mediaStreamHelpers.retrieveVideoStreams(this.roomState.room).length > 1;\n  }\n\n  hasUserMediaStream() {\n    const { streams } = this.roomState;\n\n    return streams.userMedia;\n  }\n\n  // TODO: Implement replace logic\n  /**\n   * Function that starts the screenshare.\n   * @param {boolean} isReplace\n   * @param {String} streamId\n   * @return {MediaStream}\n   */\n  async start(isReplace, streamId = null) {\n    this.isReplace = false;\n    this.streamId = streamId;\n\n    try {\n      this.checkForExistingScreenStreams();\n      this.checksForReplaceScreen();\n\n      this.stream = await this.startScreenCapture();\n      if (!this.stream) {\n        this.deleteScreensharingInstance(this.roomState.room);\n        return null;\n      }\n\n      screenshareHelpers.handleScreenStreamStates.addScreenStreamToState(this.roomState, this.stream, this.isReplace);\n      screenshareHelpers.addScreenStreamCallbacks(this.roomState, this.stream);\n\n      if (this.isReplace) {\n        this.replaceUserMediaStream();\n      } else {\n        this.addScreenshareStream();\n      }\n    } catch (error) {\n      logger.log.ERROR([this.roomState.user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.REPLACE_SCREEN], error);\n    }\n\n    return this.stream;\n  }\n\n  /**\n   * Function that stops the screenshare.\n   * @param {Boolean} fromLeaveRoom\n   * @return {MediaStream}\n   */\n  stop(fromLeaveRoom = false) {\n    if (!this.stream) {\n      logger.log.DEBUG([this.roomState.user.sid, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.ERRORS.STOP_SCREEN} - ${MESSAGES.MEDIA_STREAM.ERRORS.NO_STREAM}`]);\n      return null;\n    }\n\n    try {\n      screenshareHelpers.stopScreenStream(this.roomState.room, this.stream, this.roomState.user.sid, fromLeaveRoom);\n\n      this.isReplace = null;\n      this.streamId = null;\n      this.stream = null;\n    } catch (error) {\n      logger.log.ERROR([this.roomState.user.sid, TAGS.MEDIA_STREAM, null, `${MESSAGES.MEDIA_STREAM.ERRORS.STOP_SCREEN}`], error);\n    }\n    return null;\n  }\n\n  // eslint-disable-next-line\n  startScreenCapture() {\n    const { navigator } = window;\n    if (navigator.mediaDevices.getDisplayMedia) {\n      return navigator.mediaDevices.getDisplayMedia({ video: true })\n        .then(stream => stream)\n        .catch((error) => {\n          if (error.name === 'NotAllowedError') {\n            logger.log.WARN(error);\n          } else {\n            logger.log.ERROR(error);\n          }\n          return null;\n        });\n    }\n    return navigator.mediaDevices.getUserMedia({ video: { mediaSource: 'screen' } })\n      .then(stream => stream)\n      .catch((error) => {\n        logger.log.ERROR(error);\n        return null;\n      });\n  }\n\n  checksForReplaceScreen() {\n    if (!this.isReplace) return;\n\n    if (!this.hasUserMediaStream()) {\n      throw new Error(MESSAGES.MEDIA_STREAM.ERRORS.NO_USER_MEDIA_STREAMS);\n    }\n\n    if (this.hasMoreThanOneVideoStream() && !this.streamId) {\n      throw new Error(MESSAGES.MEDIA_STREAM.ERRORS.NO_STREAM_ID);\n    }\n\n    if (this.streamId && !isAString(this.streamId)) {\n      throw new Error(MESSAGES.MEDIA_STREAM.ERRORS.INVALID_STREAM_ID_TYPE);\n    }\n\n    if (this.streamId && !this.streamExists()) {\n      throw new Error(`${MESSAGES.MEDIA_STREAM.ERRORS.INVALID_STREAM_ID} - ${this.streamId}`);\n    }\n  }\n\n  checkForExistingScreenStreams() {\n    const peersScreenStream = screenshareHelpers.retrievePeersScreenStreamId(this.roomState);\n\n    if (!isEmptyObj(peersScreenStream)) {\n      logger.log.WARN([this.roomState.user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.PEER_SCREEN_ACTIVE]);\n    }\n  }\n\n  replaceUserMediaStream() {\n    const { peerConnections, streams } = this.roomState;\n    const peerIds = Object.keys(peerConnections);\n    const oldStream = this.streamId ? streams.userMedia[this.streamId].stream : mediaStreamHelpers.retrieveVideoStreams(this.roomState.room)[0];\n    const newStream = this.stream;\n\n    this.streamId = oldStream.id;\n    updateReplacedStreamInState(oldStream, newStream, this.roomState, true);\n\n    peerIds.forEach((peerId) => {\n      mediaStreamHelpers.replaceTrack(oldStream, newStream, peerId, this.roomState);\n    });\n  }\n\n  addScreenshareStream() {\n    const { peerConnections } = this.roomState;\n\n    if (!isEmptyObj(peerConnections)) {\n      PeerConnection.refreshConnection(this.roomState)\n        .catch(error => logger.log.ERROR([this.roomState.user.sid, TAGS.MEDIA_STREAM, null, MESSAGES.MEDIA_STREAM.ERRORS.START_SCREEN], error));\n    }\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  deleteScreensharingInstance(room) {\n    delete screensharingInstance[room.id];\n  }\n\n  isReplaceScreenStream() {\n    return this.isReplace;\n  }\n}\n\nexport default ScreenSharing;\n","import ScreenSharing from './features/screen-sharing';\nimport AsyncMessaging from './features/messaging/async-messaging';\nimport EncryptedMessaging from './features/messaging/encrypted-messaging';\n\nlet instance = null;\n\n/**\n * @class SkylinkStates\n * @hideconstructor\n * @classdesc Singleton Class that provides methods to access and update Skylink State\n * @private\n */\nclass SkylinkStates {\n  constructor() {\n    if (!instance) {\n      instance = this;\n    }\n\n    this.states = {};\n\n    return instance;\n  }\n\n  /**\n   * @param {SkylinkState} skylinkState\n   */\n  setState(skylinkState) {\n    this.states[skylinkState.room.id] = skylinkState;\n  }\n\n  /**\n   *\n   * @return {Object}\n   */\n  getAllStates() {\n    return this.states;\n  }\n\n  /**\n   *\n   * @param {String} roomId\n   * @return {SkylinkState}\n   */\n  getState(roomId) {\n    return this.states[roomId];\n  }\n\n  /**\n   *\n   * @param {String} roomId\n   * @return boolean\n   */\n  removeStateByRoomId(roomId) {\n    return delete this.states[roomId];\n  }\n\n  /**\n   *\n   * @param {String} roomKey\n   */\n  clearRoomStateFromSingletons(roomKey) {\n    const roomState = this.getState(roomKey);\n    new ScreenSharing(roomState).deleteScreensharingInstance(roomState.room);\n    AsyncMessaging.deleteAsyncInstance(roomState.room);\n    EncryptedMessaging.deleteEncryptedInstance(roomState.room);\n  }\n}\n\nexport default SkylinkStates;\n","import Skylink, { SkylinkConstants } from '../index';\nimport logger from '../logger';\nimport messages from '../messages';\nimport { GET_PEERS_STATE } from '../constants';\nimport SkylinkSignalingServer from '../server-communication/signaling-server';\nimport { dispatchEvent, removeEventListener, addEventListener } from '../utils/skylinkEventManager';\nimport { getPeersStateChange } from '../skylink-events';\n\n/**\n * @classdesc Class that represents a Privilege Peer methods\n * @class\n * @private\n */\nclass PeerPrivileged {\n  static shouldProceed(state, appKey, reject) {\n    let errMsg = null;\n\n    if (!state.isPrivileged) {\n      errMsg = messages.PEER_PRIVILEGED.not_privileged;\n    }\n\n    if (!appKey) {\n      errMsg = messages.PEER_PRIVILEGED.no_appkey;\n    }\n\n    if (errMsg) {\n      logger.log.DEBUG(errMsg);\n      reject(new Error(errMsg));\n    }\n\n    return !errMsg;\n  }\n\n  /**\n   * Function that retrieves the list of Peer IDs from Rooms within the same App space.\n   * @param {SkylinkRoom} room\n   * @param {boolean} showAll\n   * @return {Promise<object>}\n   * @fires getPeersStateChange\n   */\n  static getPeerList(room, showAll) {\n    return new Promise((resolve, reject) => {\n      try {\n        const state = Skylink.getSkylinkState(room.id);\n        const initOptions = Skylink.getInitOptions();\n        const pShowAll = showAll || false;\n\n        const executeCallbackAndRemoveEvtListener = (evt) => {\n          const result = evt.detail;\n\n          if (result.state === GET_PEERS_STATE.DISPATCHED) {\n            removeEventListener(SkylinkConstants.EVENTS.GET_PEERS_STATE_CHANGE, executeCallbackAndRemoveEvtListener);\n\n            dispatchEvent(getPeersStateChange({\n              state: GET_PEERS_STATE.RECEIVED,\n              privilegePeerId: state.user.sid,\n              peerList: result.peerList,\n            }));\n\n            resolve(result.peerList);\n          }\n        };\n\n        if (this.shouldProceed(state, initOptions.appKey, reject)) {\n          new SkylinkSignalingServer().getPeerList(pShowAll);\n\n          dispatchEvent(getPeersStateChange({\n            state: GET_PEERS_STATE.ENQUIRED,\n            privilegePeerId: state.user.sid,\n            peerList: null,\n          }));\n\n          logger.log.INFO(messages.PEER_PRIVILEGED.getPeerListFromServer);\n\n          addEventListener(SkylinkConstants.EVENTS.GET_PEERS_STATE_CHANGE, executeCallbackAndRemoveEvtListener);\n        }\n      } catch (error) {\n        logger.log.ERROR(error);\n        reject(error);\n      }\n    });\n  }\n}\n\nexport default PeerPrivileged;\n","import {\n  TURN_TRANSPORT,\n  AUDIO_CODEC,\n  VIDEO_CODEC,\n} from '../../constants';\n\n/**\n * @namespace initOptions\n * @private\n * @module skylink/defaultOptions\n */\nconst defaultOptions = {\n  /*\n   * @param {String} options.appKey The App Key.\n   * <small>By default, <code>init()</code> uses [HTTP CORS](https://en.wikipedia.org/wiki/Cross-origin_resource_sharing)\n   * authentication. For credentials based authentication, see the <code>options.credentials</code> configuration\n   * below. You can know more about the <a href=\"http://support.temasys.io/support/solutions/articles/\n   * 12000002712-authenticating-your-application-key-to-start-a-connection\">in the authentication methods article here</a>\n   * for more details on the various authentication methods.</small>\n   * <small>If you are using the Persistent Room feature for scheduled meetings, you will require to\n   * use the credential based authentication. See the <a href=\"http://support.temasys.io/support\n   * /solutions/articles/12000002811-using-the-persistent-room-feature-to-configure-meetings\">Persistent Room article here\n   * </a> for more information.</small>\n   */\n  defaultRoom: new Date().valueOf(),\n  appKey: null,\n  roomServer: '//api.temasys.io',\n  enableDataChannel: true,\n  enableSTUNServer: true,\n  enableTURNServer: true,\n  socketServerPath: null,\n  enableStatsGathering: true,\n  audioFallback: true,\n  socketTimeout: 7000,\n  apiTimeout: 4000,\n  forceTURNSSL: false,\n  forceTURN: false,\n  forceSSL: true,\n  usePublicSTUN: false,\n  disableVideoFecCodecs: false,\n  disableComfortNoiseCodec: false,\n  disableREMB: false,\n  throttleShouldThrowError: false,\n  mcuUseRenegoRestart: true,\n  useEdgeWebRTC: false,\n  enableSimultaneousTransfers: true,\n  TURNServerTransport: TURN_TRANSPORT.ANY,\n  credentials: null,\n  filterCandidatesType: {\n    host: false,\n    srflx: false,\n    relay: false,\n  },\n  throttleIntervals: {\n    shareScreen: 10000,\n    refreshConnection: 5000,\n    getUserMedia: 0,\n  },\n  iceServer: null,\n  socketServer: null,\n  audioCodec: AUDIO_CODEC.AUTO,\n  videoCodec: VIDEO_CODEC.AUTO,\n  codecParams: {\n    audio: {\n      opus: {\n        stereo: null,\n        'sprop-stereo': null,\n        usedtx: null,\n        useinbandfec: null,\n        maxplaybackrate: null,\n        minptime: null,\n      },\n    },\n    video: {\n      h264: {\n        profileLevelId: null,\n        levelAsymmetryAllowed: null,\n        packetizationMode: null,\n      },\n      vp8: {\n        maxFs: null,\n        maxFr: null,\n      },\n      vp9: {\n        maxFs: null,\n        maxFr: null,\n      },\n    },\n  },\n  beSilentOnStatsLogs: false,\n  beSilentOnParseLogs: false,\n};\n\n/**\n * Default values for options available to initialise SkylinkJS.\n */\nexport default defaultOptions;\n","/**\n * @classdesc Class representing a Skylink Room.\n * @class SkylinkRoom\n * @private\n */\nclass SkylinkRoom {\n  /**\n   * @param {RawApiResponse} rawApiResponse - API response received from the API Server\n   * @private\n   */\n  constructor(rawApiResponse) {\n    /**\n     * The room's id\n     * @type {String}\n     */\n    this.id = rawApiResponse.room_key;\n    /**\n     * The room's credentials\n     * @type {String}\n     */\n    this.token = rawApiResponse.roomCred;\n    /**\n     * The room start time\n     * @type {Date}\n     */\n    this.startDateTime = rawApiResponse.start;\n    /**\n     * The maximum allowed room duration\n     * @type {number}\n     */\n    this.duration = rawApiResponse.len;\n    /**\n     * The room name\n     * @type {String}\n     */\n    this.roomName = rawApiResponse.roomName;\n    /**\n     * The peer connection configuration\n     * @type {{mediaConstraints: any, peerConstraints: any, offerConstraints: any, peerConfig: {iceServers: Array}, sdpConstraints: {mandatory: {OfferToReceiveAudio: boolean, OfferToReceiveVideo: boolean}}}}\n     */\n    this.connection = {\n      peerConstraints: JSON.parse(rawApiResponse.pc_constraints),\n      offerConstraints: JSON.parse(rawApiResponse.offer_constraints),\n      sdpConstraints: {\n        mandatory: {\n          OfferToReceiveAudio: true,\n          OfferToReceiveVideo: true,\n        },\n      },\n      peerConfig: {\n        iceServers: [],\n      },\n      mediaConstraints: JSON.parse(rawApiResponse.media_constraints),\n    };\n  }\n\n  /**\n   * Get the ID/KEY of this room\n   * @return {String} id - The generated ID of the room\n   * @private\n   */\n  getRoomKey() {\n    return this.id;\n  }\n\n  /**\n   * Get the name of this room\n   * @return {String} roomName - The name of this room\n   * @private\n   */\n  getRoomName() {\n    return this.roomName;\n  }\n}\n\nexport default SkylinkRoom;\n","/**\n * @classdesc Class representing a Skylink User.\n * @class\n * @private\n */\nclass SkylinkUser {\n  /**\n   * @param {RawApiResponse} rawApiResponse - API response received from the API Server\n   */\n  constructor(rawApiResponse) {\n    /**\n     * The user id of the user\n     * @type {String}\n     */\n    this.uid = rawApiResponse.username;\n    /**\n     * The user credentials or token of the user\n     * @type {String}\n     */\n    this.token = rawApiResponse.userCred;\n    /**\n     * TimeStamp returned by API\n     * @type {Date}\n     */\n    this.timeStamp = rawApiResponse.timeStamp;\n    /**\n     * Information about this user\n     * @type {JSON}\n     */\n    this.info = {};\n    /**\n     * The socket ID of the user\n     * @type {JSON}\n     */\n    this.sid = null;\n    /**\n     * The status of whether messages via signaling server should be buffered. Messages will be buffered if it is not a handshake message and\n     * enter message has not been sent by the user.\n     * @type {Null|Boolean} Null when uninitialized i.e. no messages have been added to buffer, true when initialized i.e. messages have been\n     * added to buffer and false when enter message has been sent\n     */\n    this.bufferMessage = null;\n  }\n}\n\nexport default SkylinkUser;\n","/* eslint-disable camelcase */\nimport logger from '../logger/index';\nimport SkylinkRoom from './skylink-room';\nimport SkylinkUser from './skylink-user';\n/**\n * @classdesc Class representing a Skylink API response.\n * @class SkylinkApiResponse\n * @private\n * @param {RawApiResponse} rawApiResponse - API response received from the API Server\n */\nclass SkylinkApiResponse {\n  constructor(rawApiResponse) {\n    const {\n      offer_constraints,\n      pc_constraints,\n      cid,\n      apiOwner,\n      ipSigserver,\n      isPrivileged,\n      autoIntroduce,\n      httpPortList,\n      httpsPortList,\n      hasMCU,\n      ipSigserverPath,\n      hasPersistentMessage,\n    } = rawApiResponse;\n\n    if (!offer_constraints && !pc_constraints) {\n      logger.log.ERROR(['API', null, 'init', 'pc_constraints or offer_constraints are null']);\n    }\n    logger.log.DEBUG(['API', null, 'init', 'Parsed Peer Connection constraints:'], JSON.parse(pc_constraints));\n    logger.log.DEBUG(['API', null, 'init', 'Parsed Offer constraints'], JSON.parse(offer_constraints));\n\n    /**\n     * This is the cid received from API\n     * @type {String}\n     */\n    this.key = cid;\n    /**\n     * The owner of the App Key\n     * @type {String}\n     */\n    this.appKeyOwner = apiOwner;\n    /**\n     * If the App Key has privileged option enabled\n     * @type {boolean}\n     */\n    this.isPrivileged = isPrivileged;\n    /**\n     * If the App Key has autoIntroduce option enabled\n     * @type {boolean}\n     */\n    this.autoIntroduce = autoIntroduce;\n    /**\n     * The instance of SkylinkRoom\n     * @type {SkylinkRoom}\n     */\n    this.room = new SkylinkRoom(rawApiResponse);\n    /**\n     * The instance of SkylinkUser\n     * @type {SkylinkUser}\n     */\n    this.user = new SkylinkUser(rawApiResponse);\n    /**\n     * If the key has MCU enabled\n     * @type Boolean\n     */\n    this.hasMCU = hasMCU;\n    /**\n     * The endpoint of the signaling server\n     * @type {String}\n     */\n    this.socketServer = ipSigserver;\n    /**\n     * The socket server version path of the signaling server\n     * @type {String}\n     */\n    this.socketServerPath = ipSigserverPath;\n    /**\n     * The socket server ports\n     * @type {String}\n     */\n    this.socketPorts = {\n      'http:': Array.isArray(httpPortList) && httpPortList.length > 0 ? httpPortList : [80, 3000],\n      'https:': Array.isArray(httpsPortList) && httpsPortList.length > 0 ? httpsPortList : [443, 3443],\n    };\n\n    this.hasPersistentMessage = hasPersistentMessage;\n  }\n}\n\nexport default SkylinkApiResponse;\n","import MESSAGES from '../../messages';\nimport logger from '../../logger/index';\nimport SessionDescription from '../../session-description';\nimport ApiResponse from '../../models/api-response';\nimport { readyStateChange } from '../../skylink-events';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport {\n  API_VERSION,\n  READY_STATE_CHANGE,\n  READY_STATE_CHANGE_ERROR,\n  SDK_NAME,\n  SDK_VERSION,\n  SIGNALING_VERSION,\n} from '../../constants';\nimport Skylink from '../../index';\n\nconst getEndPoint = (options) => {\n  const {\n    roomServer,\n    appKey,\n    defaultRoom,\n    credentials,\n    forceSSL,\n  } = options;\n  let path = `${roomServer}/api/${appKey}/${defaultRoom}`;\n  let urlChar = '?';\n  path = forceSSL ? `https:${path}` : `${window.location.protocol}${path}`;\n\n  if (credentials) {\n    const { startDateTime, duration } = credentials;\n    path += `/${startDateTime}/${duration}?cred=${credentials.credentials}`;\n    urlChar = '&';\n  }\n\n  path += `${urlChar}rand=${Date.now()}`;\n  return path;\n};\n\nconst logAPIResponse = (response) => {\n  const { status, ok } = response;\n  const loggerMethod = ok ? 'INFO' : 'ERROR';\n  let message = MESSAGES.INIT.INFO.API_SUCCESS;\n  if (!ok) {\n    message = MESSAGES.INIT.ERRORS.AUTH_GENERAL;\n    if (status === 403) {\n      message = MESSAGES.INIT.ERRORS.AUTH_CORS;\n    }\n  }\n  logger.log[loggerMethod](['API', null, 'auth', message], response);\n};\n\nexport const validateOptions = (options) => {\n  const { appKey } = options;\n  const toReturn = {\n    isValid: true,\n    message: '',\n  };\n  logger.log.INFO(['API', null, 'init', 'API initialised with options:'], options);\n  if (!appKey) {\n    toReturn.isValid = false;\n    toReturn.message = MESSAGES.INIT.ERRORS.NO_APP_KEY;\n    dispatchEvent(readyStateChange({\n      readyState: READY_STATE_CHANGE.ERROR,\n      error: {\n        status: -2,\n        content: new Error(MESSAGES.INIT.ERRORS.NO_APP_KEY),\n        errorCode: READY_STATE_CHANGE_ERROR.NO_PATH,\n      },\n      room: null,\n    }));\n  }\n  if (!toReturn.isValid) {\n    logger.log.ERROR(['API', null, 'init', toReturn.message]);\n  }\n  return toReturn;\n};\n\nexport const validateAPIResponse = (response) => {\n  const { ok } = response;\n  logAPIResponse(response);\n  return ok;\n};\n\nexport const parseAndMutateOptions = (options) => {\n  const updatedOptions = options;\n  // Force TURN connections should enforce settings.\n  if (updatedOptions.forceTURN === true) {\n    updatedOptions.enableTURNServer = true;\n    updatedOptions.enableSTUNServer = false;\n    updatedOptions.filterCandidatesType.host = true;\n    updatedOptions.filterCandidatesType.srflx = true;\n    updatedOptions.filterCandidatesType.relay = false;\n  }\n\n  return updatedOptions;\n};\n\nexport const enforceUserInitOptions = (apiResponse) => {\n  const userInitOptions = Skylink.getUserInitOptions();\n  const initOptions = Skylink.getInitOptions();\n  let updatedInitOptions = Object.assign(initOptions, apiResponse, userInitOptions);\n  const optionsValidity = validateOptions(updatedInitOptions);\n\n  if (!optionsValidity.isValid) {\n    throw new Error(optionsValidity.message);\n  }\n\n  updatedInitOptions = parseAndMutateOptions(updatedInitOptions);\n  Skylink.setInitOptions(updatedInitOptions);\n\n  return updatedInitOptions;\n};\n\nexport const authenticateApp = async (options) => {\n  const { fetch } = window;\n  const endpoint = getEndPoint(options);\n  const apiResponse = await fetch(endpoint, {\n    headers: {\n      Skylink_SDK_type: SDK_NAME.WEB,\n      Skylink_SDK_version: SDK_VERSION,\n      Skylink_API_version: API_VERSION,\n      'X-Server-Select': SIGNALING_VERSION,\n    },\n  });\n\n  return {\n    endpoint,\n    response: apiResponse,\n  };\n};\n\nexport const parseAPIResponseBody = (responseBody) => {\n  const apiResponse = new ApiResponse(responseBody);\n  return apiResponse;\n};\n\nconst testRTCPeerConnection = () => {\n  try {\n    const p = new window.RTCPeerConnection(null);\n    // IE returns as typeof object\n    return ['object', 'function'].indexOf(typeof p.createOffer) > -1 && p.createOffer !== null;\n  } catch (e) {\n    return false;\n  }\n};\n\nexport const webRTCReadyOperations = () => {\n  const { AdapterJS } = window;\n  const returnObject = {\n    ready: true,\n    message: '',\n  };\n  if (!testRTCPeerConnection()) {\n    if (window.RTCPeerConnection && AdapterJS.webrtcDetectedType === 'plugin') {\n      returnObject.message = 'Plugin is not available. Please check plugin status.';\n    } else {\n      returnObject.message = 'WebRTC not supported. Please upgrade your browser';\n    }\n    returnObject.ready = false;\n    dispatchEvent(readyStateChange({\n      readyState: READY_STATE_CHANGE.ERROR,\n      error: {\n        status: -2,\n        content: new Error(AdapterJS.webrtcDetectedType === 'plugin' && window.RTCPeerConnection ? 'Plugin is not available' : 'WebRTC not available'),\n        errorCode: READY_STATE_CHANGE_ERROR.NO_WEBRTC_SUPPORT,\n      },\n      room: null,\n    }));\n  }\n  return returnObject;\n};\n\nexport const codecSupport = roomKey => new Promise((resolve, reject) => {\n  SessionDescription.getCodecsSupport(roomKey)\n    .then((currentCodecSupport) => {\n      const state = Skylink.getSkylinkState(roomKey);\n      const { room } = state;\n\n      if (Object.keys(currentCodecSupport.audio).length === 0 && Object.keys(currentCodecSupport.video).length === 0) {\n        logger.log.ERROR(MESSAGES.JOIN_ROOM.ERRORS.CODEC_SUPPORT);\n        dispatchEvent(readyStateChange({\n          readyState: READY_STATE_CHANGE.ERROR,\n          error: {\n            status: -2,\n            content: new Error(MESSAGES.JOIN_ROOM.ERRORS.CODEC_SUPPORT),\n            errorCode: READY_STATE_CHANGE_ERROR.PARSE_CODECS,\n          },\n          room: room.roomName,\n        }));\n        reject(new Error(MESSAGES.JOIN_ROOM.ERRORS.CODEC_SUPPORT));\n      } else {\n        resolve(true);\n      }\n\n      state.currentCodecSupport = currentCodecSupport;\n      Skylink.setSkylinkState(state);\n    })\n    .catch((error) => {\n      const state = Skylink.getSkylinkState(roomKey);\n      const { room } = state;\n\n      logger.log.ERROR(error);\n      dispatchEvent(readyStateChange({\n        readyState: READY_STATE_CHANGE.ERROR,\n        error: {\n          status: -2,\n          content: new Error(error.message || error.toString()),\n          errorCode: READY_STATE_CHANGE_ERROR.PARSE_CODECS,\n        },\n        room: room.roomName,\n      }));\n      reject(new Error(error.message || error.toString()));\n    });\n});\n","/* eslint-disable class-methods-use-this */\nimport defaultOptions from './defaultOptions';\nimport { validateDepencies } from '../../compatibility/index';\nimport {\n  authenticateApp,\n  parseAndMutateOptions,\n  validateOptions,\n  parseAPIResponseBody,\n  validateAPIResponse,\n  webRTCReadyOperations,\n  codecSupport,\n  enforceUserInitOptions,\n} from './api-helpers';\nimport Skylink from '../../index';\nimport { getStateByKey } from '../../utils/helpers';\nimport { dispatchEvent } from '../../utils/skylinkEventManager';\nimport { READY_STATE_CHANGE, READY_STATE_CHANGE_ERROR } from '../../constants';\nimport { readyStateChange } from '../../skylink-events';\n\nlet instance = null;\n\n/**\n * @class\n * @classdesc Singleton class that represents a API server.\n * @private\n */\nclass SkylinkAPIServer {\n  constructor() {\n    if (!instance) {\n      instance = this;\n    }\n\n    this.options = {};\n\n    return instance;\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  init(options = defaultOptions) {\n    if (options) {\n      if (options.socketServer) { // set socketServerPath to override socketServerPath value returned from api that only works with default sig\n        // server url\n        // eslint-disable-next-line no-param-reassign\n        options.socketServerPath = '';\n      }\n      Skylink.setUserInitOptions(options);\n    }\n    dispatchEvent(readyStateChange({\n      readyState: READY_STATE_CHANGE.INIT,\n      error: null,\n      room: null,\n    }));\n    const dependencies = validateDepencies();\n    const { AdapterJS } = window;\n    if (!dependencies.fulfilled) {\n      dispatchEvent(readyStateChange({\n        readyState: READY_STATE_CHANGE.ERROR,\n        error: {\n          status: -2,\n          content: new Error(dependencies.message),\n          errorCode: dependencies.readyStateChangeErrorCode,\n        },\n        room: null,\n      }));\n      throw new Error(dependencies.message);\n    }\n\n    let initOptions = Object.assign({}, defaultOptions, options);\n    const optionsValidity = validateOptions(initOptions);\n    if (!optionsValidity.isValid) {\n      throw new Error(optionsValidity.message);\n    }\n    AdapterJS.webRTCReady(() => {\n      const webrtcReady = webRTCReadyOperations();\n      if (!webrtcReady.ready) {\n        throw new Error(webrtcReady.message);\n      }\n    });\n    initOptions = parseAndMutateOptions(initOptions);\n    return initOptions;\n  }\n\n  createRoom(room) {\n    return new Promise((resolve, reject) => {\n      const initOptions = Skylink.getInitOptions();\n      initOptions.defaultRoom = room;\n      authenticateApp(initOptions).then((result) => {\n        const { endpoint, response } = result;\n        const isResponseValid = validateAPIResponse(response);\n        if (isResponseValid) {\n          dispatchEvent(readyStateChange({\n            readyState: READY_STATE_CHANGE.COMPLETED,\n            error: null,\n            room,\n          }));\n          response.json().then((apiResponse) => {\n            resolve({\n              endpoint,\n              response: apiResponse,\n            });\n          });\n        } else {\n          dispatchEvent(readyStateChange({\n            readyState: READY_STATE_CHANGE.ERROR,\n            error: {\n              status: response.status,\n              content: new Error(response.info || `XMLHttpRequest status not OK\\nStatus was: ${response.status}`),\n              errorCode: response.error || response.status,\n            },\n            room,\n          }));\n          reject(response.json());\n        }\n      }).catch((error) => {\n        dispatchEvent(readyStateChange({\n          readyState: READY_STATE_CHANGE.ERROR,\n          error: {\n            status: error.status || -1,\n            content: new Error(error.message || 'Network error occurred'),\n            errorCode: READY_STATE_CHANGE_ERROR.XML_HTTP_REQUEST_ERROR,\n          },\n          room,\n        }));\n      });\n    });\n  }\n\n  checkCodecSupport(roomKey) {\n    return codecSupport(roomKey);\n  }\n\n  static parseAPIResponseBody(response) {\n    return parseAPIResponseBody(response);\n  }\n\n  enforceUserInitOptions(response) {\n    return enforceUserInitOptions(response);\n  }\n\n  static getRoomNameFromParams(params) {\n    const initOptions = Skylink.getInitOptions();\n    const { roomName } = params;\n    const { defaultRoom } = initOptions;\n    let room = null;\n    if (typeof roomName !== 'undefined' && roomName !== '' && defaultRoom !== roomName) {\n      room = roomName;\n    } else {\n      room = defaultRoom;\n    }\n    return room;\n  }\n\n  static getStateByKey(roomKey) {\n    return getStateByKey(roomKey);\n  }\n}\n\nexport default SkylinkAPIServer;\n","import Skylink, { SkylinkConstants } from '../index';\nimport {\n  SERVER_PEER_TYPE, PEER_CONNECTION_STATE, DATA_CHANNEL_STATE, PEER_TYPE,\n} from '../constants';\nimport PeerData from '../peer-data';\nimport { SkylinkSignalingServer } from '../server-communication/index';\nimport { peerLeft, serverPeerLeft } from '../skylink-events';\nimport { dispatchEvent, addEventListener, removeEventListener } from '../utils/skylinkEventManager';\nimport logger from '../logger/index';\nimport PeerConnection from '../peer-connection/index';\nimport stopStreamHelpers from '../media-stream/helpers/stopStream/index';\nimport ScreenSharing from '../features/screen-sharing';\nimport MESSAGES from '../messages';\nimport { isEmptyArray } from '../utils/helpers';\n\n/**\n * Emits the peerLeft event when current peer left the room.\n * @param {SkylinkState} state\n * @param {String} peerId\n * @private\n */\nconst executePeerLeftProcess = (state, peerId) => new Promise((resolve) => {\n  const { room, peerConnections } = state;\n  const { ROOM: { LEAVE_ROOM } } = MESSAGES;\n  const { enableDataChannel } = Skylink.getInitOptions();\n\n  logger.log.INFO([peerId, room.roomName, null, LEAVE_ROOM.PEER_LEFT.START]);\n\n  if (peerId === PEER_TYPE.MCU) {\n    dispatchEvent(serverPeerLeft({\n      peerId,\n      serverPeerType: SERVER_PEER_TYPE.MCU,\n      room,\n    }));\n  } else {\n    dispatchEvent(peerLeft({\n      peerId,\n      peerInfo: PeerData.getCurrentSessionInfo(room),\n      isSelf: false,\n      room,\n    }));\n  }\n\n  if (peerConnections[peerId] && peerConnections[peerId].signalingState !== PEER_CONNECTION_STATE.CLOSED) {\n    PeerConnection.closePeerConnection(state, peerId);\n  }\n\n  if (enableDataChannel) {\n    addEventListener(SkylinkConstants.EVENTS.DATA_CHANNEL_STATE, (evt) => {\n      const { detail } = evt;\n      if (detail.state === DATA_CHANNEL_STATE.CLOSED || detail.state === DATA_CHANNEL_STATE.CLOSING) {\n        logger.log.INFO([detail.peerId, room.roomName, null, LEAVE_ROOM.PEER_LEFT.SUCCESS]);\n        resolve(detail.peerId);\n      }\n    });\n\n    PeerConnection.closeDataChannel(state, peerId);\n  } else {\n    resolve(peerId);\n  }\n});\n\n/**\n * Method that sends a bye message to the all the peers in order remove the peer information or disconnects the socket connection.\n * @param state\n * @returns {Promise<SkylinkState>}\n * @private\n */\nconst sendByeOrDisconnectSocket = state => new Promise((resolve) => {\n  const updatedState = Skylink.getSkylinkState(state.room.id);\n  const { room, peerConnections } = updatedState;\n  const { ROOM: { LEAVE_ROOM } } = MESSAGES;\n  const skylinkSignalingServer = new SkylinkSignalingServer();\n  const isInMoreThanOneRoom = Object.keys(Skylink.getSkylinkState()).length > 1;\n\n  updatedState.inRoom = false;\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  if (isInMoreThanOneRoom) {\n    // broadcast bye to all peers in the room if there is more than one room\n    logger.log.INFO([room.roomName, null, null, LEAVE_ROOM.SENDING_BYE]);\n    Object.keys(peerConnections).forEach((peerId) => {\n      skylinkSignalingServer.bye(updatedState, peerId);\n    });\n    resolve(updatedState);\n  } else {\n    // disconnect socket if it is the last room\n    skylinkSignalingServer.config = skylinkSignalingServer.resetSocketConfig(window.location.protocol);\n\n    const handleChannelClose = () => {\n      logger.log.INFO([room.roomName, null, null, LEAVE_ROOM.DISCONNECT_SOCKET.SUCCESS]);\n      removeEventListener(SkylinkConstants.EVENTS.CHANNEL_CLOSE, handleChannelClose);\n      resolve(updatedState);\n    };\n\n    addEventListener(SkylinkConstants.EVENTS.CHANNEL_CLOSE, handleChannelClose);\n\n    if (skylinkSignalingServer.socket.connected) {\n      skylinkSignalingServer.socket.disconnect();\n    } else {\n      resolve(updatedState);\n    }\n  }\n});\n\n/**\n * Stops streams within a Skylink state.\n * @private\n * @param {SkylinkState} state\n */\nconst stopStreams = (state) => {\n  const { room, streams } = state;\n\n  if (streams.userMedia) {\n    stopStreamHelpers.prepStopStreams(room.id, null, true);\n  }\n\n  if (streams.screenshare) {\n    new ScreenSharing(state).stop(true);\n  }\n};\n\nconst clearRoomState = (roomKey) => {\n  Skylink.clearRoomStateFromSingletons(roomKey);\n  Skylink.removeSkylinkState(roomKey);\n};\n\n/**\n * Method that starts the peer left process.\n * @param {SkylinkState} roomState\n * @private\n */\nexport const leaveRoom = roomState => new Promise((resolve, reject) => {\n  const {\n    peerConnections, peerInformations, room, hasMCU, user,\n  } = roomState;\n  const { ROOM: { LEAVE_ROOM } } = MESSAGES;\n\n  try {\n    const peerIds = hasMCU ? [PEER_TYPE.MCU] : Array.from(new Set([...Object.keys(peerConnections), ...Object.keys(peerInformations)]));\n\n    if (isEmptyArray(peerIds)) {\n      logger.log.DEBUG([room.roomName, null, null, LEAVE_ROOM.NO_PEERS]);\n      stopStreams(roomState);\n      sendByeOrDisconnectSocket(roomState)\n        .then((removedState) => {\n          logger.log.INFO([room.roomName, null, null, LEAVE_ROOM.REMOVE_STATE.SUCCESS]);\n          dispatchEvent(peerLeft({\n            peerId: user.sid,\n            peerInfo: PeerData.getCurrentSessionInfo(room),\n            isSelf: true,\n            room,\n          }));\n          clearRoomState(removedState.room.id);\n          resolve(removedState.room.roomName);\n        });\n    } else {\n      const peerLeftPromises = [];\n\n      peerIds.forEach((peerId) => {\n        peerLeftPromises.push(executePeerLeftProcess(roomState, peerId));\n      });\n\n      Promise.all(peerLeftPromises)\n        .then(() => {\n          stopStreams(roomState);\n          return sendByeOrDisconnectSocket(roomState);\n        })\n        .then((removedState) => {\n          logger.log.INFO([room.roomName, null, null, LEAVE_ROOM.REMOVE_STATE.SUCCESS]);\n          dispatchEvent(peerLeft({\n            peerId: user.sid,\n            peerInfo: PeerData.getCurrentSessionInfo(room),\n            isSelf: true,\n            room,\n          }));\n          clearRoomState(removedState.room.id);\n          resolve(removedState.room.roomName);\n        });\n    }\n  } catch (error) {\n    logger.log.ERROR([room.roomName, null, null, LEAVE_ROOM.ERROR], error);\n    reject(error);\n  }\n});\n\n/**\n * Method that triggers self to leave all rooms.\n * @param {Array} closedRooms - Array of rooms that have been left\n * @param {Array} resolves - Array of resolves for each room that have been left\n * @private\n */\nexport const leaveAllRooms = (closedRooms = [], resolves = []) => new Promise((resolve, reject) => {\n  const { ROOM: { LEAVE_ROOM } } = MESSAGES;\n\n  try {\n    const states = Skylink.getSkylinkState();\n    const roomStates = Object.values(states);\n\n    if (roomStates[0]) { // Checks for existing roomStates and picks the first in the array\n      leaveRoom(roomStates[0])\n        .then((roomName) => {\n          closedRooms.push(roomName);\n          resolves.push(resolve);\n          leaveAllRooms(closedRooms, resolves);\n        });\n    } else {\n      logger.log.INFO([closedRooms, 'Room', null, LEAVE_ROOM.LEAVE_ALL_ROOMS.SUCCESS]);\n      resolves.forEach(res => res(closedRooms)); // resolves all promises\n    }\n  } catch (err) {\n    logger.log.ERROR([null, 'Room', null, LEAVE_ROOM.LEAVE_ALL_ROOMS.ERROR], err);\n    reject(err);\n  }\n});\n","import SkylinkStats from './index';\nimport Skylink from '../index';\nimport { SDK_NAME } from '../constants';\n\nclass HandleClientStats extends SkylinkStats {\n  constructor() {\n    super();\n    const { AdapterJS, navigator } = window;\n    this.model = {\n      client_id: null,\n      appKey: null,\n      timestamp: null,\n      username: null,\n      sdk_name: SDK_NAME.WEB,\n      sdk_version: null,\n      agent_name: AdapterJS.webrtcDetectedBrowser,\n      agent_version: AdapterJS.webrtcDetectedVersion,\n      agent_platform: navigator.platform,\n      agent_plugin_version: (AdapterJS.WebRTCPlugin.plugin && AdapterJS.WebRTCPlugin.plugin.VERSION) || null,\n      device_version: null,\n      enumerated_devices: null,\n      device_muted: null,\n      network_type: navigator.connection ? navigator.connection.type : '-',\n      language: navigator.language,\n    };\n  }\n\n  send(roomKey) {\n    const roomState = Skylink.getSkylinkState(roomKey);\n\n    this.model.username = (roomState.user && roomState.user.uid) || null;\n    this.model.sdk_version = roomState.VERSION;\n    this.model.client_id = roomState.clientId;\n    this.model.appKey = Skylink.getInitOptions().appKey;\n    this.model.timestamp = (new Date()).toISOString();\n\n    this.postStats(this.endpoints.client, this.model);\n  }\n}\n\nexport default HandleClientStats;\n","import { DATA_TRANSFER_DATA_TYPE, SM_PROTOCOL_VERSION, DT_PROTOCOL_VERSION } from '../constants';\nimport { generateUUID } from '../utils/helpers';\n\n/**\n * @class\n * @classdesc Class representing a Skylink State.\\\n * @private\n */\nclass SkylinkState {\n  /**\n   * @property {SkylinkApiResponse} skylinkApiResponse\n   */\n  constructor(initOptions) {\n    /**\n     * Stores the list of Peer DataChannel connections.\n     * @name dataChannels\n     * @type {Object}\n     * @property {String} peerId - The list of DataChannels associated with Peer ID.\n     * @property {RTCDataChannel} channeLabel - The DataChannel connection.\n     * The property name <code>\"main\"</code> is reserved for messaging Datachannel type.\n     * @since 0.2.0\n     * @private\n     */\n    this.dataChannels = {};\n    /**\n     * Stores the list of data transfers from / to Peers.\n     * @name dataTransfers\n     * @property {JSON} #transferId The data transfer session.\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.dataTransfers = {};\n    /**\n     * Stores the list of sending data streaming sessions to Peers.\n     * @name dataStreams\n     * @property {JSON} #streamId The data stream session.\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.dataStreams = {};\n    /**\n     * Stores the list of buffered ICE candidates that is received before\n     *   remote session description is received and set.\n     * @name peerCandidatesQueue\n     * @property {Array} <#peerId> The list of the Peer connection buffered ICE candidates received.\n     * @property {RTCIceCandidate} <#peerId>.<#index> The Peer connection buffered ICE candidate received.\n     * @type JSON\n     * @since 0.5.1\n     * @private\n     */\n    this.peerCandidatesQueue = {};\n    /**\n     * Stores the list of ICE candidates received before signaling end.\n     * @name peerEndOfCandidatesCounter\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.peerEndOfCandidatesCounter = {};\n    /**\n     * Stores the list of Peer connection ICE candidates.\n     * @name gatheredCandidates\n     * @property {JSON} <#peerId> The list of the Peer connection ICE candidates.\n     * @property {JSON} <#peerId>.sending The list of the Peer connection ICE candidates sent.\n     * @property {JSON} <#peerId>.receiving The list of the Peer connection ICE candidates received.\n     * @type JSON\n     * @since 0.6.14\n     * @private\n     */\n    this.gatheredCandidates = {};\n    /**\n     * Stores the window number of Peer connection retries that would increase the wait-for-response timeout\n     *   for the Peer connection health timer.\n     * @name retryCounters\n     * @type JSON\n     * @since 0.5.10\n     * @private\n     */\n    this.retryCounters = {};\n    /**\n     * Stores the list of the Peer connections.\n     * @name peerConnections\n     * @property {RTCPeerConnection} <#peerId> The Peer connection.\n     * @type JSON\n     * @since 0.1.0\n     * @private\n     */\n    this.peerConnections = {};\n    /**\n     * Stores the list of the Peer connections stats.\n     * @name peerStats\n     * @property {JSON} <#peerId> The Peer connection stats.\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.peerStats = {};\n    /**\n     * Stores the list of the Peer connections stats.\n     * @name peerBandwidth\n     * @property {JSON} <#peerId> The Peer connection stats.\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.peerBandwidth = {};\n    /**\n     * Stores the list of the Peer custom configs.\n     * @name peerCustomConfigs\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.peerCustomConfigs = {};\n    /**\n     * Stores the list of Peers session information.\n     * @name peerInformations\n     * @property {JSON} <#peerId> The Peer session information.\n     * @property {JSON|string} <#peerId>.userData The Peer custom data.\n     * @property {JSON} <#peerId>.settings The Peer streaming information.\n     * @property {JSON} <#peerId>.mediaStatus The Peer streaming media status.\n     * @property {JSON} <#peerId>.agent The Peer agent information.\n     * @type JSON\n     * @since 0.3.0\n     * @private\n     */\n    this.peerInformations = {};\n    /**\n     * Stores the Signaling user credentials from the API response required for connecting to the Signaling server.\n     * @name user\n     * @property {String} uid The API result \"username\".\n     * @property {String} token The API result \"userCred\".\n     * @property {String} timeStamp The API result \"timeStamp\".\n     * @property {String} sid The Signaling server receive user Peer ID.\n     * @type SkylinkUser\n     * @since 0.5.6\n     * @private\n     */\n    this.user = initOptions.user;\n    /**\n     * Stores the User custom data.\n     * By default, if no custom user data is set, it is an empty string <code>\"\"</code>.\n     * @name userData\n     * @type JSON|string\n     * @default \"\"\n     * @since 0.5.6\n     * @private\n     */\n    this.userData = '';\n    /**\n     * Stores the User connection priority weight.\n     * If Peer has a higher connection weight, it will do the offer from its Peer connection first.\n     * @name peerPriorityWeight\n     * @type number\n     * @since 0.5.0\n     * @private\n     */\n    this.peerPriorityWeight = 0;\n    /**\n     * Stores the flag that indicates if \"autoIntroduce\" is enabled.\n     * If enabled, the Peers connecting the same Room will receive each others \"enter\" message ping.\n     * @name autoIntroduce\n     * @type boolean\n     * @default true\n     * @since 0.6.1\n     * @private\n     */\n    this.autoIntroduce = initOptions.autoIntroduce;\n    /**\n     * Stores the flag that indicates if \"isPrivileged\" is enabled.\n     * If enabled, the User has Privileged features which has the ability to retrieve the list of\n     *   Peers in the same App space with <code>getPeers()</code> method\n     *   and introduce Peers to each other with <code>introducePeer</code> method.\n     * @name isPrivileged\n     * @type boolean\n     * @default false\n     * @since 0.6.1\n     * @private\n     */\n    this.isPrivileged = initOptions.isPrivileged;\n    /**\n     * Stores the current Room name that User is connected to.\n     * @name selectedRoom\n     * @type string\n     * @since 0.3.0\n     * @private\n     */\n    this.selectedRoom = null;\n    /**\n     * Stores the flag that indicates if Room is locked.\n     * @name roomLocked\n     * @type boolean\n     * @since 0.5.2\n     * @private\n     */\n    this.roomLocked = false;\n    /**\n     * Stores the flag that indicates if User is connected to the Room.\n     * @name inRoom\n     * @type boolean\n     * @since 0.4.0\n     * @private\n     */\n    this.inRoom = false;\n    /**\n    /**\n     * Stores the timestamps data used for throttling.\n     * @name timestamp\n     * @type JSON\n     * @since 0.5.8\n     * @private\n     */\n    this.timestamp = {\n      socketMessage: null,\n      shareScreen: null,\n      refreshConnection: null,\n      getUserMedia: null,\n      lastRestart: null,\n    };\n    /**\n     * Stores the current socket connection information.\n     * @name socketSession\n     * @type {socketSession}\n     * @since 0.6.13\n     * @private\n     */\n    this.socketSession = {};\n    /**\n     * Stores the queued socket messages.\n     * This is to prevent too many sent over less than a second interval that might cause DROPPED messages\n     *   or jams to the Signaling connection.\n     * @name socketMessageQueue\n     * @type Array\n     * @since 0.5.8\n     * @private\n     */\n    this.socketMessageQueue = [];\n    /**\n     * Stores the <code>setTimeout</code> to sent queued socket messages.\n     * @name socketMessageTimeout\n     * @type Object\n     * @since 0.5.8\n     * @private\n     */\n    this.socketMessageTimeout = null;\n    /**\n     * Stores the list of socket ports to use to connect to the Signaling.\n     * These ports are defined by default which is commonly used currently by the Signaling.\n     * Should re-evaluate this sometime.\n     * @name socketPorts\n     * @property {Array} http: The list of HTTP socket ports.\n     * @property {Array} https: The list of HTTPS socket ports.\n     * @type JSON\n     * @since 0.5.8\n     * @private\n     */\n    this.socketPorts = initOptions.socketPorts;\n    /**\n     * Stores the flag that indicates if socket connection to the Signaling has opened.\n     * @name channelOpen\n     * @type boolean\n     * @since 0.5.2\n     * @private\n     */\n    this.channelOpen = false;\n    /**\n     * Stores the Signaling server url.\n     * @name signalingServer\n     * @type string\n     * @since 0.5.2\n     * @private\n     */\n    this.socketServer = initOptions.socketServer;\n    /**\n     * Stores the Signaling server protocol.\n     * @name signalingServerProtocol\n     * @type string\n     * @since 0.5.4\n     * @private\n     */\n    this.signalingServerProtocol = initOptions.forceSSL ? 'https:' : window.location.protocol;\n    /**\n     * Stores the Signaling server port.\n     * @name signalingServerPort\n     * @type number\n     * @since 0.5.4\n     * @private\n     */\n    this.signalingServerPort = null;\n    /**\n     * Stores the Signaling socket connection object.\n     * @name socket\n     * @type io\n     * @since 0.1.0\n     * @private\n     */\n    this.socket = null;\n    /**\n     * Stores the flag that indicates if XDomainRequest is used for IE 8/9.\n     * @name socketUseXDR\n     * @type boolean\n     * @since 0.5.4\n     * @private\n     */\n    this.socketUseXDR = false;\n    /**\n     * Stores the value if ICE restart is supported.\n     * @name enableIceRestart\n     * @type string\n     * @since 0.6.16\n     * @private\n     */\n    this.enableIceRestart = false;\n    /**\n     * Stores the flag if MCU environment is enabled.\n     * @name hasMCU\n     * @type boolean\n     * @since 0.5.4\n     * @private\n     */\n    this.hasMCU = initOptions.hasMCU;\n    /**\n     * Stores the construct API REST path to obtain Room credentials.\n     * @name path\n     * @type string\n     * @since 0.1.0\n     * @private\n     */\n    this.path = null;\n    /**\n     * Stores the current <code>init()</code> readyState.\n     * @name readyState\n     * @type number\n     * @since 0.1.0\n     * @private\n     */\n    /**\n     * Stores the \"cid\" used for <code>joinRoom()</code>.\n     * @name key\n     * @type string\n     * @since 0.1.0\n     * @private\n     */\n    this.key = initOptions.key;\n    /**\n     * Stores the \"apiOwner\" used for <code>joinRoom()</code>.\n     * @name appKeyOwner\n     * @type string\n     * @since 0.5.2\n     * @private\n     */\n    this.appKeyOwner = initOptions.appKeyOwner;\n    /**\n     * Stores the Room credentials information for <code>joinRoom()</code>.\n     * @name room\n     * @property {String} id The \"rid\" for <code>joinRoom()</code>.\n     * @property {String} token The \"roomCred\" for <code>joinRoom()</code>.\n     * @property {String} startDateTime The \"start\" for <code>joinRoom()</code>.\n     * @property {String} duration The \"len\" for <code>joinRoom()</code>.\n     * @property {String} connection The RTCPeerConnection constraints and configuration. This is not used in the SDK\n     *   except for the \"mediaConstraints\" property that sets the default <code>getUserMedia()</code> settings.\n     * @type SkylinkRoom\n     * @since 0.5.2\n     * @private\n     */\n    this.room = initOptions.room;\n    /**\n     * Stores the list of Peer messages timestamp.\n     * @name peerMessagesStamps\n     * @type JSON\n     * @since 0.6.15\n     * @private\n     */\n    this.peerMessagesStamps = {};\n    /**\n     * Stores the Streams.\n     * @name streams\n     * @type JSON\n     * @since 0.6.15\n     * @private\n     */\n    this.streams = {\n      userMedia: null,\n      screenshare: null,\n    };\n    /**\n     * Stores the default camera Stream settings.\n     * @name streamsDefaultSettings\n     * @type JSON\n     * @since 0.6.15\n     * @private\n     */\n    this.streamsDefaultSettings = {\n      userMedia: {\n        audio: {\n          stereo: false,\n        },\n        video: {\n          resolution: {\n            width: 640,\n            height: 480,\n          },\n          frameRate: 50,\n        },\n      },\n      screenshare: {\n        video: true,\n      },\n    };\n    /**\n     * Stores all the Stream required muted settings.\n     * @name streamsMutedSettings\n     * @type JSON\n     * @since 0.6.15\n     * @private\n     */\n    this.streamsMutedSettings = {};\n    /**\n     * Stores all the Stream sending maximum bandwidth settings.\n     * @name streamsBandwidthSettings\n     * @type JSON\n     * @since 0.6.15\n     * @private\n     */\n    this.streamsBandwidthSettings = {\n      googleX: {},\n      bAS: {},\n    };\n    /**\n     * Stores all the Stream stopped callbacks.\n     * @name streamsStoppedCbs\n     * @type JSON\n     * @since 0.6.15\n     * @private\n     */\n    /**\n     * Stores the session description settings.\n     * @name sdpSettings\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.sdpSettings = {\n      connection: {\n        audio: true,\n        video: true,\n        data: true,\n      },\n      direction: {\n        audio: { send: true, receive: true },\n        video: { send: true, receive: true },\n      },\n    };\n    /**\n     * Stores the publish only settings.\n     * @name publishOnly\n     * @type boolean\n     * @since 0.6.16\n     * @private\n     */\n    this.publishOnly = false;\n    /**\n     * Stores the list of recordings.\n     * @name recordings\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.recordings = {};\n    /**\n     * Stores the current active recording session ID.\n     * There can only be 1 recording session at a time in a Room\n     * @name currentRecordingId\n     * @type JSON\n     * @since 0.6.16\n     * @private\n     */\n    this.currentRecordingId = false;\n    /**\n     * Stores the recording session timeout to ensure 4 seconds has been recorded.\n     * @name recordingStartInterval\n     * @type number\n     * @since 0.6.16\n     * @private\n     */\n    this.recordingStartInterval = null;\n    /**\n     * Stores the currently supported codecs.\n     * @name currentCodecSupport\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.currentCodecSupport = null;\n    /**\n     * Stores the session description orders and info.\n     * @name sdpSessions\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.sdpSessions = {};\n    /**\n     * Stores the flag if voice activity detection should be enabled.\n     * @name voiceActivityDetection\n     * @type boolean\n     * @default true\n     * @since 0.6.18\n     * @private\n     */\n    this.voiceActivityDetection = true;\n    /**\n     * Stores the datachannel binary data chunk type.\n     * @name binaryChunkType\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.binaryChunkType = DATA_TRANSFER_DATA_TYPE.ARRAY_BUFFER;\n    /**\n     * Stores the RTCPeerConnection configuration.\n     * @name peerConnectionConfig\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.peerConnectionConfig = {};\n    /**\n     * Stores the auto bandwidth settings.\n     * @name bandwidthAdjuster\n     * @type JSON\n     * @since 0.6.18\n     * @private\n     */\n    this.bandwidthAdjuster = null;\n    /**\n     * Stores the Peer connection status.\n     * @name peerConnStatus\n     * @type JSON\n     * @since 0.6.19\n     * @private\n     */\n    this.peerConnStatus = {};\n    /**\n     * Stores the flag to temporarily halt joinRoom() from processing.\n     * @name joinRoomManager\n     * @type boolean\n     * @since 0.6.19\n     * @private\n     */\n    this.joinRoomManager = {\n      timestamp: 0,\n      socketsFn: [],\n    };\n    /**\n     * Stores the unique random number used for generating the \"client_id\".\n     * @name statIdRandom\n     * @type number\n     * @since 0.6.31\n     * @private\n     */\n    this.statIdRandom = Date.now() + Math.floor(Math.random() * 100000000);\n    /**\n     * Stores the list of RTMP Sessions.\n     * @name rtmpSessions\n     * @type JSON\n     * @since 0.6.36\n     * @private\n     */\n    this.rtmpSessions = {};\n    /**\n     * Stores the SM Protocol Version\n     * @type {String}\n     */\n    this.SMProtocolVersion = SM_PROTOCOL_VERSION;\n    /**\n     * Stores the DT Protocol Version\n     * @type {String}\n     */\n    this.DTProtocolVersion = DT_PROTOCOL_VERSION;\n    /**\n     * Originally negotiated DTLS role of this peer.\n     * @name originalDTLSRole\n     * @type string\n     * @since 1.0.0\n     * @private\n     */\n    this.originalDTLSRole = null;\n    /**\n     * Offer buffered in order to apply when received answer\n     * @name bufferedLocalOffer\n     * @type Object\n     * @private\n     * @since 1.0.0\n     */\n    this.bufferedLocalOffer = {};\n    /**\n     * Offers buffered in order to apply when answerAck has been received\n     * @name bufferedRemoteOffers\n     * @type Object\n     * @private\n     * @since 2.0.0\n     */\n    this.bufferedRemoteOffers = {};\n    /**\n     * Map of RTCRTPSenders that are added via addTrack\n     * @name currentRTCRTPSenders\n     * @type Object\n     * @private\n     * @since 1.0.0\n     */\n    this.currentRTCRTPSenders = {};\n    /**\n     * Stores the unique random number used for generating the \"client_id\".\n     * @name clientId\n     * @type string\n     * @private\n     * @since 0.6.31\n     */\n    this.clientId = generateUUID();\n    /**\n     * Stores all the Stream media status.\n     * @name streamsMediaStatus\n     * @type Object\n     * @private\n     * @since 1.0.0\n     */\n    this.streamsMediaStatus = {};\n    /**\n     * Stores the media info of all peers.\n     * @name peerMedias\n     * @type Object\n     * @private\n     * @since 2.0.0\n     */\n    this.peerMedias = {};\n    /**\n     * Stores the remote streams of all peers.\n     * @name remoteStreams\n     * @type Object\n     * @private\n     * @since 2.0.0\n     */\n    this.remoteStreams = {};\n    /**\n     * Stores the flag if messages should be persisted. Value determined by the hasPersistentMessage value returned from the API.\n     * This feature is enabled in the Temasys Developer Console by toggling the Persistent Message feature at the key level.\n     * @name hasPersistentMessage\n     * @type Object\n     * @private\n     * @since 2.0.0\n     */\n    this.hasPersistentMessage = initOptions.hasPersistentMessage;\n  }\n}\nexport default SkylinkState;\n","import Skylink from '../index';\nimport { SkylinkAPIServer, SkylinkSignalingServer } from '../server-communication/index';\nimport HandleClientStats from '../skylink-stats/handleClientStats';\nimport { dispatchEvent } from '../utils/skylinkEventManager';\nimport { readyStateChange } from '../skylink-events';\nimport * as constants from '../constants';\nimport SkylinkApiResponse from '../models/api-response';\nimport SkylinkState from '../models/skylink-state';\nimport MediaStream from '../media-stream/index';\n\n/**\n * @description Method that starts the Room Session.\n * @param {joinRoomOptions} [options] The options available to join the room and configure the session.\n * @param {MediaStream} [prefetchedStream] The prefetched media stream object obtained when the user calls getUserMedia before joinRoom.\n * @return {Promise} Promise object with MediaStream.\n * @memberOf Room\n * @alias Room.joinRoom\n * @private\n */\nconst joinRoom = (options = {}, prefetchedStream) => new Promise((resolve, reject) => {\n  const { navigator, AdapterJS } = window;\n  const apiServer = new SkylinkAPIServer();\n  const signalingServer = new SkylinkSignalingServer();\n  let initOptions = Skylink.getInitOptions();\n  const handleClientStats = new HandleClientStats();\n  const roomName = SkylinkAPIServer.getRoomNameFromParams(options) ? SkylinkAPIServer.getRoomNameFromParams(options) : initOptions.defaultRoom;\n\n  dispatchEvent(readyStateChange({\n    readyState: constants.READY_STATE_CHANGE.LOADING,\n    error: null,\n    room: roomName,\n  }));\n\n  apiServer.createRoom(roomName).then((result) => {\n    const { endpoint, response } = result;\n    response.roomName = roomName;\n    const skylinkApiResponse = new SkylinkApiResponse(response);\n    initOptions = apiServer.enforceUserInitOptions(skylinkApiResponse);\n    const skylinkState = new SkylinkState(initOptions);\n\n    skylinkState.userData = options.userData || '';\n    skylinkState.path = endpoint;\n    Skylink.setSkylinkState(skylinkState, roomName);\n\n    apiServer.checkCodecSupport(skylinkState.room.id).then(() => {\n      handleClientStats.send(skylinkState.room.id);\n      return signalingServer.createSocket(response.room_key).then(() => {\n        const room = SkylinkAPIServer.getStateByKey(response.room_key);\n        const userMediaParams = Object.assign({}, options);\n\n        userMediaParams.room = room;\n        if (prefetchedStream || (options.id && options.active)) { // check for prefetched stream as the only arg\n          MediaStream.usePrefetchedStream(response.room_key, prefetchedStream, options).then(() => {\n            signalingServer.joinRoom(room);\n            resolve(null);\n          }).catch((error) => {\n            reject(error);\n          });\n        } else if (options.audio || options.video) {\n          MediaStream.getUserMedia(skylinkState, userMediaParams).then((stream) => {\n            signalingServer.joinRoom(room);\n            resolve(stream);\n          }).catch((streamException) => {\n            reject(streamException);\n          });\n        } else {\n          // If no audio is requested for Safari, audio will not be heard on the Safari peer even if the remote peer has audio. Workaround to\n          // request media access but not add the track to the peer connection. Does not seem to apply to video.\n          if (AdapterJS.webrtcDetectedBrowser === constants.BROWSER_AGENT.SAFARI) {\n            navigator.mediaDevices.getUserMedia({ audio: true })\n              .then(() => signalingServer.joinRoom(room));\n          } else {\n            signalingServer.joinRoom(room);\n          }\n          resolve(null);\n        }\n      });\n    }).catch((codecError) => {\n      reject(codecError);\n    });\n  }).catch((socketException) => {\n    reject(socketException);\n  });\n});\n\nexport default joinRoom;\n","import Skylink from '../index';\nimport { SkylinkSignalingServer } from '../server-communication/index';\nimport { dispatchEvent } from '../utils/skylinkEventManager';\nimport { roomLock } from '../skylink-events';\nimport PeerData from '../peer-data';\n\n/**\n * @description Method that locks or unlocks a room.\n * @param {SkylinkState} roomState - The room state.\n * @param {boolean} lockRoom - The flag if the room should be locked or unlocked.\n * @private\n */\nexport const lockOrUnlockRoom = (roomState, lockRoom = true) => {\n  const updatedState = roomState;\n  const { room, user } = updatedState;\n  const signalingServer = new SkylinkSignalingServer();\n\n  updatedState.roomLocked = lockRoom;\n  Skylink.setSkylinkState(updatedState, room.id);\n\n  signalingServer.roomLock(updatedState);\n\n  dispatchEvent(roomLock({\n    isLocked: updatedState.roomLocked,\n    peerInfo: PeerData.getCurrentSessionInfo(room),\n    peerId: user.sid,\n    isSelf: true,\n  }));\n};\n\n/**\n * @description Method that locks a room.\n * @param {SkylinkState} roomState - The room state.\n * @private\n */\nexport const lockRoom = roomState => lockOrUnlockRoom(roomState, true);\n\n/**\n * @description Method that unlocls a room.\n * @param {SkylinkState} roomState - The room state.\n * @private\n */\nexport const unlockRoom = roomState => lockOrUnlockRoom(roomState, false);\n","import {\n  ROOM_LOCK,\n  BYE,\n} from './constants';\n\nimport SkylinkEvent from '../utils/skylinkEvent';\n\n/**\n * @event SkylinkEvents.roomLock\n * @description Event triggered when Room locked status has changed.\n * @param {Object} detail - Event's payload\n * @param {Boolean} detail.isLocked The flag if Room is locked.\n * @param {String} detail.peerId The Peer ID.\n * @param {peerInfo} detail.peerInfo The Peer session information. Object signature matches the <code>peerInfo</code> parameter payload received in the <code>peerJoined</code> event.\n * @param {Boolean} detail.isSelf The flag if User changed the Room locked status.\n */\nexport const roomLock = (detail = {}) => new SkylinkEvent(ROOM_LOCK, { detail });\n\n/*\n * @event SkylinkEvents.bye\n * @description Event triggered when a user leaves a room.\n * @param {Object} detail - Event's payload.\n * @param {String} detail.rid - The User's Room session Peer ID\n * @param {peerInfo} detail.mid - The User's id\n */\nexport const bye = (detail = {}) => new SkylinkEvent(BYE, { detail });\n","import { leaveRoom, leaveAllRooms } from './leaveRoom';\nimport joinRoom from './joinRoom';\nimport { lockRoom, unlockRoom } from './lockRoom';\n\n/**\n * @classdesc Class that contains the methods for Room.\n * @private\n */\nclass Room {\n  /** @lends Room */\n  static leaveRoom(args) {\n    return leaveRoom(args);\n  }\n\n  static leaveAllRooms() {\n    return leaveAllRooms();\n  }\n\n  static lockRoom(roomState) {\n    return lockRoom(roomState);\n  }\n\n  static unlockRoom(roomState) {\n    return unlockRoom(roomState);\n  }\n\n  static joinRoom(args) {\n    return joinRoom(args);\n  }\n}\n\nexport default Room;\n","import logger from '../../logger';\nimport MESSAGES from '../../messages';\nimport HandleRecordingStats from '../../skylink-stats/handleRecordingStats';\nimport { SkylinkConstants } from '../../index';\nimport { addEventListener, removeEventListener } from '../../utils/skylinkEventManager';\nimport SkylinkSignalingServer from '../../server-communication/signaling-server';\n\nconst sendRecordingMessageViaSig = (roomState, isStartRecording, currentRecordingId = null) => {\n  const signaling = new SkylinkSignalingServer();\n  const handleRecordingStats = new HandleRecordingStats();\n\n  signaling.recording(roomState.room.id, isStartRecording ? SkylinkConstants.SIG_MESSAGE_TYPE.START_RECORDING : SkylinkConstants.SIG_MESSAGE_TYPE.STOP_RECORDING);\n  handleRecordingStats.send(roomState.room.id, isStartRecording ? MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.REQUEST_START : MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.REQUEST_STOP, currentRecordingId, null, null);\n};\n\nconst manageRecordingEventListeners = (resolve, isStartRecording) => {\n  const executeCallbackAndRemoveEvtListener = (evt) => {\n    const result = evt.detail;\n    const stateToCompare = isStartRecording ? SkylinkConstants.RECORDING_STATE.START : SkylinkConstants.RECORDING_STATE.STOP;\n\n    if (result.state === stateToCompare) {\n      removeEventListener(SkylinkConstants.EVENTS.RECORDING_STATE, executeCallbackAndRemoveEvtListener);\n      resolve(result.recordingId);\n    }\n  };\n\n  addEventListener(SkylinkConstants.EVENTS.RECORDING_STATE, executeCallbackAndRemoveEvtListener);\n};\n\nconst manageErrorStatsAndCallback = (roomState, errorMessage, statsKey, currentRecordingId = null, recordings = null) => {\n  const handleRecordingStats = new HandleRecordingStats();\n  logger.log.ERROR(errorMessage);\n  handleRecordingStats.send(roomState.room.id, statsKey, currentRecordingId, recordings, errorMessage);\n  return new Error(errorMessage);\n};\n\n/**\n * @param {SkylinkState} roomState\n * @param {boolean} isStartRecording\n * @private\n */\nconst commonRecordingOperations = (roomState, isStartRecording) => new Promise((resolve, reject) => {\n  const { hasMCU, currentRecordingId, recordingStartInterval } = roomState;\n  let errorMessage = isStartRecording ? MESSAGES.RECORDING.START_FAILED : MESSAGES.RECORDING.STOP_FAILED;\n\n  if (!hasMCU) {\n    errorMessage = `${errorMessage} - ${MESSAGES.RECORDING.ERRORS.MCU_NOT_CONNECTED}`;\n    const statsStateKey = isStartRecording ? MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.ERROR_NO_MCU_START : MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.ERROR_NO_MCU_STOP;\n    const error = manageErrorStatsAndCallback(roomState, errorMessage, statsStateKey, null, null);\n    reject(error);\n  }\n\n  if (isStartRecording && currentRecordingId) {\n    const error = manageErrorStatsAndCallback(roomState, `${errorMessage} - ${MESSAGES.RECORDING.ERRORS.EXISTING_RECORDING_IN_PROGRESS}`, MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.ERROR_START_ACTIVE, currentRecordingId, null);\n    reject(error);\n  }\n\n  if (!isStartRecording && !currentRecordingId) {\n    const error = manageErrorStatsAndCallback(roomState, `${errorMessage} - ${MESSAGES.RECORDING.ERRORS.NO_RECORDING_IN_PROGRESS}`, MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.ERROR_STOP_ACTIVE, currentRecordingId, null);\n    reject(error);\n  }\n\n  if (!isStartRecording && recordingStartInterval) {\n    const error = manageErrorStatsAndCallback(roomState, `${errorMessage} - ${MESSAGES.RECORDING.ERRORS.MIN_RECORDING_TIME}`, MESSAGES.STATS_MODULE.HANDLE_RECORDING_STATS.ERROR_MIN_STOP, currentRecordingId, null);\n    reject(error);\n  }\n\n  manageRecordingEventListeners(resolve, isStartRecording);\n  sendRecordingMessageViaSig(roomState, isStartRecording, currentRecordingId);\n});\n\n/**\n * The current room's Skylink state\n * @param {SkylinkState} roomState\n * @private\n */\nexport const startRecording = roomState => commonRecordingOperations(roomState, true);\n\n/**\n * The current room's Skylink state\n * @param {SkylinkState} roomState\n * @private\n */\nexport const stopRecording = roomState => commonRecordingOperations(roomState, false);\n","import { startRecording, stopRecording } from './recording';\n\nclass Recording {\n  static start(...args) {\n    return startRecording(...args);\n  }\n\n  static stop(...args) {\n    return stopRecording(...args);\n  }\n\n  static getRecordings(roomState) {\n    const { recordings } = roomState;\n    return Object.assign({}, recordings);\n  }\n}\n\nexport default Recording;\n","import SkylinkSignalingServer from '../../../server-communication/signaling-server';\nimport { SIG_MESSAGE_TYPE } from '../../../constants';\n/**\n * Method sends START_RTMP or STOP_RTMP message to Signaling Server\n * @param {SkylinkState} roomState\n * @param {boolean} isStartRTMPSession\n * @param {String} rtmpId\n * @param {String} streamId\n * @param {String} endpoint\n * @private\n */\nconst sendRTMPMessageViaSig = (roomState, isStartRTMPSession, rtmpId, streamId = null, endpoint = null) => {\n  const { room, user } = roomState;\n  const signaling = new SkylinkSignalingServer();\n  const messageType = isStartRTMPSession ? SIG_MESSAGE_TYPE.START_RTMP : SIG_MESSAGE_TYPE.STOP_RTMP;\n\n  signaling.rtmp(messageType, room.id, user.sid, rtmpId, streamId, endpoint);\n};\n\nexport default sendRTMPMessageViaSig;\n","import checkRTMPDependencies from './checkRTMPDependencies';\nimport registerRTMPEventListenersAndResolve from './registerRTMPEventListenersAndResolve';\nimport sendRTMPMessageViaSig from './sendRTMPMessageViaSig';\n\nexport default {\n  checkRTMPDependencies,\n  registerRTMPEventListenersAndResolve,\n  sendRTMPMessageViaSig,\n};\n","import messages from '../../../messages';\n\n/**\n * Checks dependencies to start or stop an RTMP session\n * @param {boolean} isStartSession\n * @param {SkylinkState} roomState\n * @param {String|null} streamId\n * @param {String|null} endpoint\n * @private\n * @return {{shouldProceed: boolean, errorMessage: string}}\n */\nconst checkRTMPDependencies = (isStartSession, roomState, streamId = null, endpoint = null) => {\n  const toReturn = { shouldProceed: true, errorMessage: '' };\n  const { hasMCU } = roomState;\n\n  if (!hasMCU) {\n    toReturn.errorMessage = isStartSession ? messages.RTMP.start_no_mcu : messages.RTMP.stop_no_mcu;\n    toReturn.shouldProceed = false;\n    return toReturn;\n  }\n\n  if (isStartSession && !streamId) {\n    toReturn.errorMessage = messages.RTMP.start_no_stream_id;\n    toReturn.shouldProceed = false;\n    return toReturn;\n  }\n\n  if (isStartSession && !endpoint) {\n    toReturn.errorMessage = messages.RTMP.start_no_endpoint;\n    toReturn.shouldProceed = false;\n    return toReturn;\n  }\n\n  return toReturn;\n};\n\nexport default checkRTMPDependencies;\n","import { SkylinkConstants } from '../../../index';\nimport { addEventListener, removeEventListener } from '../../../utils/skylinkEventManager';\n\nconst registerRTMPEventListenersAndResolve = (isStartRTMPSession, resolve) => {\n  const executeCallbackAndRemoveEvtListener = (evt) => {\n    const result = evt.detail;\n    const stateToCompare = isStartRTMPSession ? SkylinkConstants.RTMP_STATE.START : SkylinkConstants.RTMP_STATE.STOP;\n\n    if (result.state === stateToCompare) {\n      removeEventListener(SkylinkConstants.EVENTS.RTMP_STATE, executeCallbackAndRemoveEvtListener);\n      resolve(result.rtmpId);\n    }\n  };\n\n  addEventListener(SkylinkConstants.EVENTS.RTMP_STATE, executeCallbackAndRemoveEvtListener);\n};\n\nexport default registerRTMPEventListenersAndResolve;\n","import helpers from './helpers';\nimport { generateUUID } from '../../utils/helpers';\nimport logger from '../../logger';\nimport messages from '../../messages';\nimport { PEER_TYPE } from '../../constants';\n\nclass RTMP {\n  /**\n   * Start an RTMP session\n   * @param {SkylinkState} roomState\n   * @param {String} streamId\n   * @param {String} endpoint\n   */\n  static startSession(roomState, streamId, endpoint) {\n    return this.commonRTMPOperations(roomState, streamId, null, endpoint, true, messages.RTMP.starting_rtmp);\n  }\n\n  /**\n   * Stop a RTMP Session\n   * @param {SkylinkState} roomState\n   * @param {String} rtmpId\n   */\n  static stopSession(roomState, rtmpId) {\n    return this.commonRTMPOperations(roomState, null, rtmpId, null, false, messages.RTMP.stopping_rtmp);\n  }\n\n  static logErrorAndReject(error, reject) {\n    logger.log.ERROR(error);\n    reject(error);\n  }\n\n  static commonRTMPOperations(roomState, streamId, rtmpId, endpoint, isStartRTMPSession, msg) {\n    return new Promise((resolve, reject) => {\n      try {\n        const result = helpers.checkRTMPDependencies(isStartRTMPSession, roomState, streamId, endpoint);\n        const gRtmpId = rtmpId || generateUUID();\n\n        if (result.shouldProceed) {\n          helpers.registerRTMPEventListenersAndResolve(isStartRTMPSession, resolve);\n          helpers.sendRTMPMessageViaSig(roomState, isStartRTMPSession, gRtmpId, streamId, endpoint);\n          logger.log.INFO([PEER_TYPE.MCU, 'RTMP', msg]);\n        } else {\n          this.logErrorAndReject(new Error(result.errorMessage), reject);\n        }\n      } catch (error) {\n        this.logErrorAndReject(error, reject);\n      }\n    });\n  }\n}\n\nexport default RTMP;\n","/* eslint-disable class-methods-use-this */\nimport {\n  getParamValidity, getRoomStateByName, isAString, statelessGetUserMedia, isAObj, generateUUID,\n} from '../utils/helpers';\nimport { dispatchEvent } from '../utils/skylinkEventManager';\nimport { streamEnded } from '../skylink-events';\nimport PeerConnection from '../peer-connection/index';\nimport PeerData from '../peer-data/index';\nimport PeerPrivileged from '../peer-privileged/index';\nimport ScreenSharing from '../features/screen-sharing/index';\nimport MediaStream from '../media-stream/index';\nimport Room from '../room/index';\nimport Recording from '../features/recording/index';\nimport RTMP from '../features/rtmp/index';\nimport AsyncMessaging from '../features/messaging/async-messaging';\nimport EncryptedMessaging from '../features/messaging/encrypted-messaging';\nimport Messaging from '../features/messaging';\n\n/**\n * @classdesc This class lists all the public methods of Skylink.\n * @interface\n * @private\n */\nclass SkylinkPublicInterface {\n  /**\n   * @description Method that starts a room session.\n   * <p>Resolves with an array of <code>MediaStreams</code> or null if pre-fetched\n   * stream was passed into <code>joinRoom</code> method. First item in array is <code>MediaStream</code> of kind audio and second item is\n   * <code>MediaStream</code> of kind video.</p>\n   * @param {joinRoomOptions} [options] - The options available to join the room and configure the session.\n   * @param {MediaStream} [prefetchedStream] - The pre-fetched media stream object obtained when the user calls {@link Skylink#getUserMedia|getUserMedia} method before {@link Skylink#joinRoom|joinRoom} method.\n   * @return {Promise.<MediaStreams>}\n   * @example\n   * Example 1: Calling joinRoom with options\n   *\n   * const joinRoomOptions = {\n   *    audio: true,\n   *    video: true,\n   *    roomName: \"Room_1\",\n   *    userData: {\n   *        username: \"GuestUser_1\"\n   *    },\n   * };\n   *\n   * skylink.joinRoom(joinRoomOptions)\n   *    .then((streams) => {\n   *        if (streams[0]) {\n   *          window.attachMediaStream(audioEl, streams[0]); // first item in array is an audio stream\n   *        }\n   *        if (streams[1]) {\n   *          window.attachMediaStream(videoEl, streams[1]); // second item in array is a video stream\n   *        }\n   *    })\n   *    .catch((error) => {\n   *        // handle error\n   *    });\n   * @example\n   * Example 2: Retrieving a pre-fetched stream before calling joinRoom\n   *\n   * // REF: {@link Skylink#getUserMedia|getUserMedia}\n   * const prefetchedStream = skylink.getUserMedia();\n   *\n   * skylink.joinRoom(prefetchedStream)\n   *    .catch((error) => {\n   *    // handle error\n   *    });\n   * @alias Skylink#joinRoom\n   */\n  async joinRoom(options = {}, prefetchedStream) {\n    return Room.joinRoom(options, prefetchedStream);\n  }\n\n  /**\n   * @description Method that sends a message to peers via the data channel connection.\n   * Consider using {@link Skylink#sendURLData|sendURLData} if you are sending large strings to peers.\n   * @param {String} [roomName] - The name of the room the message is intended for.\n   * When not provided, the message will be broadcast to all rooms where targetPeerId(s) are found (if provided).\n   * Note when roomName is provided, targetPeerId should be provided as null.\n   * @param {String|JSON} message - The message.\n   * @param {String|Array} [targetPeerId] - The target peer id to send message to.\n   * When provided as an Array, it will send the message to only peers which ids are in the list.\n   * When not provided, it will broadcast the message to all connected peers with data channel connection in a room.\n   * @example\n   * Example 1: Broadcasting to all peers in all rooms\n   *\n   * const message = \"Hello everyone!\";\n   *\n   * skylink.sendP2PMessage(message);\n   * @example\n   * Example 2: Broadcasting to all peers in a room\n   *\n   * const message = \"Hello everyone!\";\n   * const roomName = \"Room_1\";\n   *\n   * skylink.sendP2PMessage(message, null, roomName);\n   * @example\n   * Example 3: Sending message to a peer in all rooms\n   *\n   * const message = \"Hello!\";\n   * const targetPeerId = \"peerId\";\n   *\n   * skylink.sendP2PMessage(message, targetPeerId);\n   * @example\n   * Example 4: Sending message to a peer in a room\n   *\n   * const message = \"Hello!\";\n   * const targetPeerId = \"peerId\";\n   * const roomName = \"Room_1\";\n   *\n   * skylink.sendP2PMessage(message, targetPeerId, roomName);\n   * @example\n   * Example 5: Sending message to selected Peers in a room\n   *\n   * const message = \"Hello!\";\n   * const selectedPeers = [\"peerId_1\", \"peerId_2\"];\n   * const roomName = \"Room_1\";\n   *\n   * skylink.sendP2PMessage(message, selectedPeers, roomName);\n   * @example\n   * // Listen for onIncomingMessage event\n   * skylink.addEventListener(SkylinkEvents.ON_INCOMING_MESSAGE, (evt) => {\n   *   const detail = evt.detail;\n   *   if (detail.isSelf) {\n   *     // handle message from self\n   *   } else {\n   *     // handle message from remote peer\n   *   }\n   * }\n   * @fires {@link SkylinkEvents.event:onIncomingMessage|onIncomingMessage}\n   * @alias Skylink#sendP2PMessage\n   */\n  sendP2PMessage(roomName = '', message = '', targetPeerId = '') {\n    PeerConnection.sendP2PMessage(roomName, message, targetPeerId);\n  }\n\n  /**\n   * @description Function that sends a message to peers via the Signaling socket connection.\n   * @param {String} roomName - room name to send the message.\n   * @param {String|JSON} message - The message.\n   * @param {String|Array} [targetPeerId] - The target peer id to send message to.\n   * - When provided as an Array, it will send the message to only peers which ids are in the list.\n   * - When not provided, it will broadcast the message to all connected peers in the room.\n   * @example\n   * Example 1: Broadcasting to all peers\n   *\n   * let sendMessage = (roomName) => {\n   *    const message = \"Hi!\";\n   *    const selectedPeers = this.state[location]['selectedPeers'];\n   *    this.skylink.sendMessage(roomName, message, selectedPeers);\n   * }\n   * @example\n   * Example 2: Broadcasting to selected peers\n   *\n   * let sendMessage = (roomName) => {\n   *    const message = \"Hi all!\";\n   *    const selectedPeers = [\"PeerID_1\", \"PeerID_2\"];\n   *    this.skylink.sendMessage(roomName, message, selectedPeers);\n   * }\n   * @fires {@link SkylinkEvents.event:onIncomingMessage|onIncomingMessage}\n   * @alias Skylink#sendMessage\n   * @since 0.4.0\n   */\n  sendMessage(roomName = '', message = '', targetPeerId = '') {\n    Messaging.sendMessage(roomName, message, targetPeerId);\n  }\n\n  /**\n   * @description Method that retrieves the message history from server if Persistent Message feature is enabled for the key.\n   * @param {String} roomName - The name of the room.\n   * @example\n   * Example 1: Retrieving stored messages\n   *\n   * // add event listener to catch storedMessages event\n   * SkylinkEventManager.addEventListener(SkylinkConstants.EVENTS.STORED_MESSAGES, (evt) => {\n   *    const { storedMessages } = evt.detail;\n   *    storedMessages.content.forEach((message) => {\n   *      // do something\n   *    })\n   * });\n   *\n   * let getStoredMessages = (roomName) => {\n   *    this.skylink.getStoredMessages(roomName);\n   * }\n   * @fires {@link SkylinkEvents.event:storedMessages|storedMessages}\n   * @alias Skylink#getStoredMessages\n   * @since 2.1\n   */\n  getStoredMessages(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      new AsyncMessaging(roomState).getStoredMessages();\n    }\n  }\n\n  /**\n   * @description Method that gets the list of connected peers in the room.\n   * @param {String} roomName - The name of the room.\n   * @return {JSON.<String, peerInfo>|null} <code>peerInfo</code> keyed by peer id. Additional <code>isSelf</code> flag to determine if peer is user or not. Null is returned if room has not been created.\n   * @example\n   * Example 1: Get the list of currently connected peers in the same room\n   *\n   * const peers = skylink.getPeersInRoom();\n   * @alias Skylink#getPeersInRoom\n   */\n  getPeersInRoom(roomName) {\n    if (getParamValidity(roomName, 'roomName', 'getPeersInRoom')) {\n      return PeerConnection.getPeersInRoom(roomName);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that returns the user / peer current session information.\n   * @param {String} roomName - The name of the room.\n   * @param {String|null} [peerId] The peer id to return the current session information from.\n   * - When not provided or that the peer id is does not exists, it will return\n   *   the user current session information.\n   * @return {peerInfo|null} The user / peer current session information.\n   * @example\n   * Example 1: Get peer current session information\n   *\n   * const peerPeerInfo = skylink.getPeerInfo(peerId);\n   * @example\n   * Example 2: Get user current session information\n   *\n   * const userPeerInfo = skylink.getPeerInfo();\n   * @alias Skylink#getPeerInfo\n   */\n  getPeerInfo(roomName, peerId = null) {\n    const roomState = getRoomStateByName(roomName);\n    if (peerId && roomState) {\n      return PeerData.getPeerInfo(peerId, roomState.room);\n    }\n\n    if (!peerId && roomState) {\n      return PeerData.getCurrentSessionInfo(roomState.room);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that returns the user / peer current custom data.\n   * @param {String} roomName - The room name.\n   * @param {String} [peerId] - The peer id to return the current custom data from.\n   * - When not provided or that the peer id is does not exists, it will return\n   *   the user current custom data.\n   * @return {Object|null} The user / peer current custom data.\n   * @example\n   * Example 1: Get peer current custom data\n   *\n   * const peerUserData = skylink.getUserData(peerId);\n   * @example\n   * Example 2: Get user current custom data\n   *\n   * const userUserData = skylink.getUserData();\n   * @alias Skylink#getUserData\n   */\n  getUserData(roomName, peerId) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState && roomState.room) {\n      return PeerData.getUserData(roomState, peerId);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that overwrites the user current custom data.\n   * @param {String} roomName - The room name.\n   * @param {JSON|String} userData - The updated custom data.\n   * @fires {@link SkylinkEvents.event:peerUpdated|peerUpdatedEvent} event if peer is in room with <code>isSelf=true</code>.\n   * @example\n   * Example 1: Update user custom data after joinRoom()\n   *\n   * // add event listener to catch setUserData changes\n   * SkylinkEventManager.addEventListener(SkylinkConstants.peerUpdated, (evt) => {\n   *    const { detail } = evt;\n   *   // do something\n   * });\n   *\n   * const userData = \"afterjoin\";\n   * skylink.setUserData(userData);\n   * @alias Skylink#setUserData\n   */\n  setUserData(roomName, userData) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState && roomState.room) {\n      return PeerData.setUserData(roomState.room, userData);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that retrieves peer connection bandwidth and ICE connection stats.\n   * <blockquote class=\"info\">\n   * Note that this is not well supported in the Edge browser.\n   * </blockquote>\n   * @description Method that retrieves peer connection bandwidth and ICE connection stats.\n   * @param {String} roomName - The room name.\n   * @param {String|Array} [peerId] The target peer id to retrieve connection stats from.\n   * - When provided as an Array, it will retrieve all connection stats from all the peer ids provided.\n   * - When not provided, it will retrieve all connection stats from the currently connected peers in the room.\n   * @return {Promise<Array.<object.<String|statistics>>>}\n   * @example\n   * Example 1: Retrieving connection statistics from all peers in a room\n   *\n   * skylink.getConnectionStatus(\"Room_1\")\n   *  .then((statistics) => {\n   *    // handle statistics\n   *  }\n   *  .catch((error) => {\n   *    // handle error\n   *  }\n   * @example\n   * Example 2: Retrieving connection statistics from selected peers\n   *\n   * const selectedPeers = [\"peerId_1\", \"peerId_2\"];\n   * skylink.getConnectionStatus(\"Room_1\", selectedPeers)\n   *  .then((statistics) => {\n   *    // handle statistics\n   *  }\n   *  .catch((error) => {\n   *    // handle error\n   *  }\n   * @alias Skylink#getConnectionStats\n   */\n  getConnectionStatus(roomName, peerId) {\n    const roomState = getRoomStateByName(roomName);\n\n    return PeerConnection.getConnectionStatus(roomState, peerId);\n  }\n\n  /**\n   * @description Method that retrieves the list of peer ids from rooms within the same App space.\n   * <blockquote class=\"info\">\n   *   Note that this feature requires <code>\"isPrivileged\"</code> flag to be enabled for the App Key\n   *   provided in the {@link initOptions}, as only Users connecting using\n   *   the App Key with this flag enabled (which we call privileged Users / peers) can retrieve the list of\n   *   peer ids from rooms within the same App space.\n   *   {@link http://support.temasys.io/support/solutions/articles/12000012342-what-is-a-privileged-key-|What is a privileged key?}\n   * </blockquote>\n   * @param {String} roomName - The room name\n   * @param {Boolean} [showAll=false] - The flag if Signaling server should also return the list of privileged peer ids.\n   * By default, the Signaling server does not include the list of privileged peer ids in the return result.\n   * @return {Promise.<Object.<String, Array<String>>>} peerList - Array of peer ids, keyed by room name.\n   * @fires {@link SkylinkEvents.event:getPeersStateChange|getPeersStateChangeEvent} with parameter payload <code>state=ENQUIRED</code> upon calling <code>getPeers</code> method.\n   * @fires {@link SkylinkEvents.event:getPeersStateChange|getPeersStateChangeEvent} with parameter payload <code>state=RECEIVED</code> when peer list is received from Signaling server.\n   * @example\n   * Example 1: Retrieve un-privileged peers\n   *\n   * skylink.getPeers(location)\n   *  .then((result) => {\n   *      // do something\n   *  })\n   *  .catch((error) => {\n   *      // handle error\n   *  })\n   *\n   * Example 2: Retrieve all (privileged and un-privileged) peers\n   *\n   * skylink.getPeers(location, true)\n   *  .then((result) => {\n   *      // do something\n   *  })\n   *  .catch((error) => {\n   *      // handle error\n   *  })\n   * @alias Skylink#getPeers\n   * @since 0.6.1\n   */\n  getPeers(roomName, showAll = false) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return PeerPrivileged.getPeerList(roomState.room, showAll);\n    }\n\n    return null;\n  }\n\n  /**\n   * @typedef {Object.<String, Object>} peersStreamsInfo\n   * @property {Object.<String, Object>} #peerId - Peer streams info keyed by peer id.\n   * @property {Boolean} #peerId.isSelf - The flag if the peer is local or remote.\n   * @property {MediaStream} #peerId.#streamId - streams keyed by stream id.\n  /**\n   * @description Method that returns the list of connected peers streams in the room both user media streams and screen share streams.\n   * @param {String} roomName - The room name.\n   * @param {Boolean} [includeSelf=true] - The flag if self streams are included.\n   * @return {JSON.<String, peersStreamsInfo>} - The list of peer stream objects keyed by peer id.\n   * @example\n   * Example 1: Get the list of current peers streams in the same room\n   *\n   * const streams = skylink.getPeersStreams(\"Room_1\");\n   * @alias Skylink#getPeersStreams\n   * @since 0.6.16\n   */\n  getPeersStreams(roomName, includeSelf = true) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return PeerData.getPeersStreams(roomState, includeSelf);\n    }\n    return null;\n  }\n\n  /**\n   * @typedef {Object} dataChannelInfo\n   * @property {String} channelName - The data channel id.\n   * @property {String} channelProp - The data channel property.\n   * @property {String} channelType - The data channel type.\n   * @property {String} currentTransferId - The data channel connection\n   *   current progressing transfer session. Defined as <code>null</code> when there is\n   *   currently no transfer session progressing on the data channel connection\n   * @property {String} currentStreamId - The data channel connection\n   *   current data streaming session id. Defined as <code>null</code> when there is currently\n   *   no data streaming session on the data channel connection.\n   * @property {String} readyState - The data channel connection readyState.\n   * @property {String} bufferedAmountLow - The data channel buffered amount.\n   * @property {String} bufferedAmountLowThreshold - The data channel\n   *   buffered amount threshold.\n   */\n  /**\n   * @description Method that gets the current list of connected peers data channel connections in the room.\n   * @param {String} roomName - The room name.\n   * @return {Object.<string, Object.<String, dataChannelInfo>>} - The list of peer data channels keyed by peer id, keyed by data channel id.\n   * @example\n   * Example 1: Get the list of current peers data channels in the same room\n   *\n   * const channels = skylink.getPeersDataChannels(\"Room_1\");\n   * @alias Skylink#getPeersDataChannels\n   * @since 0.6.18\n   */\n  getPeersDataChannels(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return PeerData.getPeersDataChannels(roomState);\n    }\n    return null;\n  }\n\n  /**\n   * @typedef {Object} customSettings\n   * @property {Object} settings - The peer stream and data settings.\n   * @property {Boolean|JSON} settings.data - The flag if peer has any data channel connections enabled.\n   *   If <code>isSelf</code> value is <code>true</code>, this determines if user allows\n   *   data channel connections, else if value is <code>false</code>, this determines if peer has any active\n   *   data channel connections (where {@link SkylinkEvents.event:onDataChannelStateChanged|onDataChannelStateChangedEvent}\n   *   triggers <code>state</code> as <code>OPEN</code> and <code>channelType</code> as\n   *   <code>MESSAGING</code> for peer) with peer.\n   * @property {Boolean|JSON} settings.audio - The peer stream audio settings.\n   *   When defined as <code>false</code>, it means there is no audio being sent from peer.\n   *   When defined as <code>true</code>, the <code>settings.audio.stereo</code> value is\n   *   considered as <code>false</code> and the <code>settings.audio.exactConstraints</code>\n   *   value is considered as <code>false</code>.\n   * @property {Boolean} settings.audio.stereo - The flag if stereo band is configured\n   *   when encoding audio codec is <a href=\"#attr_AUDIO_CODEC\"><code>OPUS</code></a> for receiving audio data.\n   * @property {Boolean} [settings.audio.usedtx]\n   *   Note that this feature might not work depending on the browser support and implementation.\n   *   The flag if DTX (Discontinuous Transmission) is configured when encoding audio codec\n   *   is <a href=\"#attr_AUDIO_CODEC\"><code>OPUS</code></a> for sending audio data.\n   *   This might help to reduce bandwidth it reduces the bitrate during silence or background noise.\n   *   When not defined, the default browser configuration is used.\n   * @property {Boolean} [settings.audio.useinbandfec]\n   *   Note that this feature might not work depending on the browser support and implementation.\n   *   The flag if capability to take advantage of in-band FEC (Forward Error Correction) is\n   *   configured when encoding audio codec is <a href=\"#attr_AUDIO_CODEC\"><code>OPUS</code></a> for sending audio data.\n   *   This might help to reduce the harm of packet loss by encoding information about the previous packet.\n   *   When not defined, the default browser configuration is used.\n   * @property {Number} [settings.audio.maxplaybackrate]\n   *   Note that this feature might not work depending on the browser support and implementation.\n   *   The maximum output sampling rate rendered in Hertz (Hz) when encoding audio codec is\n   *   <a href=\"#attr_AUDIO_CODEC\"><code>OPUS</code></a> for sending audio data.\n   *   This value must be between <code>8000</code> to <code>48000</code>.\n   *   When not defined, the default browser configuration is used.\n   * @property {Boolean} settings.audio.echoCancellation - The flag if echo cancellation is enabled for audio tracks.\n   * @property {Array} [settings.audio.optional] The peer stream <code>navigator.getUserMedia()</code> API\n   *   <code>audio: { optional [..] }</code> property.\n   * @property {String} [settings.audio.deviceId] - The peer stream audio track source id of the device used.\n   * @property {Boolean} settings.audio.exactConstraints - The flag if peer stream audio track is sending exact\n   *   requested values of <code>settings.audio.deviceId</code> when provided.\n   * @property {Boolean|JSON} settings.video - The peer stream video settings.\n   *   When defined as <code>false</code>, it means there is no video being sent from peer.\n   *   When defined as <code>true</code>, the <code>settings.video.screenshare</code> value is\n   *   considered as <code>false</code>  and the <code>settings.video.exactConstraints</code>\n   *   value is considered as <code>false</code>.\n   * @property {JSON} [settings.video.resolution] - The peer stream video resolution.\n   *   [Rel: {@link SkylinkConstants.VIDEO_RESOLUTION|VIDEO_RESOLUTION}]\n   * @property {Number|JSON} settings.video.resolution.width - The peer stream video resolution width or\n   *   video resolution width settings.\n   *   When defined as a JSON Object, it is the user set resolution width settings with (<code>\"min\"</code> or\n   *   <code>\"max\"</code> or <code>\"ideal\"</code> or <code>\"exact\"</code> etc configurations).\n   * @property {Number|JSON} settings.video.resolution.height - The peer stream video resolution height or\n   *   video resolution height settings.\n   *   When defined as a JSON Object, it is the user set resolution height settings with (<code>\"min\"</code> or\n   *   <code>\"max\"</code> or <code>\"ideal\"</code> or <code>\"exact\"</code> etc configurations).\n   * @property {Number|JSON} [settings.video.frameRate] - The peer stream video\n   *   <a href=\"https://en.wikipedia.org/wiki/Frame_rate\">frameRate</a> per second (fps) or video frameRate settings.\n   *   When defined as a JSON Object, it is the user set frameRate settings with (<code>\"min\"</code> or\n   *   <code>\"max\"</code> or <code>\"ideal\"</code> or <code>\"exact\"</code> etc configurations).\n   * @property {Boolean} settings.video.screenshare - The flag if peer stream is a screensharing stream.\n   * @property {Array} [settings.video.optional] - The peer stream <code>navigator.getUserMedia()</code> API\n   *   <code>video: { optional [..] }</code> property.\n   * @property {String} [settings.video.deviceId] - The peer stream video track source id of the device used.\n   * @property {Boolean} settings.video.exactConstraints The flag if peer stream video track is sending exact\n   *   requested values of <code>settings.video.resolution</code>,\n   *   <code>settings.video.frameRate</code> and <code>settings.video.deviceId</code>\n   *   when provided.\n   * @property {String|JSON} [settings.video.facingMode] - The peer stream video camera facing mode.\n   *   When defined as a JSON Object, it is the user set facingMode settings with (<code>\"min\"</code> or\n   *   <code>\"max\"</code> or <code>\"ideal\"</code> or <code>\"exact\"</code> etc configurations).\n   * @property {Object} settings.bandwidth The maximum streaming bandwidth sent from peer.\n   * @property {Number} [settings.bandwidth.audio] - The maximum audio streaming bandwidth sent from peer.\n   * @property {Number} [settings.bandwidth.video] - The maximum video streaming bandwidth sent from peer.\n   * @property {Number} [settings.bandwidth.data] - The maximum data streaming bandwidth sent from peer.\n   * @property {Object} settings.googleXBandwidth\n   *   Note that this feature might not work depending on the browser support and implementation,\n   *   and its properties and values are only defined for user's end and cannot be viewed\n   *   from peer's end (when <code>isSelf</code> value is <code>false</code>).\n   *   The experimental google video streaming bandwidth sent to peers.\n   * @property {Number} [settings.googleXBandwidth.min] - The minimum experimental google video streaming bandwidth sent to peers.\n   * @property {Number} [settings.googleXBandwidth.max] - The maximum experimental google video streaming bandwidth sent to peers.\n   * @property {Object} mediaStatus The peer streaming media status.\n   * @property {Boolean} mediaStatus.audioMuted -  The value of the audio status.\n   *   <small>If peer <code>mediaStatus</code> is <code>-1</code>, audio is not present in the stream. If peer <code>mediaStatus</code> is <code>1</code>, audio is present\n   *   in the stream and active (not muted). If peer <code>mediaStatus</code> is <code>0</code>, audio is present in the stream and muted.\n   *   </small>\n   * @property {Boolean} mediaStatus.videoMuted - The value of the video status.\n   *   <small>If peer <code>mediaStatus</code> is <code>-1</code>, video is not present in the stream. If peer <code>mediaStatus</code> is <code>1</code>, video is present\n   *   in the stream and active (not muted). If peer <code>mediaStatus</code> is <code>0</code>, video is present in the stream and muted.\n   *   </small>\n   */\n  /**\n   * @description Method that gets the list of current custom peer settings sent and set.\n   * @param {String} roomName - The room name.\n   * @return {Object.<String, customSettings>|null} - The peer custom settings keyed by peer id.\n   * @example\n   * Example 1: Get the list of current peer custom settings from peers in a room.\n   *\n   * const currentPeerSettings = skylink.getPeersCustomSettings(\"Room_1\");\n   * @alias Skylink#getPeersCustomSettings\n   * @since 0.6.18\n   */\n  getPeersCustomSettings(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return PeerData.getPeersCustomSettings(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that refreshes the main messaging data channel.\n   * @param {String} roomName - The room name.\n   * @param {String} peerId - The target peer id of the peer data channel to refresh.\n   * @return {null}\n   * @example\n   * Example 1: Initiate refresh data channel\n   *\n   * skylink.refreshDatachannel(\"Room_1\", \"peerID_1\");\n   *\n   * @alias Skylink#refreshDatachannel\n   * @since 0.6.30\n   */\n  refreshDatachannel(roomName, peerId) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return PeerConnection.refreshDataChannel(roomState, peerId);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that refreshes peer connections to update with the current streaming.\n   * <blockquote class=\"info\">\n   *   Note that Edge browser does not support renegotiation.\n   *   For MCU enabled peer connections with <code>options.mcuUseRenegoRestart</code> set to <code>false</code>\n   *   in the {@link initOptions}, the restart method may differ, you\n   *   may learn more about how to workaround it in this article\n   *   {@link http://support.temasys.io/support/discussions/topics/12000002853|here}.\n   *   For restarts with peers connecting from Android, iOS or C++ SDKs, restarts might not work as written in this article\n   *   {@link http://support.temasys.io/support/discussions/topics/12000005188|here}.\n   *   Note that this functionality should be used when peer connection stream freezes during a connection.\n   *   For a better user experience for only MCU enabled peer connections, the method is throttled when invoked many\n   *   times in less than the milliseconds interval configured in {@link initOptions}.\n   * </blockquote>\n   * @param {String} roomName - The name of the room.\n   * @param {String|Array} [targetPeerId] <blockquote class=\"info\">\n   *   Note that this is ignored if MCU is enabled for the App Key provided in\n   *   {@link initOptions}. <code>refreshConnection()</code> will \"refresh\"\n   *   all peer connections. </blockquote>\n   *   - The target peer id to refresh connection with.\n   * - When provided as an Array, it will refresh all connections with all the peer ids provided.\n   * - When not provided, it will refresh all the currently connected peers in the room.\n   * @param {Boolean} [iceRestart=false] <blockquote class=\"info\">\n   *   Note that this flag will not be honoured for MCU enabled peer connections where\n   *   <code>options.mcuUseRenegoRestart</code> flag is set to <code>false</code> as it is not necessary since for MCU\n   *   \"restart\" case is to invoke {@link Skylink#joinRoom}again, or that it is\n   *   not supported by the MCU.</blockquote>\n   *   The flag if ICE connections should restart when refreshing peer connections.\n   *   This is used when ICE connection state is <code>FAILED</code> or <code>DISCONNECTED</code>, which state\n   *   can be retrieved with the {@link SkylinkEvents.event:iceConnectionState|iceConnectionStateEvent}\n   * @param {JSON} [options] <blockquote class=\"info\">\n   *   Note that for MCU connections, the <code>bandwidth</code> or <code>googleXBandwidth</code>\n   *   settings will override for all peers or the current room connection session settings.</blockquote>\n   *   The custom peer configuration settings.\n   * @param {JSON} [options.bandwidth] The configuration to set the maximum streaming bandwidth to send to peers.\n   *   Object signature follows {@link Skylink#joinRoom}\n   *   <code>options.bandwidth</code> settings.\n   * @param {JSON} [options.googleXBandwidth] The configuration to set the experimental google\n   *   video streaming bandwidth sent to peers.\n   *   Object signature follows {@link Skylink#joinRoom}\n   *   <code>options.googleXBandwidth</code> settings.\n   * @return {Promise.<refreshConnectionResolve>} - The Promise will always resolve.\n   * @example\n   * Example 1: Refreshing a peer connection\n   *\n   * skylink.refreshConnection(roomName, peerId)\n   * .then((result) => {\n   *   const failedRefreshIds = Object.keys(result.refreshErrors);\n   *   failedRefreshIds.forEach((peerId) => {\n   *     // handle error\n   *   });\n   * });\n   *\n   * @example\n   * Example 2: Refreshing a list of peer connections\n   * let selectedPeers = [\"peerID_1\", \"peerID_2\"];\n   *\n   * skylink.refreshConnection(roomName, selectedPeers)\n   * .then((result) => {\n   *   const failedRefreshIds = Object.keys(result.refreshErrors);\n   *   failedRefreshIds.forEach((peerId) => {\n   *     // handle error\n   *   });\n   * });\n   * @example\n   * Example 3: Refreshing all peer connections\n   *\n   * skylink.refreshConnection(roomName)\n   * .then((result) => {\n   *   const failedRefreshIds = Object.keys(result.refreshErrors);\n   *   failedRefreshIds.forEach((peerId) => {\n   *    // handle error\n   *   });\n   * });\n   * @alias Skylink#refreshConnection\n   * @since 0.5.5\n   */\n  refreshConnection(roomName, targetPeerId, iceRestart, options) {\n    const roomState = getRoomStateByName(roomName);\n\n    return PeerConnection.refreshConnection(roomState, targetPeerId, iceRestart, options);\n  }\n\n  /**\n   * @description Method that returns starts screenshare and returns the stream.\n   * @param {String} roomName - The room name.\n   * @param {Boolean} replaceUserMediaStream - The flag if screenshare replaces the <code>userMedia</code> stream.\n   * @param {String} [streamId] - The stream id of the <code>userMedia</code> stream to replace. streamId must be provided if there is more than\n   * one <code>userMedia</code> stream on the peer connection and replaceUserMediaStream is true.\n   * @return {MediaStream|null} - The screen share stream.\n   * @example\n   * Example 1: Replace selected stream with screen share stream\n   *\n   * let shareScreenReplace = () => {\n   *    // Retrieve all userMedia streams\n   *    const streamList = skylink.getStreams(roomName);\n   *    skylink.shareScreen(roomName, true, Object.keys(streamList.userMedia)[0]).then((screenStream) => {\n   *      window.attachMediaStream(localVideoElement, screenStream);\n   *    });\n   * }\n   * @alias Skylink#shareScreen\n   * @since 2.0.0\n   */\n  shareScreen(roomName, streamId) {\n    const replaceUserMediaStream = false;\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      const screenSharing = new ScreenSharing(roomState);\n      return screenSharing.start(replaceUserMediaStream, streamId);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that returns the screenshare stream id of peers.\n   * @param {String} roomName - The room name.\n   * @return {Object.<String, MediaStream>|null} screenshareStream - The peer screen share stream keyed by peer id if there is one.\n   * @alias Skylink#getPeersScreenshare\n   * @since 2.0.0\n   */\n  getPeersScreenshare(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return PeerConnection.getPeerScreenshare(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * <blockquote class=\"info\">\n   *   For a better user experience, the functionality is throttled when invoked many times in less\n   *   than the milliseconds interval configured in the {@link initOptions}.\n   * </blockquote>\n   * @description Method that retrieves camera stream.\n   * <p>Resolves with an array of <code>MediaStreams</code>. First item in array is <code>MediaStream</code> of kind audio and second item is\n   * <code>MediaStream</code> of kind video.</p>\n   * @param {String|null} roomName - The room name.\n   * - If no roomName is passed or <code>getUserMedia()</code> is called before {@link Skylink#joinRoom|joinRoom}, the returned stream will not be associated with a room. The stream must be maintained independently.\n   * To stop the stream, call {@link Skylink#stopPrefetchedStream|stopPrefetchedStream} method.\n   * @param {JSON} [options] - The camera stream configuration options.\n   * - When not provided, the value is set to <code>{ audio: true, video: true }</code>.\n   *   To fallback to retrieve audio track only when retrieving of audio and video tracks failed,\n   *   enable the <code>audioFallback</code> flag in the {@link initOptions}.\n   * @param {Boolean} [options.useExactConstraints=false] <blockquote class=\"info\">\n   *   Note that by enabling this flag, exact values will be requested when retrieving camera stream,\n   *   but it does not prevent constraints related errors. By default when not enabled,\n   *   expected mandatory maximum values (or optional values for source id) will requested to prevent constraints related\n   *   errors, with an exception for <code>options.video.frameRate</code> option in Safari and IE (any plugin-enabled) browsers,\n   *   where the expected maximum value will not be requested due to the lack of support.</blockquote>\n   *   The flag if <code>getUserMedia()</code> should request for camera stream to match exact requested values of\n   *   <code>options.audio.deviceId</code> and <code>options.video.deviceId</code>, <code>options.video.resolution</code>\n   *   and <code>options.video.frameRate</code> when provided.\n   * @param {Boolean|JSON} [options.audio=false] <blockquote class=\"info\">\n   *    Note that the current Edge browser implementation does not support the <code>options.audio.optional</code>,\n   *    <code>options.audio.deviceId</code>, <code>options.audio.echoCancellation</code>.</blockquote>\n   *    The audio configuration options.\n   * @param {Boolean} [options.audio.stereo=false] <blockquote class=\"info\"><b>Deprecation Warning!</b>\n   *   This property has been deprecated. Configure this with the <code>options.codecParams.audio.opus.stereo</code> and\n   *   the <code>options.codecParams.audio.opus[\"sprop-stereo\"]</code>\n   *   parameter in the {@link initOptions} instead. If the\n   *   <code>options.codecParams.audio.opus.stereo</code> or <code>options.codecParams.audio.opus[\"sprop-stereo\"]</code>\n   *   is configured, this overrides the <code>options.audio.stereo</code> setting.</blockquote>\n   *   The flag if OPUS audio codec stereo band should be configured for sending encoded audio data.\n   *   When not provided, the default browser configuration is used.\n   * @param {Boolean} [options.audio.usedtx] <blockquote class=\"info\"><b>Deprecation Warning!</b>\n   *   This property has been deprecated. Configure this with the <code>options.codecParams.audio.opus.stereo</code>\n   *   parameter in the {@link initOptions} instead. If the\n   *   <code>options.codecParams.audio.opus.stereo</code> is configured, this overrides the\n   *   <code>options.audio.stereo</code> setting.  Note that this feature might\n   *   not work depending on the browser support and implementation.</blockquote>\n   *   The flag if OPUS audio codec should enable DTX (Discontinuous Transmission) for sending encoded audio data.\n   *   This might help to reduce bandwidth as it reduces the bitrate during silence or background noise, and\n   *   goes hand-in-hand with the <code>options.voiceActivityDetection</code> flag in <a href=\"#method_joinRoom\">\n   *   <code>joinRoom()</code> method</a>.\n   *   When not provided, the default browser configuration is used.\n   * @param {Boolean} [options.audio.useinbandfec] <blockquote class=\"info\"><b>Deprecation Warning!</b>\n   *   This property has been deprecated. Configure this with the <code>options.codecParams.audio.opus.useinbandfec</code>\n   *   parameter in the {@link initOptions} instead. If the\n   *   <code>options.codecParams.audio.opus.useinbandfec</code> is configured, this overrides the\n   *   <code>options.audio.useinbandfec</code> setting. Note that this parameter should only be used\n   *   for debugging purposes only.</blockquote>\n   *   The flag if OPUS audio codec has the capability to take advantage of the in-band FEC\n   *   (Forward Error Correction) when sending encoded audio data.\n   *   This helps to reduce the harm of packet loss by encoding information about the previous packet loss.\n   *   When not provided, the default browser configuration is used.\n   * @param {Number} [options.audio.maxplaybackrate] <blockquote class=\"info\"><b>Deprecation Warning!</b>\n   *   This property has been deprecated. Configure this with the <code>options.codecParams.audio.opus.maxplaybackrate</code>\n   *   parameter in the {@link initOptions} instead. If the\n   *   <code>options.codecParams.audio.opus.maxplaybackrate</code> is configured, this overrides the\n   *   <code>options.audio.maxplaybackrate</code> setting.  Note that this feature might\n   *   not work depending on the browser support and implementation.\n   *   Note that this parameter should only be used for debugging purposes only.</blockquote>\n   *   The OPUS audio codec maximum output sampling rate in Hz (hertz) that is is capable of receiving\n   *   decoded audio data, to adjust to the hardware limitations and ensure that any sending audio data\n   *   would not encode at a higher sampling rate specified by this.\n   *   This value must be between <code>8000</code> to <code>48000</code>.\n   *   When not provided, the default browser configuration is used.\n   * @param {Boolean} [options.audio.mute=false] The flag if audio tracks should be muted upon receiving them.\n   *   Providing the value as <code>false</code> sets <code>peerInfo.mediaStatus.audioMuted</code> to <code>1</code>,\n   *   but when provided as <code>true</code>, this sets the <code>peerInfo.mediaStatus.audioMuted</code> value to\n   *   <code>0</code> and mutes any existing <a href=\"#method_shareScreen\">\n   *   <code>shareScreen()</code> stream</a> audio tracks as well.\n   * @param {Array} [options.audio.optional] <blockquote class=\"info\">\n   *   This property has been deprecated. \"optional\" constraints has been moved from specs.<br>\n   *   Note that this may result in constraints related error when <code>options.useExactConstraints</code> value is\n   *   <code>true</code>. If you are looking to set the requested source id of the audio track,\n   *   use <code>options.audio.deviceId</code> instead.</blockquote>\n   *   The <code>navigator.getUserMedia()</code> API <code>audio: { optional [..] }</code> property.\n   * @param {String} [options.audio.deviceId] <blockquote class=\"info\">\n   *   Note this is currently not supported in Firefox browsers.\n   *   </blockquote> The audio track source id of the device to use.\n   *   The list of available audio source id can be retrieved by the {@link https://developer.\n   * mozilla.org/en-US/docs/Web/API/MediaDevices/enumerateDevices}.\n   * @param {Boolean} [options.audio.echoCancellation=true] <blockquote class=\"info\">\n   *   For Chrome/Opera/IE/Safari/Bowser, the echo cancellation @description Methodality may not work and may produce a terrible\n   *   feedback. It is recommended to use headphones or other microphone devices rather than the device\n   *   in-built microphones.</blockquote> The flag to enable echo cancellation for audio track.\n   * @param {Boolean|JSON} [options.video=false] <blockquote class=\"info\">\n   *    Note that the current Edge browser implementation does not support the <code>options.video.optional</code>,\n   *    <code>options.video.deviceId</code>, <code>options.video.resolution</code> and\n   *    <code>options.video.frameRate</code>, <code>options.video.facingMode</code>.</blockquote>\n   *   The video configuration options.\n   * @param {Boolean} [options.video.mute=false] The flag if video tracks should be muted upon receiving them.\n   *   Providing the value as <code>false</code> sets the <code>peerInfo.mediaStatus.videoMuted</code> value to\n   *   <code>1</code>, but when provided as <code>true</code>, this sets the <code>peerInfo.mediaStatus.videoMuted</code> value to\n   *   <code>0</code> and mutes any existing <a href=\"#method_shareScreen\">\n   *   <code>shareScreen()</code> stream</a> video tracks as well.\n   * @param {JSON} [options.video.resolution] The video resolution.\n   *   By default, <a href=\"#attr_VIDEO_RESOLUTION\"><code>VGA</code></a> resolution option\n   *   is selected when not provided.\n   *   [Rel: {@link SkylinkConstants.VIDEO_RESOLUTION|VIDEO_RESOLUTION}]\n   * @param {Number|JSON} [options.video.resolution.width] The video resolution width.\n   * - When provided as a number, it is the video resolution width.\n   * - When provided as a JSON, it is the <code>navigator.mediaDevices.getUserMedia()</code> <code>.width</code> settings.\n   *   Parameters are <code>\"ideal\"</code> for ideal resolution width, <code>\"exact\"</code> for exact video resolution width,\n   *   <code>\"min\"</code> for min video resolution width and <code>\"max\"</code> for max video resolution width.\n   *   Note that this may result in constraints related errors depending on the browser/hardware supports.\n   * @param {Number|JSON} [options.video.resolution.height] The video resolution height.\n   * - When provided as a number, it is the video resolution height.\n   * - When provided as a JSON, it is the <code>navigator.mediaDevices.getUserMedia()</code> <code>.height</code> settings.\n   *   Parameters are <code>\"ideal\"</code> for ideal video resolution height, <code>\"exact\"</code> for exact video resolution height,\n   *   <code>\"min\"</code> for min video resolution height and <code>\"max\"</code> for max video resolution height.\n   *   Note that this may result in constraints related errors depending on the browser/hardware supports.\n   * @param {Number|JSON} [options.video.frameRate] The video {@link https://en.wikipedia.org/wiki/Frame_rate} per second (fps).\n   * - When provided as a number, it is the video framerate.\n   * - When provided as a JSON, it is the <code>navigator.mediaDevices.getUserMedia()</code> <code>.frameRate</code> settings.\n   *   Parameters are <code>\"ideal\"</code> for ideal video framerate, <code>\"exact\"</code> for exact video framerate,\n   *   <code>\"min\"</code> for min video framerate and <code>\"max\"</code> for max video framerate.\n   *   Note that this may result in constraints related errors depending on the browser/hardware supports.\n   * @param {Array} [options.video.optional] <blockquote class=\"info\">\n   *   This property has been deprecated. \"optional\" constraints has been moved from specs.<br>\n   *   Note that this may result in constraints related error when <code>options.useExactConstraints</code> value is\n   *   <code>true</code>. If you are looking to set the requested source id of the video track,\n   *   use <code>options.video.deviceId</code> instead.</blockquote>\n   *   The <code>navigator.getUserMedia()</code> API <code>video: { optional [..] }</code> property.\n   * @param {String} [options.video.deviceId] <blockquote class=\"info\">\n   *   Note this is currently not supported in Firefox browsers.\n   *   </blockquote> The video track source id of the device to use.\n   *   The list of available video source id can be retrieved by the {@link https://developer.\n   * mozilla.org/en-US/docs/Web/API/MediaDevices/enumerateDevices}.\n   * @param {String|JSON} [options.video.facingMode] The video camera facing mode.\n   *   The list of available video source id can be retrieved by the {@link https://developer.mozilla.org\n   *   /en-US/docs/Web/API/MediaTrackConstraints/facingMode}.\n   * @return {Promise.<MediaStreams>}\n   * @example\n   * Example 1: Get both audio and video after joinRoom\n   *\n   * skylink.getUserMedia(roomName, {\n   *     audio: true,\n   *     video: true,\n   * }).then((streams) => // do something)\n   * .catch((error) => // handle error);\n   * @example\n   * Example 2: Get only audio\n   *\n   * skylink.getUserMedia(roomName, {\n   *     audio: true,\n   *     video: false,\n   * }).then((streams) => // do something)\n   * .catch((error) => // handle error);\n   * @example\n   * Example 3: Configure resolution for video\n   *\n   * skylink.getUserMedia(roomName, {\n   *     audio: true,\n   *     video: { resolution: skylinkConstants.VIDEO_RESOLUTION.HD },\n   * }).then((streams) => // do something)\n   * .catch((error) => // handle error);\n   * @example\n   * Example 4: Configure stereo flag for OPUS codec audio (OPUS is always used by default)\n   *\n   * this.skylink.getUserMedia(roomName, {\n   *     audio: {\n   *         stereo: true,\n   *     },\n   *     video: true,\n   * }).then((streams) => // do something)\n   * .catch((error) => // handle error);\n   * @example\n   * Example 5: Get both audio and video before joinRoom\n   *\n   * // Note: the prefetched stream must be maintained independently\n   * skylink.getUserMedia({\n   *     audio: true,\n   *     video: true,\n   * }).then((streams) => // do something)\n   * .catch((error) => // handle error);\n   * @example\n   * Example 6: Get media sources before joinRoom - only available on Chrome browsers\n   *\n   * const audioInputDevices = [];\n   * const videoInputDevices = [];\n   *\n   * navigator.mediaDevices.enumerateDevices().then((devices) => {\n   *   devices.forEach((device) => {\n   *     if (device.kind === \"audioinput\") {\n   *       audioInputDevices.push(device);\n   *     }\n   *\n   *     if (device.kind === \"videoinput\") {\n   *       videoInputDevices.push(device);\n   *     }\n   *   })\n   * }).catch((error) => // handle error);\n   *\n   * skylink.getUserMedia(roomName, {\n   *   audio: {\n   *     deviceId: audioInputDevices[0].deviceId,\n   *   },\n   *   video: {\n   *     deviceId: videoInputDevices[0].deviceId,\n   *   }\n   * }).then((streams) => // do something)\n   * .catch((error) => // handle error);\n   * @fires <b>If retrieval of fallback audio stream is successful:</b> <br/> - {@link SkylinkEvents.event:mediaAccessSuccess|mediaAccessSuccessEvent} with parameter payload <code>isScreensharing=false</code> and <code>isAudioFallback=false</code> if initial retrieval is successful.\n   * @fires <b>If initial retrieval is unsuccessful:</b> <br/> Fallback to retrieve audio only stream is triggered (configured in {@link initOptions} <code>audioFallback</code>) <br/>&emsp; - {@link SkylinkEvents.event:mediaAccessFallback|mediaAccessFallbackEvent} with parameter payload <code>state=FALLBACKING</code>, <code>isScreensharing=false</code> and <code>isAudioFallback=true</code> and <code>options.video=true</code> and <code>options.audio=true</code>. <br/> No fallback to retrieve audio only stream <br/> - {@link SkylinkEvents.event:mediaAccessError|mediaAccessErrorEvent} with parameter payload <code>isScreensharing=false</code> and <code>isAudioFallbackError=false</code>.\n   * @fires <b>If retrieval of fallback audio stream is successful:</b> <br/> - {@link SkylinkEvents.event:mediaAccessSuccess|mediaAccessSuccessEvent} with parameter payload <code>isScreensharing=false</code> and <code>isAudioFallback=true</code>.\n   * @fires <b>If retrieval of fallback audio stream is unsuccessful:</b> <br/> - {@link SkylinkEvents.event:mediaAccessFallback|mediaAccessFallbackEvent} with parameter payload <code>state=ERROR</code>, <code>isScreensharing=false</code> and <code>isAudioFallback=true</code>. <br/> - {@link SkylinkEvents.event:mediaAccessError|mediaAccessErrorEvent} with parameter payload <code>isScreensharing=false</code> and <code>isAudioFallbackError=true</code>.\n   * @alias Skylink#getUserMedia\n   * @since 0.5.6\n   */\n  // eslint-disable-next-line consistent-return\n  getUserMedia(roomName = null, options) {\n    if (!roomName) {\n      return statelessGetUserMedia(options);\n    }\n\n    if (isAString(roomName)) {\n      const roomState = getRoomStateByName(roomName);\n      if (roomState) {\n        return MediaStream.getUserMediaLayer(roomState, options);\n      }\n    } else if (isAObj(roomName)) {\n      return statelessGetUserMedia(roomName);\n    }\n  }\n\n  /**\n   * @description Method that stops the {@link Skylink#getUserMedia} stream that is called without roomName param or before {@link Skylink#joinRoom|joinRoom} is called.\n   * @param {MediaStream} stream - The prefetched stream.\n   * @return {null}\n   * @fires {@link SkylinkEvents.event:streamEnded|streamEndedEvent}\n   * @alias Skylink#stopPrefetchedStream\n   * @since 2.0\n   * @ignore\n   */\n  stopPrefetchedStream(stream) {\n    if (stream) {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n      });\n\n      dispatchEvent(streamEnded({\n        room: null,\n        peerId: null,\n        peerInfo: null,\n        isSelf: true,\n        isScreensharing: false,\n        streamId: stream.id,\n      }));\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that stops the screen share stream returned from {@link Skylink#shareScreen|shareScreen} method.\n   * @param {String} roomName - The room name.\n   * @return {null}\n   * @example\n   * Example 1\n   *\n   * skylink.stopScreen(roomName);\n   *\n   * @fires {@link SkylinkEvents.event:mediaAccessStopped|mediaAccessStoppedEvent} with parameter payload <code>isScreensharing</code> value as <code>true</code> and <code>isAudioFallback</code> value as <code>false</code> if there is a screen stream\n   * @fires {@link SkylinkEvents.event:streamEnded|streamEndedEvent} with parameter payload <code>isSelf</code> value as <code>true</code> and <code>isScreensharing</code> value as <code>true</code> if user is in the room\n   * @fires {@link SkylinkEvents.event:peerUpdated|peerUpdatedEvent} with parameter payload <code>isSelf</code> value as <code>true</code>\n   * @fires {@link SkylinkEvents.event:onIncomingStream|onIncomingStreamEvent} with parameter payload <code>isSelf</code> value as <code>true</code> and <code>stream</code> as {@link Skylink#getUserMedia} stream</a> if there is an existing <code>userMedia</code> stream\n   * @alias Skylink#stopScreen\n   * @since 0.6.0\n   */\n  stopScreen(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      const screenSharing = new ScreenSharing(roomState);\n      screenSharing.stop();\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that stops the <code>userMedia</code> stream returned from {@link Skylink#getUserMedia|getUserMedia}</a> method.\n   * @param {String} roomName - The room name.\n   * @param {String} streamId - The stream id of the stream to stop. If streamId is not set, all <code>userMedia</code> streams will be stopped.\n   * @return {Promise}\n   * @example\n   * skylink.stopStreams(roomName)\n   * .then(() => // do some thing);\n   * @fires {@link SkylinkEvents.event:mediaAccessStopped|mediaAccessStoppedEvent} with parameter payload <code>isSelf=true</code> and <code>isScreensharing=false</code> if there is a <code>getUserMedia</code> stream.\n   * @fires {@link SkylinkEvents.event:streamEnded|streamEndedEvent} with parameter payload <code>isSelf=true</code> and <code>isScreensharing=false</code> if there is a <code>getUserMedia</code> stream and user is in a room.\n   * @fires {@link SkylinkEvents.event:peerUpdated|peerUpdatedEvent} with parameter payload <code>isSelf=true</code>.\n   * @alias Skylink#stopStreams\n   * @since 0.5.6\n   */\n  stopStreams(roomName, streamId) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return MediaStream.stopStreams(roomState, streamId);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that stops the room session.\n   * @param {String} roomName  - The room name to leave.\n   * @return {Promise.<String>}\n   * @example\n   * Example 1:\n   *\n   * // add event listener to catch peerLeft events when remote peer leaves room\n   * SkylinkEventManager.addEventListener(SkylinkConstants.EVENTS.PEER_LEFT, (evt) => {\n   *    const { detail } = evt;\n   *   // handle remote peer left\n   * });\n   *\n   * skylink.leaveRoom(roomName)\n   * .then((roomName) => {\n   *   // handle local peer left\n   * })\n   * .catch((error) => // handle error);\n   * @fires {@link SkylinkEvents.event:peerLeft|peerLeft} on the remote end of the connection.\n   * @alias Skylink#leaveRoom\n   * @since 0.5.5\n   */\n  leaveRoom(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return Room.leaveRoom(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that stops all room sessions.\n   * @return {Promise.<Array.<String>>}\n   * @alias Skylink#leaveAllRooms\n   * @since 2.0.0\n   */\n  leaveAllRooms() {\n    return Room.leaveAllRooms();\n  }\n\n  /**\n   * @description Method that starts a recording session.\n   * <blockquote class=\"info\">\n   *   Note that this feature requires MCU and recording to be enabled for the App Key provided in\n   *   {@link initOptions}. If recording feature is not available to\n   *   be enabled in the {@link https://console.temasys.io|Temasys Developer Console}, please contact us on our support portal {@link http://support.temasys.io|here}.\n   * </blockquote>\n   * @param {String} roomName - The room name.\n   * @return {Promise<String>} recordingId - The recording session id.\n   * @example\n   * Example 1: Start a recording session\n   *\n   * skylink.startRecording(roomName)\n   * .then(recordingId => {\n   *   // do something\n   * })\n   * .catch(error => {\n   *   // handle error\n   * });\n   * @fires {@link SkylinkEvents.recordingState|recordingStateEvent} with payload <code>state=START</code> if recording has started successfully.\n   * @fires {@link SkylinkEvents.recordingState|recordingStateEvent} with payload <code>error</code> if an error occurred during recording.\n   * @alias Skylink#startRecording\n   * @since 0.6.16\n   */\n  startRecording(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return Recording.start(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that stops a recording session.\n   * <blockquote class=\"info\">\n   *   <ul>\n   *     <li>\n   *      Note that this feature requires MCU and recording to be enabled for the App Key provided in the\n   *      {@link initOptions}. If recording feature is not available to be enabled in the {@link https://console.temasys.io|Temasys Developer Console},\n   *      please contact us on our support portal {@link http://support.temasys.io|here}.\n   *    </li>\n   *    <li>\n   *      It is mandatory for the recording session to have elapsed for more than 4 minutes before calling <code>stopRecording</code> method.\n   *    </li>\n   *   </ul>\n   * </blockquote>\n   * @param {String} roomName - The room name.\n   * @return {Promise<String>} recordingId - The recording session id.\n   * @example\n   * Example 1: Stop the recording session\n   *\n   * skylink.stopRecording(roomName)\n   * .then(recordingId => {\n   *   // do something\n   * })\n   * .catch(error => {\n   *   // handle error\n   * });\n   * @fires {@link SkylinkEvents.recordingState|recordingStateEvent} with payload <code>state=STOP</code> if recording has stopped successfully.\n   * @fires {@link SkylinkEvents.recordingState|recordingStateEvent} with payload <code>error</code> if an error occurred during recording.\n   * @alias Skylink#stopRecording\n   * @since 0.6.16\n   */\n  stopRecording(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return Recording.stop(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that locks a room.\n   * @param {String} roomName - The room name.\n   * @return {Boolean}\n   * @fires {@link SkylinkEvents.event:roomLock|roomLockEvent} with payload parameters <code>isLocked=true</code> when the room is successfully locked.\n   * @example\n   * // add event listener to listen for room locked state when peer tries to join a locked room\n   * skylinkEventManager.addEventListener(SkylinkEvents.SYSTEM_ACTION, (evt) => {\n   *   const { detail } = evt;\n   *   if (detail.reason === SkylinkConstants.SYSTEM_ACTION.LOCKED') {\n   *     // handle event\n   *   }\n   * }\n   *\n   * // add event listener to listen for room locked/unlocked event after calling lockRoom method\n   * skylinkEventManager.addEventListener(SkylinkEvents.ROOM_LOCK, (evt) => {\n   *   const { detail } = evt;\n   *   if (detail.isLocked) {\n   *     // handle room lock event\n   *   } else {\n   *     // handle room unlock event\n   *   }\n   * }\n   *\n   * skylink.lockRoom(roomName);\n   * @alias Skylink#lockRoom\n   * @since 0.5.0\n   */\n  lockRoom(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return Room.lockRoom(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that unlocks a room.\n   * @param {String} roomName - The room name.\n   * @return {Boolean}\n   * @fires {@link SkylinkEvents.event:roomLock|roomLockEvent} with payload parameters <code>isLocked=false</code> when the room is successfully locked.\n   * @alias Skylink#unlockRoom\n   * @since 0.5.0\n   */\n  unlockRoom(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return Room.unlockRoom(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @typedef {Object} recordingSessions\n   * @property {Object<string, Object>} #recordingId - The recording session keyed by recording id.\n   * @property {Boolean} #recordingId.active - The flag that indicates if the recording session is currently active.\n   * @property {String} #recordingId.state - The current recording state. [Rel: {@link SkylinkConstants.RECORDING_STATE|RECORDING_STATE}]\n   * @property {String} #recordingId.startedStateTime - The recording session started DateTime in\n   *   {@link https://en.wikipedia.org/wiki/ISO_8601|ISO}.Note that this value may not be\n   *   very accurate as this value is recorded when the start event is received.\n   * @property {String} #recordingId.endedDateTime - The recording session ended DateTime in\n   *   {@link https://en.wikipedia.org/wiki/ISO_8601|ISO}.Note that this value may not be\n   *   very accurate as this value is recorded when the stop event is received.\n   *   Defined only after <code>state</code> has triggered <code>STOP</code>.\n   * @property {String} #recordingId.mixingDateTime - The recording session mixing completed DateTime in\n   *   {@link https://en.wikipedia.org/wiki/ISO_8601|ISO}.Note that this value may not be\n   *   very accurate as this value is recorded when the mixing completed event is received.\n   *   Defined only when <code>state</code> is <code>LINK</code>.\n   * @property {String} #recordingId.links - The recording session links.\n   *   Object signature matches the <code>link</code> parameter payload received in the\n   *   {@link SkylinkEvents.event:recordingState|recordingStateEvent} event.\n   * @property {Error} #recordingId.error - The recording session error.\n   *   Defined only when <code>state</code> is <code>ERROR</code>.\n   */\n  /**\n   * Gets the list of current recording sessions since user has connected to the room.\n   * @description Method that retrieves the list of recording sessions.\n   * <blockquote class=\"info\">\n   *   Note that this feature requires MCU and recording to be enabled for the App Key provided in\n   *   {@link initOptions}. If recording feature is not available to be enabled in the {@link https://console.temasys.io|Temasys Developer Console},\n   *   please contact us on our support portal {@link http://support.temasys.io|here}.\n   * </blockquote>\n   * @param {String} roomName - The room name.\n   * @return {recordingSessions|{}} The list of recording sessions.\n   * @example\n   * Example 1: Get recording sessions\n   *\n   * skylink.getRecordings(roomName);\n   * @alias Skylink#getRecordings\n   * @since 0.6.16\n   */\n  getRecordings(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return Recording.getRecordings(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that mutes both <code>userMedia</code> [{@link Skylink#getUserMedia|getUserMedia}] stream and\n   * <code>screen</code> [{@link Skylink#shareScreen|shareScreen}] stream.\n   * @param {String} roomName - The room name.\n   * @param {JSON} options - The streams muting options.\n   * @param {Boolean} [options.audioMuted=true] - The flag if all streams audio\n   *   tracks should be muted or not.\n   * @param {Boolean} [options.videoMuted=true] - The flag if all streams video\n   *   tracks should be muted or not.\n   * @param {String} [streamId] - The id of the stream to mute.\n   * @return {null}\n   * @example\n   * Example 1: Mute both audio and video tracks in all streams\n   *\n   * skylink.muteStreams(roomName, {\n   *    audioMuted: true,\n   *    videoMuted: true\n   * });\n   * @example\n   * Example 2: Mute only audio tracks in all streams\n   *\n   * skylink.muteStreams(roomName, {\n   *    audioMuted: true,\n   *    videoMuted: false\n   * });\n   * @example\n   * Example 3: Mute only video tracks in all streams\n   *\n   * skylink.muteStreams(roomName, {\n   *    audioMuted: false,\n   *    videoMuted: true\n   * });\n   * @fires <b>On local peer:</b> {@link SkylinkEvents.event:localMediaMuted|localMediaMutedEvent}, {@link SkylinkEvents.event:streamMuted|streamMuted}, {@link SkylinkEvents.event:peerUpdated|peerUpdatedEvent} with payload parameters <code>isSelf=true</code> and <code>isAudio=true</code> if a local audio stream is muted or <code>isVideo</code> if local video stream is muted.\n   * @fires <b>On remote peer:</b> {@link SkylinkEvents.event:streamMuted|streamMuted}, {@link SkylinkEvents.event:peerUpdated|peerUpdatedEvent} with with parameter payload <code>isSelf=false</code> and <code>isAudio=true</code> if a remote audio stream is muted or <code>isVideo</code> if remote video stream is muted.\n   * @alias Skylink#muteStreams\n   * @since 0.5.7\n   */\n  muteStreams(roomName, options = { audioMuted: true, videoMuted: true }, streamId) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return MediaStream.muteStreams(roomState, options, streamId);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that starts a RTMP session. [Beta]\n   * <blockquote class=\"info\">\n   *   Note that this feature requires MCU to be enabled for the App Key provided in the\n   *   {@link initOptions}.\n   * </blockquote>\n   * @param {String} roomName - The room name.\n   * @param {String} streamId - The stream id to live stream for the session.\n   * @param {String} endpoint - The RTMP endpoint.\n   * @return {Promise<String>} rtmpId - The RTMP session id.\n   * @example\n   * Example 1: Start a rtmp session\n   *\n   * skylink.startRTMPSession(roomName, streamId, endpoint)\n   * .then(rtmpId => {\n   *   // do something\n   * })\n   * .catch(error => {\n   *   // handle error\n   * });\n   * @fires {@link SkylinkEvents.event:rtmpState|rtmpStateEvent} with parameter payload <code>state=START</code>.\n   * @alias Skylink#startRTMPSession\n   * @since 0.6.36\n   */\n  startRTMPSession(roomName, streamId, endpoint) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return RTMP.startSession(roomState, streamId, endpoint);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that stops a RTMP session. [Beta]\n   * <blockquote class=\"info\">\n   *   Note that this feature requires MCU to be enabled for the App Key provided in {@link initOptions}.\n   * </blockquote>\n   * @param {String} roomName - The room name.\n   * @param {String} rtmpId - The RTMP session id.\n   * @return {Promise<String>}\n   * @example\n   * Example 1: Stop rtmp session\n   *\n   * skylink.stopRTMPSession(roomName, rtmpId)\n   * .then(rtmpId => {\n   *   // do something\n   * })\n   * .catch(error => {\n   *   // handle error\n   * });\n   * @fires {@link SkylinkEvents.event:rtmpState|rtmpStateEvent} with parameter payload <code>state=STOP</code>.\n   * @alias Skylink#stopRTMPSession\n   * @since 0.6.36\n   */\n  stopRTMPSession(roomName, rtmpId) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return RTMP.stopSession(roomState, rtmpId);\n    }\n    return null;\n  }\n\n  /**\n     * @typedef {Object} streamSources\n     * @property {Object} audio - The list of audio input (microphone) and output (speakers) sources.\n     * @property {Array.<Object>} audio.input - The list of audio input (microphone) sources.\n     * @property {String} audio.input.deviceId The audio input source item device id.\n     * @property {String} audio.input.label The audio input source item device label name.\n     * @property {String} [audio.input.groupId] The audio input source item device physical device id.\n     * Note that there can be different <code>deviceId</code> due to differing sources but can share a\n     * <code>groupId</code> because it's the same device.\n     * @property {Array.<Object>} audio.output - The list of audio output (speakers) sources.\n     * Object signature matches <code>audio.input</code> format.\n     * @property {Object} video - The list of video input (camera) sources.\n     * @property {Array.<Object>} video.input - The list of video input (camera) sources.\n     * Object signature matches <code>audio.input</code> format.\n     */\n  /**\n   * @description Method that returns the camera and microphone sources.\n   * @return {Promise.<streamSources>} outputSources\n   * @alias Skylink#getStreamSources\n   */\n  getStreamSources() {\n    return MediaStream.getStreamSources();\n  }\n\n  /**\n   * @description Method that sends a new <code>userMedia</code> stream to all connected peers in a room.\n   * <p>Resolves with an array of <code>MediaStreams</code>. First item in array is <code>MediaStream</code> of kind audio and second item is\n   * <code>MediaStream</code> of kind video.</p>\n   * @param {String} roomName - The room name.\n   * @param {JSON|MediaStream} options - The {@link Skylink#getUserMedia|getUserMedia} <code>options</code> parameter settings. The MediaStream to send to the remote peer.\n   * - When provided as a <code>MediaStream</code> object, this configures the <code>options.audio</code> and\n   *   <code>options.video</code> based on the tracks available in the <code>MediaStream</code> object.\n   *   Object signature matches the <code>options</code> parameter in the\n   *   <code>getUserMedia</code> method</a>.\n   * @return {Promise.<MediaStreams>}\n   * @example\n   * Example 1: Send new MediaStream with audio and video\n   *\n   * let sendStream = (roomName) => {\n   * const options = { audio: true, video: true };\n   *\n   * // Add listener to incomingStream event\n   * SkylinkEventManager.addEventListener(SkylinkConstants.EVENTS.ON_INCOMING_STREAM, (evt) => {\n   *   const { detail } = evt;\n   *   window.attachMediaStream(localVideoEl, detail.stream);\n   * })\n   *\n   * skylink.sendStream(roomName, options)\n   *  // streams can also be obtained from resolved promise\n   *  .then((streams) => {\n   *        if (streams[0]) {\n   *          window.attachMediaStream(audioEl, streams[0]); // first item in array is an audio stream\n   *        }\n   *        if (streams[1]) {\n   *          window.attachMediaStream(videoEl, streams[1]); // second item in array is a video stream\n   *        }\n   *    })\n   *   .catch((error) => { console.error(error) });\n   * }\n   *\n   * Example 2: Use pre-fetched media streams\n   *\n   * const prefetchedStreams = null;\n   * skylink.getUserMedia(null, {\n   *    audio: { stereo: true },\n   *    video: true,\n   *    })\n   *    .then((streams) => {\n   *      prefetchedStream = streams\n   * });\n   *\n   * skylink.sendStream(roomName, prefetchedStreams)\n   *   .catch((error) => { console.error(error) });\n   * }\n   *\n   * @fires {@link SkylinkEvents.event:mediaAccessSuccess} with parameter payload <code>isScreensharing=false</code> and\n   * <code>isAudioFallback=false</code> if <code>userMedia</code> <code>options</code> is passed into\n   * <code>sendStream</code> method.\n   * @fires {@link SkylinkEvents.event:onIncomingStream} with parameter payload <code>isSelf=true</code> and\n   * <code>stream</code> as <code>userMedia</code> stream.\n   * @fires {@link SkylinkEvents.event:peerUpdated} with parameter payload <code>isSelf=true</code>.\n   * @alias Skylink#sendStream\n   * @since 0.5.6\n   */\n  sendStream(roomName, options) {\n    const roomState = getRoomStateByName(roomName);\n\n    return MediaStream.sendStream(roomState, options);\n  }\n\n  /**\n   * @typedef {Object} screenSources - The list of screensharing media sources and screen sources.\n   * @property {Array.<String>} mediaSource - The screensharing media source item.\n   * @property {Array.<Object>} mediaSourceInput - The list of specific media source screen inputs.\n   * @property {String} mediaSourceInput.sourceId - The screen input item id.\n   * @property {Object} mediaSourceInput.label - The screen input item label name.\n   * @property {Object} mediaSourceInput.mediaSource - The screen input item media source it belongs to.\n   */\n  /**\n   * @description Method that returns the screensharing sources.\n   * @return {Promise.<screenSources>}\n   * @alias Skylink#getScreenSources\n   * @since 2.0.0\n   */\n  getScreenSources() {\n    return MediaStream.getScreenSources();\n  }\n\n  /**\n   * @typedef {Object} streamList\n   * @property {Object.<string, MediaStream>|null} userMedia - The user media streams keyed by stream id.\n   * @property {MediaStream|null} screenshare - The screenshare stream.\n   */\n  /**\n   * @description Method that returns all active user streams including screenshare stream if present.\n   * @param {String} roomName - The room name.\n   * @return {streamList|null}\n   * @alias Skylink#getStreams\n   * @since 2.0.0\n   */\n  getStreams(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    if (roomState) {\n      return MediaStream.getStreams(roomState);\n    }\n\n    return null;\n  }\n\n  /**\n   * @description Method that generates an <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\">UUID</a> (Unique ID).\n   * @return {String} Returns a generated UUID (Unique ID).\n   * @alias Skylink#generateUUID\n   * @since 0.5.9\n   */\n  generateUUID() {\n    return generateUUID();\n  }\n\n  /**\n   * @description Method that stores a secret and secret id pair used for encrypting and decrypting messages.\n   * @param {String} roomName - The room name.\n   * @param {String} secret - A secret to use for encrypting and decrypting messages.\n   * @param {String} secretId - The id of the secret.\n   * @alias Skylink#setEncryptSecret\n   * @since 2.0.0\n   */\n  setEncryptSecret(roomName = '', secret = '', secretId = '') {\n    const roomState = getRoomStateByName(roomName);\n    const encryption = new EncryptedMessaging(roomState);\n    return encryption.setEncryptSecret(secret, secretId);\n  }\n\n  /**\n   * @description Method that returns all the secret and secret id pairs.\n   * @param {String} roomName - The room name.\n   * @returns {Object|{}}\n   * @alias Skylink#getEncryptSecrets\n   * @since 2.0.0\n   */\n  getEncryptSecrets(roomName = '') {\n    const roomState = getRoomStateByName(roomName);\n    const encryption = new EncryptedMessaging(roomState);\n    return encryption.getEncryptSecrets();\n  }\n\n  /**\n   * @description Method that deletes an encrypt secret.\n   * @param {String} roomName - The room name.\n   * @param {String} [secretId] - The id of the secret to be deleted. If no secret id is provided, all secrets will be deleted.\n   * @alias Skylink#deleteEncryptSecrets\n   * @since 2.0.0\n   */\n  deleteEncryptSecrets(roomName = '', secretId = '') {\n    const roomState = getRoomStateByName(roomName);\n    const encryption = new EncryptedMessaging(roomState);\n    return encryption.deleteEncryptSecrets(secretId);\n  }\n\n  /**\n   * @description Method that sets the secret to be used in encrypting and decrypting messages.\n   * @param {String} roomName - The room name.\n   * @param {String} secretId - The id of the secret to be used for encrypting and decrypting messages.\n   * @alias Skylink#setSelectedSecret\n   * @since 2.0.0\n   */\n  setSelectedSecret(roomName = '', secretId = '') {\n    const roomState = getRoomStateByName(roomName);\n    const encryption = new EncryptedMessaging(roomState);\n    encryption.setSelectedSecretId(secretId);\n  }\n\n  /**\n   * @description Method that returns the secret used in encrypting and decrypting messages.\n   * @param {String} roomName - The room name.\n   * @param {String} secretId - The id of the secret.\n   * @returns {String} secret - The secret used for encrypting and decrypting messages.\n   * @alias Skylink#getSelectedSecret\n   * @since 2.0.0\n   */\n  getSelectedSecret(roomName, secretId) {\n    const roomState = getRoomStateByName(roomName);\n    const encryption = new EncryptedMessaging(roomState);\n    return encryption.getSelectedSecretId(secretId);\n  }\n\n  /**\n   * @description Method that overrides the persistent message feature configured at the key level.\n   * <blockquote class=\"info\">\n   *   Note that to set message persistence at the app level, the persistent message feature MUST be enabled at the key level in the Temasys\n   *   Developers Console. Messages will also only be persisted if the messages are encrypted, are public messages and, are sent via the signaling\n   *   server using the [{@link Skylink#sendMessage|sendMessage}] method.\n   * </blockquote>\n   * @param {String} roomName - The room name.\n   * @param {Boolean} isPersistent - The flag if messages should be persisted.\n   */\n  setMessagePersistence(roomName, isPersistent) {\n    const roomState = getRoomStateByName(roomName);\n    const asyncMessaging = new AsyncMessaging(roomState);\n    return asyncMessaging.setMessagePersistence(isPersistent);\n  }\n\n  /**\n   * @description Method that retrieves the persistent message feature configured.\n   * @param {String} roomName - The room name.\n   * @returns {Boolean} isPersistent\n   */\n  getMessagePersistence(roomName) {\n    const roomState = getRoomStateByName(roomName);\n    const asyncMessaging = new AsyncMessaging(roomState);\n    return asyncMessaging.getMessagePersistence();\n  }\n}\n\nexport default SkylinkPublicInterface;\n","/**\n * @description Exports {@link Skylink}, {@link SkylinkLogger} and {@link SkylinkConstants}\n * */\nimport io from 'socket.io-client';\nimport AdapterJS from './adapter';\nimport SkylinkStates from './skylink-states';\nimport SkylinkPublicInterface from './public/index';\nimport SkylinkLogger from './logger/index';\nimport SkylinkEventManager from './utils/skylinkEventManager';\nimport * as constants from './constants';\nimport messages from './messages';\nimport { SkylinkAPIServer } from './server-communication';\n\n/**\n * @description AdapterJS provides polyfills and cross-browser mediaStreamHelpers for WebRTC.\n * @see {@link https://github.com/Temasys/AdapterJS}\n * @global\n */\nwindow.AdapterJS = AdapterJS;\n/**\n * @description Socket.IO enables real-time, bidirectional and event-based communication. It works on every platform, browser or device, focusing equally on reliability and speed.\n * @see {@link https://socket.io/}\n * @global\n */\nwindow.io = io;\n\n/**\n * @description State manager for accessing SkylinkJS states.\n * @type {SkylinkStates}\n * @private\n */\nconst skylinkStates = new SkylinkStates();\n\n/**\n * @description Stores options passed into init.\n * @type {initOptions}\n * @private\n */\nlet initOptions = {};\nlet userInitOptions = {};\n\nconst SkylinkEvents = constants.EVENTS;\n\n/**\n * @classdesc Class representing a SkylinkJS instance.\n * @example\n * import Skylink from 'skylinkjs';\n *\n * const initOptions = {\n *    // Obtain your app key from {@link https://console.temasys.io}\n *    appKey: 'temasys-appKey-XXXXX-XXXXXX',\n *    defaultRoom: \"Default_Room\",\n * };\n *\n * const skylink = new Skylink(initOptions);\n */\nclass Skylink extends SkylinkPublicInterface {\n  /**\n   * @description Creates a SkylinkJS instance.\n   * @param {initOptions} options - Skylink authentication and initialisation configuration options.\n   * @private\n   */\n  constructor(options) {\n    super();\n\n    /**\n     * @description Init options passed to API server to set certain values.\n     * @type {initOptions}\n     * @private\n     */\n    const parsedOptions = new SkylinkAPIServer().init(options);\n\n    Skylink.setInitOptions(parsedOptions);\n  }\n\n  /**\n   * @description Method that retrieves the Skylink state.\n   * @param {SkylinkRoom.id} roomKey - The id/key of the room.\n   * @return {SkylinkState| Object}\n   * @private\n   */\n  static getSkylinkState(roomKey = null) {\n    if (roomKey) {\n      return skylinkStates.getState(roomKey);\n    }\n    return skylinkStates.getAllStates();\n  }\n\n  /**\n   * @description Method that sets the Skylink state keyed by room id.\n   * @param {SkylinkState} state\n   * @param {SkylinkRoom.id} roomKey - The id/key of the room.\n   * @private\n   */\n  static setSkylinkState(state, roomKey) {\n    if (roomKey) {\n      skylinkStates.setState(state);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  static removeSkylinkState(roomKey) {\n    if (roomKey) {\n      return skylinkStates.removeStateByRoomId(roomKey);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  static clearRoomStateFromSingletons(roomKey) {\n    if (roomKey) {\n      return skylinkStates.clearRoomStateFromSingletons(roomKey);\n    }\n  }\n\n  /**\n   * @description Method that retrieves the complete initOptions values (default + user specified).\n   * @return {initOptions}\n   * @private\n   */\n  static getInitOptions() {\n    return initOptions;\n  }\n\n  /**\n   * @description Method that stores the complete initOptions values (default + user specified).\n   * @param {initOptions} options\n   * @private\n   */\n  static setInitOptions(options) {\n    initOptions = options;\n  }\n\n  /**\n   * @description Method that stores the initOptions specified by the user.\n   * @param {initOptions} options\n   * @private\n   */\n  static setUserInitOptions(options) {\n    userInitOptions = options;\n  }\n\n  /**\n   * @description Method that retrieves the initOptions specified by the user.\n   * @private\n   */\n  static getUserInitOptions() {\n    return userInitOptions;\n  }\n\n  /**\n   * @description Logs an error when Skylink state is not found for a roomKey.\n   * @param {String} keyOrName - The id/key of the room or the room name.\n   * @private\n   */\n  static logNoRoomState(keyOrName) {\n    SkylinkLogger.log.ERROR(`${messages.ROOM_STATE.NOT_FOUND} - ${keyOrName}`);\n  }\n}\n\nexport default Skylink;\nexport {\n  SkylinkLogger,\n  SkylinkEventManager,\n  SkylinkEvents,\n  constants as SkylinkConstants,\n};\n"],"sourceRoot":""}